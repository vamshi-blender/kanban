(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();function iS(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var sS={exports:{}},bu={},aS={exports:{}},ae={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rl=Symbol.for("react.element"),PA=Symbol.for("react.portal"),DA=Symbol.for("react.fragment"),LA=Symbol.for("react.strict_mode"),UA=Symbol.for("react.profiler"),HA=Symbol.for("react.provider"),FA=Symbol.for("react.context"),BA=Symbol.for("react.forward_ref"),zA=Symbol.for("react.suspense"),KA=Symbol.for("react.memo"),jA=Symbol.for("react.lazy"),Hg=Symbol.iterator;function $A(n){return n===null||typeof n!="object"?null:(n=Hg&&n[Hg]||n["@@iterator"],typeof n=="function"?n:null)}var lS={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},cS=Object.assign,uS={};function Is(n,e,t){this.props=n,this.context=e,this.refs=uS,this.updater=t||lS}Is.prototype.isReactComponent={};Is.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Is.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function dS(){}dS.prototype=Is.prototype;function wp(n,e,t){this.props=n,this.context=e,this.refs=uS,this.updater=t||lS}var Tp=wp.prototype=new dS;Tp.constructor=wp;cS(Tp,Is.prototype);Tp.isPureReactComponent=!0;var Fg=Array.isArray,hS=Object.prototype.hasOwnProperty,Ep={current:null},fS={key:!0,ref:!0,__self:!0,__source:!0};function pS(n,e,t){var r,o={},i=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(i=""+e.key),e)hS.call(e,r)&&!fS.hasOwnProperty(r)&&(o[r]=e[r]);var a=arguments.length-2;if(a===1)o.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];o.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)o[r]===void 0&&(o[r]=a[r]);return{$$typeof:rl,type:n,key:i,ref:s,props:o,_owner:Ep.current}}function VA(n,e){return{$$typeof:rl,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function kp(n){return typeof n=="object"&&n!==null&&n.$$typeof===rl}function WA(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Bg=/\/+/g;function Od(n,e){return typeof n=="object"&&n!==null&&n.key!=null?WA(""+n.key):e.toString(36)}function rc(n,e,t,r,o){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(i){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case rl:case PA:s=!0}}if(s)return s=n,o=o(s),n=r===""?"."+Od(s,0):r,Fg(o)?(t="",n!=null&&(t=n.replace(Bg,"$&/")+"/"),rc(o,e,t,"",function(c){return c})):o!=null&&(kp(o)&&(o=VA(o,t+(!o.key||s&&s.key===o.key?"":(""+o.key).replace(Bg,"$&/")+"/")+n)),e.push(o)),1;if(s=0,r=r===""?".":r+":",Fg(n))for(var a=0;a<n.length;a++){i=n[a];var l=r+Od(i,a);s+=rc(i,e,t,l,o)}else if(l=$A(n),typeof l=="function")for(n=l.call(n),a=0;!(i=n.next()).done;)i=i.value,l=r+Od(i,a++),s+=rc(i,e,t,l,o);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function Tl(n,e,t){if(n==null)return n;var r=[],o=0;return rc(n,r,"","",function(i){return e.call(t,i,o++)}),r}function qA(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Kt={current:null},oc={transition:null},GA={ReactCurrentDispatcher:Kt,ReactCurrentBatchConfig:oc,ReactCurrentOwner:Ep};function mS(){throw Error("act(...) is not supported in production builds of React.")}ae.Children={map:Tl,forEach:function(n,e,t){Tl(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return Tl(n,function(){e++}),e},toArray:function(n){return Tl(n,function(e){return e})||[]},only:function(n){if(!kp(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};ae.Component=Is;ae.Fragment=DA;ae.Profiler=UA;ae.PureComponent=wp;ae.StrictMode=LA;ae.Suspense=zA;ae.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=GA;ae.act=mS;ae.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=cS({},n.props),o=n.key,i=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,s=Ep.current),e.key!==void 0&&(o=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)hS.call(e,l)&&!fS.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:rl,type:n.type,key:o,ref:i,props:r,_owner:s}};ae.createContext=function(n){return n={$$typeof:FA,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:HA,_context:n},n.Consumer=n};ae.createElement=pS;ae.createFactory=function(n){var e=pS.bind(null,n);return e.type=n,e};ae.createRef=function(){return{current:null}};ae.forwardRef=function(n){return{$$typeof:BA,render:n}};ae.isValidElement=kp;ae.lazy=function(n){return{$$typeof:jA,_payload:{_status:-1,_result:n},_init:qA}};ae.memo=function(n,e){return{$$typeof:KA,type:n,compare:e===void 0?null:e}};ae.startTransition=function(n){var e=oc.transition;oc.transition={};try{n()}finally{oc.transition=e}};ae.unstable_act=mS;ae.useCallback=function(n,e){return Kt.current.useCallback(n,e)};ae.useContext=function(n){return Kt.current.useContext(n)};ae.useDebugValue=function(){};ae.useDeferredValue=function(n){return Kt.current.useDeferredValue(n)};ae.useEffect=function(n,e){return Kt.current.useEffect(n,e)};ae.useId=function(){return Kt.current.useId()};ae.useImperativeHandle=function(n,e,t){return Kt.current.useImperativeHandle(n,e,t)};ae.useInsertionEffect=function(n,e){return Kt.current.useInsertionEffect(n,e)};ae.useLayoutEffect=function(n,e){return Kt.current.useLayoutEffect(n,e)};ae.useMemo=function(n,e){return Kt.current.useMemo(n,e)};ae.useReducer=function(n,e,t){return Kt.current.useReducer(n,e,t)};ae.useRef=function(n){return Kt.current.useRef(n)};ae.useState=function(n){return Kt.current.useState(n)};ae.useSyncExternalStore=function(n,e,t){return Kt.current.useSyncExternalStore(n,e,t)};ae.useTransition=function(){return Kt.current.useTransition()};ae.version="18.3.1";aS.exports=ae;var S=aS.exports;const ie=iS(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QA=S,YA=Symbol.for("react.element"),JA=Symbol.for("react.fragment"),XA=Object.prototype.hasOwnProperty,ZA=QA.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e0={key:!0,ref:!0,__self:!0,__source:!0};function gS(n,e,t){var r,o={},i=null,s=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)XA.call(e,r)&&!e0.hasOwnProperty(r)&&(o[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)o[r]===void 0&&(o[r]=e[r]);return{$$typeof:YA,type:n,key:i,ref:s,props:o,_owner:ZA.current}}bu.Fragment=JA;bu.jsx=gS;bu.jsxs=gS;sS.exports=bu;var E=sS.exports,yS={exports:{}},vn={},vS={exports:{}},CS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(L,V){var G=L.length;L.push(V);e:for(;0<G;){var le=G-1>>>1,te=L[le];if(0<o(te,V))L[le]=V,L[G]=te,G=le;else break e}}function t(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var V=L[0],G=L.pop();if(G!==V){L[0]=G;e:for(var le=0,te=L.length,_e=te>>>1;le<_e;){var $e=2*(le+1)-1,ne=L[$e],j=$e+1,J=L[j];if(0>o(ne,G))j<te&&0>o(J,ne)?(L[le]=J,L[j]=G,le=j):(L[le]=ne,L[$e]=G,le=$e);else if(j<te&&0>o(J,G))L[le]=J,L[j]=G,le=j;else break e}}return V}function o(L,V){var G=L.sortIndex-V.sortIndex;return G!==0?G:L.id-V.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var s=Date,a=s.now();n.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(L){for(var V=t(c);V!==null;){if(V.callback===null)r(c);else if(V.startTime<=L)r(c),V.sortIndex=V.expirationTime,e(l,V);else break;V=t(c)}}function w(L){if(m=!1,C(L),!p)if(t(l)!==null)p=!0,Wt(I);else{var V=t(c);V!==null&&He(w,V.startTime-L)}}function I(L,V){p=!1,m&&(m=!1,g(k),k=-1),f=!0;var G=h;try{for(C(V),d=t(l);d!==null&&(!(d.expirationTime>V)||L&&!q());){var le=d.callback;if(typeof le=="function"){d.callback=null,h=d.priorityLevel;var te=le(d.expirationTime<=V);V=n.unstable_now(),typeof te=="function"?d.callback=te:d===t(l)&&r(l),C(V)}else r(l);d=t(l)}if(d!==null)var _e=!0;else{var $e=t(c);$e!==null&&He(w,$e.startTime-V),_e=!1}return _e}finally{d=null,h=G,f=!1}}var A=!1,R=null,k=-1,M=5,O=-1;function q(){return!(n.unstable_now()-O<M)}function de(){if(R!==null){var L=n.unstable_now();O=L;var V=!0;try{V=R(!0,L)}finally{V?pe():(A=!1,R=null)}}else A=!1}var pe;if(typeof y=="function")pe=function(){y(de)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,tn=Ee.port2;Ee.port1.onmessage=de,pe=function(){tn.postMessage(null)}}else pe=function(){v(de,0)};function Wt(L){R=L,A||(A=!0,pe())}function He(L,V){k=v(function(){L(n.unstable_now())},V)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(L){L.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,Wt(I))},n.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):M=0<L?Math.floor(1e3/L):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(L){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var G=h;h=V;try{return L()}finally{h=G}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(L,V){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var G=h;h=L;try{return V()}finally{h=G}},n.unstable_scheduleCallback=function(L,V,G){var le=n.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?le+G:le):G=le,L){case 1:var te=-1;break;case 2:te=250;break;case 5:te=1073741823;break;case 4:te=1e4;break;default:te=5e3}return te=G+te,L={id:u++,callback:V,priorityLevel:L,startTime:G,expirationTime:te,sortIndex:-1},G>le?(L.sortIndex=G,e(c,L),t(l)===null&&L===t(c)&&(m?(g(k),k=-1):m=!0,He(w,G-le))):(L.sortIndex=te,e(l,L),p||f||(p=!0,Wt(I))),L},n.unstable_shouldYield=q,n.unstable_wrapCallback=function(L){var V=h;return function(){var G=h;h=V;try{return L.apply(this,arguments)}finally{h=G}}}})(CS);vS.exports=CS;var t0=vS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var n0=S,yn=t0;function _(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var SS=new Set,Ia={};function gi(n,e){as(n,e),as(n+"Capture",e)}function as(n,e){for(Ia[n]=e,n=0;n<e.length;n++)SS.add(e[n])}var xr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Dh=Object.prototype.hasOwnProperty,r0=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,zg={},Kg={};function o0(n){return Dh.call(Kg,n)?!0:Dh.call(zg,n)?!1:r0.test(n)?Kg[n]=!0:(zg[n]=!0,!1)}function i0(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function s0(n,e,t,r){if(e===null||typeof e>"u"||i0(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function jt(n,e,t,r,o,i,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=o,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=s}var Tt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Tt[n]=new jt(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Tt[e]=new jt(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Tt[n]=new jt(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Tt[n]=new jt(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Tt[n]=new jt(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Tt[n]=new jt(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Tt[n]=new jt(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Tt[n]=new jt(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Tt[n]=new jt(n,5,!1,n.toLowerCase(),null,!1,!1)});var Ip=/[\-:]([a-z])/g;function Ap(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(Ip,Ap);Tt[e]=new jt(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(Ip,Ap);Tt[e]=new jt(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(Ip,Ap);Tt[e]=new jt(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Tt[n]=new jt(n,1,!1,n.toLowerCase(),null,!1,!1)});Tt.xlinkHref=new jt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Tt[n]=new jt(n,1,!1,n.toLowerCase(),null,!0,!0)});function bp(n,e,t,r){var o=Tt.hasOwnProperty(e)?Tt[e]:null;(o!==null?o.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(s0(e,t,o,r)&&(t=null),r||o===null?o0(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):o.mustUseProperty?n[o.propertyName]=t===null?o.type===3?!1:"":t:(e=o.attributeName,r=o.attributeNamespace,t===null?n.removeAttribute(e):(o=o.type,t=o===3||o===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Ur=n0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,El=Symbol.for("react.element"),Mi=Symbol.for("react.portal"),_i=Symbol.for("react.fragment"),Rp=Symbol.for("react.strict_mode"),Lh=Symbol.for("react.profiler"),wS=Symbol.for("react.provider"),TS=Symbol.for("react.context"),Np=Symbol.for("react.forward_ref"),Uh=Symbol.for("react.suspense"),Hh=Symbol.for("react.suspense_list"),xp=Symbol.for("react.memo"),Wr=Symbol.for("react.lazy"),ES=Symbol.for("react.offscreen"),jg=Symbol.iterator;function Fs(n){return n===null||typeof n!="object"?null:(n=jg&&n[jg]||n["@@iterator"],typeof n=="function"?n:null)}var Ue=Object.assign,Md;function Gs(n){if(Md===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Md=e&&e[1]||""}return`
`+Md+n}var _d=!1;function Pd(n,e){if(!n||_d)return"";_d=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var o=c.stack.split(`
`),i=r.stack.split(`
`),s=o.length-1,a=i.length-1;1<=s&&0<=a&&o[s]!==i[a];)a--;for(;1<=s&&0<=a;s--,a--)if(o[s]!==i[a]){if(s!==1||a!==1)do if(s--,a--,0>a||o[s]!==i[a]){var l=`
`+o[s].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=s&&0<=a);break}}}finally{_d=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?Gs(n):""}function a0(n){switch(n.tag){case 5:return Gs(n.type);case 16:return Gs("Lazy");case 13:return Gs("Suspense");case 19:return Gs("SuspenseList");case 0:case 2:case 15:return n=Pd(n.type,!1),n;case 11:return n=Pd(n.type.render,!1),n;case 1:return n=Pd(n.type,!0),n;default:return""}}function Fh(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case _i:return"Fragment";case Mi:return"Portal";case Lh:return"Profiler";case Rp:return"StrictMode";case Uh:return"Suspense";case Hh:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case TS:return(n.displayName||"Context")+".Consumer";case wS:return(n._context.displayName||"Context")+".Provider";case Np:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case xp:return e=n.displayName||null,e!==null?e:Fh(n.type)||"Memo";case Wr:e=n._payload,n=n._init;try{return Fh(n(e))}catch{}}return null}function l0(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Fh(e);case 8:return e===Rp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Eo(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function kS(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function c0(n){var e=kS(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var o=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return o.call(this)},set:function(s){r=""+s,i.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function kl(n){n._valueTracker||(n._valueTracker=c0(n))}function IS(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=kS(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function Tc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Bh(n,e){var t=e.checked;return Ue({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function $g(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Eo(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function AS(n,e){e=e.checked,e!=null&&bp(n,"checked",e,!1)}function zh(n,e){AS(n,e);var t=Eo(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?Kh(n,e.type,t):e.hasOwnProperty("defaultValue")&&Kh(n,e.type,Eo(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Vg(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function Kh(n,e,t){(e!=="number"||Tc(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Qs=Array.isArray;function Qi(n,e,t,r){if(n=n.options,e){e={};for(var o=0;o<t.length;o++)e["$"+t[o]]=!0;for(t=0;t<n.length;t++)o=e.hasOwnProperty("$"+n[t].value),n[t].selected!==o&&(n[t].selected=o),o&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Eo(t),e=null,o=0;o<n.length;o++){if(n[o].value===t){n[o].selected=!0,r&&(n[o].defaultSelected=!0);return}e!==null||n[o].disabled||(e=n[o])}e!==null&&(e.selected=!0)}}function jh(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(_(91));return Ue({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Wg(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(_(92));if(Qs(t)){if(1<t.length)throw Error(_(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Eo(t)}}function bS(n,e){var t=Eo(e.value),r=Eo(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function qg(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function RS(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function $h(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?RS(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var Il,NS=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,o){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,o)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(Il=Il||document.createElement("div"),Il.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Il.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Aa(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var na={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},u0=["Webkit","ms","Moz","O"];Object.keys(na).forEach(function(n){u0.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),na[e]=na[n]})});function xS(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||na.hasOwnProperty(n)&&na[n]?(""+e).trim():e+"px"}function OS(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,o=xS(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,o):n[t]=o}}var d0=Ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Vh(n,e){if(e){if(d0[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(_(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(_(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(_(61))}if(e.style!=null&&typeof e.style!="object")throw Error(_(62))}}function Wh(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qh=null;function Op(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var Gh=null,Yi=null,Ji=null;function Gg(n){if(n=sl(n)){if(typeof Gh!="function")throw Error(_(280));var e=n.stateNode;e&&(e=Mu(e),Gh(n.stateNode,n.type,e))}}function MS(n){Yi?Ji?Ji.push(n):Ji=[n]:Yi=n}function _S(){if(Yi){var n=Yi,e=Ji;if(Ji=Yi=null,Gg(n),e)for(n=0;n<e.length;n++)Gg(e[n])}}function PS(n,e){return n(e)}function DS(){}var Dd=!1;function LS(n,e,t){if(Dd)return n(e,t);Dd=!0;try{return PS(n,e,t)}finally{Dd=!1,(Yi!==null||Ji!==null)&&(DS(),_S())}}function ba(n,e){var t=n.stateNode;if(t===null)return null;var r=Mu(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(_(231,e,typeof t));return t}var Qh=!1;if(xr)try{var Bs={};Object.defineProperty(Bs,"passive",{get:function(){Qh=!0}}),window.addEventListener("test",Bs,Bs),window.removeEventListener("test",Bs,Bs)}catch{Qh=!1}function h0(n,e,t,r,o,i,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var ra=!1,Ec=null,kc=!1,Yh=null,f0={onError:function(n){ra=!0,Ec=n}};function p0(n,e,t,r,o,i,s,a,l){ra=!1,Ec=null,h0.apply(f0,arguments)}function m0(n,e,t,r,o,i,s,a,l){if(p0.apply(this,arguments),ra){if(ra){var c=Ec;ra=!1,Ec=null}else throw Error(_(198));kc||(kc=!0,Yh=c)}}function yi(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function US(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Qg(n){if(yi(n)!==n)throw Error(_(188))}function g0(n){var e=n.alternate;if(!e){if(e=yi(n),e===null)throw Error(_(188));return e!==n?null:n}for(var t=n,r=e;;){var o=t.return;if(o===null)break;var i=o.alternate;if(i===null){if(r=o.return,r!==null){t=r;continue}break}if(o.child===i.child){for(i=o.child;i;){if(i===t)return Qg(o),n;if(i===r)return Qg(o),e;i=i.sibling}throw Error(_(188))}if(t.return!==r.return)t=o,r=i;else{for(var s=!1,a=o.child;a;){if(a===t){s=!0,t=o,r=i;break}if(a===r){s=!0,r=o,t=i;break}a=a.sibling}if(!s){for(a=i.child;a;){if(a===t){s=!0,t=i,r=o;break}if(a===r){s=!0,r=i,t=o;break}a=a.sibling}if(!s)throw Error(_(189))}}if(t.alternate!==r)throw Error(_(190))}if(t.tag!==3)throw Error(_(188));return t.stateNode.current===t?n:e}function HS(n){return n=g0(n),n!==null?FS(n):null}function FS(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=FS(n);if(e!==null)return e;n=n.sibling}return null}var BS=yn.unstable_scheduleCallback,Yg=yn.unstable_cancelCallback,y0=yn.unstable_shouldYield,v0=yn.unstable_requestPaint,Ke=yn.unstable_now,C0=yn.unstable_getCurrentPriorityLevel,Mp=yn.unstable_ImmediatePriority,zS=yn.unstable_UserBlockingPriority,Ic=yn.unstable_NormalPriority,S0=yn.unstable_LowPriority,KS=yn.unstable_IdlePriority,Ru=null,lr=null;function w0(n){if(lr&&typeof lr.onCommitFiberRoot=="function")try{lr.onCommitFiberRoot(Ru,n,void 0,(n.current.flags&128)===128)}catch{}}var Fn=Math.clz32?Math.clz32:k0,T0=Math.log,E0=Math.LN2;function k0(n){return n>>>=0,n===0?32:31-(T0(n)/E0|0)|0}var Al=64,bl=4194304;function Ys(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Ac(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,o=n.suspendedLanes,i=n.pingedLanes,s=t&268435455;if(s!==0){var a=s&~o;a!==0?r=Ys(a):(i&=s,i!==0&&(r=Ys(i)))}else s=t&~o,s!==0?r=Ys(s):i!==0&&(r=Ys(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&o)&&(o=r&-r,i=e&-e,o>=i||o===16&&(i&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Fn(e),o=1<<t,r|=n[t],e&=~o;return r}function I0(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function A0(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,o=n.expirationTimes,i=n.pendingLanes;0<i;){var s=31-Fn(i),a=1<<s,l=o[s];l===-1?(!(a&t)||a&r)&&(o[s]=I0(a,e)):l<=e&&(n.expiredLanes|=a),i&=~a}}function Jh(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function jS(){var n=Al;return Al<<=1,!(Al&4194240)&&(Al=64),n}function Ld(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function ol(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Fn(e),n[e]=t}function b0(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var o=31-Fn(t),i=1<<o;e[o]=0,r[o]=-1,n[o]=-1,t&=~i}}function _p(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Fn(t),o=1<<r;o&e|n[r]&e&&(n[r]|=e),t&=~o}}var ge=0;function $S(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var VS,Pp,WS,qS,GS,Xh=!1,Rl=[],ao=null,lo=null,co=null,Ra=new Map,Na=new Map,Jr=[],R0="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Jg(n,e){switch(n){case"focusin":case"focusout":ao=null;break;case"dragenter":case"dragleave":lo=null;break;case"mouseover":case"mouseout":co=null;break;case"pointerover":case"pointerout":Ra.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Na.delete(e.pointerId)}}function zs(n,e,t,r,o,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:i,targetContainers:[o]},e!==null&&(e=sl(e),e!==null&&Pp(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,o!==null&&e.indexOf(o)===-1&&e.push(o),n)}function N0(n,e,t,r,o){switch(e){case"focusin":return ao=zs(ao,n,e,t,r,o),!0;case"dragenter":return lo=zs(lo,n,e,t,r,o),!0;case"mouseover":return co=zs(co,n,e,t,r,o),!0;case"pointerover":var i=o.pointerId;return Ra.set(i,zs(Ra.get(i)||null,n,e,t,r,o)),!0;case"gotpointercapture":return i=o.pointerId,Na.set(i,zs(Na.get(i)||null,n,e,t,r,o)),!0}return!1}function QS(n){var e=zo(n.target);if(e!==null){var t=yi(e);if(t!==null){if(e=t.tag,e===13){if(e=US(t),e!==null){n.blockedOn=e,GS(n.priority,function(){WS(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function ic(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Zh(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);qh=r,t.target.dispatchEvent(r),qh=null}else return e=sl(t),e!==null&&Pp(e),n.blockedOn=t,!1;e.shift()}return!0}function Xg(n,e,t){ic(n)&&t.delete(e)}function x0(){Xh=!1,ao!==null&&ic(ao)&&(ao=null),lo!==null&&ic(lo)&&(lo=null),co!==null&&ic(co)&&(co=null),Ra.forEach(Xg),Na.forEach(Xg)}function Ks(n,e){n.blockedOn===e&&(n.blockedOn=null,Xh||(Xh=!0,yn.unstable_scheduleCallback(yn.unstable_NormalPriority,x0)))}function xa(n){function e(o){return Ks(o,n)}if(0<Rl.length){Ks(Rl[0],n);for(var t=1;t<Rl.length;t++){var r=Rl[t];r.blockedOn===n&&(r.blockedOn=null)}}for(ao!==null&&Ks(ao,n),lo!==null&&Ks(lo,n),co!==null&&Ks(co,n),Ra.forEach(e),Na.forEach(e),t=0;t<Jr.length;t++)r=Jr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Jr.length&&(t=Jr[0],t.blockedOn===null);)QS(t),t.blockedOn===null&&Jr.shift()}var Xi=Ur.ReactCurrentBatchConfig,bc=!0;function O0(n,e,t,r){var o=ge,i=Xi.transition;Xi.transition=null;try{ge=1,Dp(n,e,t,r)}finally{ge=o,Xi.transition=i}}function M0(n,e,t,r){var o=ge,i=Xi.transition;Xi.transition=null;try{ge=4,Dp(n,e,t,r)}finally{ge=o,Xi.transition=i}}function Dp(n,e,t,r){if(bc){var o=Zh(n,e,t,r);if(o===null)Wd(n,e,r,Rc,t),Jg(n,r);else if(N0(o,n,e,t,r))r.stopPropagation();else if(Jg(n,r),e&4&&-1<R0.indexOf(n)){for(;o!==null;){var i=sl(o);if(i!==null&&VS(i),i=Zh(n,e,t,r),i===null&&Wd(n,e,r,Rc,t),i===o)break;o=i}o!==null&&r.stopPropagation()}else Wd(n,e,r,null,t)}}var Rc=null;function Zh(n,e,t,r){if(Rc=null,n=Op(r),n=zo(n),n!==null)if(e=yi(n),e===null)n=null;else if(t=e.tag,t===13){if(n=US(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Rc=n,null}function YS(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(C0()){case Mp:return 1;case zS:return 4;case Ic:case S0:return 16;case KS:return 536870912;default:return 16}default:return 16}}var eo=null,Lp=null,sc=null;function JS(){if(sc)return sc;var n,e=Lp,t=e.length,r,o="value"in eo?eo.value:eo.textContent,i=o.length;for(n=0;n<t&&e[n]===o[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===o[i-r];r++);return sc=o.slice(n,1<r?1-r:void 0)}function ac(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function Nl(){return!0}function Zg(){return!1}function Cn(n){function e(t,r,o,i,s){this._reactName=t,this._targetInst=o,this.type=r,this.nativeEvent=i,this.target=s,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?Nl:Zg,this.isPropagationStopped=Zg,this}return Ue(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=Nl)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=Nl)},persist:function(){},isPersistent:Nl}),e}var As={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Up=Cn(As),il=Ue({},As,{view:0,detail:0}),_0=Cn(il),Ud,Hd,js,Nu=Ue({},il,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Hp,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==js&&(js&&n.type==="mousemove"?(Ud=n.screenX-js.screenX,Hd=n.screenY-js.screenY):Hd=Ud=0,js=n),Ud)},movementY:function(n){return"movementY"in n?n.movementY:Hd}}),ey=Cn(Nu),P0=Ue({},Nu,{dataTransfer:0}),D0=Cn(P0),L0=Ue({},il,{relatedTarget:0}),Fd=Cn(L0),U0=Ue({},As,{animationName:0,elapsedTime:0,pseudoElement:0}),H0=Cn(U0),F0=Ue({},As,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),B0=Cn(F0),z0=Ue({},As,{data:0}),ty=Cn(z0),K0={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},j0={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},$0={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function V0(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=$0[n])?!!e[n]:!1}function Hp(){return V0}var W0=Ue({},il,{key:function(n){if(n.key){var e=K0[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=ac(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?j0[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Hp,charCode:function(n){return n.type==="keypress"?ac(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ac(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),q0=Cn(W0),G0=Ue({},Nu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),ny=Cn(G0),Q0=Ue({},il,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Hp}),Y0=Cn(Q0),J0=Ue({},As,{propertyName:0,elapsedTime:0,pseudoElement:0}),X0=Cn(J0),Z0=Ue({},Nu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),eb=Cn(Z0),tb=[9,13,27,32],Fp=xr&&"CompositionEvent"in window,oa=null;xr&&"documentMode"in document&&(oa=document.documentMode);var nb=xr&&"TextEvent"in window&&!oa,XS=xr&&(!Fp||oa&&8<oa&&11>=oa),ry=" ",oy=!1;function ZS(n,e){switch(n){case"keyup":return tb.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ew(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Pi=!1;function rb(n,e){switch(n){case"compositionend":return ew(e);case"keypress":return e.which!==32?null:(oy=!0,ry);case"textInput":return n=e.data,n===ry&&oy?null:n;default:return null}}function ob(n,e){if(Pi)return n==="compositionend"||!Fp&&ZS(n,e)?(n=JS(),sc=Lp=eo=null,Pi=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return XS&&e.locale!=="ko"?null:e.data;default:return null}}var ib={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function iy(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!ib[n.type]:e==="textarea"}function tw(n,e,t,r){MS(r),e=Nc(e,"onChange"),0<e.length&&(t=new Up("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ia=null,Oa=null;function sb(n){hw(n,0)}function xu(n){var e=Ui(n);if(IS(e))return n}function ab(n,e){if(n==="change")return e}var nw=!1;if(xr){var Bd;if(xr){var zd="oninput"in document;if(!zd){var sy=document.createElement("div");sy.setAttribute("oninput","return;"),zd=typeof sy.oninput=="function"}Bd=zd}else Bd=!1;nw=Bd&&(!document.documentMode||9<document.documentMode)}function ay(){ia&&(ia.detachEvent("onpropertychange",rw),Oa=ia=null)}function rw(n){if(n.propertyName==="value"&&xu(Oa)){var e=[];tw(e,Oa,n,Op(n)),LS(sb,e)}}function lb(n,e,t){n==="focusin"?(ay(),ia=e,Oa=t,ia.attachEvent("onpropertychange",rw)):n==="focusout"&&ay()}function cb(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return xu(Oa)}function ub(n,e){if(n==="click")return xu(e)}function db(n,e){if(n==="input"||n==="change")return xu(e)}function hb(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var jn=typeof Object.is=="function"?Object.is:hb;function Ma(n,e){if(jn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var o=t[r];if(!Dh.call(e,o)||!jn(n[o],e[o]))return!1}return!0}function ly(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function cy(n,e){var t=ly(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=ly(t)}}function ow(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?ow(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function iw(){for(var n=window,e=Tc();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=Tc(n.document)}return e}function Bp(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function fb(n){var e=iw(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&ow(t.ownerDocument.documentElement,t)){if(r!==null&&Bp(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var o=t.textContent.length,i=Math.min(r.start,o);r=r.end===void 0?i:Math.min(r.end,o),!n.extend&&i>r&&(o=r,r=i,i=o),o=cy(t,i);var s=cy(t,r);o&&s&&(n.rangeCount!==1||n.anchorNode!==o.node||n.anchorOffset!==o.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(o.node,o.offset),n.removeAllRanges(),i>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var pb=xr&&"documentMode"in document&&11>=document.documentMode,Di=null,ef=null,sa=null,tf=!1;function uy(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;tf||Di==null||Di!==Tc(r)||(r=Di,"selectionStart"in r&&Bp(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),sa&&Ma(sa,r)||(sa=r,r=Nc(ef,"onSelect"),0<r.length&&(e=new Up("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=Di)))}function xl(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Li={animationend:xl("Animation","AnimationEnd"),animationiteration:xl("Animation","AnimationIteration"),animationstart:xl("Animation","AnimationStart"),transitionend:xl("Transition","TransitionEnd")},Kd={},sw={};xr&&(sw=document.createElement("div").style,"AnimationEvent"in window||(delete Li.animationend.animation,delete Li.animationiteration.animation,delete Li.animationstart.animation),"TransitionEvent"in window||delete Li.transitionend.transition);function Ou(n){if(Kd[n])return Kd[n];if(!Li[n])return n;var e=Li[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in sw)return Kd[n]=e[t];return n}var aw=Ou("animationend"),lw=Ou("animationiteration"),cw=Ou("animationstart"),uw=Ou("transitionend"),dw=new Map,dy="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ro(n,e){dw.set(n,e),gi(e,[n])}for(var jd=0;jd<dy.length;jd++){var $d=dy[jd],mb=$d.toLowerCase(),gb=$d[0].toUpperCase()+$d.slice(1);Ro(mb,"on"+gb)}Ro(aw,"onAnimationEnd");Ro(lw,"onAnimationIteration");Ro(cw,"onAnimationStart");Ro("dblclick","onDoubleClick");Ro("focusin","onFocus");Ro("focusout","onBlur");Ro(uw,"onTransitionEnd");as("onMouseEnter",["mouseout","mouseover"]);as("onMouseLeave",["mouseout","mouseover"]);as("onPointerEnter",["pointerout","pointerover"]);as("onPointerLeave",["pointerout","pointerover"]);gi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));gi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));gi("onBeforeInput",["compositionend","keypress","textInput","paste"]);gi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));gi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Js="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),yb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Js));function hy(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,m0(r,e,void 0,n),n.currentTarget=null}function hw(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],o=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&o.isPropagationStopped())break e;hy(o,a,c),i=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&o.isPropagationStopped())break e;hy(o,a,c),i=l}}}if(kc)throw n=Yh,kc=!1,Yh=null,n}function Ae(n,e){var t=e[af];t===void 0&&(t=e[af]=new Set);var r=n+"__bubble";t.has(r)||(fw(e,n,2,!1),t.add(r))}function Vd(n,e,t){var r=0;e&&(r|=4),fw(t,n,r,e)}var Ol="_reactListening"+Math.random().toString(36).slice(2);function _a(n){if(!n[Ol]){n[Ol]=!0,SS.forEach(function(t){t!=="selectionchange"&&(yb.has(t)||Vd(t,!1,n),Vd(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[Ol]||(e[Ol]=!0,Vd("selectionchange",!1,e))}}function fw(n,e,t,r){switch(YS(e)){case 1:var o=O0;break;case 4:o=M0;break;default:o=Dp}t=o.bind(null,e,t,n),o=void 0,!Qh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(o=!0),r?o!==void 0?n.addEventListener(e,t,{capture:!0,passive:o}):n.addEventListener(e,t,!0):o!==void 0?n.addEventListener(e,t,{passive:o}):n.addEventListener(e,t,!1)}function Wd(n,e,t,r,o){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===o||a.nodeType===8&&a.parentNode===o)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===o||l.nodeType===8&&l.parentNode===o))return;s=s.return}for(;a!==null;){if(s=zo(a),s===null)return;if(l=s.tag,l===5||l===6){r=i=s;continue e}a=a.parentNode}}r=r.return}LS(function(){var c=i,u=Op(t),d=[];e:{var h=dw.get(n);if(h!==void 0){var f=Up,p=n;switch(n){case"keypress":if(ac(t)===0)break e;case"keydown":case"keyup":f=q0;break;case"focusin":p="focus",f=Fd;break;case"focusout":p="blur",f=Fd;break;case"beforeblur":case"afterblur":f=Fd;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=ey;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=D0;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=Y0;break;case aw:case lw:case cw:f=H0;break;case uw:f=X0;break;case"scroll":f=_0;break;case"wheel":f=eb;break;case"copy":case"cut":case"paste":f=B0;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=ny}var m=(e&4)!==0,v=!m&&n==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,C;y!==null;){C=y;var w=C.stateNode;if(C.tag===5&&w!==null&&(C=w,g!==null&&(w=ba(y,g),w!=null&&m.push(Pa(y,w,C)))),v)break;y=y.return}0<m.length&&(h=new f(h,p,null,t,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",h&&t!==qh&&(p=t.relatedTarget||t.fromElement)&&(zo(p)||p[Or]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=c,p=p?zo(p):null,p!==null&&(v=yi(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=ey,w="onMouseLeave",g="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(m=ny,w="onPointerLeave",g="onPointerEnter",y="pointer"),v=f==null?h:Ui(f),C=p==null?h:Ui(p),h=new m(w,y+"leave",f,t,u),h.target=v,h.relatedTarget=C,w=null,zo(u)===c&&(m=new m(g,y+"enter",p,t,u),m.target=C,m.relatedTarget=v,w=m),v=w,f&&p)t:{for(m=f,g=p,y=0,C=m;C;C=Ei(C))y++;for(C=0,w=g;w;w=Ei(w))C++;for(;0<y-C;)m=Ei(m),y--;for(;0<C-y;)g=Ei(g),C--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=Ei(m),g=Ei(g)}m=null}else m=null;f!==null&&fy(d,h,f,m,!1),p!==null&&v!==null&&fy(d,v,p,m,!0)}}e:{if(h=c?Ui(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var I=ab;else if(iy(h))if(nw)I=db;else{I=cb;var A=lb}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(I=ub);if(I&&(I=I(n,c))){tw(d,I,t,u);break e}A&&A(n,h,c),n==="focusout"&&(A=h._wrapperState)&&A.controlled&&h.type==="number"&&Kh(h,"number",h.value)}switch(A=c?Ui(c):window,n){case"focusin":(iy(A)||A.contentEditable==="true")&&(Di=A,ef=c,sa=null);break;case"focusout":sa=ef=Di=null;break;case"mousedown":tf=!0;break;case"contextmenu":case"mouseup":case"dragend":tf=!1,uy(d,t,u);break;case"selectionchange":if(pb)break;case"keydown":case"keyup":uy(d,t,u)}var R;if(Fp)e:{switch(n){case"compositionstart":var k="onCompositionStart";break e;case"compositionend":k="onCompositionEnd";break e;case"compositionupdate":k="onCompositionUpdate";break e}k=void 0}else Pi?ZS(n,t)&&(k="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(k="onCompositionStart");k&&(XS&&t.locale!=="ko"&&(Pi||k!=="onCompositionStart"?k==="onCompositionEnd"&&Pi&&(R=JS()):(eo=u,Lp="value"in eo?eo.value:eo.textContent,Pi=!0)),A=Nc(c,k),0<A.length&&(k=new ty(k,n,null,t,u),d.push({event:k,listeners:A}),R?k.data=R:(R=ew(t),R!==null&&(k.data=R)))),(R=nb?rb(n,t):ob(n,t))&&(c=Nc(c,"onBeforeInput"),0<c.length&&(u=new ty("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=R))}hw(d,e)})}function Pa(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Nc(n,e){for(var t=e+"Capture",r=[];n!==null;){var o=n,i=o.stateNode;o.tag===5&&i!==null&&(o=i,i=ba(n,t),i!=null&&r.unshift(Pa(n,i,o)),i=ba(n,e),i!=null&&r.push(Pa(n,i,o))),n=n.return}return r}function Ei(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function fy(n,e,t,r,o){for(var i=e._reactName,s=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,o?(l=ba(t,i),l!=null&&s.unshift(Pa(t,l,a))):o||(l=ba(t,i),l!=null&&s.push(Pa(t,l,a)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var vb=/\r\n?/g,Cb=/\u0000|\uFFFD/g;function py(n){return(typeof n=="string"?n:""+n).replace(vb,`
`).replace(Cb,"")}function Ml(n,e,t){if(e=py(e),py(n)!==e&&t)throw Error(_(425))}function xc(){}var nf=null,rf=null;function of(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var sf=typeof setTimeout=="function"?setTimeout:void 0,Sb=typeof clearTimeout=="function"?clearTimeout:void 0,my=typeof Promise=="function"?Promise:void 0,wb=typeof queueMicrotask=="function"?queueMicrotask:typeof my<"u"?function(n){return my.resolve(null).then(n).catch(Tb)}:sf;function Tb(n){setTimeout(function(){throw n})}function qd(n,e){var t=e,r=0;do{var o=t.nextSibling;if(n.removeChild(t),o&&o.nodeType===8)if(t=o.data,t==="/$"){if(r===0){n.removeChild(o),xa(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=o}while(t);xa(e)}function uo(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function gy(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var bs=Math.random().toString(36).slice(2),rr="__reactFiber$"+bs,Da="__reactProps$"+bs,Or="__reactContainer$"+bs,af="__reactEvents$"+bs,Eb="__reactListeners$"+bs,kb="__reactHandles$"+bs;function zo(n){var e=n[rr];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Or]||t[rr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=gy(n);n!==null;){if(t=n[rr])return t;n=gy(n)}return e}n=t,t=n.parentNode}return null}function sl(n){return n=n[rr]||n[Or],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Ui(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(_(33))}function Mu(n){return n[Da]||null}var lf=[],Hi=-1;function No(n){return{current:n}}function Re(n){0>Hi||(n.current=lf[Hi],lf[Hi]=null,Hi--)}function Te(n,e){Hi++,lf[Hi]=n.current,n.current=e}var ko={},xt=No(ko),Yt=No(!1),ti=ko;function ls(n,e){var t=n.type.contextTypes;if(!t)return ko;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var o={},i;for(i in t)o[i]=e[i];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=o),o}function Jt(n){return n=n.childContextTypes,n!=null}function Oc(){Re(Yt),Re(xt)}function yy(n,e,t){if(xt.current!==ko)throw Error(_(168));Te(xt,e),Te(Yt,t)}function pw(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var o in r)if(!(o in e))throw Error(_(108,l0(n)||"Unknown",o));return Ue({},t,r)}function Mc(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||ko,ti=xt.current,Te(xt,n),Te(Yt,Yt.current),!0}function vy(n,e,t){var r=n.stateNode;if(!r)throw Error(_(169));t?(n=pw(n,e,ti),r.__reactInternalMemoizedMergedChildContext=n,Re(Yt),Re(xt),Te(xt,n)):Re(Yt),Te(Yt,t)}var Sr=null,_u=!1,Gd=!1;function mw(n){Sr===null?Sr=[n]:Sr.push(n)}function Ib(n){_u=!0,mw(n)}function xo(){if(!Gd&&Sr!==null){Gd=!0;var n=0,e=ge;try{var t=Sr;for(ge=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}Sr=null,_u=!1}catch(o){throw Sr!==null&&(Sr=Sr.slice(n+1)),BS(Mp,xo),o}finally{ge=e,Gd=!1}}return null}var Fi=[],Bi=0,_c=null,Pc=0,kn=[],In=0,ni=null,wr=1,Tr="";function Uo(n,e){Fi[Bi++]=Pc,Fi[Bi++]=_c,_c=n,Pc=e}function gw(n,e,t){kn[In++]=wr,kn[In++]=Tr,kn[In++]=ni,ni=n;var r=wr;n=Tr;var o=32-Fn(r)-1;r&=~(1<<o),t+=1;var i=32-Fn(e)+o;if(30<i){var s=o-o%5;i=(r&(1<<s)-1).toString(32),r>>=s,o-=s,wr=1<<32-Fn(e)+o|t<<o|r,Tr=i+n}else wr=1<<i|t<<o|r,Tr=n}function zp(n){n.return!==null&&(Uo(n,1),gw(n,1,0))}function Kp(n){for(;n===_c;)_c=Fi[--Bi],Fi[Bi]=null,Pc=Fi[--Bi],Fi[Bi]=null;for(;n===ni;)ni=kn[--In],kn[In]=null,Tr=kn[--In],kn[In]=null,wr=kn[--In],kn[In]=null}var mn=null,hn=null,Oe=!1,Un=null;function yw(n,e){var t=bn(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function Cy(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,mn=n,hn=uo(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,mn=n,hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=ni!==null?{id:wr,overflow:Tr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=bn(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,mn=n,hn=null,!0):!1;default:return!1}}function cf(n){return(n.mode&1)!==0&&(n.flags&128)===0}function uf(n){if(Oe){var e=hn;if(e){var t=e;if(!Cy(n,e)){if(cf(n))throw Error(_(418));e=uo(t.nextSibling);var r=mn;e&&Cy(n,e)?yw(r,t):(n.flags=n.flags&-4097|2,Oe=!1,mn=n)}}else{if(cf(n))throw Error(_(418));n.flags=n.flags&-4097|2,Oe=!1,mn=n}}}function Sy(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;mn=n}function _l(n){if(n!==mn)return!1;if(!Oe)return Sy(n),Oe=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!of(n.type,n.memoizedProps)),e&&(e=hn)){if(cf(n))throw vw(),Error(_(418));for(;e;)yw(n,e),e=uo(e.nextSibling)}if(Sy(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(_(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){hn=uo(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}hn=null}}else hn=mn?uo(n.stateNode.nextSibling):null;return!0}function vw(){for(var n=hn;n;)n=uo(n.nextSibling)}function cs(){hn=mn=null,Oe=!1}function jp(n){Un===null?Un=[n]:Un.push(n)}var Ab=Ur.ReactCurrentBatchConfig;function $s(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(_(309));var r=t.stateNode}if(!r)throw Error(_(147,n));var o=r,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(s){var a=o.refs;s===null?delete a[i]:a[i]=s},e._stringRef=i,e)}if(typeof n!="string")throw Error(_(284));if(!t._owner)throw Error(_(290,n))}return n}function Pl(n,e){throw n=Object.prototype.toString.call(e),Error(_(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function wy(n){var e=n._init;return e(n._payload)}function Cw(n){function e(g,y){if(n){var C=g.deletions;C===null?(g.deletions=[y],g.flags|=16):C.push(y)}}function t(g,y){if(!n)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function o(g,y){return g=mo(g,y),g.index=0,g.sibling=null,g}function i(g,y,C){return g.index=C,n?(C=g.alternate,C!==null?(C=C.index,C<y?(g.flags|=2,y):C):(g.flags|=2,y)):(g.flags|=1048576,y)}function s(g){return n&&g.alternate===null&&(g.flags|=2),g}function a(g,y,C,w){return y===null||y.tag!==6?(y=th(C,g.mode,w),y.return=g,y):(y=o(y,C),y.return=g,y)}function l(g,y,C,w){var I=C.type;return I===_i?u(g,y,C.props.children,w,C.key):y!==null&&(y.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Wr&&wy(I)===y.type)?(w=o(y,C.props),w.ref=$s(g,y,C),w.return=g,w):(w=pc(C.type,C.key,C.props,null,g.mode,w),w.ref=$s(g,y,C),w.return=g,w)}function c(g,y,C,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==C.containerInfo||y.stateNode.implementation!==C.implementation?(y=nh(C,g.mode,w),y.return=g,y):(y=o(y,C.children||[]),y.return=g,y)}function u(g,y,C,w,I){return y===null||y.tag!==7?(y=Qo(C,g.mode,w,I),y.return=g,y):(y=o(y,C),y.return=g,y)}function d(g,y,C){if(typeof y=="string"&&y!==""||typeof y=="number")return y=th(""+y,g.mode,C),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case El:return C=pc(y.type,y.key,y.props,null,g.mode,C),C.ref=$s(g,null,y),C.return=g,C;case Mi:return y=nh(y,g.mode,C),y.return=g,y;case Wr:var w=y._init;return d(g,w(y._payload),C)}if(Qs(y)||Fs(y))return y=Qo(y,g.mode,C,null),y.return=g,y;Pl(g,y)}return null}function h(g,y,C,w){var I=y!==null?y.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return I!==null?null:a(g,y,""+C,w);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case El:return C.key===I?l(g,y,C,w):null;case Mi:return C.key===I?c(g,y,C,w):null;case Wr:return I=C._init,h(g,y,I(C._payload),w)}if(Qs(C)||Fs(C))return I!==null?null:u(g,y,C,w,null);Pl(g,C)}return null}function f(g,y,C,w,I){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(C)||null,a(y,g,""+w,I);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case El:return g=g.get(w.key===null?C:w.key)||null,l(y,g,w,I);case Mi:return g=g.get(w.key===null?C:w.key)||null,c(y,g,w,I);case Wr:var A=w._init;return f(g,y,C,A(w._payload),I)}if(Qs(w)||Fs(w))return g=g.get(C)||null,u(y,g,w,I,null);Pl(y,w)}return null}function p(g,y,C,w){for(var I=null,A=null,R=y,k=y=0,M=null;R!==null&&k<C.length;k++){R.index>k?(M=R,R=null):M=R.sibling;var O=h(g,R,C[k],w);if(O===null){R===null&&(R=M);break}n&&R&&O.alternate===null&&e(g,R),y=i(O,y,k),A===null?I=O:A.sibling=O,A=O,R=M}if(k===C.length)return t(g,R),Oe&&Uo(g,k),I;if(R===null){for(;k<C.length;k++)R=d(g,C[k],w),R!==null&&(y=i(R,y,k),A===null?I=R:A.sibling=R,A=R);return Oe&&Uo(g,k),I}for(R=r(g,R);k<C.length;k++)M=f(R,g,k,C[k],w),M!==null&&(n&&M.alternate!==null&&R.delete(M.key===null?k:M.key),y=i(M,y,k),A===null?I=M:A.sibling=M,A=M);return n&&R.forEach(function(q){return e(g,q)}),Oe&&Uo(g,k),I}function m(g,y,C,w){var I=Fs(C);if(typeof I!="function")throw Error(_(150));if(C=I.call(C),C==null)throw Error(_(151));for(var A=I=null,R=y,k=y=0,M=null,O=C.next();R!==null&&!O.done;k++,O=C.next()){R.index>k?(M=R,R=null):M=R.sibling;var q=h(g,R,O.value,w);if(q===null){R===null&&(R=M);break}n&&R&&q.alternate===null&&e(g,R),y=i(q,y,k),A===null?I=q:A.sibling=q,A=q,R=M}if(O.done)return t(g,R),Oe&&Uo(g,k),I;if(R===null){for(;!O.done;k++,O=C.next())O=d(g,O.value,w),O!==null&&(y=i(O,y,k),A===null?I=O:A.sibling=O,A=O);return Oe&&Uo(g,k),I}for(R=r(g,R);!O.done;k++,O=C.next())O=f(R,g,k,O.value,w),O!==null&&(n&&O.alternate!==null&&R.delete(O.key===null?k:O.key),y=i(O,y,k),A===null?I=O:A.sibling=O,A=O);return n&&R.forEach(function(de){return e(g,de)}),Oe&&Uo(g,k),I}function v(g,y,C,w){if(typeof C=="object"&&C!==null&&C.type===_i&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case El:e:{for(var I=C.key,A=y;A!==null;){if(A.key===I){if(I=C.type,I===_i){if(A.tag===7){t(g,A.sibling),y=o(A,C.props.children),y.return=g,g=y;break e}}else if(A.elementType===I||typeof I=="object"&&I!==null&&I.$$typeof===Wr&&wy(I)===A.type){t(g,A.sibling),y=o(A,C.props),y.ref=$s(g,A,C),y.return=g,g=y;break e}t(g,A);break}else e(g,A);A=A.sibling}C.type===_i?(y=Qo(C.props.children,g.mode,w,C.key),y.return=g,g=y):(w=pc(C.type,C.key,C.props,null,g.mode,w),w.ref=$s(g,y,C),w.return=g,g=w)}return s(g);case Mi:e:{for(A=C.key;y!==null;){if(y.key===A)if(y.tag===4&&y.stateNode.containerInfo===C.containerInfo&&y.stateNode.implementation===C.implementation){t(g,y.sibling),y=o(y,C.children||[]),y.return=g,g=y;break e}else{t(g,y);break}else e(g,y);y=y.sibling}y=nh(C,g.mode,w),y.return=g,g=y}return s(g);case Wr:return A=C._init,v(g,y,A(C._payload),w)}if(Qs(C))return p(g,y,C,w);if(Fs(C))return m(g,y,C,w);Pl(g,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,y!==null&&y.tag===6?(t(g,y.sibling),y=o(y,C),y.return=g,g=y):(t(g,y),y=th(C,g.mode,w),y.return=g,g=y),s(g)):t(g,y)}return v}var us=Cw(!0),Sw=Cw(!1),Dc=No(null),Lc=null,zi=null,$p=null;function Vp(){$p=zi=Lc=null}function Wp(n){var e=Dc.current;Re(Dc),n._currentValue=e}function df(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function Zi(n,e){Lc=n,$p=zi=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Qt=!0),n.firstContext=null)}function On(n){var e=n._currentValue;if($p!==n)if(n={context:n,memoizedValue:e,next:null},zi===null){if(Lc===null)throw Error(_(308));zi=n,Lc.dependencies={lanes:0,firstContext:n}}else zi=zi.next=n;return e}var Ko=null;function qp(n){Ko===null?Ko=[n]:Ko.push(n)}function ww(n,e,t,r){var o=e.interleaved;return o===null?(t.next=t,qp(e)):(t.next=o.next,o.next=t),e.interleaved=t,Mr(n,r)}function Mr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var qr=!1;function Gp(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Tw(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Ar(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function ho(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,ue&2){var o=r.pending;return o===null?e.next=e:(e.next=o.next,o.next=e),r.pending=e,Mr(n,t)}return o=r.interleaved,o===null?(e.next=e,qp(r)):(e.next=o.next,o.next=e),r.interleaved=e,Mr(n,t)}function lc(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,_p(n,t)}}function Ty(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var o=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?o=i=s:i=i.next=s,t=t.next}while(t!==null);i===null?o=i=e:i=i.next=e}else o=i=e;t={baseState:r.baseState,firstBaseUpdate:o,lastBaseUpdate:i,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Uc(n,e,t,r){var o=n.updateQueue;qr=!1;var i=o.firstBaseUpdate,s=o.lastBaseUpdate,a=o.shared.pending;if(a!==null){o.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?i=c:s.next=c,s=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var d=o.baseState;s=0,u=c=l=null,a=i;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=n,m=a;switch(h=e,f=t,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Ue({},d,h);break e;case 2:qr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,h=o.effects,h===null?o.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,s|=h;if(a=a.next,a===null){if(a=o.shared.pending,a===null)break;h=a,a=h.next,h.next=null,o.lastBaseUpdate=h,o.shared.pending=null}}while(!0);if(u===null&&(l=d),o.baseState=l,o.firstBaseUpdate=c,o.lastBaseUpdate=u,e=o.shared.interleaved,e!==null){o=e;do s|=o.lane,o=o.next;while(o!==e)}else i===null&&(o.shared.lanes=0);oi|=s,n.lanes=s,n.memoizedState=d}}function Ey(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],o=r.callback;if(o!==null){if(r.callback=null,r=t,typeof o!="function")throw Error(_(191,o));o.call(r)}}}var al={},cr=No(al),La=No(al),Ua=No(al);function jo(n){if(n===al)throw Error(_(174));return n}function Qp(n,e){switch(Te(Ua,e),Te(La,n),Te(cr,al),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:$h(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=$h(e,n)}Re(cr),Te(cr,e)}function ds(){Re(cr),Re(La),Re(Ua)}function Ew(n){jo(Ua.current);var e=jo(cr.current),t=$h(e,n.type);e!==t&&(Te(La,n),Te(cr,t))}function Yp(n){La.current===n&&(Re(cr),Re(La))}var De=No(0);function Hc(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Qd=[];function Jp(){for(var n=0;n<Qd.length;n++)Qd[n]._workInProgressVersionPrimary=null;Qd.length=0}var cc=Ur.ReactCurrentDispatcher,Yd=Ur.ReactCurrentBatchConfig,ri=0,Le=null,Ze=null,st=null,Fc=!1,aa=!1,Ha=0,bb=0;function Et(){throw Error(_(321))}function Xp(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!jn(n[t],e[t]))return!1;return!0}function Zp(n,e,t,r,o,i){if(ri=i,Le=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,cc.current=n===null||n.memoizedState===null?Ob:Mb,n=t(r,o),aa){i=0;do{if(aa=!1,Ha=0,25<=i)throw Error(_(301));i+=1,st=Ze=null,e.updateQueue=null,cc.current=_b,n=t(r,o)}while(aa)}if(cc.current=Bc,e=Ze!==null&&Ze.next!==null,ri=0,st=Ze=Le=null,Fc=!1,e)throw Error(_(300));return n}function em(){var n=Ha!==0;return Ha=0,n}function er(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Le.memoizedState=st=n:st=st.next=n,st}function Mn(){if(Ze===null){var n=Le.alternate;n=n!==null?n.memoizedState:null}else n=Ze.next;var e=st===null?Le.memoizedState:st.next;if(e!==null)st=e,Ze=n;else{if(n===null)throw Error(_(310));Ze=n,n={memoizedState:Ze.memoizedState,baseState:Ze.baseState,baseQueue:Ze.baseQueue,queue:Ze.queue,next:null},st===null?Le.memoizedState=st=n:st=st.next=n}return st}function Fa(n,e){return typeof e=="function"?e(n):e}function Jd(n){var e=Mn(),t=e.queue;if(t===null)throw Error(_(311));t.lastRenderedReducer=n;var r=Ze,o=r.baseQueue,i=t.pending;if(i!==null){if(o!==null){var s=o.next;o.next=i.next,i.next=s}r.baseQueue=o=i,t.pending=null}if(o!==null){i=o.next,r=r.baseState;var a=s=null,l=null,c=i;do{var u=c.lane;if((ri&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Le.lanes|=u,oi|=u}c=c.next}while(c!==null&&c!==i);l===null?s=r:l.next=a,jn(r,e.memoizedState)||(Qt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){o=n;do i=o.lane,Le.lanes|=i,oi|=i,o=o.next;while(o!==n)}else o===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Xd(n){var e=Mn(),t=e.queue;if(t===null)throw Error(_(311));t.lastRenderedReducer=n;var r=t.dispatch,o=t.pending,i=e.memoizedState;if(o!==null){t.pending=null;var s=o=o.next;do i=n(i,s.action),s=s.next;while(s!==o);jn(i,e.memoizedState)||(Qt=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,r]}function kw(){}function Iw(n,e){var t=Le,r=Mn(),o=e(),i=!jn(r.memoizedState,o);if(i&&(r.memoizedState=o,Qt=!0),r=r.queue,tm(Rw.bind(null,t,r,n),[n]),r.getSnapshot!==e||i||st!==null&&st.memoizedState.tag&1){if(t.flags|=2048,Ba(9,bw.bind(null,t,r,o,e),void 0,null),ut===null)throw Error(_(349));ri&30||Aw(t,e,o)}return o}function Aw(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function bw(n,e,t,r){e.value=t,e.getSnapshot=r,Nw(e)&&xw(n)}function Rw(n,e,t){return t(function(){Nw(e)&&xw(n)})}function Nw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!jn(n,t)}catch{return!0}}function xw(n){var e=Mr(n,1);e!==null&&Bn(e,n,1,-1)}function ky(n){var e=er();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Fa,lastRenderedState:n},e.queue=n,n=n.dispatch=xb.bind(null,Le,n),[e.memoizedState,n]}function Ba(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function Ow(){return Mn().memoizedState}function uc(n,e,t,r){var o=er();Le.flags|=n,o.memoizedState=Ba(1|e,t,void 0,r===void 0?null:r)}function Pu(n,e,t,r){var o=Mn();r=r===void 0?null:r;var i=void 0;if(Ze!==null){var s=Ze.memoizedState;if(i=s.destroy,r!==null&&Xp(r,s.deps)){o.memoizedState=Ba(e,t,i,r);return}}Le.flags|=n,o.memoizedState=Ba(1|e,t,i,r)}function Iy(n,e){return uc(8390656,8,n,e)}function tm(n,e){return Pu(2048,8,n,e)}function Mw(n,e){return Pu(4,2,n,e)}function _w(n,e){return Pu(4,4,n,e)}function Pw(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Dw(n,e,t){return t=t!=null?t.concat([n]):null,Pu(4,4,Pw.bind(null,e,n),t)}function nm(){}function Lw(n,e){var t=Mn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Xp(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function Uw(n,e){var t=Mn();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Xp(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function Hw(n,e,t){return ri&21?(jn(t,e)||(t=jS(),Le.lanes|=t,oi|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Qt=!0),n.memoizedState=t)}function Rb(n,e){var t=ge;ge=t!==0&&4>t?t:4,n(!0);var r=Yd.transition;Yd.transition={};try{n(!1),e()}finally{ge=t,Yd.transition=r}}function Fw(){return Mn().memoizedState}function Nb(n,e,t){var r=po(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},Bw(n))zw(e,t);else if(t=ww(n,e,t,r),t!==null){var o=Ut();Bn(t,n,r,o),Kw(t,e,r)}}function xb(n,e,t){var r=po(n),o={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(Bw(n))zw(e,o);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var s=e.lastRenderedState,a=i(s,t);if(o.hasEagerState=!0,o.eagerState=a,jn(a,s)){var l=e.interleaved;l===null?(o.next=o,qp(e)):(o.next=l.next,l.next=o),e.interleaved=o;return}}catch{}finally{}t=ww(n,e,o,r),t!==null&&(o=Ut(),Bn(t,n,r,o),Kw(t,e,r))}}function Bw(n){var e=n.alternate;return n===Le||e!==null&&e===Le}function zw(n,e){aa=Fc=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Kw(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,_p(n,t)}}var Bc={readContext:On,useCallback:Et,useContext:Et,useEffect:Et,useImperativeHandle:Et,useInsertionEffect:Et,useLayoutEffect:Et,useMemo:Et,useReducer:Et,useRef:Et,useState:Et,useDebugValue:Et,useDeferredValue:Et,useTransition:Et,useMutableSource:Et,useSyncExternalStore:Et,useId:Et,unstable_isNewReconciler:!1},Ob={readContext:On,useCallback:function(n,e){return er().memoizedState=[n,e===void 0?null:e],n},useContext:On,useEffect:Iy,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,uc(4194308,4,Pw.bind(null,e,n),t)},useLayoutEffect:function(n,e){return uc(4194308,4,n,e)},useInsertionEffect:function(n,e){return uc(4,2,n,e)},useMemo:function(n,e){var t=er();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=er();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=Nb.bind(null,Le,n),[r.memoizedState,n]},useRef:function(n){var e=er();return n={current:n},e.memoizedState=n},useState:ky,useDebugValue:nm,useDeferredValue:function(n){return er().memoizedState=n},useTransition:function(){var n=ky(!1),e=n[0];return n=Rb.bind(null,n[1]),er().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Le,o=er();if(Oe){if(t===void 0)throw Error(_(407));t=t()}else{if(t=e(),ut===null)throw Error(_(349));ri&30||Aw(r,e,t)}o.memoizedState=t;var i={value:t,getSnapshot:e};return o.queue=i,Iy(Rw.bind(null,r,i,n),[n]),r.flags|=2048,Ba(9,bw.bind(null,r,i,t,e),void 0,null),t},useId:function(){var n=er(),e=ut.identifierPrefix;if(Oe){var t=Tr,r=wr;t=(r&~(1<<32-Fn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Ha++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=bb++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},Mb={readContext:On,useCallback:Lw,useContext:On,useEffect:tm,useImperativeHandle:Dw,useInsertionEffect:Mw,useLayoutEffect:_w,useMemo:Uw,useReducer:Jd,useRef:Ow,useState:function(){return Jd(Fa)},useDebugValue:nm,useDeferredValue:function(n){var e=Mn();return Hw(e,Ze.memoizedState,n)},useTransition:function(){var n=Jd(Fa)[0],e=Mn().memoizedState;return[n,e]},useMutableSource:kw,useSyncExternalStore:Iw,useId:Fw,unstable_isNewReconciler:!1},_b={readContext:On,useCallback:Lw,useContext:On,useEffect:tm,useImperativeHandle:Dw,useInsertionEffect:Mw,useLayoutEffect:_w,useMemo:Uw,useReducer:Xd,useRef:Ow,useState:function(){return Xd(Fa)},useDebugValue:nm,useDeferredValue:function(n){var e=Mn();return Ze===null?e.memoizedState=n:Hw(e,Ze.memoizedState,n)},useTransition:function(){var n=Xd(Fa)[0],e=Mn().memoizedState;return[n,e]},useMutableSource:kw,useSyncExternalStore:Iw,useId:Fw,unstable_isNewReconciler:!1};function Pn(n,e){if(n&&n.defaultProps){e=Ue({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function hf(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ue({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var Du={isMounted:function(n){return(n=n._reactInternals)?yi(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=Ut(),o=po(n),i=Ar(r,o);i.payload=e,t!=null&&(i.callback=t),e=ho(n,i,o),e!==null&&(Bn(e,n,o,r),lc(e,n,o))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=Ut(),o=po(n),i=Ar(r,o);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=ho(n,i,o),e!==null&&(Bn(e,n,o,r),lc(e,n,o))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=Ut(),r=po(n),o=Ar(t,r);o.tag=2,e!=null&&(o.callback=e),e=ho(n,o,r),e!==null&&(Bn(e,n,r,t),lc(e,n,r))}};function Ay(n,e,t,r,o,i,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,i,s):e.prototype&&e.prototype.isPureReactComponent?!Ma(t,r)||!Ma(o,i):!0}function jw(n,e,t){var r=!1,o=ko,i=e.contextType;return typeof i=="object"&&i!==null?i=On(i):(o=Jt(e)?ti:xt.current,r=e.contextTypes,i=(r=r!=null)?ls(n,o):ko),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Du,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=o,n.__reactInternalMemoizedMaskedChildContext=i),e}function by(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&Du.enqueueReplaceState(e,e.state,null)}function ff(n,e,t,r){var o=n.stateNode;o.props=t,o.state=n.memoizedState,o.refs={},Gp(n);var i=e.contextType;typeof i=="object"&&i!==null?o.context=On(i):(i=Jt(e)?ti:xt.current,o.context=ls(n,i)),o.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(hf(n,e,i,t),o.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof o.getSnapshotBeforeUpdate=="function"||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(e=o.state,typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount(),e!==o.state&&Du.enqueueReplaceState(o,o.state,null),Uc(n,t,o,r),o.state=n.memoizedState),typeof o.componentDidMount=="function"&&(n.flags|=4194308)}function hs(n,e){try{var t="",r=e;do t+=a0(r),r=r.return;while(r);var o=t}catch(i){o=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:o,digest:null}}function Zd(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function pf(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var Pb=typeof WeakMap=="function"?WeakMap:Map;function $w(n,e,t){t=Ar(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){Kc||(Kc=!0,kf=r),pf(n,e)},t}function Vw(n,e,t){t=Ar(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var o=e.value;t.payload=function(){return r(o)},t.callback=function(){pf(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){pf(n,e),typeof r!="function"&&(fo===null?fo=new Set([this]):fo.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function Ry(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new Pb;var o=new Set;r.set(e,o)}else o=r.get(e),o===void 0&&(o=new Set,r.set(e,o));o.has(t)||(o.add(t),n=Gb.bind(null,n,e,t),e.then(n,n))}function Ny(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function xy(n,e,t,r,o){return n.mode&1?(n.flags|=65536,n.lanes=o,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Ar(-1,1),e.tag=2,ho(t,e,1))),t.lanes|=1),n)}var Db=Ur.ReactCurrentOwner,Qt=!1;function Dt(n,e,t,r){e.child=n===null?Sw(e,null,t,r):us(e,n.child,t,r)}function Oy(n,e,t,r,o){t=t.render;var i=e.ref;return Zi(e,o),r=Zp(n,e,t,r,i,o),t=em(),n!==null&&!Qt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~o,_r(n,e,o)):(Oe&&t&&zp(e),e.flags|=1,Dt(n,e,r,o),e.child)}function My(n,e,t,r,o){if(n===null){var i=t.type;return typeof i=="function"&&!um(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,Ww(n,e,i,r,o)):(n=pc(t.type,null,r,e,e.mode,o),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&o)){var s=i.memoizedProps;if(t=t.compare,t=t!==null?t:Ma,t(s,r)&&n.ref===e.ref)return _r(n,e,o)}return e.flags|=1,n=mo(i,r),n.ref=e.ref,n.return=e,e.child=n}function Ww(n,e,t,r,o){if(n!==null){var i=n.memoizedProps;if(Ma(i,r)&&n.ref===e.ref)if(Qt=!1,e.pendingProps=r=i,(n.lanes&o)!==0)n.flags&131072&&(Qt=!0);else return e.lanes=n.lanes,_r(n,e,o)}return mf(n,e,t,r,o)}function qw(n,e,t){var r=e.pendingProps,o=r.children,i=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(ji,sn),sn|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Te(ji,sn),sn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:t,Te(ji,sn),sn|=r}else i!==null?(r=i.baseLanes|t,e.memoizedState=null):r=t,Te(ji,sn),sn|=r;return Dt(n,e,o,t),e.child}function Gw(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function mf(n,e,t,r,o){var i=Jt(t)?ti:xt.current;return i=ls(e,i),Zi(e,o),t=Zp(n,e,t,r,i,o),r=em(),n!==null&&!Qt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~o,_r(n,e,o)):(Oe&&r&&zp(e),e.flags|=1,Dt(n,e,t,o),e.child)}function _y(n,e,t,r,o){if(Jt(t)){var i=!0;Mc(e)}else i=!1;if(Zi(e,o),e.stateNode===null)dc(n,e),jw(e,t,r),ff(e,t,r,o),r=!0;else if(n===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=t.contextType;typeof c=="object"&&c!==null?c=On(c):(c=Jt(t)?ti:xt.current,c=ls(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&by(e,s,r,c),qr=!1;var h=e.memoizedState;s.state=h,Uc(e,r,s,o),l=e.memoizedState,a!==r||h!==l||Yt.current||qr?(typeof u=="function"&&(hf(e,t,u,r),l=e.memoizedState),(a=qr||Ay(e,t,a,r,h,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,Tw(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:Pn(e.type,a),s.props=c,d=e.pendingProps,h=s.context,l=t.contextType,typeof l=="object"&&l!==null?l=On(l):(l=Jt(t)?ti:xt.current,l=ls(e,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==l)&&by(e,s,r,l),qr=!1,h=e.memoizedState,s.state=h,Uc(e,r,s,o);var p=e.memoizedState;a!==d||h!==p||Yt.current||qr?(typeof f=="function"&&(hf(e,t,f,r),p=e.memoizedState),(c=qr||Ay(e,t,c,r,h,p,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),r=!1)}return gf(n,e,t,r,i,o)}function gf(n,e,t,r,o,i){Gw(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return o&&vy(e,t,!1),_r(n,e,i);r=e.stateNode,Db.current=e;var a=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=us(e,n.child,null,i),e.child=us(e,null,a,i)):Dt(n,e,a,i),e.memoizedState=r.state,o&&vy(e,t,!0),e.child}function Qw(n){var e=n.stateNode;e.pendingContext?yy(n,e.pendingContext,e.pendingContext!==e.context):e.context&&yy(n,e.context,!1),Qp(n,e.containerInfo)}function Py(n,e,t,r,o){return cs(),jp(o),e.flags|=256,Dt(n,e,t,r),e.child}var yf={dehydrated:null,treeContext:null,retryLane:0};function vf(n){return{baseLanes:n,cachePool:null,transitions:null}}function Yw(n,e,t){var r=e.pendingProps,o=De.current,i=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=n!==null&&n.memoizedState===null?!1:(o&2)!==0),a?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(o|=1),Te(De,o&1),n===null)return uf(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,i?(r=e.mode,i=e.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Hu(s,r,0,null),n=Qo(n,r,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=vf(t),e.memoizedState=yf,n):rm(e,s));if(o=n.memoizedState,o!==null&&(a=o.dehydrated,a!==null))return Lb(n,e,s,r,a,o,t);if(i){i=r.fallback,s=e.mode,o=n.child,a=o.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==o?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=mo(o,l),r.subtreeFlags=o.subtreeFlags&14680064),a!==null?i=mo(a,i):(i=Qo(i,s,t,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,s=n.child.memoizedState,s=s===null?vf(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},i.memoizedState=s,i.childLanes=n.childLanes&~t,e.memoizedState=yf,r}return i=n.child,n=i.sibling,r=mo(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function rm(n,e){return e=Hu({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function Dl(n,e,t,r){return r!==null&&jp(r),us(e,n.child,null,t),n=rm(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Lb(n,e,t,r,o,i,s){if(t)return e.flags&256?(e.flags&=-257,r=Zd(Error(_(422))),Dl(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=r.fallback,o=e.mode,r=Hu({mode:"visible",children:r.children},o,0,null),i=Qo(i,o,s,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&us(e,n.child,null,s),e.child.memoizedState=vf(s),e.memoizedState=yf,i);if(!(e.mode&1))return Dl(n,e,s,null);if(o.data==="$!"){if(r=o.nextSibling&&o.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(_(419)),r=Zd(i,r,void 0),Dl(n,e,s,r)}if(a=(s&n.childLanes)!==0,Qt||a){if(r=ut,r!==null){switch(s&-s){case 4:o=2;break;case 16:o=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:o=32;break;case 536870912:o=268435456;break;default:o=0}o=o&(r.suspendedLanes|s)?0:o,o!==0&&o!==i.retryLane&&(i.retryLane=o,Mr(n,o),Bn(r,n,o,-1))}return cm(),r=Zd(Error(_(421))),Dl(n,e,s,r)}return o.data==="$?"?(e.flags|=128,e.child=n.child,e=Qb.bind(null,n),o._reactRetry=e,null):(n=i.treeContext,hn=uo(o.nextSibling),mn=e,Oe=!0,Un=null,n!==null&&(kn[In++]=wr,kn[In++]=Tr,kn[In++]=ni,wr=n.id,Tr=n.overflow,ni=e),e=rm(e,r.children),e.flags|=4096,e)}function Dy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),df(n.return,e,t)}function eh(n,e,t,r,o){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:o}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=t,i.tailMode=o)}function Jw(n,e,t){var r=e.pendingProps,o=r.revealOrder,i=r.tail;if(Dt(n,e,r.children,t),r=De.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&Dy(n,t,e);else if(n.tag===19)Dy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Te(De,r),!(e.mode&1))e.memoizedState=null;else switch(o){case"forwards":for(t=e.child,o=null;t!==null;)n=t.alternate,n!==null&&Hc(n)===null&&(o=t),t=t.sibling;t=o,t===null?(o=e.child,e.child=null):(o=t.sibling,t.sibling=null),eh(e,!1,o,t,i);break;case"backwards":for(t=null,o=e.child,e.child=null;o!==null;){if(n=o.alternate,n!==null&&Hc(n)===null){e.child=o;break}n=o.sibling,o.sibling=t,t=o,o=n}eh(e,!0,t,null,i);break;case"together":eh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function dc(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function _r(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),oi|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(_(153));if(e.child!==null){for(n=e.child,t=mo(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=mo(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Ub(n,e,t){switch(e.tag){case 3:Qw(e),cs();break;case 5:Ew(e);break;case 1:Jt(e.type)&&Mc(e);break;case 4:Qp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,o=e.memoizedProps.value;Te(Dc,r._currentValue),r._currentValue=o;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Te(De,De.current&1),e.flags|=128,null):t&e.child.childLanes?Yw(n,e,t):(Te(De,De.current&1),n=_r(n,e,t),n!==null?n.sibling:null);Te(De,De.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Jw(n,e,t);e.flags|=128}if(o=e.memoizedState,o!==null&&(o.rendering=null,o.tail=null,o.lastEffect=null),Te(De,De.current),r)break;return null;case 22:case 23:return e.lanes=0,qw(n,e,t)}return _r(n,e,t)}var Xw,Cf,Zw,eT;Xw=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Cf=function(){};Zw=function(n,e,t,r){var o=n.memoizedProps;if(o!==r){n=e.stateNode,jo(cr.current);var i=null;switch(t){case"input":o=Bh(n,o),r=Bh(n,r),i=[];break;case"select":o=Ue({},o,{value:void 0}),r=Ue({},r,{value:void 0}),i=[];break;case"textarea":o=jh(n,o),r=jh(n,r),i=[];break;default:typeof o.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=xc)}Vh(t,r);var s;t=null;for(c in o)if(!r.hasOwnProperty(c)&&o.hasOwnProperty(c)&&o[c]!=null)if(c==="style"){var a=o[c];for(s in a)a.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Ia.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=o!=null?o[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(t||(t={}),t[s]=l[s])}else t||(i||(i=[]),i.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Ia.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ae("scroll",n),i||a===l||(i=[])):(i=i||[]).push(c,l))}t&&(i=i||[]).push("style",t);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};eT=function(n,e,t,r){t!==r&&(e.flags|=4)};function Vs(n,e){if(!Oe)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function kt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var o=n.child;o!==null;)t|=o.lanes|o.childLanes,r|=o.subtreeFlags&14680064,r|=o.flags&14680064,o.return=n,o=o.sibling;else for(o=n.child;o!==null;)t|=o.lanes|o.childLanes,r|=o.subtreeFlags,r|=o.flags,o.return=n,o=o.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function Hb(n,e,t){var r=e.pendingProps;switch(Kp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return kt(e),null;case 1:return Jt(e.type)&&Oc(),kt(e),null;case 3:return r=e.stateNode,ds(),Re(Yt),Re(xt),Jp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(_l(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Un!==null&&(bf(Un),Un=null))),Cf(n,e),kt(e),null;case 5:Yp(e);var o=jo(Ua.current);if(t=e.type,n!==null&&e.stateNode!=null)Zw(n,e,t,r,o),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(_(166));return kt(e),null}if(n=jo(cr.current),_l(e)){r=e.stateNode,t=e.type;var i=e.memoizedProps;switch(r[rr]=e,r[Da]=i,n=(e.mode&1)!==0,t){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(o=0;o<Js.length;o++)Ae(Js[o],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":$g(r,i),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ae("invalid",r);break;case"textarea":Wg(r,i),Ae("invalid",r)}Vh(t,i),o=null;for(var s in i)if(i.hasOwnProperty(s)){var a=i[s];s==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&Ml(r.textContent,a,n),o=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&Ml(r.textContent,a,n),o=["children",""+a]):Ia.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Ae("scroll",r)}switch(t){case"input":kl(r),Vg(r,i,!0);break;case"textarea":kl(r),qg(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=xc)}r=o,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=o.nodeType===9?o:o.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=RS(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[rr]=e,n[Da]=r,Xw(n,e,!1,!1),e.stateNode=n;e:{switch(s=Wh(t,r),t){case"dialog":Ae("cancel",n),Ae("close",n),o=r;break;case"iframe":case"object":case"embed":Ae("load",n),o=r;break;case"video":case"audio":for(o=0;o<Js.length;o++)Ae(Js[o],n);o=r;break;case"source":Ae("error",n),o=r;break;case"img":case"image":case"link":Ae("error",n),Ae("load",n),o=r;break;case"details":Ae("toggle",n),o=r;break;case"input":$g(n,r),o=Bh(n,r),Ae("invalid",n);break;case"option":o=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},o=Ue({},r,{value:void 0}),Ae("invalid",n);break;case"textarea":Wg(n,r),o=jh(n,r),Ae("invalid",n);break;default:o=r}Vh(t,o),a=o;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?OS(n,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&NS(n,l)):i==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Aa(n,l):typeof l=="number"&&Aa(n,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ia.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ae("scroll",n):l!=null&&bp(n,i,l,s))}switch(t){case"input":kl(n),Vg(n,r,!1);break;case"textarea":kl(n),qg(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Eo(r.value));break;case"select":n.multiple=!!r.multiple,i=r.value,i!=null?Qi(n,!!r.multiple,i,!1):r.defaultValue!=null&&Qi(n,!!r.multiple,r.defaultValue,!0);break;default:typeof o.onClick=="function"&&(n.onclick=xc)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return kt(e),null;case 6:if(n&&e.stateNode!=null)eT(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(_(166));if(t=jo(Ua.current),jo(cr.current),_l(e)){if(r=e.stateNode,t=e.memoizedProps,r[rr]=e,(i=r.nodeValue!==t)&&(n=mn,n!==null))switch(n.tag){case 3:Ml(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&Ml(r.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[rr]=e,e.stateNode=r}return kt(e),null;case 13:if(Re(De),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Oe&&hn!==null&&e.mode&1&&!(e.flags&128))vw(),cs(),e.flags|=98560,i=!1;else if(i=_l(e),r!==null&&r.dehydrated!==null){if(n===null){if(!i)throw Error(_(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(_(317));i[rr]=e}else cs(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;kt(e),i=!1}else Un!==null&&(bf(Un),Un=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||De.current&1?tt===0&&(tt=3):cm())),e.updateQueue!==null&&(e.flags|=4),kt(e),null);case 4:return ds(),Cf(n,e),n===null&&_a(e.stateNode.containerInfo),kt(e),null;case 10:return Wp(e.type._context),kt(e),null;case 17:return Jt(e.type)&&Oc(),kt(e),null;case 19:if(Re(De),i=e.memoizedState,i===null)return kt(e),null;if(r=(e.flags&128)!==0,s=i.rendering,s===null)if(r)Vs(i,!1);else{if(tt!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=Hc(n),s!==null){for(e.flags|=128,Vs(i,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)i=t,n=r,i.flags&=14680066,s=i.alternate,s===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=s.childLanes,i.lanes=s.lanes,i.child=s.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=s.memoizedProps,i.memoizedState=s.memoizedState,i.updateQueue=s.updateQueue,i.type=s.type,n=s.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Te(De,De.current&1|2),e.child}n=n.sibling}i.tail!==null&&Ke()>fs&&(e.flags|=128,r=!0,Vs(i,!1),e.lanes=4194304)}else{if(!r)if(n=Hc(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),Vs(i,!0),i.tail===null&&i.tailMode==="hidden"&&!s.alternate&&!Oe)return kt(e),null}else 2*Ke()-i.renderingStartTime>fs&&t!==1073741824&&(e.flags|=128,r=!0,Vs(i,!1),e.lanes=4194304);i.isBackwards?(s.sibling=e.child,e.child=s):(t=i.last,t!==null?t.sibling=s:e.child=s,i.last=s)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Ke(),e.sibling=null,t=De.current,Te(De,r?t&1|2:t&1),e):(kt(e),null);case 22:case 23:return lm(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sn&1073741824&&(kt(e),e.subtreeFlags&6&&(e.flags|=8192)):kt(e),null;case 24:return null;case 25:return null}throw Error(_(156,e.tag))}function Fb(n,e){switch(Kp(e),e.tag){case 1:return Jt(e.type)&&Oc(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return ds(),Re(Yt),Re(xt),Jp(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Yp(e),null;case 13:if(Re(De),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(_(340));cs()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Re(De),null;case 4:return ds(),null;case 10:return Wp(e.type._context),null;case 22:case 23:return lm(),null;case 24:return null;default:return null}}var Ll=!1,bt=!1,Bb=typeof WeakSet=="function"?WeakSet:Set,H=null;function Ki(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Be(n,e,r)}else t.current=null}function Sf(n,e,t){try{t()}catch(r){Be(n,e,r)}}var Ly=!1;function zb(n,e){if(nf=bc,n=iw(),Bp(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var o=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=n,h=null;t:for(;;){for(var f;d!==t||o!==0&&d.nodeType!==3||(a=s+o),d!==i||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===n)break t;if(h===t&&++c===o&&(a=s),h===i&&++u===r&&(l=s),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(rf={focusedElem:n,selectionRange:t},bc=!1,H=e;H!==null;)if(e=H,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,H=n;else for(;H!==null;){e=H;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Pn(e.type,m),v);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(_(163))}}catch(w){Be(e,e.return,w)}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}return p=Ly,Ly=!1,p}function la(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var o=r=r.next;do{if((o.tag&n)===n){var i=o.destroy;o.destroy=void 0,i!==void 0&&Sf(e,t,i)}o=o.next}while(o!==r)}}function Lu(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function wf(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function tT(n){var e=n.alternate;e!==null&&(n.alternate=null,tT(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[rr],delete e[Da],delete e[af],delete e[Eb],delete e[kb])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function nT(n){return n.tag===5||n.tag===3||n.tag===4}function Uy(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||nT(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Tf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=xc));else if(r!==4&&(n=n.child,n!==null))for(Tf(n,e,t),n=n.sibling;n!==null;)Tf(n,e,t),n=n.sibling}function Ef(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(Ef(n,e,t),n=n.sibling;n!==null;)Ef(n,e,t),n=n.sibling}var yt=null,Dn=!1;function Kr(n,e,t){for(t=t.child;t!==null;)rT(n,e,t),t=t.sibling}function rT(n,e,t){if(lr&&typeof lr.onCommitFiberUnmount=="function")try{lr.onCommitFiberUnmount(Ru,t)}catch{}switch(t.tag){case 5:bt||Ki(t,e);case 6:var r=yt,o=Dn;yt=null,Kr(n,e,t),yt=r,Dn=o,yt!==null&&(Dn?(n=yt,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):yt.removeChild(t.stateNode));break;case 18:yt!==null&&(Dn?(n=yt,t=t.stateNode,n.nodeType===8?qd(n.parentNode,t):n.nodeType===1&&qd(n,t),xa(n)):qd(yt,t.stateNode));break;case 4:r=yt,o=Dn,yt=t.stateNode.containerInfo,Dn=!0,Kr(n,e,t),yt=r,Dn=o;break;case 0:case 11:case 14:case 15:if(!bt&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){o=r=r.next;do{var i=o,s=i.destroy;i=i.tag,s!==void 0&&(i&2||i&4)&&Sf(t,e,s),o=o.next}while(o!==r)}Kr(n,e,t);break;case 1:if(!bt&&(Ki(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Be(t,e,a)}Kr(n,e,t);break;case 21:Kr(n,e,t);break;case 22:t.mode&1?(bt=(r=bt)||t.memoizedState!==null,Kr(n,e,t),bt=r):Kr(n,e,t);break;default:Kr(n,e,t)}}function Hy(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Bb),e.forEach(function(r){var o=Yb.bind(null,n,r);t.has(r)||(t.add(r),r.then(o,o))})}}function _n(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var o=t[r];try{var i=n,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:yt=a.stateNode,Dn=!1;break e;case 3:yt=a.stateNode.containerInfo,Dn=!0;break e;case 4:yt=a.stateNode.containerInfo,Dn=!0;break e}a=a.return}if(yt===null)throw Error(_(160));rT(i,s,o),yt=null,Dn=!1;var l=o.alternate;l!==null&&(l.return=null),o.return=null}catch(c){Be(o,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)oT(e,n),e=e.sibling}function oT(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(_n(e,n),Xn(n),r&4){try{la(3,n,n.return),Lu(3,n)}catch(m){Be(n,n.return,m)}try{la(5,n,n.return)}catch(m){Be(n,n.return,m)}}break;case 1:_n(e,n),Xn(n),r&512&&t!==null&&Ki(t,t.return);break;case 5:if(_n(e,n),Xn(n),r&512&&t!==null&&Ki(t,t.return),n.flags&32){var o=n.stateNode;try{Aa(o,"")}catch(m){Be(n,n.return,m)}}if(r&4&&(o=n.stateNode,o!=null)){var i=n.memoizedProps,s=t!==null?t.memoizedProps:i,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&AS(o,i),Wh(a,s);var c=Wh(a,i);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?OS(o,d):u==="dangerouslySetInnerHTML"?NS(o,d):u==="children"?Aa(o,d):bp(o,u,d,c)}switch(a){case"input":zh(o,i);break;case"textarea":bS(o,i);break;case"select":var h=o._wrapperState.wasMultiple;o._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?Qi(o,!!i.multiple,f,!1):h!==!!i.multiple&&(i.defaultValue!=null?Qi(o,!!i.multiple,i.defaultValue,!0):Qi(o,!!i.multiple,i.multiple?[]:"",!1))}o[Da]=i}catch(m){Be(n,n.return,m)}}break;case 6:if(_n(e,n),Xn(n),r&4){if(n.stateNode===null)throw Error(_(162));o=n.stateNode,i=n.memoizedProps;try{o.nodeValue=i}catch(m){Be(n,n.return,m)}}break;case 3:if(_n(e,n),Xn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{xa(e.containerInfo)}catch(m){Be(n,n.return,m)}break;case 4:_n(e,n),Xn(n);break;case 13:_n(e,n),Xn(n),o=n.child,o.flags&8192&&(i=o.memoizedState!==null,o.stateNode.isHidden=i,!i||o.alternate!==null&&o.alternate.memoizedState!==null||(sm=Ke())),r&4&&Hy(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(bt=(c=bt)||u,_n(e,n),bt=c):_n(e,n),Xn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(H=n,u=n.child;u!==null;){for(d=H=u;H!==null;){switch(h=H,f=h.child,h.tag){case 0:case 11:case 14:case 15:la(4,h,h.return);break;case 1:Ki(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,t=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Be(r,t,m)}}break;case 5:Ki(h,h.return);break;case 22:if(h.memoizedState!==null){By(d);continue}}f!==null?(f.return=h,H=f):By(d)}u=u.sibling}e:for(u=null,d=n;;){if(d.tag===5){if(u===null){u=d;try{o=d.stateNode,c?(i=o.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=xS("display",s))}catch(m){Be(n,n.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Be(n,n.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:_n(e,n),Xn(n),r&4&&Hy(n);break;case 21:break;default:_n(e,n),Xn(n)}}function Xn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(nT(t)){var r=t;break e}t=t.return}throw Error(_(160))}switch(r.tag){case 5:var o=r.stateNode;r.flags&32&&(Aa(o,""),r.flags&=-33);var i=Uy(n);Ef(n,i,o);break;case 3:case 4:var s=r.stateNode.containerInfo,a=Uy(n);Tf(n,a,s);break;default:throw Error(_(161))}}catch(l){Be(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Kb(n,e,t){H=n,iT(n)}function iT(n,e,t){for(var r=(n.mode&1)!==0;H!==null;){var o=H,i=o.child;if(o.tag===22&&r){var s=o.memoizedState!==null||Ll;if(!s){var a=o.alternate,l=a!==null&&a.memoizedState!==null||bt;a=Ll;var c=bt;if(Ll=s,(bt=l)&&!c)for(H=o;H!==null;)s=H,l=s.child,s.tag===22&&s.memoizedState!==null?zy(o):l!==null?(l.return=s,H=l):zy(o);for(;i!==null;)H=i,iT(i),i=i.sibling;H=o,Ll=a,bt=c}Fy(n)}else o.subtreeFlags&8772&&i!==null?(i.return=o,H=i):Fy(n)}}function Fy(n){for(;H!==null;){var e=H;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:bt||Lu(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!bt)if(t===null)r.componentDidMount();else{var o=e.elementType===e.type?t.memoizedProps:Pn(e.type,t.memoizedProps);r.componentDidUpdate(o,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Ey(e,i,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}Ey(e,s,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&xa(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(_(163))}bt||e.flags&512&&wf(e)}catch(h){Be(e,e.return,h)}}if(e===n){H=null;break}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}}function By(n){for(;H!==null;){var e=H;if(e===n){H=null;break}var t=e.sibling;if(t!==null){t.return=e.return,H=t;break}H=e.return}}function zy(n){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Lu(4,e)}catch(l){Be(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var o=e.return;try{r.componentDidMount()}catch(l){Be(e,o,l)}}var i=e.return;try{wf(e)}catch(l){Be(e,i,l)}break;case 5:var s=e.return;try{wf(e)}catch(l){Be(e,s,l)}}}catch(l){Be(e,e.return,l)}if(e===n){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var jb=Math.ceil,zc=Ur.ReactCurrentDispatcher,om=Ur.ReactCurrentOwner,Nn=Ur.ReactCurrentBatchConfig,ue=0,ut=null,Qe=null,wt=0,sn=0,ji=No(0),tt=0,za=null,oi=0,Uu=0,im=0,ca=null,qt=null,sm=0,fs=1/0,yr=null,Kc=!1,kf=null,fo=null,Ul=!1,to=null,jc=0,ua=0,If=null,hc=-1,fc=0;function Ut(){return ue&6?Ke():hc!==-1?hc:hc=Ke()}function po(n){return n.mode&1?ue&2&&wt!==0?wt&-wt:Ab.transition!==null?(fc===0&&(fc=jS()),fc):(n=ge,n!==0||(n=window.event,n=n===void 0?16:YS(n.type)),n):1}function Bn(n,e,t,r){if(50<ua)throw ua=0,If=null,Error(_(185));ol(n,t,r),(!(ue&2)||n!==ut)&&(n===ut&&(!(ue&2)&&(Uu|=t),tt===4&&Xr(n,wt)),Xt(n,r),t===1&&ue===0&&!(e.mode&1)&&(fs=Ke()+500,_u&&xo()))}function Xt(n,e){var t=n.callbackNode;A0(n,e);var r=Ac(n,n===ut?wt:0);if(r===0)t!==null&&Yg(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Yg(t),e===1)n.tag===0?Ib(Ky.bind(null,n)):mw(Ky.bind(null,n)),wb(function(){!(ue&6)&&xo()}),t=null;else{switch($S(r)){case 1:t=Mp;break;case 4:t=zS;break;case 16:t=Ic;break;case 536870912:t=KS;break;default:t=Ic}t=fT(t,sT.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function sT(n,e){if(hc=-1,fc=0,ue&6)throw Error(_(327));var t=n.callbackNode;if(es()&&n.callbackNode!==t)return null;var r=Ac(n,n===ut?wt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=$c(n,r);else{e=r;var o=ue;ue|=2;var i=lT();(ut!==n||wt!==e)&&(yr=null,fs=Ke()+500,Go(n,e));do try{Wb();break}catch(a){aT(n,a)}while(!0);Vp(),zc.current=i,ue=o,Qe!==null?e=0:(ut=null,wt=0,e=tt)}if(e!==0){if(e===2&&(o=Jh(n),o!==0&&(r=o,e=Af(n,o))),e===1)throw t=za,Go(n,0),Xr(n,r),Xt(n,Ke()),t;if(e===6)Xr(n,r);else{if(o=n.current.alternate,!(r&30)&&!$b(o)&&(e=$c(n,r),e===2&&(i=Jh(n),i!==0&&(r=i,e=Af(n,i))),e===1))throw t=za,Go(n,0),Xr(n,r),Xt(n,Ke()),t;switch(n.finishedWork=o,n.finishedLanes=r,e){case 0:case 1:throw Error(_(345));case 2:Ho(n,qt,yr);break;case 3:if(Xr(n,r),(r&130023424)===r&&(e=sm+500-Ke(),10<e)){if(Ac(n,0)!==0)break;if(o=n.suspendedLanes,(o&r)!==r){Ut(),n.pingedLanes|=n.suspendedLanes&o;break}n.timeoutHandle=sf(Ho.bind(null,n,qt,yr),e);break}Ho(n,qt,yr);break;case 4:if(Xr(n,r),(r&4194240)===r)break;for(e=n.eventTimes,o=-1;0<r;){var s=31-Fn(r);i=1<<s,s=e[s],s>o&&(o=s),r&=~i}if(r=o,r=Ke()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*jb(r/1960))-r,10<r){n.timeoutHandle=sf(Ho.bind(null,n,qt,yr),r);break}Ho(n,qt,yr);break;case 5:Ho(n,qt,yr);break;default:throw Error(_(329))}}}return Xt(n,Ke()),n.callbackNode===t?sT.bind(null,n):null}function Af(n,e){var t=ca;return n.current.memoizedState.isDehydrated&&(Go(n,e).flags|=256),n=$c(n,e),n!==2&&(e=qt,qt=t,e!==null&&bf(e)),n}function bf(n){qt===null?qt=n:qt.push.apply(qt,n)}function $b(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var o=t[r],i=o.getSnapshot;o=o.value;try{if(!jn(i(),o))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Xr(n,e){for(e&=~im,e&=~Uu,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Fn(e),r=1<<t;n[t]=-1,e&=~r}}function Ky(n){if(ue&6)throw Error(_(327));es();var e=Ac(n,0);if(!(e&1))return Xt(n,Ke()),null;var t=$c(n,e);if(n.tag!==0&&t===2){var r=Jh(n);r!==0&&(e=r,t=Af(n,r))}if(t===1)throw t=za,Go(n,0),Xr(n,e),Xt(n,Ke()),t;if(t===6)throw Error(_(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Ho(n,qt,yr),Xt(n,Ke()),null}function am(n,e){var t=ue;ue|=1;try{return n(e)}finally{ue=t,ue===0&&(fs=Ke()+500,_u&&xo())}}function ii(n){to!==null&&to.tag===0&&!(ue&6)&&es();var e=ue;ue|=1;var t=Nn.transition,r=ge;try{if(Nn.transition=null,ge=1,n)return n()}finally{ge=r,Nn.transition=t,ue=e,!(ue&6)&&xo()}}function lm(){sn=ji.current,Re(ji)}function Go(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,Sb(t)),Qe!==null)for(t=Qe.return;t!==null;){var r=t;switch(Kp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Oc();break;case 3:ds(),Re(Yt),Re(xt),Jp();break;case 5:Yp(r);break;case 4:ds();break;case 13:Re(De);break;case 19:Re(De);break;case 10:Wp(r.type._context);break;case 22:case 23:lm()}t=t.return}if(ut=n,Qe=n=mo(n.current,null),wt=sn=e,tt=0,za=null,im=Uu=oi=0,qt=ca=null,Ko!==null){for(e=0;e<Ko.length;e++)if(t=Ko[e],r=t.interleaved,r!==null){t.interleaved=null;var o=r.next,i=t.pending;if(i!==null){var s=i.next;i.next=o,r.next=s}t.pending=r}Ko=null}return n}function aT(n,e){do{var t=Qe;try{if(Vp(),cc.current=Bc,Fc){for(var r=Le.memoizedState;r!==null;){var o=r.queue;o!==null&&(o.pending=null),r=r.next}Fc=!1}if(ri=0,st=Ze=Le=null,aa=!1,Ha=0,om.current=null,t===null||t.return===null){tt=1,za=e,Qe=null;break}e:{var i=n,s=t.return,a=t,l=e;if(e=wt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=Ny(s);if(f!==null){f.flags&=-257,xy(f,s,a,i,e),f.mode&1&&Ry(i,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){Ry(i,c,e),cm();break e}l=Error(_(426))}}else if(Oe&&a.mode&1){var v=Ny(s);if(v!==null){!(v.flags&65536)&&(v.flags|=256),xy(v,s,a,i,e),jp(hs(l,a));break e}}i=l=hs(l,a),tt!==4&&(tt=2),ca===null?ca=[i]:ca.push(i),i=s;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var g=$w(i,l,e);Ty(i,g);break e;case 1:a=l;var y=i.type,C=i.stateNode;if(!(i.flags&128)&&(typeof y.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(fo===null||!fo.has(C)))){i.flags|=65536,e&=-e,i.lanes|=e;var w=Vw(i,a,e);Ty(i,w);break e}}i=i.return}while(i!==null)}uT(t)}catch(I){e=I,Qe===t&&t!==null&&(Qe=t=t.return);continue}break}while(!0)}function lT(){var n=zc.current;return zc.current=Bc,n===null?Bc:n}function cm(){(tt===0||tt===3||tt===2)&&(tt=4),ut===null||!(oi&268435455)&&!(Uu&268435455)||Xr(ut,wt)}function $c(n,e){var t=ue;ue|=2;var r=lT();(ut!==n||wt!==e)&&(yr=null,Go(n,e));do try{Vb();break}catch(o){aT(n,o)}while(!0);if(Vp(),ue=t,zc.current=r,Qe!==null)throw Error(_(261));return ut=null,wt=0,tt}function Vb(){for(;Qe!==null;)cT(Qe)}function Wb(){for(;Qe!==null&&!y0();)cT(Qe)}function cT(n){var e=hT(n.alternate,n,sn);n.memoizedProps=n.pendingProps,e===null?uT(n):Qe=e,om.current=null}function uT(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Fb(t,e),t!==null){t.flags&=32767,Qe=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{tt=6,Qe=null;return}}else if(t=Hb(t,e,sn),t!==null){Qe=t;return}if(e=e.sibling,e!==null){Qe=e;return}Qe=e=n}while(e!==null);tt===0&&(tt=5)}function Ho(n,e,t){var r=ge,o=Nn.transition;try{Nn.transition=null,ge=1,qb(n,e,t,r)}finally{Nn.transition=o,ge=r}return null}function qb(n,e,t,r){do es();while(to!==null);if(ue&6)throw Error(_(327));t=n.finishedWork;var o=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(_(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(b0(n,i),n===ut&&(Qe=ut=null,wt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Ul||(Ul=!0,fT(Ic,function(){return es(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Nn.transition,Nn.transition=null;var s=ge;ge=1;var a=ue;ue|=4,om.current=null,zb(n,t),oT(t,n),fb(rf),bc=!!nf,rf=nf=null,n.current=t,Kb(t),v0(),ue=a,ge=s,Nn.transition=i}else n.current=t;if(Ul&&(Ul=!1,to=n,jc=o),i=n.pendingLanes,i===0&&(fo=null),w0(t.stateNode),Xt(n,Ke()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)o=e[t],r(o.value,{componentStack:o.stack,digest:o.digest});if(Kc)throw Kc=!1,n=kf,kf=null,n;return jc&1&&n.tag!==0&&es(),i=n.pendingLanes,i&1?n===If?ua++:(ua=0,If=n):ua=0,xo(),null}function es(){if(to!==null){var n=$S(jc),e=Nn.transition,t=ge;try{if(Nn.transition=null,ge=16>n?16:n,to===null)var r=!1;else{if(n=to,to=null,jc=0,ue&6)throw Error(_(331));var o=ue;for(ue|=4,H=n.current;H!==null;){var i=H,s=i.child;if(H.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(H=c;H!==null;){var u=H;switch(u.tag){case 0:case 11:case 15:la(8,u,i)}var d=u.child;if(d!==null)d.return=u,H=d;else for(;H!==null;){u=H;var h=u.sibling,f=u.return;if(tT(u),u===c){H=null;break}if(h!==null){h.return=f,H=h;break}H=f}}}var p=i.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}H=i}}if(i.subtreeFlags&2064&&s!==null)s.return=i,H=s;else e:for(;H!==null;){if(i=H,i.flags&2048)switch(i.tag){case 0:case 11:case 15:la(9,i,i.return)}var g=i.sibling;if(g!==null){g.return=i.return,H=g;break e}H=i.return}}var y=n.current;for(H=y;H!==null;){s=H;var C=s.child;if(s.subtreeFlags&2064&&C!==null)C.return=s,H=C;else e:for(s=y;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Lu(9,a)}}catch(I){Be(a,a.return,I)}if(a===s){H=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,H=w;break e}H=a.return}}if(ue=o,xo(),lr&&typeof lr.onPostCommitFiberRoot=="function")try{lr.onPostCommitFiberRoot(Ru,n)}catch{}r=!0}return r}finally{ge=t,Nn.transition=e}}return!1}function jy(n,e,t){e=hs(t,e),e=$w(n,e,1),n=ho(n,e,1),e=Ut(),n!==null&&(ol(n,1,e),Xt(n,e))}function Be(n,e,t){if(n.tag===3)jy(n,n,t);else for(;e!==null;){if(e.tag===3){jy(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(fo===null||!fo.has(r))){n=hs(t,n),n=Vw(e,n,1),e=ho(e,n,1),n=Ut(),e!==null&&(ol(e,1,n),Xt(e,n));break}}e=e.return}}function Gb(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=Ut(),n.pingedLanes|=n.suspendedLanes&t,ut===n&&(wt&t)===t&&(tt===4||tt===3&&(wt&130023424)===wt&&500>Ke()-sm?Go(n,0):im|=t),Xt(n,e)}function dT(n,e){e===0&&(n.mode&1?(e=bl,bl<<=1,!(bl&130023424)&&(bl=4194304)):e=1);var t=Ut();n=Mr(n,e),n!==null&&(ol(n,e,t),Xt(n,t))}function Qb(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),dT(n,t)}function Yb(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,o=n.memoizedState;o!==null&&(t=o.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(_(314))}r!==null&&r.delete(e),dT(n,t)}var hT;hT=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Yt.current)Qt=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Qt=!1,Ub(n,e,t);Qt=!!(n.flags&131072)}else Qt=!1,Oe&&e.flags&1048576&&gw(e,Pc,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;dc(n,e),n=e.pendingProps;var o=ls(e,xt.current);Zi(e,t),o=Zp(null,e,r,n,o,t);var i=em();return e.flags|=1,typeof o=="object"&&o!==null&&typeof o.render=="function"&&o.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Jt(r)?(i=!0,Mc(e)):i=!1,e.memoizedState=o.state!==null&&o.state!==void 0?o.state:null,Gp(e),o.updater=Du,e.stateNode=o,o._reactInternals=e,ff(e,r,n,t),e=gf(null,e,r,!0,i,t)):(e.tag=0,Oe&&i&&zp(e),Dt(null,e,o,t),e=e.child),e;case 16:r=e.elementType;e:{switch(dc(n,e),n=e.pendingProps,o=r._init,r=o(r._payload),e.type=r,o=e.tag=Xb(r),n=Pn(r,n),o){case 0:e=mf(null,e,r,n,t);break e;case 1:e=_y(null,e,r,n,t);break e;case 11:e=Oy(null,e,r,n,t);break e;case 14:e=My(null,e,r,Pn(r.type,n),t);break e}throw Error(_(306,r,""))}return e;case 0:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Pn(r,o),mf(n,e,r,o,t);case 1:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Pn(r,o),_y(n,e,r,o,t);case 3:e:{if(Qw(e),n===null)throw Error(_(387));r=e.pendingProps,i=e.memoizedState,o=i.element,Tw(n,e),Uc(e,r,null,t);var s=e.memoizedState;if(r=s.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){o=hs(Error(_(423)),e),e=Py(n,e,r,t,o);break e}else if(r!==o){o=hs(Error(_(424)),e),e=Py(n,e,r,t,o);break e}else for(hn=uo(e.stateNode.containerInfo.firstChild),mn=e,Oe=!0,Un=null,t=Sw(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(cs(),r===o){e=_r(n,e,t);break e}Dt(n,e,r,t)}e=e.child}return e;case 5:return Ew(e),n===null&&uf(e),r=e.type,o=e.pendingProps,i=n!==null?n.memoizedProps:null,s=o.children,of(r,o)?s=null:i!==null&&of(r,i)&&(e.flags|=32),Gw(n,e),Dt(n,e,s,t),e.child;case 6:return n===null&&uf(e),null;case 13:return Yw(n,e,t);case 4:return Qp(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=us(e,null,r,t):Dt(n,e,r,t),e.child;case 11:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Pn(r,o),Oy(n,e,r,o,t);case 7:return Dt(n,e,e.pendingProps,t),e.child;case 8:return Dt(n,e,e.pendingProps.children,t),e.child;case 12:return Dt(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,o=e.pendingProps,i=e.memoizedProps,s=o.value,Te(Dc,r._currentValue),r._currentValue=s,i!==null)if(jn(i.value,s)){if(i.children===o.children&&!Yt.current){e=_r(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){s=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Ar(-1,t&-t),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=t,l=i.alternate,l!==null&&(l.lanes|=t),df(i.return,t,e),a.lanes|=t;break}l=l.next}}else if(i.tag===10)s=i.type===e.type?null:i.child;else if(i.tag===18){if(s=i.return,s===null)throw Error(_(341));s.lanes|=t,a=s.alternate,a!==null&&(a.lanes|=t),df(s,t,e),s=i.sibling}else s=i.child;if(s!==null)s.return=i;else for(s=i;s!==null;){if(s===e){s=null;break}if(i=s.sibling,i!==null){i.return=s.return,s=i;break}s=s.return}i=s}Dt(n,e,o.children,t),e=e.child}return e;case 9:return o=e.type,r=e.pendingProps.children,Zi(e,t),o=On(o),r=r(o),e.flags|=1,Dt(n,e,r,t),e.child;case 14:return r=e.type,o=Pn(r,e.pendingProps),o=Pn(r.type,o),My(n,e,r,o,t);case 15:return Ww(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,o=e.pendingProps,o=e.elementType===r?o:Pn(r,o),dc(n,e),e.tag=1,Jt(r)?(n=!0,Mc(e)):n=!1,Zi(e,t),jw(e,r,o),ff(e,r,o,t),gf(null,e,r,!0,n,t);case 19:return Jw(n,e,t);case 22:return qw(n,e,t)}throw Error(_(156,e.tag))};function fT(n,e){return BS(n,e)}function Jb(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function bn(n,e,t,r){return new Jb(n,e,t,r)}function um(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Xb(n){if(typeof n=="function")return um(n)?1:0;if(n!=null){if(n=n.$$typeof,n===Np)return 11;if(n===xp)return 14}return 2}function mo(n,e){var t=n.alternate;return t===null?(t=bn(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function pc(n,e,t,r,o,i){var s=2;if(r=n,typeof n=="function")um(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case _i:return Qo(t.children,o,i,e);case Rp:s=8,o|=8;break;case Lh:return n=bn(12,t,e,o|2),n.elementType=Lh,n.lanes=i,n;case Uh:return n=bn(13,t,e,o),n.elementType=Uh,n.lanes=i,n;case Hh:return n=bn(19,t,e,o),n.elementType=Hh,n.lanes=i,n;case ES:return Hu(t,o,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case wS:s=10;break e;case TS:s=9;break e;case Np:s=11;break e;case xp:s=14;break e;case Wr:s=16,r=null;break e}throw Error(_(130,n==null?n:typeof n,""))}return e=bn(s,t,e,o),e.elementType=n,e.type=r,e.lanes=i,e}function Qo(n,e,t,r){return n=bn(7,n,r,e),n.lanes=t,n}function Hu(n,e,t,r){return n=bn(22,n,r,e),n.elementType=ES,n.lanes=t,n.stateNode={isHidden:!1},n}function th(n,e,t){return n=bn(6,n,null,e),n.lanes=t,n}function nh(n,e,t){return e=bn(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Zb(n,e,t,r,o){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ld(0),this.expirationTimes=Ld(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ld(0),this.identifierPrefix=r,this.onRecoverableError=o,this.mutableSourceEagerHydrationData=null}function dm(n,e,t,r,o,i,s,a,l){return n=new Zb(n,e,t,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=bn(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},Gp(i),n}function eR(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Mi,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function pT(n){if(!n)return ko;n=n._reactInternals;e:{if(yi(n)!==n||n.tag!==1)throw Error(_(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Jt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(_(171))}if(n.tag===1){var t=n.type;if(Jt(t))return pw(n,t,e)}return e}function mT(n,e,t,r,o,i,s,a,l){return n=dm(t,r,!0,n,o,i,s,a,l),n.context=pT(null),t=n.current,r=Ut(),o=po(t),i=Ar(r,o),i.callback=e??null,ho(t,i,o),n.current.lanes=o,ol(n,o,r),Xt(n,r),n}function Fu(n,e,t,r){var o=e.current,i=Ut(),s=po(o);return t=pT(t),e.context===null?e.context=t:e.pendingContext=t,e=Ar(i,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=ho(o,e,s),n!==null&&(Bn(n,o,s,i),lc(n,o,s)),s}function Vc(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function $y(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function hm(n,e){$y(n,e),(n=n.alternate)&&$y(n,e)}function tR(){return null}var gT=typeof reportError=="function"?reportError:function(n){console.error(n)};function fm(n){this._internalRoot=n}Bu.prototype.render=fm.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(_(409));Fu(n,e,null,null)};Bu.prototype.unmount=fm.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;ii(function(){Fu(null,n,null,null)}),e[Or]=null}};function Bu(n){this._internalRoot=n}Bu.prototype.unstable_scheduleHydration=function(n){if(n){var e=qS();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Jr.length&&e!==0&&e<Jr[t].priority;t++);Jr.splice(t,0,n),t===0&&QS(n)}};function pm(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function zu(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Vy(){}function nR(n,e,t,r,o){if(o){if(typeof r=="function"){var i=r;r=function(){var c=Vc(s);i.call(c)}}var s=mT(e,r,n,0,null,!1,!1,"",Vy);return n._reactRootContainer=s,n[Or]=s.current,_a(n.nodeType===8?n.parentNode:n),ii(),s}for(;o=n.lastChild;)n.removeChild(o);if(typeof r=="function"){var a=r;r=function(){var c=Vc(l);a.call(c)}}var l=dm(n,0,!1,null,null,!1,!1,"",Vy);return n._reactRootContainer=l,n[Or]=l.current,_a(n.nodeType===8?n.parentNode:n),ii(function(){Fu(e,l,t,r)}),l}function Ku(n,e,t,r,o){var i=t._reactRootContainer;if(i){var s=i;if(typeof o=="function"){var a=o;o=function(){var l=Vc(s);a.call(l)}}Fu(e,s,n,o)}else s=nR(t,e,n,o,r);return Vc(s)}VS=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ys(e.pendingLanes);t!==0&&(_p(e,t|1),Xt(e,Ke()),!(ue&6)&&(fs=Ke()+500,xo()))}break;case 13:ii(function(){var r=Mr(n,1);if(r!==null){var o=Ut();Bn(r,n,1,o)}}),hm(n,1)}};Pp=function(n){if(n.tag===13){var e=Mr(n,134217728);if(e!==null){var t=Ut();Bn(e,n,134217728,t)}hm(n,134217728)}};WS=function(n){if(n.tag===13){var e=po(n),t=Mr(n,e);if(t!==null){var r=Ut();Bn(t,n,e,r)}hm(n,e)}};qS=function(){return ge};GS=function(n,e){var t=ge;try{return ge=n,e()}finally{ge=t}};Gh=function(n,e,t){switch(e){case"input":if(zh(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var o=Mu(r);if(!o)throw Error(_(90));IS(r),zh(r,o)}}}break;case"textarea":bS(n,t);break;case"select":e=t.value,e!=null&&Qi(n,!!t.multiple,e,!1)}};PS=am;DS=ii;var rR={usingClientEntryPoint:!1,Events:[sl,Ui,Mu,MS,_S,am]},Ws={findFiberByHostInstance:zo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},oR={bundleType:Ws.bundleType,version:Ws.version,rendererPackageName:Ws.rendererPackageName,rendererConfig:Ws.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Ur.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=HS(n),n===null?null:n.stateNode},findFiberByHostInstance:Ws.findFiberByHostInstance||tR,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Hl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Hl.isDisabled&&Hl.supportsFiber)try{Ru=Hl.inject(oR),lr=Hl}catch{}}vn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rR;vn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!pm(e))throw Error(_(200));return eR(n,e,null,t)};vn.createRoot=function(n,e){if(!pm(n))throw Error(_(299));var t=!1,r="",o=gT;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(o=e.onRecoverableError)),e=dm(n,1,!1,null,null,t,!1,r,o),n[Or]=e.current,_a(n.nodeType===8?n.parentNode:n),new fm(e)};vn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(_(188)):(n=Object.keys(n).join(","),Error(_(268,n)));return n=HS(e),n=n===null?null:n.stateNode,n};vn.flushSync=function(n){return ii(n)};vn.hydrate=function(n,e,t){if(!zu(e))throw Error(_(200));return Ku(null,n,e,!0,t)};vn.hydrateRoot=function(n,e,t){if(!pm(n))throw Error(_(405));var r=t!=null&&t.hydratedSources||null,o=!1,i="",s=gT;if(t!=null&&(t.unstable_strictMode===!0&&(o=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=mT(e,null,n,1,t??null,o,!1,i,s),n[Or]=e.current,_a(n),r)for(n=0;n<r.length;n++)t=r[n],o=t._getVersion,o=o(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,o]:e.mutableSourceEagerHydrationData.push(t,o);return new Bu(e)};vn.render=function(n,e,t){if(!zu(e))throw Error(_(200));return Ku(null,n,e,!1,t)};vn.unmountComponentAtNode=function(n){if(!zu(n))throw Error(_(40));return n._reactRootContainer?(ii(function(){Ku(null,null,n,!1,function(){n._reactRootContainer=null,n[Or]=null})}),!0):!1};vn.unstable_batchedUpdates=am;vn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!zu(t))throw Error(_(200));if(n==null||n._reactInternals===void 0)throw Error(_(38));return Ku(n,e,t,!1,r)};vn.version="18.3.1-next-f1338f8080-20240426";function yT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(yT)}catch(n){console.error(n)}}yT(),yS.exports=vn;var no=yS.exports;const iR=iS(no);var vT,Wy=no;vT=Wy.createRoot,Wy.hydrateRoot;/*! @azure/msal-common v14.16.0 2024-11-05 */const b={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Fl={CLIENT_ERROR_RANGE_START:400,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR_RANGE_START:500,SERVER_ERROR_RANGE_END:599},Rs=[b.OPENID_SCOPE,b.PROFILE_SCOPE,b.OFFLINE_ACCESS_SCOPE],qy=[...Rs,b.EMAIL_SCOPE],Lt={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},ot={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},go={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Bl={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},lt={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Gy={PLAIN:"plain",S256:"S256"},ll={QUERY:"query",FRAGMENT:"fragment"},sR={...ll},CT={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},zl={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},Rt={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},Q={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},mm="appmetadata",aR="client_info",da="1",Wc={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},rn={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},gt={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ye={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},ha={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Qy={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Yy={username:"username",password:"password"},Kl={httpSuccess:200,httpBadRequest:400},ki={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},rh={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},$r={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},lR={Pop:"pop"},cR=300;/*! @azure/msal-common v14.16.0 2024-11-05 */const gm="unexpected_error",uR="post_request_failed";/*! @azure/msal-common v14.16.0 2024-11-05 */const Jy={[gm]:"Unexpected error in authentication.",[uR]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Me extends Error{constructor(e,t,r){const o=t?`${e}: ${t}`:e;super(o),Object.setPrototypeOf(this,Me.prototype),this.errorCode=e||b.EMPTY_STRING,this.errorMessage=t||b.EMPTY_STRING,this.subError=r||b.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function ST(n,e){return new Me(n,e?`${Jy[n]} ${e}`:Jy[n])}/*! @azure/msal-common v14.16.0 2024-11-05 */const ym="client_info_decoding_error",wT="client_info_empty_error",vm="token_parsing_error",TT="null_or_empty_token",vr="endpoints_resolution_error",ET="network_error",kT="openid_config_error",IT="hash_not_deserialized",ps="invalid_state",AT="state_mismatch",qc="state_not_found",bT="nonce_mismatch",Cm="auth_time_not_found",RT="max_age_transpired",dR="multiple_matching_tokens",hR="multiple_matching_accounts",NT="multiple_matching_appMetadata",xT="request_cannot_be_made",OT="cannot_remove_empty_scope",MT="cannot_append_scopeset",Rf="empty_input_scopeset",fR="device_code_polling_cancelled",pR="device_code_expired",mR="device_code_unknown_error",Sm="no_account_in_silent_request",_T="invalid_cache_record",wm="invalid_cache_environment",Nf="no_account_found",xf="no_crypto_object",Of="unexpected_credential_type",gR="invalid_assertion",yR="invalid_client_credential",Er="token_refresh_required",vR="user_timeout_reached",PT="token_claims_cnf_required_for_signedjwt",DT="authorization_code_missing_from_server_response",LT="binding_key_not_removed",UT="end_session_endpoint_not_supported",Tm="key_id_missing",CR="no_network_connectivity",SR="user_canceled",wR="missing_tenant_id_error",re="method_not_implemented",TR="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.16.0 2024-11-05 */const Xy={[ym]:"The client info could not be parsed/decoded correctly",[wT]:"The client info was empty",[vm]:"Token cannot be parsed",[TT]:"The token is null or empty",[vr]:"Endpoints cannot be resolved",[ET]:"Network request failed",[kT]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[IT]:"The hash parameters could not be deserialized",[ps]:"State was not the expected format",[AT]:"State mismatch error",[qc]:"State not found",[bT]:"Nonce mismatch error",[Cm]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[RT]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[dR]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[hR]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[NT]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[xT]:"Token request cannot be made without authorization code or refresh token.",[OT]:"Cannot remove null or empty scope from ScopeSet",[MT]:"Cannot append ScopeSet",[Rf]:"Empty input ScopeSet cannot be processed",[fR]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[pR]:"Device code is expired.",[mR]:"Device code stopped polling for unknown reasons.",[Sm]:"Please pass an account object, silent flow is not supported without account information",[_T]:"Cache record object was null or undefined.",[wm]:"Invalid environment when attempting to create cache entry",[Nf]:"No account found in cache for given key.",[xf]:"No crypto object detected.",[Of]:"Unexpected credential type.",[gR]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[yR]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Er]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[vR]:"User defined timeout for device code polling reached",[PT]:"Cannot generate a POP jwt if the token_claims are not populated",[DT]:"Server response does not contain an authorization code to proceed",[LT]:"Could not remove the credential's binding key from storage.",[UT]:"The provided authority does not support logout",[Tm]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[CR]:"No network connectivity. Check your internet connection.",[SR]:"User cancelled the flow.",[wR]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[re]:"This method has not been implemented",[TR]:"The nested app auth bridge is disabled"};class ju extends Me{constructor(e,t){super(e,t?`${Xy[e]}: ${t}`:Xy[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,ju.prototype)}}function x(n,e){return new ju(n,e)}/*! @azure/msal-common v14.16.0 2024-11-05 */const Gc={createNewGuid:()=>{throw x(re)},base64Decode:()=>{throw x(re)},base64Encode:()=>{throw x(re)},base64UrlEncode:()=>{throw x(re)},encodeKid:()=>{throw x(re)},async getPublicKeyThumbprint(){throw x(re)},async removeTokenBindingKey(){throw x(re)},async clearKeystore(){throw x(re)},async signJwt(){throw x(re)},async hashString(){throw x(re)}};/*! @azure/msal-common v14.16.0 2024-11-05 */var xe;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(xe||(xe={}));class Pr{constructor(e,t,r){this.level=xe.Info;const o=()=>{},i=e||Pr.createDefaultLoggerOptions();this.localCallback=i.loggerCallback||o,this.piiLoggingEnabled=i.piiLoggingEnabled||!1,this.level=typeof i.logLevel=="number"?i.logLevel:xe.Info,this.correlationId=i.correlationId||b.EMPTY_STRING,this.packageName=t||b.EMPTY_STRING,this.packageVersion=r||b.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:xe.Info}}clone(e,t,r){return new Pr({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const i=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${xe[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,i,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:xe.Error,containsPii:!1,correlationId:t||b.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:xe.Error,containsPii:!0,correlationId:t||b.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:xe.Warning,containsPii:!1,correlationId:t||b.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:xe.Warning,containsPii:!0,correlationId:t||b.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:xe.Info,containsPii:!1,correlationId:t||b.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:xe.Info,containsPii:!0,correlationId:t||b.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:xe.Verbose,containsPii:!1,correlationId:t||b.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:xe.Verbose,containsPii:!0,correlationId:t||b.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:xe.Trace,containsPii:!1,correlationId:t||b.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:xe.Trace,containsPii:!0,correlationId:t||b.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.16.0 2024-11-05 */const HT="@azure/msal-common",Em="14.16.0";/*! @azure/msal-common v14.16.0 2024-11-05 */const km={None:"none"};/*! @azure/msal-common v14.16.0 2024-11-05 */function vi(n,e){const t=ER(n);try{const r=e(t);return JSON.parse(r)}catch{throw x(vm)}}function ER(n){if(!n)throw x(TT);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw x(vm);return t[2]}function FT(n,e){if(e===0||Date.now()-3e5>n+e)throw x(RT)}/*! @azure/msal-common v14.16.0 2024-11-05 */function dr(){return Math.round(new Date().getTime()/1e3)}function Mf(n,e){const t=Number(n)||0;return dr()+e>t}function kR(n){return Number(n)>dr()}/*! @azure/msal-common v14.16.0 2024-11-05 */function $i(n){return[IR(n),AR(n),bR(n),RR(n),NR(n)].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function $u(n,e,t,r,o){return{credentialType:Q.ID_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t,realm:o}}function Vu(n,e,t,r,o,i,s,a,l,c,u,d,h,f,p){var v,g;const m={homeAccountId:n,credentialType:Q.ACCESS_TOKEN,secret:t,cachedAt:dr().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:o,target:i,tokenType:u||ye.BEARER};if(d&&(m.userAssertionHash=d),c&&(m.refreshOn=c.toString()),f&&(m.requestedClaims=f,m.requestedClaimsHash=p),((v=m.tokenType)==null?void 0:v.toLowerCase())!==ye.BEARER.toLowerCase())switch(m.credentialType=Q.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case ye.POP:const y=vi(t,l);if(!((g=y==null?void 0:y.cnf)!=null&&g.kid))throw x(PT);m.keyId=y.cnf.kid;break;case ye.SSH:m.keyId=h}return m}function BT(n,e,t,r,o,i,s){const a={credentialType:Q.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t};return i&&(a.userAssertionHash=i),o&&(a.familyId=o),s&&(a.expiresOn=s.toString()),a}function Im(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function Zy(n){return n?Im(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===Q.ACCESS_TOKEN||n.credentialType===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function ev(n){return n?Im(n)&&n.hasOwnProperty("realm")&&n.credentialType===Q.ID_TOKEN:!1}function tv(n){return n?Im(n)&&n.credentialType===Q.REFRESH_TOKEN:!1}function IR(n){return[n.homeAccountId,n.environment].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function AR(n){const e=n.credentialType===Q.REFRESH_TOKEN&&n.familyId||n.clientId;return[n.credentialType,e,n.realm||""].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function bR(n){return(n.target||"").toLowerCase()}function RR(n){return(n.requestedClaimsHash||"").toLowerCase()}function NR(n){return n.tokenType&&n.tokenType.toLowerCase()!==ye.BEARER.toLowerCase()?n.tokenType.toLowerCase():""}function xR(n,e){const t=n.indexOf(gt.CACHE_KEY)===0;let r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&r}function OR(n,e){let t=!1;n&&(t=n.indexOf(ha.THROTTLING_PREFIX)===0);let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),t&&r}function MR({environment:n,clientId:e}){return[mm,n,e].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}function _R(n,e){return e?n.indexOf(mm)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function PR(n,e){return e?n.indexOf(Wc.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function nv(){return dr()+Wc.REFRESH_TIME_SECONDS}function jl(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function oh(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function rv(n){return n.expiresAt<=dr()}/*! @azure/msal-common v14.16.0 2024-11-05 */const zT="redirect_uri_empty",DR="claims_request_parsing_error",KT="authority_uri_insecure",Xs="url_parse_error",jT="empty_url_error",$T="empty_input_scopes_error",VT="invalid_prompt_value",Am="invalid_claims",WT="token_request_empty",qT="logout_request_empty",GT="invalid_code_challenge_method",bm="pkce_params_missing",Rm="invalid_cloud_discovery_metadata",QT="invalid_authority_metadata",YT="untrusted_authority",Wu="missing_ssh_jwk",JT="missing_ssh_kid",LR="missing_nonce_authentication_header",UR="invalid_authentication_header",XT="cannot_set_OIDCOptions",ZT="cannot_allow_native_broker",eE="authority_mismatch";/*! @azure/msal-common v14.16.0 2024-11-05 */const HR={[zT]:"A redirect URI is required for all calls, and none has been set.",[DR]:"Could not parse the given claims request object.",[KT]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Xs]:"URL could not be parsed into appropriate segments.",[jT]:"URL was empty or null.",[$T]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[VT]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Am]:"Given claims parameter must be a stringified JSON object.",[WT]:"Token request was empty and not found in cache.",[qT]:"The logout request was null or undefined.",[GT]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[bm]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Rm]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[QT]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[YT]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Wu]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[JT]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[LR]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[UR]:"Invalid authentication header provided",[XT]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[ZT]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[eE]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class Nm extends Me{constructor(e){super(e,HR[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,Nm.prototype)}}function Ce(n){return new Nm(n)}/*! @azure/msal-common v14.16.0 2024-11-05 */class zn{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),o=i=>decodeURIComponent(i.replace(/\+/g," "));return r.forEach(i=>{if(i.trim()){const[s,a]=i.split(/=(.+)/g,2);s&&a&&(t[o(s)]=o(a))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class je{constructor(e){const t=e?zn.trimArrayEntries([...e]):[],r=t?zn.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(o=>this.scopes.add(o))}static fromString(e){const r=(e||b.EMPTY_STRING).split(" ");return new je(r)}static createSearchScopes(e){const t=new je(e);return t.containsOnlyOIDCScopes()?t.removeScope(b.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Ce($T)}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new je(t);return e?r.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return qy.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw x(MT)}}removeScope(e){if(!e)throw x(OT);this.scopes.delete(e.trim())}removeOIDCScopes(){qy.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw x(Rf);const t=new Set;return e.scopes.forEach(r=>t.add(r.toLowerCase())),this.scopes.forEach(r=>t.add(r.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw x(Rf);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),o=this.getScopeCount();return t.size<o+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):b.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.16.0 2024-11-05 */function Qc(n,e){if(!n)throw x(wT);try{const t=e(n);return JSON.parse(t)}catch{throw x(ym)}}function Vi(n){if(!n)throw x(ym);const e=n.split(Rt.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?b.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.16.0 2024-11-05 */function Yc(n,e){return!!n&&!!e&&n===e.split(".")[1]}function xm(n,e,t,r){if(r){const{oid:o,sub:i,tid:s,name:a,tfp:l,acr:c}=r,u=s||l||c||"";return{tenantId:u,localAccountId:o||i||"",name:a,isHomeTenant:Yc(u,n)}}else return{tenantId:t,localAccountId:e,isHomeTenant:Yc(t,n)}}function Om(n,e,t,r){let o=n;if(e){const{isHomeTenant:i,...s}=e;o={...n,...s}}if(t){const{isHomeTenant:i,...s}=xm(n.homeAccountId,n.localAccountId,n.tenantId,t);return o={...o,...s,idTokenClaims:t,idToken:r},o}return o}/*! @azure/msal-common v14.16.0 2024-11-05 */const Ln={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.16.0 2024-11-05 */function tE(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v14.16.0 2024-11-05 */const br={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.16.0 2024-11-05 */class nt{generateAccountId(){return[this.homeAccountId,this.environment].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return nt.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(Rt.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){var c,u,d,h,f,p;const o=new nt;t.authorityType===Ln.Adfs?o.authorityType=zl.ADFS_ACCOUNT_TYPE:t.protocolMode===br.AAD?o.authorityType=zl.MSSTS_ACCOUNT_TYPE:o.authorityType=zl.GENERIC_ACCOUNT_TYPE;let i;e.clientInfo&&r&&(i=Qc(e.clientInfo,r)),o.clientInfo=e.clientInfo,o.homeAccountId=e.homeAccountId,o.nativeAccountId=e.nativeAccountId;const s=e.environment||t&&t.getPreferredCache();if(!s)throw x(wm);o.environment=s,o.realm=(i==null?void 0:i.utid)||tE(e.idTokenClaims)||"",o.localAccountId=(i==null?void 0:i.uid)||((c=e.idTokenClaims)==null?void 0:c.oid)||((u=e.idTokenClaims)==null?void 0:u.sub)||"";const a=((d=e.idTokenClaims)==null?void 0:d.preferred_username)||((h=e.idTokenClaims)==null?void 0:h.upn),l=(f=e.idTokenClaims)!=null&&f.emails?e.idTokenClaims.emails[0]:null;if(o.username=a||l||"",o.name=((p=e.idTokenClaims)==null?void 0:p.name)||"",o.cloudGraphHostName=e.cloudGraphHostName,o.msGraphHost=e.msGraphHost,e.tenantProfiles)o.tenantProfiles=e.tenantProfiles;else{const m=xm(e.homeAccountId,o.localAccountId,o.realm,e.idTokenClaims);o.tenantProfiles=[m]}return o}static createFromAccountInfo(e,t,r){var i;const o=new nt;return o.authorityType=e.authorityType||zl.GENERIC_ACCOUNT_TYPE,o.homeAccountId=e.homeAccountId,o.localAccountId=e.localAccountId,o.nativeAccountId=e.nativeAccountId,o.realm=e.tenantId,o.environment=e.environment,o.username=e.username,o.name=e.name,o.cloudGraphHostName=t,o.msGraphHost=r,o.tenantProfiles=Array.from(((i=e.tenantProfiles)==null?void 0:i.values())||[]),o}static generateHomeAccountId(e,t,r,o,i){if(!(t===Ln.Adfs||t===Ln.Dsts)){if(e)try{const s=Qc(e,o.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch{}r.warning("No client info in response")}return(i==null?void 0:i.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let o=!0;if(r){const i=e.idTokenClaims||{},s=t.idTokenClaims||{};o=i.iat===s.iat&&i.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&o}}/*! @azure/msal-common v14.16.0 2024-11-05 */function nE(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function Jc(n){if(!n||n.indexOf("=")<0)return null;try{const e=nE(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw x(IT)}return null}/*! @azure/msal-common v14.16.0 2024-11-05 */class ce{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Ce(jT);e.includes("#")||(this._urlString=ce.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return zn.endsWith(t,"?")?t=t.slice(0,-1):zn.endsWith(t,"?/")&&(t=t.slice(0,-2)),zn.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Ce(Xs)}if(!e.HostNameAndPort||!e.PathSegments)throw Ce(Xs);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Ce(KT)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return ce.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return e&&r.length!==0&&(r[0]===go.COMMON||r[0]===go.ORGANIZATIONS)&&(r[0]=e),ce.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ce(Xs);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let o=r.AbsolutePath.split("/");return o=o.filter(i=>i&&i.length>0),r.PathSegments=o,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Ce(Xs);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===b.FORWARD_SLASH){const o=new ce(t).getUrlComponents();return o.Protocol+"//"+o.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new ce(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Jc(e)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const rE={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},ov=rE.endpointMetadata,Mm=rE.instanceDiscoveryMetadata,oE=new Set;Mm.metadata.forEach(n=>{n.aliases.forEach(e=>{oE.add(e)})});function FR(n,e){var o;let t;const r=n.canonicalAuthority;if(r){const i=new ce(r).getUrlComponents().HostNameAndPort;t=iv(i,(o=n.cloudDiscoveryMetadata)==null?void 0:o.metadata,rn.CONFIG,e)||iv(i,Mm.metadata,rn.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function iv(n,e,t,r){if(r==null||r.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const o=Xc(e,n);if(o)return r==null||r.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),o.aliases;r==null||r.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function BR(n){return Xc(Mm.metadata,n)}function Xc(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(r.aliases.includes(e))return r}return null}/*! @azure/msal-common v14.16.0 2024-11-05 */const iE="cache_quota_exceeded",_m="cache_error_unknown";/*! @azure/msal-common v14.16.0 2024-11-05 */const ih={[iE]:"Exceeded cache storage capacity.",[_m]:"Unexpected error occurred when using cache storage."};class ts extends Error{constructor(e,t){const r=t||(ih[e]?ih[e]:ih[_m]);super(`${e}: ${r}`),Object.setPrototypeOf(this,ts.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}/*! @azure/msal-common v14.16.0 2024-11-05 */class ms{constructor(e,t,r,o){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(HT,Em),this.staticAuthorityOptions=o}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort(o=>o.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(r=>this.getTenantProfilesFromAccountEntity(r,t==null?void 0:t.tenantId,t))}getTenantedAccountInfoByFilter(e,t,r,o){let i=null,s;if(o&&!this.tenantProfileMatchesFilter(r,o))return null;const a=this.getIdToken(e,t,r.tenantId);return a&&(s=vi(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,o))?null:(i=Om(e,r,s,a==null?void 0:a.secret),i)}getTenantProfilesFromAccountEntity(e,t,r){const o=e.getAccountInfo();let i=o.tenantProfiles||new Map;const s=this.getTokenKeys();if(t){const l=i.get(t);if(l)i=new Map([[t,l]]);else return[]}const a=[];return i.forEach(l=>{const c=this.getTenantedAccountInfoByFilter(o,s,l,r);c&&a.push(c)}),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,r){var o,i,s,a;if(!e)throw x(_T);try{e.account&&this.setAccount(e.account),e.idToken&&(t==null?void 0:t.idToken)!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&(t==null?void 0:t.accessToken)!==!1&&await this.saveAccessToken(e.accessToken),e.refreshToken&&(t==null?void 0:t.refreshToken)!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(l){throw(o=this.commonLogger)==null||o.error("CacheManager.saveCacheRecord: failed"),l instanceof Error?((i=this.commonLogger)==null||i.errorPii(`CacheManager.saveCacheRecord: ${l.message}`,r),l.name==="QuotaExceededError"||l.name==="NS_ERROR_DOM_QUOTA_REACHED"||l.message.includes("exceeded the quota")?((s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new ts(iE)):new ts(l.name,l.message)):((a=this.commonLogger)==null||a.errorPii(`CacheManager.saveCacheRecord: ${l}`,r),new ts(_m))}}async saveAccessToken(e){const t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),o=je.fromString(e.target),i=[];r.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,t,!1))return;const a=this.getAccessTokenCredential(s);a&&this.credentialMatchesFilter(a,t)&&je.fromString(a.target).intersectingScopeSets(o)&&i.push(this.removeAccessToken(s))}),await Promise.all(i),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach(o=>{var l;if(!this.isAccountKey(o,e.homeAccountId))return;const i=this.getAccount(o,this.commonLogger);if(!i||e.homeAccountId&&!this.matchHomeAccountId(i,e.homeAccountId)||e.username&&!this.matchUsername(i.username,e.username)||e.environment&&!this.matchEnvironment(i,e.environment)||e.realm&&!this.matchRealm(i,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(i,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(i,e.authorityType))return;const s={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},a=(l=i.tenantProfiles)==null?void 0:l.filter(c=>this.tenantProfileMatchesFilter(c,s));a&&a.length===0||r.push(i)}),r}isAccountKey(e,t,r){return!(e.split(Rt.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(Rt.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(t.indexOf(Q.ID_TOKEN.toLowerCase())===-1&&t.indexOf(Q.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(Q.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(Q.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(Q.REFRESH_TOKEN.toLowerCase())>-1){const r=`${Q.REFRESH_TOKEN}${Rt.CACHE_KEY_SEPARATOR}${this.clientId}${Rt.CACHE_KEY_SEPARATOR}`,o=`${Q.REFRESH_TOKEN}${Rt.CACHE_KEY_SEPARATOR}${da}${Rt.CACHE_KEY_SEPARATOR}`;if(t.indexOf(r.toLowerCase())===-1&&t.indexOf(o.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===ye.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach(o=>{if(!this.isAppMetadata(o))return;const i=this.getAppMetadata(o);i&&(e.environment&&!this.matchEnvironment(i,e.environment)||e.clientId&&!this.matchClientId(i,e.clientId)||(r[o]=i))}),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach(o=>{if(!this.isAuthorityMetadata(o)||o.indexOf(this.clientId)===-1)return;const i=this.getAuthorityMetadata(o);i&&i.aliases.indexOf(e)!==-1&&(r=i)}),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach(r=>{t.push(this.removeAccount(r))}),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),o=[];t.idToken.forEach(i=>{i.indexOf(r)===0&&this.removeIdToken(i)}),t.accessToken.forEach(i=>{i.indexOf(r)===0&&o.push(this.removeAccessToken(i))}),t.refreshToken.forEach(i=>{i.indexOf(r)===0&&this.removeRefreshToken(i)}),await Promise.all(o)}updateOutdatedCachedAccount(e,t,r){var o;if(t&&t.isSingleTenant()){(o=this.commonLogger)==null||o.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const i=this.getAccountKeys().filter(u=>u.startsWith(t.homeAccountId)),s=[];i.forEach(u=>{const d=this.getCachedAccountEntity(u);d&&s.push(d)});const a=s.find(u=>Yc(u.realm,u.homeAccountId))||s[0];a.tenantProfiles=s.map(u=>({tenantId:u.realm,localAccountId:u.localAccountId,name:u.name,isHomeTenant:Yc(u.realm,u.homeAccountId)}));const l=ms.toObject(new nt,{...a}),c=l.generateAccountKey();return i.forEach(u=>{u!==c&&this.removeOutdatedAccount(e)}),this.setAccount(l),r==null||r.verbose("Updated an outdated account entity in the cache"),l}return t}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===ye.POP){const o=t.keyId;if(o)try{await this.cryptoImpl.removeTokenBindingKey(o)}catch{throw x(LT)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){const t=nt.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,o,i){this.commonLogger.trace("CacheManager - getIdToken called");const s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Q.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(s,t),l=a.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=a;if(!r){const u=new Map;a.forEach((h,f)=>{h.realm===e.tenantId&&u.set(f,h)});const d=u.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(d===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;c=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((u,d)=>{this.removeIdToken(d)}),o&&i&&o.addFields({multiMatchedID:a.size},i),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,o=new Map;return r.forEach(i=>{if(!this.idTokenKeyMatchesFilter(i,{clientId:this.clientId,...e}))return;const s=this.getIdTokenCredential(i);s&&this.credentialMatchesFilter(s,e)&&o.set(i,s)}),o}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,o,i,s){this.commonLogger.trace("CacheManager - getAccessToken called");const a=je.createSearchScopes(t.scopes),l=t.authenticationScheme||ye.BEARER,c=l.toLowerCase()!==ye.BEARER.toLowerCase()?Q.ACCESS_TOKEN_WITH_AUTH_SCHEME:Q.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:o||e.tenantId,target:a,tokenType:l,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=r&&r.accessToken||this.getTokenKeys().accessToken,h=[];d.forEach(p=>{if(this.accessTokenKeyMatchesFilter(p,u,!0)){const m=this.getAccessTokenCredential(p);m&&this.credentialMatchesFilter(m,u)&&h.push(m)}});const f=h.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),h.forEach(p=>{this.removeAccessToken($i(p))}),i&&s&&i.addFields({multiMatchedAT:h.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),h[0])}accessTokenKeyMatchesFilter(e,t,r){const o=e.toLowerCase();if(t.clientId&&o.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&o.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&o.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&o.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const i=t.target.asArray();for(let s=0;s<i.length;s++){if(r&&!o.includes(i[s].toLowerCase()))return!1;if(!r&&o.includes(i[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach(o=>{if(!this.accessTokenKeyMatchesFilter(o,e,!0))return;const i=this.getAccessTokenCredential(o);i&&this.credentialMatchesFilter(i,e)&&r.push(i)}),r}getRefreshToken(e,t,r,o,i){this.commonLogger.trace("CacheManager - getRefreshToken called");const s=t?da:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Q.REFRESH_TOKEN,clientId:this.clientId,familyId:s},l=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(d=>{if(this.refreshTokenKeyMatchesFilter(d,a)){const h=this.getRefreshTokenCredential(d);h&&this.credentialMatchesFilter(h,a)&&c.push(h)}});const u=c.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&o&&i&&o.addFields({multiMatchedRT:u},i),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&r.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),o=Object.keys(r).map(s=>r[s]),i=o.length;if(i<1)return null;if(i>1)throw x(NT);return o[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===da)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const r=e.oid||e.sub;return t===r}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var r;return t.toLowerCase()===((r=e.name)==null?void 0:r.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const o=FR(this.staticAuthorityOptions,this.commonLogger);if(o.includes(t)&&o.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var r;return((r=e.realm)==null?void 0:r.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==Q.ACCESS_TOKEN&&e.credentialType!==Q.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:je.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(mm)!==-1}isAuthorityMetadata(e){return e.indexOf(Wc.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Wc.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class zR extends ms{setAccount(){throw x(re)}getAccount(){throw x(re)}getCachedAccountEntity(){throw x(re)}setIdTokenCredential(){throw x(re)}getIdTokenCredential(){throw x(re)}setAccessTokenCredential(){throw x(re)}getAccessTokenCredential(){throw x(re)}setRefreshTokenCredential(){throw x(re)}getRefreshTokenCredential(){throw x(re)}setAppMetadata(){throw x(re)}getAppMetadata(){throw x(re)}setServerTelemetry(){throw x(re)}getServerTelemetry(){throw x(re)}setAuthorityMetadata(){throw x(re)}getAuthorityMetadata(){throw x(re)}getAuthorityMetadataKeys(){throw x(re)}setThrottlingCache(){throw x(re)}getThrottlingCache(){throw x(re)}removeItem(){throw x(re)}getKeys(){throw x(re)}getAccountKeys(){throw x(re)}getTokenKeys(){throw x(re)}updateCredentialCacheKey(){throw x(re)}removeOutdatedAccount(){throw x(re)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const sE={tokenRenewalOffsetSeconds:cR,preventCorsPreflight:!1},KR={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:xe.Info,correlationId:b.EMPTY_STRING},jR={claimsBasedCachingEnabled:!1},$R={async sendGetRequestAsync(){throw x(re)},async sendPostRequestAsync(){throw x(re)}},VR={sku:b.SKU,version:Em,cpu:b.EMPTY_STRING,os:b.EMPTY_STRING},WR={clientSecret:b.EMPTY_STRING,clientAssertion:void 0},qR={azureCloudInstance:km.None,tenant:`${b.DEFAULT_COMMON_TENANT}`},GR={application:{appName:"",appVersion:""}};function QR({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:r,storageInterface:o,networkInterface:i,cryptoInterface:s,clientCredentials:a,libraryInfo:l,telemetry:c,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){const f={...KR,...t};return{authOptions:YR(n),systemOptions:{...sE,...e},loggerOptions:f,cacheOptions:{...jR,...r},storageInterface:o||new zR(n.clientId,Gc,new Pr(f)),networkInterface:i||$R,cryptoInterface:s||Gc,clientCredentials:a||WR,libraryInfo:{...VR,...l},telemetry:{...GR,...c},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null}}function YR(n){return{clientCapabilities:[],azureCloudOptions:qR,skipAuthorityMetadataCache:!1,instanceAware:!1,...n}}function _f(n){return n.authOptions.authority.options.protocolMode===br.OIDC}/*! @azure/msal-common v14.16.0 2024-11-05 */const fn={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.16.0 2024-11-05 */const si="client_id",aE="redirect_uri",sv="response_type",JR="response_mode",XR="grant_type",ZR="claims",eN="scope",tN="refresh_token",nN="state",rN="nonce",oN="prompt",iN="code",sN="code_challenge",aN="code_challenge_method",lN="code_verifier",cN="client-request-id",uN="x-client-SKU",dN="x-client-VER",hN="x-client-OS",fN="x-client-CPU",pN="x-client-current-telemetry",mN="x-client-last-telemetry",gN="x-ms-lib-capability",yN="x-app-name",vN="x-app-ver",CN="post_logout_redirect_uri",SN="id_token_hint",wN="device_code",TN="client_secret",EN="client_assertion",kN="client_assertion_type",av="token_type",lv="req_cnf",IN="assertion",AN="requested_token_use",cv="return_spa_code",bN="nativebroker",RN="logout_hint",NN="sid",xN="login_hint",ON="domain_hint",MN="x-client-xtra-sku",Pm="brk_client_id",Pf="brk_redirect_uri";/*! @azure/msal-common v14.16.0 2024-11-05 */class bi{static validateRedirectUri(e){if(!e)throw Ce(zT)}static validatePrompt(e){const t=[];for(const r in lt)t.push(lt[r]);if(t.indexOf(e)<0)throw Ce(VT)}static validateClaims(e){try{JSON.parse(e)}catch{throw Ce(Am)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Ce(bm);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Gy.PLAIN,Gy.S256].indexOf(e)<0)throw Ce(GT)}}/*! @azure/msal-common v14.16.0 2024-11-05 */function _N(n,e,t){if(!e)return;const r=n.get(si);r&&n.has(Pm)&&(t==null||t.addFields({embeddedClientId:r,embeddedRedirectUri:n.get(aE)},e))}class fa{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(sv,encodeURIComponent(b.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(sv,encodeURIComponent(`${b.TOKEN_RESPONSE_TYPE} ${b.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(JR,encodeURIComponent(e||sR.QUERY))}addNativeBroker(){this.parameters.set(bN,encodeURIComponent("1"))}addScopes(e,t=!0,r=Rs){t&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");const o=t?[...e||[],...r]:e||[],i=new je(o);this.parameters.set(eN,encodeURIComponent(i.printScopes()))}addClientId(e){this.parameters.set(si,encodeURIComponent(e))}addRedirectUri(e){bi.validateRedirectUri(e),this.parameters.set(aE,encodeURIComponent(e))}addPostLogoutRedirectUri(e){bi.validateRedirectUri(e),this.parameters.set(CN,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(SN,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(ON,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(xN,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(Lt.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(Lt.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(NN,encodeURIComponent(e))}addClaims(e,t){const r=this.addClientCapabilitiesToClaims(e,t);bi.validateClaims(r),this.parameters.set(ZR,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(cN,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(uN,e.sku),this.parameters.set(dN,e.version),e.os&&this.parameters.set(hN,e.os),e.cpu&&this.parameters.set(fN,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(yN,e.appName),e!=null&&e.appVersion&&this.parameters.set(vN,e.appVersion)}addPrompt(e){bi.validatePrompt(e),this.parameters.set(`${oN}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(nN,encodeURIComponent(e))}addNonce(e){this.parameters.set(rN,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(bi.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(sN,encodeURIComponent(e)),this.parameters.set(aN,encodeURIComponent(t));else throw Ce(bm)}addAuthorizationCode(e){this.parameters.set(iN,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(wN,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(tN,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(lN,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(TN,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(EN,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(kN,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(IN,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(AN,encodeURIComponent(e))}addGrantType(e){this.parameters.set(XR,encodeURIComponent(e))}addClientInfo(){this.parameters.set(aR,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,r])=>{!this.parameters.has(t)&&r&&this.parameters.set(t,r)})}addClientCapabilitiesToClaims(e,t){let r;if(!e)r={};else try{r=JSON.parse(e)}catch{throw Ce(Am)}return t&&t.length>0&&(r.hasOwnProperty(Bl.ACCESS_TOKEN)||(r[Bl.ACCESS_TOKEN]={}),r[Bl.ACCESS_TOKEN][Bl.XMS_CC]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(Yy.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Yy.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(av,ye.POP),this.parameters.set(lv,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(av,ye.SSH),this.parameters.set(lv,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(pN,e.generateCurrentRequestHeaderValue()),this.parameters.set(mN,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(gN,ha.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(RN,encodeURIComponent(e))}addBrokerParameters(e){const t={};t[Pm]=e.brokerClientId,t[Pf]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,r)=>{e.push(`${r}=${t}`)}),_N(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v14.16.0 2024-11-05 */function PN(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.16.0 2024-11-05 */function DN(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v14.16.0 2024-11-05 */function LN(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v14.16.0 2024-11-05 */const T={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},UN={InProgress:1};/*! @azure/msal-common v14.16.0 2024-11-05 */const Ci=(n,e,t,r,o)=>(...i)=>{t.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,o);if(o){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},o)}try{const a=n(...i);return s==null||s.end({success:!0}),t.trace(`Returning result from ${e}`),a}catch(a){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a}},D=(n,e,t,r,o)=>(...i)=>{t.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,o);if(o){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},o)}return r==null||r.setPreQueueTime(e,o),n(...i).then(a=>(t.trace(`Returning result from ${e}`),s==null||s.end({success:!0}),a)).catch(a=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a})};/*! @azure/msal-common v14.16.0 2024-11-05 */class qu{constructor(e,t,r,o){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=o}async detectRegion(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(T.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)t.region_source=ki.ENVIRONMENT_VARIABLE;else{const i=qu.IMDS_OPTIONS;try{const s=await D(this.getRegionFromIMDS.bind(this),T.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(b.IMDS_VERSION,i);if(s.status===Kl.httpSuccess&&(r=s.body,t.region_source=ki.IMDS),s.status===Kl.httpBadRequest){const a=await D(this.getCurrentVersion.bind(this),T.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(i);if(!a)return t.region_source=ki.FAILED_AUTO_DETECTION,null;const l=await D(this.getRegionFromIMDS.bind(this),T.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,i);l.status===Kl.httpSuccess&&(r=l.body,t.region_source=ki.IMDS)}}catch{return t.region_source=ki.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=ki.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(T.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${b.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,b.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(T.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${b.IMDS_ENDPOINT}?format=json`,e);return r.status===Kl.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}qu.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.16.0 2024-11-05 */class At{constructor(e,t,r,o,i,s,a,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=o,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=i,this.performanceClient=a,this.correlationId=s,this.managedIdentity=l||!1,this.regionDiscovery=new qu(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(b.CIAM_AUTH_URL))return Ln.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case b.ADFS:return Ln.Adfs;case b.DSTS:return Ln.Dsts}return Ln.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new ce(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw x(vr)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw x(vr)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw x(vr)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw x(UT);return this.replacePath(this.metadata.end_session_endpoint)}else throw x(vr)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw x(vr)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw x(vr)}canReplaceTenant(e){return e.PathSegments.length===1&&!At.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Ln.Default&&this.protocolMode===br.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const o=new ce(this.metadata.canonical_authority).getUrlComponents(),i=o.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,l)=>{let c=i[l];if(l===0&&this.canReplaceTenant(o)){const u=new ce(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==u&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${u}`),c=u)}a!==c&&(t=t.replace(`/${c}/`,`/${a}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Ln.Adfs||this.protocolMode!==br.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(T.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await D(this.updateCloudDiscoveryMetadata.bind(this),T.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await D(this.updateEndpointMetadata.bind(this),T.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),(i=this.performanceClient)==null||i.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:nv(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==rn.CACHE&&(r==null?void 0:r.source)!==rn.CACHE&&(e.expiresAt=nv(),e.canonical_authority=this.canonicalAuthority);const o=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(o,e),this.metadata=e}async updateEndpointMetadata(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(T.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===rn.HARDCODED_VALUES&&(i=this.authorityOptions.azureRegionConfiguration)!=null&&i.azureRegion&&t.metadata){const a=await D(this.updateMetadataWithRegionalInformation.bind(this),T.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);jl(e,a,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let r=await D(this.getEndpointMetadataFromNetwork.bind(this),T.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return(s=this.authorityOptions.azureRegionConfiguration)!=null&&s.azureRegion&&(r=await D(this.updateMetadataWithRegionalInformation.bind(this),T.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),jl(e,r,!0),rn.NETWORK;throw x(kT,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),jl(e,t,!1),{source:rn.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const o=this.getEndpointMetadataFromHardcodedValues();if(o)return jl(e,o,!1),{source:rn.HARDCODED_VALUES,metadata:o};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=rv(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:rn.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new ce(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Ce(QT)}return null}async getEndpointMetadataFromNetwork(){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(T.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const o=await this.networkInterface.sendGetRequestAsync(t,e);return PN(o.body)?o.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(o){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${o}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in ov?ov[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var r,o,i;(r=this.performanceClient)==null||r.addQueueMeasurement(T.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=(o=this.authorityOptions.azureRegionConfiguration)==null?void 0:o.azureRegion;if(t){if(t!==b.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=rh.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,At.replaceWithRegionalInformation(e,t);const s=await D(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),T.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.environmentRegion,this.regionDiscoveryMetadata);if(s)return this.regionDiscoveryMetadata.region_outcome=rh.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=s,At.replaceWithRegionalInformation(e,s);this.regionDiscoveryMetadata.region_outcome=rh.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(T.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await D(this.getCloudDiscoveryMetadataFromNetwork.bind(this),T.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return oh(e,r,!0),rn.NETWORK;throw Ce(YT)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||b.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||b.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||b.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),oh(e,t,!1),rn.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const o=BR(this.hostnameAndPort);if(o)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),oh(e,o,!1),rn.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=rv(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),rn.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Ln.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),At.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Xc(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ce(Rm)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),At.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(T.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${b.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const i=await this.networkInterface.sendGetRequestAsync(e,t);let s,a;if(DN(i.body))s=i.body,a=s.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${s.tenant_discovery_endpoint}`);else if(LN(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),s=i.body,s.error===b.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${s.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${s.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Xc(a,this.hostnameAndPort)}catch(i){if(i instanceof Me)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{const s=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${s.name}
Error Description: ${s.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=At.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&ce.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==km.None){const o=t.tenant?t.tenant:b.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${o}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return b.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw x(vr)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return oE.has(e)}static isPublicCloudAuthority(e){return b.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const o=new ce(e);o.validateAsUri();const i=o.getUrlComponents();let s=`${t}.${i.HostNameAndPort}`;this.isPublicCloudAuthority(i.HostNameAndPort)&&(s=`${t}.${b.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=ce.constructAuthorityUriFromObject({...o.getUrlComponents(),HostNameAndPort:s}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=At.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=At.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=At.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const o=new ce(e).getUrlComponents();if(o.PathSegments.length===0&&o.HostNameAndPort.endsWith(b.CIAM_AUTH_URL)){const i=o.HostNameAndPort.split(".")[0];t=`${t}${i}${b.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}At.reservedTenantDomains=new Set(["{tenant}","{tenantid}",go.COMMON,go.CONSUMERS,go.ORGANIZATIONS]);function HN(n){var o;const r=(o=new ce(n).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:o.toLowerCase();switch(r){case go.COMMON:case go.ORGANIZATIONS:case go.CONSUMERS:return;default:return r}}function lE(n){return n.endsWith(b.FORWARD_SLASH)?n:`${n}${b.FORWARD_SLASH}`}function FN(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw Ce(Rm)}return{canonicalAuthority:n.authority?lE(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v14.16.0 2024-11-05 */async function cE(n,e,t,r,o,i,s){s==null||s.addQueueMeasurement(T.AuthorityFactoryCreateDiscoveredInstance,i);const a=At.transformCIAMAuthority(lE(n)),l=new At(a,e,t,r,o,i,s);try{return await D(l.resolveEndpointsAsync.bind(l),T.AuthorityResolveEndpointsAsync,o,s,i)(),l}catch{throw x(vr)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class Io extends Me{constructor(e,t,r,o,i){super(e,t,r),this.name="ServerError",this.errorNo=o,this.status=i,Object.setPrototypeOf(this,Io.prototype)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class or{static generateThrottlingStorageKey(e){return`${ha.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){var i;const r=or.generateThrottlingStorageKey(t),o=e.getThrottlingCache(r);if(o){if(o.throttleTime<Date.now()){e.removeItem(r);return}throw new Io(((i=o.errorCodes)==null?void 0:i.join(" "))||b.EMPTY_STRING,o.errorMessage,o.subError)}}static postProcess(e,t,r){if(or.checkResponseStatus(r)||or.checkResponseForRetryAfter(r)){const o={throttleTime:or.calculateThrottleTime(parseInt(r.headers[Lt.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(or.generateThrottlingStorageKey(t),o)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Lt.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(Math.min(r+(t||ha.DEFAULT_THROTTLE_TIME_SECONDS),r+ha.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,r,o){const i={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:o,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},s=this.generateThrottlingStorageKey(i);e.removeItem(s)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class Gu extends Me{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Gu.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function uv(n,e,t){return new Gu(n,e,t)}/*! @azure/msal-common v14.16.0 2024-11-05 */class Dm{constructor(e,t){this.config=QR(e),this.logger=new Pr(this.config.loggerOptions,HT,Em),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[Lt.CONTENT_TYPE]=b.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case fn.HOME_ACCOUNT_ID:try{const r=Vi(e.credential);t[Lt.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case fn.UPN:t[Lt.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,r,o,i,s){var l;s&&((l=this.performanceClient)==null||l.addQueueMeasurement(s,i));const a=await this.sendPostRequest(o,e,{body:t,headers:r},i);return this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,o){var s,a,l;or.preProcess(this.cacheManager,e);let i;try{i=await D(this.networkClient.sendPostRequestAsync.bind(this.networkClient),T.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,o)(t,r);const c=i.headers||{};(a=this.performanceClient)==null||a.addFields({refreshTokenSize:((s=i.body.refresh_token)==null?void 0:s.length)||0,httpVerToken:c[Lt.X_MS_HTTP_VERSION]||"",requestId:c[Lt.X_MS_REQUEST_ID]||""},o)}catch(c){if(c instanceof Gu){const u=c.responseHeaders;throw u&&((l=this.performanceClient)==null||l.addFields({httpVerToken:u[Lt.X_MS_HTTP_VERSION]||"",requestId:u[Lt.X_MS_REQUEST_ID]||"",contentTypeHeader:u[Lt.CONTENT_TYPE]||void 0,contentLengthHeader:u[Lt.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},o)),c.error}throw c instanceof Me?c:x(ET)}return or.postProcess(this.cacheManager,e,i),i}async updateAuthority(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(T.UpdateTokenEndpointAuthority,t);const r=`https://${e}/${this.authority.tenant}/`,o=await cE(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=o}createTokenQueryParameters(e){const t=new fa(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}/*! @azure/msal-common v14.16.0 2024-11-05 */const Zc="no_tokens_found",uE="native_account_unavailable",Lm="refresh_token_expired",BN="interaction_required",zN="consent_required",KN="login_required",Qu="bad_token";/*! @azure/msal-common v14.16.0 2024-11-05 */const dv=[BN,zN,KN,Qu],jN=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],$N={[Zc]:"No refresh token found in the cache. Please sign-in.",[uE]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Lm]:"Refresh token has expired.",[Qu]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class $n extends Me{constructor(e,t,r,o,i,s,a,l){super(e,t,r),Object.setPrototypeOf(this,$n.prototype),this.timestamp=o||b.EMPTY_STRING,this.traceId=i||b.EMPTY_STRING,this.correlationId=s||b.EMPTY_STRING,this.claims=a||b.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function hv(n,e,t){const r=!!n&&dv.indexOf(n)>-1,o=!!t&&jN.indexOf(t)>-1,i=!!e&&dv.some(s=>e.indexOf(s)>-1);return r||i||o}function Df(n){return new $n(n,$N[n])}/*! @azure/msal-common v14.16.0 2024-11-05 */class Kn{static setRequestState(e,t,r){const o=Kn.generateLibraryState(e,r);return t?`${o}${b.RESOURCE_DELIM}${t}`:o}static generateLibraryState(e,t){if(!e)throw x(xf);const r={id:e.createNewGuid()};t&&(r.meta=t);const o=JSON.stringify(r);return e.base64Encode(o)}static parseRequestState(e,t){if(!e)throw x(xf);if(!t)throw x(ps);try{const r=t.split(b.RESOURCE_DELIM),o=r[0],i=r.length>1?r.slice(1).join(b.RESOURCE_DELIM):b.EMPTY_STRING,s=e.base64Decode(o),a=JSON.parse(s);return{userRequestState:i||b.EMPTY_STRING,libraryState:a}}catch{throw x(ps)}}}/*! @azure/msal-common v14.16.0 2024-11-05 */const VN={SW:"sw"};class gs{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(T.PopTokenGenerateCnf,e.correlationId);const r=await D(this.generateKid.bind(this),T.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),o=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:o}}async generateKid(e){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(T.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:VN.SW}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,o){const{resourceRequestMethod:i,resourceRequestUri:s,shrClaims:a,shrNonce:l,shrOptions:c}=r,u=s?new ce(s):void 0,d=u==null?void 0:u.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:dr(),m:i==null?void 0:i.toUpperCase(),u:d==null?void 0:d.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:d==null?void 0:d.AbsolutePath,q:d!=null&&d.QueryString?[[],d.QueryString]:void 0,client_claims:a||void 0,...o},t,c,r.correlationId)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class WN{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.16.0 2024-11-05 */function qN(n){var r,o;const e="code=",t=(r=n.error_uri)==null?void 0:r.lastIndexOf(e);return t&&t>=0?(o=n.error_uri)==null?void 0:o.substring(t+e.length):void 0}class ai{constructor(e,t,r,o,i,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=o,this.serializableCache=i,this.persistencePlugin=s,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?x(qc,"Cached State"):x(qc,"Server State");let r,o;try{r=decodeURIComponent(e.state)}catch{throw x(ps,e.state)}try{o=decodeURIComponent(t)}catch{throw x(ps,e.state)}if(r!==o)throw x(AT);if(e.error||e.error_description||e.suberror){const i=qN(e);throw hv(e.error,e.error_description,e.suberror)?new $n(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",i):new Io(e.error||"",e.error_description,e.suberror,i)}}validateTokenResponse(e,t){var r;if(e.error||e.error_description||e.suberror){const o=`Error(s): ${e.error_codes||b.NOT_AVAILABLE} - Timestamp: ${e.timestamp||b.NOT_AVAILABLE} - Description: ${e.error_description||b.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||b.NOT_AVAILABLE} - Trace ID: ${e.trace_id||b.NOT_AVAILABLE}`,i=(r=e.error_codes)!=null&&r.length?e.error_codes[0]:void 0,s=new Io(e.error,o,e.suberror,i,e.status);if(t&&e.status&&e.status>=Fl.SERVER_ERROR_RANGE_START&&e.status<=Fl.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${s}`);return}else if(t&&e.status&&e.status>=Fl.CLIENT_ERROR_RANGE_START&&e.status<=Fl.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${s}`);return}throw hv(e.error,e.error_description,e.suberror)?new $n(e.error,e.error_description,e.suberror,e.timestamp||b.EMPTY_STRING,e.trace_id||b.EMPTY_STRING,e.correlation_id||b.EMPTY_STRING,e.claims||b.EMPTY_STRING,i):s}}async handleServerTokenResponse(e,t,r,o,i,s,a,l,c){var p;(p=this.performanceClient)==null||p.addQueueMeasurement(T.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=vi(e.id_token||b.EMPTY_STRING,this.cryptoObj.base64Decode),i&&i.nonce&&u.nonce!==i.nonce)throw x(bT);if(o.maxAge||o.maxAge===0){const m=u.auth_time;if(!m)throw x(Cm);FT(m,o.maxAge)}}this.homeAccountIdentifier=nt.generateHomeAccountId(e.client_info||b.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u);let d;i&&i.state&&(d=Kn.parseRequestState(this.cryptoObj,i.state)),e.key_id=e.key_id||o.sshKid||void 0;const h=this.generateCacheRecord(e,t,r,o,u,s,i);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new WN(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),a&&!l&&h.account){const m=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(m,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await ai.generateAuthenticationResult(this.cryptoObj,t,h,!1,o,u,d,void 0,c)}await this.cacheStorage.saveCacheRecord(h,o.storeInCache,o.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return ai.generateAuthenticationResult(this.cryptoObj,t,h,!1,o,u,d,e,c)}generateCacheRecord(e,t,r,o,i,s,a){const l=t.getPreferredCache();if(!l)throw x(wm);const c=tE(i);let u,d;e.id_token&&i&&(u=$u(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),d=Um(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,i,e.client_info,l,c,a,void 0,this.logger));let h=null;if(e.access_token){const m=e.scope?je.fromString(e.scope):new je(o.scopes||[]),v=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,g=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,C=r+v,w=C+g,I=y&&y>0?r+y:void 0;h=Vu(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",m.printScopes(),C,w,this.cryptoObj.base64Decode,I,e.token_type,s,e.key_id,o.claims,o.requestedClaimsHash)}let f=null;if(e.refresh_token){let m;if(e.refresh_token_expires_in){const v=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;m=r+v}f=BT(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,s,m)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:l,familyId:e.foci}),{account:d,idToken:u,accessToken:h,refreshToken:f,appMetadata:p}}static async generateAuthenticationResult(e,t,r,o,i,s,a,l,c){var C,w,I,A,R;let u=b.EMPTY_STRING,d=[],h=null,f,p,m=b.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===ye.POP&&!i.popKid){const k=new gs(e),{secret:M,keyId:O}=r.accessToken;if(!O)throw x(Tm);u=await k.signPopToken(M,O,i)}else u=r.accessToken.secret;d=je.fromString(r.accessToken.target).asArray(),h=new Date(Number(r.accessToken.expiresOn)*1e3),f=new Date(Number(r.accessToken.extendedExpiresOn)*1e3),r.accessToken.refreshOn&&(p=new Date(Number(r.accessToken.refreshOn)*1e3))}r.appMetadata&&(m=r.appMetadata.familyId===da?da:"");const v=(s==null?void 0:s.oid)||(s==null?void 0:s.sub)||"",g=(s==null?void 0:s.tid)||"";l!=null&&l.spa_accountid&&r.account&&(r.account.nativeAccountId=l==null?void 0:l.spa_accountid);const y=r.account?Om(r.account.getAccountInfo(),void 0,s,(C=r.idToken)==null?void 0:C.secret):null;return{authority:t.canonicalAuthority,uniqueId:v,tenantId:g,scopes:d,account:y,idToken:((w=r==null?void 0:r.idToken)==null?void 0:w.secret)||"",idTokenClaims:s||{},accessToken:u,fromCache:o,expiresOn:h,extExpiresOn:f,refreshOn:p,correlationId:i.correlationId,requestId:c||b.EMPTY_STRING,familyId:m,tokenType:((I=r.accessToken)==null?void 0:I.tokenType)||b.EMPTY_STRING,state:a?a.userRequestState:b.EMPTY_STRING,cloudGraphHostName:((A=r.account)==null?void 0:A.cloudGraphHostName)||b.EMPTY_STRING,msGraphHost:((R=r.account)==null?void 0:R.msGraphHost)||b.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function Um(n,e,t,r,o,i,s,a,l,c,u){u==null||u.verbose("setCachedAccount called");const h=n.getAccountKeys().find(g=>g.startsWith(t));let f=null;h&&(f=n.getAccount(h,u));const p=f||nt.createAccount({homeAccountId:t,idTokenClaims:o,clientInfo:i,environment:s,cloudGraphHostName:l==null?void 0:l.cloud_graph_host_name,msGraphHost:l==null?void 0:l.msgraph_host,nativeAccountId:c},e,r),m=p.tenantProfiles||[],v=a||p.realm;if(v&&!m.find(g=>g.tenantId===v)){const g=xm(t,p.localAccountId,v,o);m.push(g)}return p.tenantProfiles=m,p}/*! @azure/msal-common v14.16.0 2024-11-05 */async function dE(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v14.16.0 2024-11-05 */class hE extends Dm{constructor(e,t){var r;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(r=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:r.defaultScopes}async getAuthCodeUrl(e){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(T.GetAuthCodeUrl,e.correlationId);const t=await D(this.createAuthCodeUrlQueryString.bind(this),T.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return ce.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){var a,l;if((a=this.performanceClient)==null||a.addQueueMeasurement(T.AuthClientAcquireToken,e.correlationId),!e.code)throw x(xT);const r=dr(),o=await D(this.executeTokenRequest.bind(this),T.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),i=(l=o.headers)==null?void 0:l[Lt.X_MS_REQUEST_ID],s=new ai(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(o.body),D(s.handleServerTokenResponse.bind(s),T.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(o.body,this.authority,r,e,t,void 0,void 0,void 0,i)}handleFragmentResponse(e,t){if(new ai(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw x(DT);return e}getLogoutUri(e){if(!e)throw Ce(qT);const t=this.createLogoutUrlQueryString(e);return ce.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var c,u;(c=this.performanceClient)==null||c.addQueueMeasurement(T.AuthClientExecuteTokenRequest,t.correlationId);const r=this.createTokenQueryParameters(t),o=ce.appendQueryString(e.tokenEndpoint,r),i=await D(this.createTokenRequestBody.bind(this),T.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let s;if(t.clientInfo)try{const d=Qc(t.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${d.uid}${Rt.CLIENT_INFO_SEPARATOR}${d.utid}`,type:fn.HOME_ACCOUNT_ID}}catch(d){this.logger.verbose("Could not parse client info for CCS Header: "+d)}const a=this.createTokenRequestHeaders(s||t.ccsCredential),l={clientId:((u=t.tokenBodyParameters)==null?void 0:u.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return D(this.executePostToTokenEndpoint.bind(this),T.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(o,i,a,l,t.correlationId,T.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var o,i;(o=this.performanceClient)==null||o.addQueueMeasurement(T.AuthClientCreateTokenRequestBody,e.correlationId);const t=new fa(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[si])||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):bi.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!_f(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const s=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await dE(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(s.assertionType)}if(t.addGrantType(CT.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===ye.POP){const s=new gs(this.cryptoUtils,this.performanceClient);let a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await D(s.generateCnf.bind(s),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}else if(e.authenticationScheme===ye.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw Ce(Wu);(!zn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let r;if(e.clientInfo)try{const s=Qc(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${s.uid}${Rt.CLIENT_INFO_SEPARATOR}${s.utid}`,type:fn.HOME_ACCOUNT_ID}}catch(s){this.logger.verbose("Could not parse client info for CCS Header: "+s)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case fn.HOME_ACCOUNT_ID:try{const s=Vi(r.credential);t.addCcsOid(s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case fn.UPN:t.addCcsUpn(r.credential);break}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[cv])&&t.addExtraQueryParameters({[cv]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){var i,s;const t=e.correlationId||this.config.cryptoInterface.createNewGuid();(i=this.performanceClient)==null||i.addQueueMeasurement(T.AuthClientCreateQueryString,t);const r=new fa(t,this.performanceClient);r.addClientId(e.embeddedClientId||((s=e.extraQueryParameters)==null?void 0:s[si])||this.config.authOptions.clientId);const o=[...e.scopes||[],...e.extraScopesToConsent||[]];if(r.addScopes(o,!0,this.oidcDefaultScopes),r.addRedirectUri(e.redirectUri),r.addCorrelationId(t),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),_f(this.config)||r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==lt.SELECT_ACCOUNT)if(e.sid&&e.prompt===lt.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){const a=this.extractAccountSid(e.account);let l=this.extractLoginHint(e.account);if(l&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(l);try{const c=Vi(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&e.prompt===lt.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(a);try{const c=Vi(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{const c=Vi(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,r),e.nativeBroker&&(r.addNativeBroker(),e.authenticationScheme===ye.POP)){const a=new gs(this.cryptoUtils);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await D(a.generateCnf.bind(a),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}return r.createQueryString()}createLogoutUrlQueryString(e){const t=new fa(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return((t=e.idTokenClaims)==null?void 0:t.sid)||null}extractLoginHint(e){var t;return((t=e.idTokenClaims)==null?void 0:t.login_hint)||null}}/*! @azure/msal-common v14.16.0 2024-11-05 */const GN=300;class Lf extends Dm{constructor(e,t){super(e,t)}async acquireToken(e){var s,a;(s=this.performanceClient)==null||s.addQueueMeasurement(T.RefreshTokenClientAcquireToken,e.correlationId);const t=dr(),r=await D(this.executeTokenRequest.bind(this),T.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),o=(a=r.headers)==null?void 0:a[Lt.X_MS_REQUEST_ID],i=new ai(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return i.validateTokenResponse(r.body),D(i.handleServerTokenResponse.bind(i),T.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,o)}async acquireTokenByRefreshToken(e){var r;if(!e)throw Ce(WT);if((r=this.performanceClient)==null||r.addQueueMeasurement(T.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw x(Sm);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await D(this.acquireTokenWithCachedRefreshToken.bind(this),T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(o){const i=o instanceof $n&&o.errorCode===Zc,s=o instanceof Io&&o.errorCode===Qy.INVALID_GRANT_ERROR&&o.subError===Qy.CLIENT_MISMATCH_ERROR;if(i||s)return D(this.acquireTokenWithCachedRefreshToken.bind(this),T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw o}return D(this.acquireTokenWithCachedRefreshToken.bind(this),T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const r=Ci(this.cacheManager.getRefreshToken.bind(this.cacheManager),T.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw Df(Zc);if(r.expiresOn&&Mf(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||GN))throw Df(Lm);const o={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||ye.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:fn.HOME_ACCOUNT_ID}};try{return await D(this.acquireToken.bind(this),T.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(o)}catch(s){if(s instanceof $n&&s.subError===Qu){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const a=$i(r);this.cacheManager.removeRefreshToken(a)}throw s}}async executeTokenRequest(e,t){var l,c;(l=this.performanceClient)==null||l.addQueueMeasurement(T.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=this.createTokenQueryParameters(e),o=ce.appendQueryString(t.tokenEndpoint,r),i=await D(this.createTokenRequestBody.bind(this),T.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:((c=e.tokenBodyParameters)==null?void 0:c.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return D(this.executePostToTokenEndpoint.bind(this),T.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(o,i,s,a,e.correlationId,T.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var o,i,s;(o=this.performanceClient)==null||o.addQueueMeasurement(T.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,r=new fa(t,this.performanceClient);if(r.addClientId(e.embeddedClientId||((i=e.tokenBodyParameters)==null?void 0:i[si])||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,(s=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:s.defaultScopes),r.addGrantType(CT.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!_f(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await dE(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(a.assertionType)}if(e.authenticationScheme===ye.POP){const a=new gs(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await D(a.generateCnf.bind(a),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}else if(e.authenticationScheme===ye.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw Ce(Wu);if((!zn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case fn.HOME_ACCOUNT_ID:try{const a=Vi(e.ccsCredential.credential);r.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case fn.UPN:r.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}/*! @azure/msal-common v14.16.0 2024-11-05 */class QN extends Dm{constructor(e,t){super(e,t)}async acquireToken(e){var t;try{const[r,o]=await this.acquireCachedToken({...e,scopes:(t=e.scopes)!=null&&t.length?e.scopes:[...Rs]});return o===$r.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new Lf(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),r}catch(r){if(r instanceof ju&&r.errorCode===Er)return new Lf(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw r}}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(T.SilentFlowClientAcquireCachedToken,e.correlationId);let t=$r.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!zn.isEmptyObj(e.claims))throw this.setCacheOutcome($r.FORCE_REFRESH_OR_CLAIMS,e.correlationId),x(Er);if(!e.account)throw x(Sm);const r=e.account.tenantId||HN(e.authority),o=this.cacheManager.getTokenKeys(),i=this.cacheManager.getAccessToken(e.account,e,o,r,this.performanceClient,e.correlationId);if(i){if(kR(i.cachedAt)||Mf(i.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome($r.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),x(Er);i.refreshOn&&Mf(i.refreshOn,0)&&(t=$r.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome($r.NO_CACHED_ACCESS_TOKEN,e.correlationId),x(Er);const s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:i,idToken:this.cacheManager.getIdToken(e.account,o,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await D(this.generateResultFromCacheRecord.bind(this),T.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){var r,o;(r=this.serverTelemetryManager)==null||r.setCacheOutcome(e),(o=this.performanceClient)==null||o.addFields({cacheOutcome:e},t),e!==$r.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(T.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let r;if(e.idToken&&(r=vi(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const i=r==null?void 0:r.auth_time;if(!i)throw x(Cm);FT(i,t.maxAge)}return ai.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const YN={sendGetRequestAsync:()=>Promise.reject(x(re)),sendPostRequestAsync:()=>Promise.reject(x(re))};/*! @azure/msal-common v14.16.0 2024-11-05 */const fv=",",fE="|";function JN(n){const{skus:e,libraryName:t,libraryVersion:r,extensionName:o,extensionVersion:i}=n,s=new Map([[0,[t,r]],[2,[o,i]]]);let a=[];if(e!=null&&e.length){if(a=e.split(fv),a.length<4)return e}else a=Array.from({length:4},()=>fE);return s.forEach((l,c)=>{var u,d;l.length===2&&((u=l[0])!=null&&u.length)&&((d=l[1])!=null&&d.length)&&XN({skuArr:a,index:c,skuName:l[0],skuVersion:l[1]})}),a.join(fv)}function XN(n){const{skuArr:e,index:t,skuName:r,skuVersion:o}=n;t>=e.length||(e[t]=[r,o].join(fE))}class Ka{constructor(e,t){this.cacheOutcome=$r.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||b.EMPTY_STRING,this.wrapperVer=e.wrapperVer||b.EMPTY_STRING,this.telemetryCacheKey=gt.CACHE_KEY+Rt.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${gt.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r!=null&&r.length&&t.push(`broker_error=${r}`);const o=t.join(gt.VALUE_SEPARATOR),i=this.getRegionDiscoveryFields(),s=[e,i].join(gt.VALUE_SEPARATOR);return[gt.SCHEMA_VERSION,s,o].join(gt.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Ka.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(gt.VALUE_SEPARATOR),o=e.errors.slice(0,t).join(gt.VALUE_SEPARATOR),i=e.errors.length,s=t<i?gt.OVERFLOW_TRUE:gt.OVERFLOW_FALSE,a=[i,s].join(gt.VALUE_SEPARATOR);return[gt.SCHEMA_VERSION,e.cacheHits,r,o,a].join(gt.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=gt.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Me?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(gt.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=Ka.maxErrorsToSend(e),r=e.errors.length;if(t===r)this.cacheManager.removeItem(this.telemetryCacheKey);else{const o={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,o)}}static maxErrorsToSend(e){let t,r=0,o=0;const i=e.errors.length;for(t=0;t<i;t++){const s=e.failedRequests[2*t]||b.EMPTY_STRING,a=e.failedRequests[2*t+1]||b.EMPTY_STRING,l=e.errors[t]||b.EMPTY_STRING;if(o+=s.toString().length+a.toString().length+l.length+3,o<gt.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||b.EMPTY_STRING),e.push(this.regionSource||b.EMPTY_STRING),e.push(this.regionOutcome||b.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return JN(e)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const pE="missing_kid_error",mE="missing_alg_error";/*! @azure/msal-common v14.16.0 2024-11-05 */const ZN={[pE]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[mE]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Hm extends Me{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Hm.prototype)}}function pv(n){return new Hm(n,ZN[n])}/*! @azure/msal-common v14.16.0 2024-11-05 */class Fm{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw pv(pE);if(!e.alg)throw pv(mE);const t=new Fm({typ:e.typ||lR.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class mv{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class ex{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:UN.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new mv}}startPerformanceMeasurement(){return new mv}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const Bm="pkce_not_created",Uf="crypto_nonexistent",Yu="empty_navigate_uri",gE="hash_empty_error",zm="no_state_in_hash",yE="hash_does_not_contain_known_properties",vE="unable_to_parse_state",CE="state_interaction_type_mismatch",SE="interaction_in_progress",wE="popup_window_error",TE="empty_window_error",li="user_cancelled",tx="monitor_popup_timeout",EE="monitor_window_timeout",kE="redirect_in_iframe",IE="block_iframe_reload",AE="block_nested_popups",nx="iframe_closed_prematurely",Ju="silent_logout_unsupported",bE="no_account_error",rx="silent_prompt_value_error",RE="no_token_request_cache_error",NE="unable_to_parse_token_request_cache_error",Km="no_cached_authority_error",ox="auth_request_not_set_error",ix="invalid_cache_type",Xu="non_browser_environment",Ri="database_not_open",eu="no_network_connectivity",xE="post_request_failed",OE="get_request_failed",Hf="failed_to_parse_response",ME="unable_to_load_token",jm="crypto_key_not_found",_E="auth_code_required",PE="auth_code_or_nativeAccountId_required",DE="spa_code_and_nativeAccountId_present",$m="database_unavailable",LE="unable_to_acquire_token_from_native_platform",UE="native_handshake_timeout",HE="native_extension_not_installed",cl="native_connection_not_established",FE="uninitialized_public_client_application",BE="native_prompt_not_supported",zE="invalid_base64_string",KE="invalid_pop_token_request",jE="failed_to_build_headers",$E="failed_to_parse_headers";/*! @azure/msal-browser v3.28.1 2025-01-14 */const mr="For more visit: aka.ms/msaljs/browser-errors",sx={[Bm]:"The PKCE code challenge and verifier could not be generated.",[Uf]:"The crypto object or function is not available.",[Yu]:"Navigation URI is empty. Please check stack trace for more info.",[gE]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${mr}`,[zm]:"Hash does not contain state. Please verify that the request originated from msal.",[yE]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${mr}`,[vE]:"Unable to parse state. Please verify that the request originated from msal.",[CE]:"Hash contains state but the interaction type does not match the caller.",[SE]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${mr}`,[wE]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[TE]:"window.open returned null or undefined window object.",[li]:"User cancelled the flow.",[tx]:`Token acquisition in popup failed due to timeout.  ${mr}`,[EE]:`Token acquisition in iframe failed due to timeout.  ${mr}`,[kE]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[IE]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${mr}`,[AE]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[nx]:"The iframe being monitored was closed prematurely.",[Ju]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[bE]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[rx]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[RE]:"No token request found in cache.",[NE]:"The cached token request could not be parsed.",[Km]:"No cached authority found.",[ox]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[ix]:"Invalid cache type",[Xu]:"Login and token requests are not supported in non-browser environments.",[Ri]:"Database is not open!",[eu]:"No network connectivity. Check your internet connection.",[xE]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[OE]:"Network request failed. Please check the network trace to determine root cause.",[Hf]:"Failed to parse network response. Check network trace.",[ME]:"Error loading token to cache.",[jm]:"Cryptographic Key or Keypair not found in browser storage.",[_E]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[PE]:"An authorization code or nativeAccountId must be provided to this flow.",[DE]:"Request cannot contain both spa code and native account id.",[$m]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[LE]:`Unable to acquire token from native platform.  ${mr}`,[UE]:"Timed out while attempting to establish connection to browser extension",[HE]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[cl]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${mr}`,[FE]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${mr}`,[BE]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[zE]:"Invalid base64 encoded string.",[KE]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[jE]:"Failed to build request headers object.",[$E]:"Failed to parse response headers"};class ul extends Me{constructor(e,t){super(e,sx[e],t),Object.setPrototypeOf(this,ul.prototype),this.name="BrowserAuthError"}}function F(n,e){return new ul(n,e)}/*! @azure/msal-browser v3.28.1 2025-01-14 */const cn={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Wi={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},$o={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},Gt={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},gv={GET:"GET",POST:"POST"},me={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},jr={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},$l={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},be={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var $;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})($||($={}));const it={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},yv={scopes:Rs},VE="jwk",ax={React:"@azure/msal-react"},Ff="msal.db",lx=1,cx=`${Ff}.keys`,on={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},ux=[on.Default,on.Skip,on.RefreshTokenAndNetwork],dx="msal.browser.log.level",hx="msal.browser.log.pii";/*! @azure/msal-browser v3.28.1 2025-01-14 */function Vl(n){return encodeURIComponent(Vm(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Zu(n){return WE(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Vm(n){return WE(new TextEncoder().encode(n))}function WE(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v3.28.1 2025-01-14 */const fx="RSASSA-PKCS1-v1_5",qE="SHA-256",px=2048,mx=new Uint8Array([1,0,1]),vv="0123456789abcdef",Cv=new Uint32Array(1),gx="crypto_subtle_undefined",Wm={name:fx,hash:qE,modulusLength:px,publicExponent:mx};function yx(n){if(!window)throw F(Xu);if(!window.crypto)throw F(Uf);if(!n&&!window.crypto.subtle)throw F(Uf,gx)}async function GE(n,e,t){e==null||e.addQueueMeasurement(T.Sha256Digest,t);const o=new TextEncoder().encode(n);return window.crypto.subtle.digest(qE,o)}function vx(n){return window.crypto.getRandomValues(n)}function sh(){return window.crypto.getRandomValues(Cv),Cv[0]}function Dr(){const n=Date.now(),e=sh()*1024+(sh()&1023),t=new Uint8Array(16),r=Math.trunc(e/2**30),o=e&2**30-1,i=sh();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|r>>>8,t[7]=r,t[8]=128|o>>>24,t[9]=o>>>16,t[10]=o>>>8,t[11]=o,t[12]=i>>>24,t[13]=i>>>16,t[14]=i>>>8,t[15]=i;let s="";for(let a=0;a<t.length;a++)s+=vv.charAt(t[a]>>>4),s+=vv.charAt(t[a]&15),(a===3||a===5||a===7||a===9)&&(s+="-");return s}async function Cx(n,e){return window.crypto.subtle.generateKey(Wm,n,e)}async function ah(n){return window.crypto.subtle.exportKey(VE,n)}async function Sx(n,e,t){return window.crypto.subtle.importKey(VE,n,Wm,e,t)}async function wx(n,e){return window.crypto.subtle.sign(Wm,n,e)}async function QE(n){const e=await GE(n),t=new Uint8Array(e);return Zu(t)}/*! @azure/msal-browser v3.28.1 2025-01-14 */const ed="storage_not_supported",Xe="stubbed_public_client_application_called",qm="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.28.1 2025-01-14 */const mc={[ed]:"Given storage configuration option was not supported.",[Xe]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[qm]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};mc[ed],mc[Xe],mc[qm];class Gm extends Me{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Gm.prototype)}}function qe(n){return new Gm(n,mc[n])}/*! @azure/msal-browser v3.28.1 2025-01-14 */function Tx(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function Ex(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Qm(){return window.parent!==window}function kx(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${cn.POPUP_NAME_PREFIX}.`)===0}function kr(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function Ix(){const e=new ce(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function Ax(){if(ce.hashContainsKnownProperties(window.location.hash)&&Qm())throw F(IE)}function bx(n){if(Qm()&&!n)throw F(kE)}function Rx(){if(kx())throw F(AE)}function YE(){if(typeof window>"u")throw F(Xu)}function JE(n){if(!n)throw F(FE)}function Ym(n){YE(),Ax(),Rx(),JE(n)}function Sv(n,e){if(Ym(n),bx(e.system.allowRedirectInIframe),e.cache.cacheLocation===Gt.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw qe(qm)}function XE(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function Nx(){return Dr()}/*! @azure/msal-browser v3.28.1 2025-01-14 */class tu{navigateInternal(e,t){return tu.defaultNavigateWindow(e,t)}navigateExternal(e,t){return tu.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(r=>{setTimeout(()=>{r(!0)},t.timeout)})}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class xx{async sendGetRequestAsync(e,t){let r,o={},i=0;const s=wv(t);try{r=await fetch(e,{method:gv.GET,headers:s})}catch{throw F(window.navigator.onLine?OE:eu)}o=Tv(r.headers);try{return i=r.status,{headers:o,body:await r.json(),status:i}}catch{throw uv(F(Hf),i,o)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",o=wv(t);let i,s=0,a={};try{i=await fetch(e,{method:gv.POST,headers:o,body:r})}catch{throw F(window.navigator.onLine?xE:eu)}a=Tv(i.headers);try{return s=i.status,{headers:a,body:await i.json(),status:s}}catch{throw uv(F(Hf),s,a)}}}function wv(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([r,o])=>{e.append(r,o)}),e}catch{throw F(jE)}}function Tv(n){try{const e={};return n.forEach((t,r)=>{e[r]=t}),e}catch{throw F($E)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const Ox=6e4,Bf=1e4,Mx=3e4,_x=2e3;function Px({auth:n,cache:e,system:t,telemetry:r},o){const i={clientId:b.EMPTY_STRING,authority:`${b.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:b.EMPTY_STRING,authorityMetadata:b.EMPTY_STRING,redirectUri:typeof window<"u"?kr():"",postLogoutRedirectUri:b.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:br.AAD,OIDCOptions:{serverResponseType:ll.FRAGMENT,defaultScopes:[b.OPENID_SCOPE,b.PROFILE_SCOPE,b.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:km.None,tenant:b.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:Gt.SessionStorage,temporaryCacheLocation:Gt.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===Gt.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:xe.Info,piiLoggingEnabled:!1},c={...{...sE,loggerOptions:a,networkClient:o?new xx:YN,navigationClient:new tu,loadFrameTimeout:0,windowHashTimeout:(t==null?void 0:t.loadFrameTimeout)||Ox,iframeHashTimeout:(t==null?void 0:t.loadFrameTimeout)||Bf,navigateFrameWait:0,redirectNavigationTimeout:Mx,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(t==null?void 0:t.nativeBrokerHandshakeTimeout)||_x,pollIntervalMilliseconds:cn.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:(t==null?void 0:t.loggerOptions)||a},u={application:{appName:b.EMPTY_STRING,appVersion:b.EMPTY_STRING},client:new ex};if((n==null?void 0:n.protocolMode)!==br.OIDC&&(n!=null&&n.OIDCOptions)&&new Pr(c.loggerOptions).warning(JSON.stringify(Ce(XT))),n!=null&&n.protocolMode&&n.protocolMode!==br.AAD&&(c!=null&&c.allowNativeBroker))throw Ce(ZT);return{auth:{...i,...n,OIDCOptions:{...i.OIDCOptions,...n==null?void 0:n.OIDCOptions}},cache:{...s,...e},system:c,telemetry:{...u,...r}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const Dx="@azure/msal-browser",td="3.28.1";/*! @azure/msal-browser v3.28.1 2025-01-14 */class Jm{static loggerCallback(e,t){switch(e){case xe.Error:console.error(t);return;case xe.Info:console.info(t);return;case xe.Verbose:console.debug(t);return;case xe.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=Px(e,this.browserEnvironment);let t;try{t=window[Gt.SessionStorage]}catch{}const r=t==null?void 0:t.getItem(dx),o=(l=t==null?void 0:t.getItem(hx))==null?void 0:l.toLowerCase(),i=o==="true"?!0:o==="false"?!1:void 0,s={...this.config.system.loggerOptions},a=r&&Object.keys(xe).includes(r)?xe[r]:void 0;a&&(s.loggerCallback=Jm.loggerCallback,s.logLevel=a),i!==void 0&&(s.piiLoggingEnabled=i),this.logger=new Pr(s,Dx,td),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ci extends Jm{getModuleName(){return ci.MODULE_NAME}getId(){return ci.ID}async initialize(){return this.available=typeof window<"u",this.available}}ci.MODULE_NAME="";ci.ID="StandardOperatingContext";/*! @azure/msal-browser v3.28.1 2025-01-14 */function ur(n){return new TextDecoder().decode(Lx(n))}function Lx(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw F(zE)}const t=atob(e);return Uint8Array.from(t,r=>r.codePointAt(0)||0)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Ux{constructor(){this.dbName=Ff,this.version=lx,this.tableName=cx,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",o=>{o.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",o=>{const i=o;this.db=i.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>t(F($m)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(F(Ri));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);s.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((r,o)=>{if(!this.db)return o(F(Ri));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",l=>{this.closeConnection(),o(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(F(Ri));const s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);s.addEventListener("success",()=>{this.closeConnection(),t()}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(F(Ri));const i=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();i.addEventListener("success",s=>{const a=s;this.closeConnection(),e(a.target.result)}),i.addEventListener("error",s=>{this.closeConnection(),t(s)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(F(Ri));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);s.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result===1)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const r=window.indexedDB.deleteDatabase(Ff),o=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(o),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(o),e(!0))),r.addEventListener("error",()=>(clearTimeout(o),t(!1)))})}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class zf{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Hx{constructor(e){this.inMemoryCache=new zf,this.indexedDBCache=new Ux,this.logger=e}handleDatabaseAccessError(e){if(e instanceof ul&&e.errorCode===$m)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(r){this.handleDatabaseAccessError(r)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ys{constructor(e,t,r){this.logger=e,yx(r??!1),this.cache=new Hx(this.logger),this.performanceClient=t}createNewGuid(){return Dr()}base64Encode(e){return Vm(e)}base64Decode(e){return ur(e)}base64UrlEncode(e){return Vl(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var u;const t=(u=this.performanceClient)==null?void 0:u.startMeasurement(T.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await Cx(ys.EXTRACTABLE,ys.POP_KEY_USAGES),o=await ah(r.publicKey),i={e:o.e,kty:o.kty,n:o.n},s=Ev(i),a=await this.hashString(s),l=await ah(r.privateKey),c=await Sx(l,!1,["sign"]);return await this.cache.setItem(a,{privateKey:c,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,o){var C;const i=(C=this.performanceClient)==null?void 0:C.startMeasurement(T.CryptoOptsSignJwt,o),s=await this.cache.getItem(t);if(!s)throw F(jm);const a=await ah(s.publicKey),l=Ev(a),c=Vl(JSON.stringify({kid:t})),u=Fm.getShrHeaderString({...r==null?void 0:r.header,alg:a.alg,kid:c}),d=Vl(u);e.cnf={jwk:JSON.parse(l)};const h=Vl(JSON.stringify(e)),f=`${d}.${h}`,m=new TextEncoder().encode(f),v=await wx(s.privateKey,m),g=Zu(new Uint8Array(v)),y=`${f}.${g}`;return i&&i.end({success:!0}),y}async hashString(e){return QE(e)}}ys.POP_KEY_USAGES=["sign","verify"];ys.EXTRACTABLE=!0;function Ev(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Fx{constructor(){if(!window.localStorage)throw qe(ed)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Bx{constructor(){if(!window.sessionStorage)throw qe(ed)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */function ZE(n,e){if(!e)return null;try{return Kn.parseRequestState(n,e).libraryState.meta}catch{throw x(ps)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const zx=24*60*60*1e3;class Kx{getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let o=0;o<r.length;o++){const i=r[o],[s,...a]=decodeURIComponent(i).trim().split("="),l=a.join("=");if(s===t)return l}return""}setItem(e,t,r,o=!0){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(r){const s=jx(r);i+=`expires=${s};`}o&&(i+="Secure;"),document.cookie=i}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(r=>{const o=decodeURIComponent(r).trim().split("=");t.push(o[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function jx(n){const e=new Date;return new Date(e.getTime()+n*zx).toUTCString()}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Kf extends ms{constructor(e,t,r,o,i,s){super(e,r,o,i),this.cacheConfig=t,this.logger=o,this.internalStorage=new zf,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new Kx,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=s}setupBrowserStorage(e){try{switch(e){case Gt.LocalStorage:return new Fx;case Gt.SessionStorage:return new Bx;case Gt.MemoryStorage:default:break}}catch(t){this.logger.error(t)}return this.cacheConfig.cacheLocation=Gt.MemoryStorage,new zf}migrateCacheEntries(){const e=`${b.CACHE_PREFIX}.${ot.ID_TOKEN}`,t=`${b.CACHE_PREFIX}.${ot.CLIENT_INFO}`,r=`${b.CACHE_PREFIX}.${ot.ERROR}`,o=`${b.CACHE_PREFIX}.${ot.ERROR_DESC}`,i=this.browserStorage.getItem(e),s=this.browserStorage.getItem(t),a=this.browserStorage.getItem(r),l=this.browserStorage.getItem(o),c=[i,s,a,l];[ot.ID_TOKEN,ot.CLIENT_INFO,ot.ERROR,ot.ERROR_DESC].forEach((d,h)=>{const f=c[h];f&&this.setTemporaryCache(d,f,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(jr.ACCOUNT_KEYS),t=this.getItem(`${jr.TOKEN_KEYS}.${this.clientId}`);if(e&&t){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(o=>{if(this.isCredentialKey(o)){const i=this.getItem(o);if(i){const s=this.validateAndParseJson(i);if(s&&s.hasOwnProperty("credentialType"))switch(s.credentialType){case Q.ID_TOKEN:if(ev(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${o} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(o,a);this.addTokenKey(l,Q.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${o}`);break;case Q.ACCESS_TOKEN:case Q.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Zy(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${o} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(o,a);this.addTokenKey(l,Q.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${o}`);break;case Q.REFRESH_TOKEN:if(tv(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${o} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(o,a);this.addTokenKey(l,Q.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${o}`);break}}}if(this.isAccountKey(o)){const i=this.getItem(o);if(i){const s=this.validateAndParseJson(i);s&&nt.isAccountEntity(s)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${o} found, saving key to account key map`),this.addAccountKeyToMap(o))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,r,t)}getCachedAccountEntity(e){const t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return!r||!nt.isAccountEntity(r)?(this.removeAccountKeyFromMap(e),null):ms.toObject(new nt,r)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(jr.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();t.indexOf(e)===-1?(t.push(e),this.setItem(jr.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(jr.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,Q.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,Q.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,Q.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${jr.TOKEN_KEYS}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case Q.ID_TOKEN:r.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case Q.ACCESS_TOKEN:r.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case Q.REFRESH_TOKEN:r.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),x(Of)}this.setItem(`${jr.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case Q.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const o=r.idToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case Q.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const i=r.accessToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case Q.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const s=r.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),x(Of)}this.setItem(`${jr.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ID_TOKEN),null;const r=this.validateAndParseJson(t);return!r||!ev(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const t=$i(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Q.ID_TOKEN)}getAccessTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return!r||!Zy(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const t=$i(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Q.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return!r||!tv(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const t=$i(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Q.REFRESH_TOKEN)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!_R(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=MR(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!xR(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&PR(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem($l.WRAPPER_SKU,e),this.internalStorage.setItem($l.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem($l.WRAPPER_SKU)||b.EMPTY_STRING,t=this.internalStorage.getItem($l.WRAPPER_VER)||b.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(ot.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const o=this.generateCacheKey(ot.ACTIVE_ACCOUNT),i=this.getItem(o);if(!i)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const s=this.getAccountInfoFilteredBy({localAccountId:i});return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(ot.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(ot.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const o={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(o)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!OR(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const i=this.cookieStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),i}const o=this.temporaryCacheStorage.getItem(r);if(!o){if(this.cacheConfig.cacheLocation===Gt.LocalStorage){const i=this.browserStorage.getItem(r);if(i)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),i}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),o}setTemporaryCache(e,t,r){const o=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(o,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(o,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(b.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(b.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(T.ClearTokensAndKeysWithClaims,t);const r=this.getTokenKeys(),o=[];r.accessToken.forEach(i=>{const s=this.getAccessTokenCredential(i);s!=null&&s.requestedClaimsHash&&i.includes(s.requestedClaimsHash.toLowerCase())&&o.push(this.removeAccessToken(i))}),await Promise.all(o),o.length>0&&this.logger.warning(`${o.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):zn.startsWith(e,b.CACHE_PREFIX)||zn.startsWith(e,ot.ADAL_ID_TOKEN)?e:`${b.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=Kn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${me.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=Kn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${me.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=Kn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${me.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;const o=this.generateAuthorityKey(r);return this.getTemporaryCache(o)}updateCacheEntries(e,t,r,o,i){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const s=this.generateStateKey(e);this.setTemporaryCache(s,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,r,!1),i){const c={credential:i.homeAccountId,type:fn.HOME_ACCOUNT_ID};this.setTemporaryCache(me.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(o){const c={credential:o,type:fn.UPN};this.setTemporaryCache(me.CCS_CREDENTIAL,JSON.stringify(c),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(me.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(me.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(me.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(me.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(me.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(me.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||b.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(me.REQUEST_STATE)===-1)return;const r=this.temporaryCacheStorage.getItem(t);if(!r)return;const o=ZE(this.cryptoImpl,r);o&&o.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=Vm(JSON.stringify(e));this.setTemporaryCache(me.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(me.REQUEST_PARAMS,!0);if(!t)throw F(RE);let r;try{r=JSON.parse(ur(t))}catch(o){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${o}`),F(NE)}if(this.removeTemporaryItem(this.generateCacheKey(me.REQUEST_PARAMS)),!r.authority){const o=this.generateAuthorityKey(e),i=this.getTemporaryCache(o);if(!i)throw F(Km);r.authority=i}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(me.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${b.CACHE_PREFIX}.${me.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${b.CACHE_PREFIX}.${me.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw F(SE);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(ot.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(ot.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(ot.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(ot.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=t||e;if(r){const o=vi(r,ur);if(o.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),o.preferred_username;if(o.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),o.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){const r=$i(t);if(e!==r){const o=this.getItem(e);if(o)return this.browserStorage.removeItem(e),this.setItem(r,o),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){var a,l,c;const r=$u((a=e.account)==null?void 0:a.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let o;t.claims&&(o=await this.cryptoImpl.hashString(t.claims));const i=Vu((c=e.account)==null?void 0:c.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,ur,void 0,e.tokenType,void 0,t.sshKid,t.claims,o),s={idToken:r,accessToken:i};return this.saveCacheRecord(s)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(o){if(o instanceof ts&&this.performanceClient&&r)try{const i=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:i.refreshToken.length,cacheIdCount:i.idToken.length,cacheAtCount:i.accessToken.length},r)}catch{}throw o}}}const $x=(n,e)=>{const t={cacheLocation:Gt.MemoryStorage,temporaryCacheLocation:Gt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Kf(n,t,Gc,e)};/*! @azure/msal-browser v3.28.1 2025-01-14 */function Vx(n,e,t,r){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(r):[]}function Wx(n,e,t){if(e.trace("getAccount called"),Object.keys(n).length===0)return e.warning("getAccount: No accountFilter provided"),null;const r=t.getAccountInfoFilteredBy(n);return r?(e.verbose("getAccount: Account matching provided filter found, returning"),r):(e.verbose("getAccount: No matching account found, returning null"),null)}function qx(n,e,t){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const r=t.getAccountInfoFilteredBy({username:n});return r?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),r):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function Gx(n,e,t){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const r=t.getAccountInfoFilteredBy({homeAccountId:n});return r?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),r):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function Qx(n,e,t){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const r=t.getAccountInfoFilteredBy({localAccountId:n});return r?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),r):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function Yx(n,e){e.setActiveAccount(n)}function Jx(n){return n.getActiveAccount()}/*! @azure/msal-browser v3.28.1 2025-01-14 */const z={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.28.1 2025-01-14 */class Xx{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Pr({})}addEventCallback(e,t,r){if(typeof window<"u"){const o=r||Nx();return this.eventCallbacks.has(o)?(this.logger.error(`Event callback with id: ${o} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(o,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${o}`),o)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,o){if(typeof window<"u"){const i={eventType:e,interactionType:t||null,payload:r||null,error:o||null,timestamp:Date.now()};this.eventCallbacks.forEach(([s,a],l)=>{(a.length===0||a.includes(e))&&(this.logger.verbose(`Emitting event to callback ${l}: ${e}`),s.apply(null,[i]))})}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ek{constructor(e,t,r,o,i,s,a,l,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=i,this.navigationClient=s,this.nativeMessageHandler=l,this.correlationId=c||Dr(),this.logger=o.clone(cn.MSAL_SKU,td,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){nt.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(nt.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return ce.getAbsoluteUrl(t,kr())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Ka(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(T.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const o={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},i=e.requestAuthority||this.config.auth.authority,s=r!=null&&r.length?r==="true":this.config.auth.instanceAware,a=t&&s?this.config.auth.authority.replace(ce.getDomainFromUrl(i),t.environment):i,l=At.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await D(cE,T.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,o,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Ce(eE);return c}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const Zx=32;async function e1(n,e,t){n.addQueueMeasurement(T.GeneratePkceCodes,t);const r=Ci(t1,T.GenerateCodeVerifier,e,n,t)(n,e,t),o=await D(n1,T.GenerateCodeChallengeFromVerifier,e,n,t)(r,n,e,t);return{verifier:r,challenge:o}}function t1(n,e,t){try{const r=new Uint8Array(Zx);return Ci(vx,T.GetRandomValues,e,n,t)(r),Zu(r)}catch{throw F(Bm)}}async function n1(n,e,t,r){e.addQueueMeasurement(T.GenerateCodeChallengeFromVerifier,r);try{const o=await D(GE,T.Sha256Digest,t,e,r)(n,e,r);return Zu(new Uint8Array(o))}catch{throw F(Bm)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */async function Xm(n,e,t,r){t.addQueueMeasurement(T.InitializeBaseRequest,n.correlationId);const o=n.authority||e.auth.authority,i=[...n&&n.scopes||[]],s={...n,correlationId:n.correlationId,authority:o,scopes:i};if(!s.authenticationScheme)s.authenticationScheme=ye.BEARER,r.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(s.authenticationScheme===ye.SSH){if(!n.sshJwk)throw Ce(Wu);if(!n.sshKid)throw Ce(JT)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!zn.isEmptyObj(n.claims)&&(s.requestedClaimsHash=await QE(n.claims)),s}async function r1(n,e,t,r,o){r.addQueueMeasurement(T.InitializeSilentRequest,n.correlationId);const i=await D(Xm,T.InitializeBaseRequest,o,r,n.correlationId)(n,t,r,o);return{...n,...i,account:e,forceRefresh:n.forceRefresh||!1}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Ns extends ek{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const t=await D(e1,T.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:b.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=b.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const t={correlationId:this.correlationId||Dr(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=ce.getAbsoluteUrl(e.postLogoutRedirectUri,kr())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=ce.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,kr())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=ce.getAbsoluteUrl(kr(),kr())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(T.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await D(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new hE(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:s}=e;this.performanceClient.addQueueMeasurement(T.StandardInteractionClientGetClientConfiguration,this.correlationId);const a=await D(this.getDiscoveredAuthority.bind(this),T.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:o,requestExtraQueryParameters:i,account:s}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:cn.MSAL_SKU,version:td,cpu:b.EMPTY_STRING,os:b.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(T.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),o={interactionType:t},i=Kn.setRequestState(this.browserCrypto,e&&e.state||b.EMPTY_STRING,o),a={...await D(Xm,T.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:i,nonce:e.nonce||Dr(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return a;const l=e.account||this.browserStorage.getActiveAccount();if(l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),a.account=l),!a.loginHint&&!l){const c=this.browserStorage.getLegacyLoginHint();c&&(a.loginHint=c)}return a}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const o1="ContentError",tk="user_switch";/*! @azure/msal-browser v3.28.1 2025-01-14 */const i1="USER_INTERACTION_REQUIRED",s1="USER_CANCEL",a1="NO_NETWORK",l1="PERSISTENT_ERROR",c1="DISABLED",u1="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.28.1 2025-01-14 */const d1=-2147186943,h1={[tk]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class ir extends Me{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,ir.prototype),this.name="NativeAuthError",this.ext=r}}function Ni(n){if(n.ext&&n.ext.status&&(n.ext.status===l1||n.ext.status===c1)||n.ext&&n.ext.error&&n.ext.error===d1)return!0;switch(n.errorCode){case o1:return!0;default:return!1}}function jf(n,e,t){if(t&&t.status)switch(t.status){case u1:return Df(uE);case i1:return new $n(n,e);case s1:return F(li);case a1:return F(eu)}return new ir(n,h1[n]||e,t)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class nk extends Ns{async acquireToken(e){this.performanceClient.addQueueMeasurement(T.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(be.acquireTokenSilent_silentFlow),r=await D(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),o=new QN(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const s=(await D(o.acquireCachedToken.bind(o),T.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),s}catch(i){throw i instanceof ul&&i.errorCode===jm&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),i}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t==null?void 0:t.account)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ns extends ek{constructor(e,t,r,o,i,s,a,l,c,u,d,h){var p;super(e,t,r,o,i,s,l,c,h),this.apiId=a,this.accountId=u,this.nativeMessageHandler=c,this.nativeStorageManager=d,this.silentCacheClient=new nk(e,this.nativeStorageManager,r,o,i,s,l,c,h),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const f=this.nativeMessageHandler.getExtensionId()===Wi.PREFERRED_EXTENSION_ID?"chrome":(p=this.nativeMessageHandler.getExtensionId())!=null&&p.length?"unknown":void 0;this.skus=Ka.makeExtraSkuString({libraryName:cn.MSAL_SKU,libraryVersion:td,extensionName:f,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[MN]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(T.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(T.NativeInteractionClientAcquireToken,e.correlationId),r=dr();try{const o=await this.initializeNativeRequest(e);try{const c=await this.acquireTokensFromCache(this.accountId,o);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),c}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...i}=o,s={method:$o.GetToken,request:i},a=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(a);return await this.handleNativeResponse(l,o,r).then(c=>(t.end({success:!0,isNativeBroker:!0,requestId:c.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),c)).catch(c=>{throw t.end({success:!1,errorCode:c.errorCode,subErrorCode:c.subError,isNativeBroker:!0}),c})}catch(o){throw o instanceof ir&&this.serverTelemetryManager.setNativeBrokerErrorCode(o.errorCode),o}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:je.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),x(Nf);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw x(Nf);try{const o=this.createSilentCacheRequest(t,r),i=await this.silentCacheClient.acquireToken(o),s={...r,idTokenClaims:i==null?void 0:i.idTokenClaims,idToken:i==null?void 0:i.idToken};return{...i,account:s}}catch(o){throw o}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const o=await this.initializeNativeRequest(r),i={method:$o.GetToken,request:o};try{const l=await this.nativeMessageHandler.sendMessage(i);this.validateNativeResponse(l)}catch(l){if(l instanceof ir&&(this.serverTelemetryManager.setNativeBrokerErrorCode(l.errorCode),Ni(l)))throw l}this.browserStorage.setTemporaryCache(me.NATIVE_REQUEST,JSON.stringify(o),!0);const s={apiId:be.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,s)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(e==null||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:o,...i}=r;o&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(me.NATIVE_REQUEST));const s={method:$o.GetToken,request:i},a=dr();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(s);this.validateNativeResponse(l);const c=this.handleNativeResponse(l,i,a);this.browserStorage.setInteractionInProgress(!1);const u=await c;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),u}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){var u;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const o=vi(e.id_token,ur),i=this.createHomeAccountIdentifier(e,o),s=(u=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId}))==null?void 0:u.homeAccountId;if(i!==s&&e.account.id!==t.accountId)throw jf(tk);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=Um(this.browserStorage,a,i,ur,o,e.client_info,void 0,o.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,o,l,a.canonicalAuthority,r);return this.cacheAccount(l),this.cacheNativeTokens(e,t,i,o,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return nt.generateHomeAccountId(e.client_info||b.EMPTY_STRING,Ln.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?je.fromString(e.scope):je.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===ye.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new gs(this.browserCrypto),o={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw x(Tm);return r.signPopToken(e.access_token,t.keyId,o)}else return e.access_token}async generateAuthenticationResult(e,t,r,o,i,s){const a=this.addTelemetryFromNativeResponse(e),l=e.scope?je.fromString(e.scope):je.fromString(t.scope),c=e.account.properties||{},u=c.UID||r.oid||r.sub||b.EMPTY_STRING,d=c.TenantId||r.tid||b.EMPTY_STRING,h=Om(o.getAccountInfo(),void 0,r,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const f=await this.generatePopAccessToken(e,t),p=t.tokenType===ye.POP?ye.POP:ye.BEARER;return{authority:i,uniqueId:u,tenantId:d,scopes:l.asArray(),account:h,idToken:e.id_token,idTokenClaims:r,accessToken:f,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(s+e.expires_in)*1e3),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,r,o,i,s,a){const l=$u(r,t.authority,e.id_token||"",t.clientId,o.tid||""),c=t.tokenType===ye.POP?b.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,u=a+c,d=this.generateScopes(e,t),h=Vu(r,t.authority,i,t.clientId,o.tid||s,d.printScopes(),u,0,ur,void 0,t.tokenType,void 0,t.keyId),f={idToken:l,accessToken:h};this.nativeStorageManager.saveCacheRecord(f,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw ST(gm,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new ce(t);r.validateAsUri();const{scopes:o,...i}=e,s=new je(o||[]);s.appendScopes(Rs);const a=()=>{switch(this.apiId){case be.ssoSilent:case be.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),lt.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case lt.NONE:case lt.CONSENT:case lt.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),F(BE)}},l={...i,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw F(KE);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=Wi.MATS_TELEMETRY,e.authenticationScheme===ye.POP){const c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},u=new gs(this.browserCrypto);let d;if(l.keyId)d=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const h=await D(u.generateCnf.bind(u),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(c,this.logger);d=h.reqCnfString,l.keyId=h.kid,l.signPopToken=!0}l.reqCnf=d}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var i;const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Pm)&&e.extraParameters.hasOwnProperty(Pf)&&e.extraParameters.hasOwnProperty(si);if(!e.embeddedClientId&&!t)return;let r="";const o=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Pf],r=e.extraParameters[si]),e.extraParameters={child_client_id:r,child_redirect_uri:o},(i=this.performanceClient)==null||i.addFields({embeddedClientId:r,embeddedRedirectUri:o},e.correlationId)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class sr{constructor(e,t,r,o){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=o,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(T.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:Wi.CHANNEL_ID,extensionId:this.extensionId,responseId:Dr(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((r,o)=>{this.resolvers.set(t.responseId,{resolve:r,reject:o})})}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const o=new sr(e,t,r,Wi.PREFERRED_EXTENSION_ID);return await o.sendHandshakeRequest(),o}catch{const i=new sr(e,t,r);return await i.sendHandshakeRequest(),i}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Wi.CHANNEL_ID,extensionId:this.extensionId,responseId:Dr(),body:{method:$o.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(F(UE)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Wi.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===$o.HandshakeRequest){const r=this.handshakeResolvers.get(t.responseId);if(!r){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(F(HE))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),o=this.handshakeResolvers.get(t.responseId);try{const i=t.body.method;if(i===$o.Response){if(!r)return;const s=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(s)}`),s.status!=="Success")r.reject(jf(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?r.reject(jf(s.result.code,s.result.description,s.result.ext)):r.resolve(s.result);else throw ST(gm,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(i===$o.HandshakeResponse){if(!o){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),o.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(i){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${i}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(i):o&&o.reject(i)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,r,o){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(o)switch(o){case ye.BEARER:case ye.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Zm{constructor(e,t,r,o,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(T.HandleCodeResponse,t.correlationId);let r;try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(o){throw o instanceof Io&&o.subError===li?F(li):o}return D(this.handleCodeResponseFromServer.bind(this),T.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(T.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await D(this.authModule.updateAuthority.bind(this.authModule),T.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const i=this.createCcsCredentials(t);i&&(this.authCodeRequest.ccsCredential=i)}return await D(this.authModule.acquireToken.bind(this.authModule),T.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:fn.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:fn.UPN}:null}}/*! @azure/msal-browser v3.28.1 2025-01-14 */function rk(n,e,t){const r=Jc(n);if(!r)throw nE(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),F(yE)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),F(gE));return r}function f1(n,e,t){if(!n.state)throw F(zm);const r=ZE(e,n.state);if(!r)throw F(vE);if(r.interactionType!==t)throw F(CE)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class p1 extends Ns{constructor(e,t,r,o,i,s,a,l,c,u){super(e,t,r,o,i,s,a,c,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e){try{const r={popupName:this.generatePopupName(e.scopes||Rs,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r))}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},o=e&&e.authority,i=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,o,i)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,o,i))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t){var i;this.logger.verbose("acquireTokenPopupAsync called");const r=this.initializeServerTelemetryManager(be.acquireTokenPopup),o=await D(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,$.Popup);XE(o.authority);try{const s=await D(this.initializeAuthorizationCodeRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(o),a=await D(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:o.authority,requestAzureCloudOptions:o.azureCloudOptions,requestExtraQueryParameters:o.extraQueryParameters,account:o.account}),l=sr.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let c;l&&(c=this.performanceClient.startMeasurement(T.FetchAccountIdWithNativeBroker,e.correlationId));const u=await a.getAuthCodeUrl({...o,nativeBroker:l}),d=new Zm(a,this.browserStorage,s,this.logger,this.performanceClient),h=this.initiateAuthRequest(u,t);this.eventHandler.emitEvent(z.POPUP_OPENED,$.Popup,{popupWindow:h},null);const f=await this.monitorPopupForHash(h,t.popupWindowParent),p=Ci(rk,T.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(f,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(or.removeThrottle(this.browserStorage,this.config.auth.clientId,s),p.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw F(cl);const v=new ns(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,p.accountId,this.nativeStorage,o.correlationId),{userRequestState:g}=Kn.parseRequestState(this.browserCrypto,o.state);return await v.acquireToken({...o,state:g,prompt:void 0})}return await d.handleCodeResponse(p,o)}catch(s){throw(i=t.popup)==null||i.close(),s instanceof Me&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),s}}async logoutPopupAsync(e,t,r,o){var s,a,l,c;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(z.LOGOUT_START,$.Popup,e);const i=this.initializeServerTelemetryManager(be.logoutPopup);try{await this.clearCacheOnLogout(e.account);const u=await D(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:i,requestAuthority:r,account:e.account||void 0});try{u.authority.endSessionEndpoint}catch{if((s=e.account)!=null&&s.homeAccountId&&e.postLogoutRedirectUri&&u.authority.protocolMode===br.OIDC){if(this.browserStorage.removeAccount((a=e.account)==null?void 0:a.homeAccountId),this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Popup,e),o){const f={apiId:be.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=ce.getAbsoluteUrl(o,kr());await this.navigationClient.navigateInternal(p,f)}(l=t.popup)==null||l.close();return}}const d=u.getLogoutUri(e);this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Popup,e);const h=this.openPopup(d,t);if(this.eventHandler.emitEvent(z.POPUP_OPENED,$.Popup,{popupWindow:h},null),await this.monitorPopupForHash(h,t.popupWindowParent).catch(()=>{}),o){const f={apiId:be.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=ce.getAbsoluteUrl(o,kr());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${p}`),await this.navigationClient.navigateInternal(p,f)}else this.logger.verbose("No main window navigation requested")}catch(u){throw(c=t.popup)==null||c.close(),u instanceof Me&&(u.setCorrelationId(this.correlationId),i.cacheFailedRequest(u)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(z.LOGOUT_FAILURE,$.Popup,null,u),this.eventHandler.emitEvent(z.LOGOUT_END,$.Popup),u}this.eventHandler.emitEvent(z.LOGOUT_END,$.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),F(Yu)}monitorPopupForHash(e,t){return new Promise((r,o)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),o(F(li));return}let s="";try{s=e.location.href}catch{}if(!s||s==="about:blank")return;clearInterval(i);let a="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===ll.QUERY?a=e.location.search:a=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw F(TE);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),F(wE)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:o}){var f,p,m,v;const i=o.screenLeft?o.screenLeft:o.screenX,s=o.screenTop?o.screenTop:o.screenY,a=o.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=o.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=(f=r.popupSize)==null?void 0:f.width,u=(p=r.popupSize)==null?void 0:p.height,d=(m=r.popupPosition)==null?void 0:m.top,h=(v=r.popupPosition)==null?void 0:v.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=cn.POPUP_WIDTH),(!u||u<0||u>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=cn.POPUP_HEIGHT),(!d||d<0||d>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),d=Math.max(0,l/2-cn.POPUP_HEIGHT/2+s)),(!h||h<0||h>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,a/2-cn.POPUP_WIDTH/2+i)),o.open(e,t,`width=${c}, height=${u}, top=${d}, left=${h}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType($.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${cn.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${cn.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v3.28.1 2025-01-14 */let kv=class{constructor(e,t,r,o,i){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=o,this.performanceClient=i}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(me.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(me.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:be.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,r);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,r);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),F(Yu)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),o=this.browserStorage.getTemporaryCache(r);if(!o)throw x(qc,"Cached State");let i;try{i=this.authModule.handleFragmentResponse(e,o)}catch(c){throw c instanceof Io&&c.subError===li?F(li):c}const s=this.browserStorage.generateNonceKey(o),a=this.browserStorage.getTemporaryCache(s);if(this.authCodeRequest.code=i.code,i.cloud_instance_host_name&&await D(this.authModule.updateAuthority.bind(this.authModule),T.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(i.cloud_instance_host_name,this.authCodeRequest.correlationId),i.nonce=a||void 0,i.state=o,i.client_info)this.authCodeRequest.clientInfo=i.client_info;else{const c=this.checkCcsCredentials();c&&(this.authCodeRequest.ccsCredential=c)}const l=await this.authModule.acquireToken(this.authCodeRequest,i);return this.browserStorage.cleanRequestByState(t),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(me.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}};/*! @azure/msal-browser v3.28.1 2025-01-14 */function m1(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation"),e=n.length?n[0]:void 0;return e==null?void 0:e.type}class g1 extends Ns{constructor(e,t,r,o,i,s,a,l,c,u){super(e,t,r,o,i,s,a,c,u),this.nativeStorage=l}async acquireToken(e){const t=await D(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,$.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const r=this.initializeServerTelemetryManager(be.acquireTokenRedirect),o=i=>{i.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(z.RESTORE_FROM_BFCACHE,$.Redirect))};try{const i=await D(this.initializeAuthorizationCodeRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),s=await D(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new kv(s,this.browserStorage,i,this.logger,this.performanceClient),l=await s.getAuthCodeUrl({...t,nativeBroker:sr.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",o),await a.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(i){throw i instanceof Me&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),window.removeEventListener("pageshow",o),this.browserStorage.cleanRequestByState(t.state),i}}async handleRedirectPromise(e="",t){const r=this.initializeServerTelemetryManager(be.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[o,i]=this.getRedirectResponse(e||"");if(!o)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType($.Redirect),m1()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(me.ORIGIN_URI,!0)||b.EMPTY_STRING,a=ce.removeHashFromUrl(s),l=ce.removeHashFromUrl(window.location.href);if(a===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&Ex(s),await this.handleResponse(o,r);if(this.config.auth.navigateToLoginRequestUrl){if(!Qm()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(me.URL_HASH,i,!0);const c={apiId:be.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let u=!0;if(!s||s==="null"){const d=Ix();this.browserStorage.setTemporaryCache(me.ORIGIN_URI,d,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),u=await this.navigationClient.navigateInternal(d,c)}else this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),u=await this.navigationClient.navigateInternal(s,c);if(!u)return await this.handleResponse(o,r)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(o,r);return null}catch(o){throw o instanceof Me&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),this.browserStorage.cleanRequestByInteractionType($.Redirect),o}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===ll.QUERY?t=window.location.search:t=window.location.hash);let r=Jc(t);if(r){try{f1(r,this.browserCrypto,$.Redirect)}catch(i){return i instanceof Me&&this.logger.error(`Interaction type validation failed due to ${i.errorCode}: ${i.errorMessage}`),[null,""]}return Tx(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const o=this.browserStorage.getTemporaryCache(me.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(me.URL_HASH)),o&&(r=Jc(o),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,o]):[null,""]}async handleResponse(e,t){const r=e.state;if(!r)throw F(zm);const o=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw F(cl);const l=new ns(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,o.correlationId),{userRequestState:c}=Kn.parseRequestState(this.browserCrypto,r);return l.acquireToken({...o,state:c,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}const i=this.browserStorage.getCachedAuthority(r);if(!i)throw F(Km);const s=await D(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:i});return or.removeThrottle(this.browserStorage,this.config.auth.clientId,o),new kv(s,this.browserStorage,o,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){var o,i;this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(be.logout);try{this.eventHandler.emitEvent(z.LOGOUT_START,$.Redirect,e),await this.clearCacheOnLogout(t.account);const s={apiId:be.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await D(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===br.OIDC)try{a.authority.endSessionEndpoint}catch{if((o=t.account)!=null&&o.homeAccountId){this.browserStorage.removeAccount((i=t.account)==null?void 0:i.homeAccountId),this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Redirect,t);return}}const l=a.getLogoutUri(t);if(this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,s);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,s);return}}catch(s){throw s instanceof Me&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),this.eventHandler.emitEvent(z.LOGOUT_FAILURE,$.Redirect,null,s),this.eventHandler.emitEvent(z.LOGOUT_END,$.Redirect),s}this.eventHandler.emitEvent(z.LOGOUT_END,$.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return ce.getAbsoluteUrl(t,kr())}}/*! @azure/msal-browser v3.28.1 2025-01-14 */async function y1(n,e,t,r,o){if(e.addQueueMeasurement(T.SilentHandlerInitiateAuthRequest,r),!n)throw t.info("Navigate url is empty"),F(Yu);return o?D(C1,T.SilentHandlerLoadFrame,t,e,r)(n,o,e,r):Ci(S1,T.SilentHandlerLoadFrameSync,t,e,r)(n)}async function v1(n,e,t,r,o,i,s){return r.addQueueMeasurement(T.SilentHandlerMonitorIframeForHash,i),new Promise((a,l)=>{e<Bf&&o.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${Bf}ms). This may result in timeouts.`);const c=window.setTimeout(()=>{window.clearInterval(u),l(F(EE))},e),u=window.setInterval(()=>{let d="";const h=n.contentWindow;try{d=h?h.location.href:""}catch{}if(!d||d==="about:blank")return;let f="";h&&(s===ll.QUERY?f=h.location.search:f=h.location.hash),window.clearTimeout(c),window.clearInterval(u),a(f)},t)}).finally(()=>{Ci(w1,T.RemoveHiddenIframe,o,r,i)(n)})}function C1(n,e,t,r){return t.addQueueMeasurement(T.SilentHandlerLoadFrame,r),new Promise((o,i)=>{const s=ok();window.setTimeout(()=>{if(!s){i("Unable to load iframe");return}s.src=n,o(s)},e)})}function S1(n){const e=ok();return e.src=n,e}function ok(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function w1(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class T1 extends Ns{constructor(e,t,r,o,i,s,a,l,c,u,d){super(e,t,r,o,i,s,l,u,d),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(T.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==lt.NONE&&t.prompt!==lt.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${lt.NONE}`),t.prompt=lt.NONE):t.prompt=lt.NONE;const r=await D(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,$.Silent);XE(r.authority);const o=this.initializeServerTelemetryManager(this.apiId);let i;try{return i=await D(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:o,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),await D(this.silentTokenHelper.bind(this),T.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(i,r)}catch(s){if(s instanceof Me&&(s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s)),!i||!(s instanceof Me)||s.errorCode!==cn.INVALID_GRANT_ERROR)throw s;this.performanceClient.addFields({retryError:s.errorCode},this.correlationId);const a=await D(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,$.Silent);return await D(this.silentTokenHelper.bind(this),T.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(i,a)}}logout(){return Promise.reject(F(Ju))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(T.SilentIframeClientTokenHelper,r);const o=await D(this.initializeAuthorizationCodeRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(t),i=await D(e.getAuthCodeUrl.bind(e),T.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...t,nativeBroker:sr.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),s=new Zm(e,this.browserStorage,o,this.logger,this.performanceClient),a=await D(y1,T.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(i,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,c=await D(v1,T.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,l),u=Ci(rk,T.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(c,l,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw F(cl);const d=new ns(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,r),{userRequestState:h}=Kn.parseRequestState(this.browserCrypto,t.state);return D(d.acquireToken.bind(d),T.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...t,state:h,prompt:t.prompt||lt.NONE})}return D(s.handleCodeResponse.bind(s),T.HandleCodeResponse,this.logger,this.performanceClient,r)(u,t)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class E1 extends Ns{async acquireToken(e){this.performanceClient.addQueueMeasurement(T.SilentRefreshClientAcquireToken,e.correlationId);const t=await D(Xm,T.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const o=this.initializeServerTelemetryManager(be.acquireTokenSilent_silentFlow),i=await this.createRefreshTokenClient({serverTelemetryManager:o,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return D(i.acquireTokenByRefreshToken.bind(i),T.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(s=>{throw s.setCorrelationId(this.correlationId),o.cacheFailedRequest(s),s})}logout(){return Promise.reject(F(Ju))}async createRefreshTokenClient(e){const t=await D(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Lf(t,this.performanceClient)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class k1{constructor(e,t,r,o){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=r,this.cryptoObj=o}loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw F(Xu);const o=t.id_token?vi(t.id_token,ur):void 0,i={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new At(At.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,i,this.logger,e.correlationId||Dr()):void 0,a=this.loadAccount(e,r.clientInfo||t.client_info||"",o,s),l=this.loadIdToken(t,a.homeAccountId,a.environment,a.realm),c=this.loadAccessToken(e,t,a.homeAccountId,a.environment,a.realm,r),u=this.loadRefreshToken(t,a.homeAccountId,a.environment);return this.generateAuthenticationResult(e,{account:a,idToken:l,accessToken:c,refreshToken:u},o,s)}loadAccount(e,t,r,o){if(this.logger.verbose("TokenCache - loading account"),e.account){const l=nt.createFromAccountInfo(e.account);return this.storage.setAccount(l),l}else if(!o||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),F(ME);const i=nt.generateHomeAccountId(t,o.authorityType,this.logger,this.cryptoObj,r),s=r==null?void 0:r.tid,a=Um(this.storage,o,i,ur,r,t,o.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(a),a}loadIdToken(e,t,r,o){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const i=$u(t,r,e.id_token,this.config.auth.clientId,o);return this.storage.setIdTokenCredential(i),i}loadAccessToken(e,t,r,o,i,s){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const a=t.scope?je.fromString(t.scope):new je(e.scopes),l=s.expiresOn||t.expires_in+new Date().getTime()/1e3,c=s.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=Vu(r,o,t.access_token,this.config.auth.clientId,i,a.printScopes(),l,c,ur);return this.storage.setAccessTokenCredential(u),u}loadRefreshToken(e,t,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const o=BT(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(o),o}generateAuthenticationResult(e,t,r,o){var u,d,h;let i="",s=[],a=null,l;t!=null&&t.accessToken&&(i=t.accessToken.secret,s=je.fromString(t.accessToken.target).asArray(),a=new Date(Number(t.accessToken.expiresOn)*1e3),l=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const c=t.account;return{authority:o?o.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:s,account:c.getAccountInfo(),idToken:((u=t.idToken)==null?void 0:u.secret)||"",idTokenClaims:r||{},accessToken:i,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((d=t.refreshToken)==null?void 0:d.familyId)||"",tokenType:((h=t==null?void 0:t.accessToken)==null?void 0:h.tokenType)||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class I1 extends hE{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class A1 extends Ns{constructor(e,t,r,o,i,s,a,l,c,u){super(e,t,r,o,i,s,l,c,u),this.apiId=a}async acquireToken(e){if(!e.code)throw F(_E);const t=await D(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,$.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const o={...t,code:e.code},i=await D(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),s=new I1(i);this.logger.verbose("Auth code client created");const a=new Zm(s,this.browserStorage,o,this.logger,this.performanceClient);return await D(a.handleCodeResponseFromServer.bind(a),T.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(o){throw o instanceof Me&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),o}}logout(){return Promise.reject(F(Ju))}}/*! @azure/msal-browser v3.28.1 2025-01-14 */function Zn(n){const e=n==null?void 0:n.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function Wl(n,e){try{Ym(n)}catch(t){throw e.end({success:!1},t),t}}class nd{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new ys(this.logger,this.performanceClient):Gc,this.eventHandler=new Xx(this.logger),this.browserStorage=this.isBrowserEnvironment?new Kf(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,FN(this.config.auth),this.performanceClient):$x(this.config.auth.clientId,this.logger);const t={cacheLocation:Gt.MemoryStorage,temporaryCacheLocation:Gt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Kf(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new k1(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const r=new nd(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(z.INITIALIZE_END);return}const t=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,o=this.performanceClient.startMeasurement(T.InitializeClientApplication,t);if(this.eventHandler.emitEvent(z.INITIALIZE_START),r)try{this.nativeExtensionProvider=await sr.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(i){this.logger.verbose(i)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await D(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),T.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(z.INITIALIZE_END),o.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),JE(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return typeof r>"u"?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),o=r&&sr.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,i=o?r==null?void 0:r.correlationId:this.browserStorage.getTemporaryCache(me.CORRELATION_ID,!0)||"",s=this.performanceClient.startMeasurement(T.AcquireTokenRedirect,i);this.eventHandler.emitEvent(z.HANDLE_REDIRECT_START,$.Redirect);let a;if(o&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new ns(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=D(l.handleRedirectPromise.bind(l),T.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(this.performanceClient,s.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(i);a=D(l.handleRedirectPromise.bind(l),T.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(e,s)}return a.then(l=>(l?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(z.LOGIN_SUCCESS,$.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,$.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),s.end({success:!0,accountType:Zn(l.account)})):s.event.errorCode?s.end({success:!1}):s.discard(),this.eventHandler.emitEvent(z.HANDLE_REDIRECT_END,$.Redirect),l)).catch(l=>{const c=l;throw t.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Redirect,null,c):this.eventHandler.emitEvent(z.LOGIN_FAILURE,$.Redirect,null,c),this.eventHandler.emitEvent(z.HANDLE_REDIRECT_END,$.Redirect),s.end({success:!1},c),l})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement(T.AcquireTokenPreRedirect,t);r.add({accountType:Zn(e.account),scenarioId:e.scenarioId});const o=e.onRedirectNavigate;if(o)e.onRedirectNavigate=s=>{const a=typeof o=="function"?o(s):void 0;return a!==!1?r.end({success:!0}):r.discard(),a};else{const s=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=a=>{const l=typeof s=="function"?s(a):void 0;return l!==!1?r.end({success:!0}):r.discard(),l}}const i=this.getAllAccounts().length>0;try{Sv(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),i?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,$.Redirect,e):this.eventHandler.emitEvent(z.LOGIN_START,$.Redirect,e);let s;return this.nativeExtensionProvider&&this.canUseNative(e)?s=new ns(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch(l=>{if(l instanceof ir&&Ni(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(l instanceof $n)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):s=this.createRedirectClient(t).acquireToken(e),await s}catch(s){throw r.end({success:!1},s),i?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Redirect,null,s):this.eventHandler.emitEvent(z.LOGIN_FAILURE,$.Redirect,null,s),s}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(T.AcquireTokenPopup,t);r.add({scenarioId:e.scenarioId,accountType:Zn(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Wl(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(s){return Promise.reject(s)}const o=this.getAllAccounts();o.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,$.Popup,e):this.eventHandler.emitEvent(z.LOGIN_START,$.Popup,e);let i;return this.canUseNative(e)?i=this.acquireTokenNative({...e,correlationId:t},be.acquireTokenPopup).then(s=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,accountType:Zn(s.account)}),s)).catch(s=>{if(s instanceof ir&&Ni(s))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(s instanceof $n)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),s}):i=this.createPopupClient(t).acquireToken(e),i.then(s=>(o.length<this.getAllAccounts().length?this.eventHandler.emitEvent(z.LOGIN_SUCCESS,$.Popup,s):this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,$.Popup,s),r.end({success:!0,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Zn(s.account)}),s)).catch(s=>(o.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Popup,null,s):this.eventHandler.emitEvent(z.LOGIN_FAILURE,$.Popup,null,s),r.end({success:!1},s),Promise.reject(s)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var i,s;const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(T.SsoSilent,t),(i=this.ssoSilentMeasurement)==null||i.add({scenarioId:e.scenarioId,accountType:Zn(e.account)}),Wl(this.initialized,this.ssoSilentMeasurement),(s=this.ssoSilentMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(z.SSO_SILENT_START,$.Silent,r);let o;return this.canUseNative(r)?o=this.acquireTokenNative(r,be.ssoSilent).catch(a=>{if(a instanceof ir&&Ni(a))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw a}):o=this.createSilentIframeClient(r.correlationId).acquireToken(r),o.then(a=>{var l;return this.eventHandler.emitEvent(z.SSO_SILENT_SUCCESS,$.Silent,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Zn(a.account)}),a}).catch(a=>{var l;throw this.eventHandler.emitEvent(z.SSO_SILENT_FAILURE,$.Silent,null,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},a),a}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(T.AcquireTokenByCode,t);Wl(this.initialized,r),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_START,$.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw F(DE);if(e.code){const o=e.code;let i=this.hybridAuthCodeResponses.get(o);return i?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),i=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(s=>(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_SUCCESS,$.Silent,s),this.hybridAuthCodeResponses.delete(o),r.end({success:!0,isNativeBroker:s.fromNativeBroker,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Zn(s.account)}),s)).catch(s=>{throw this.hybridAuthCodeResponses.delete(o),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_FAILURE,$.Silent,null,s),r.end({success:!1},s),s}),this.hybridAuthCodeResponses.set(o,i)),await i}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const o=await this.acquireTokenNative({...e,correlationId:t},be.acquireTokenByCode,e.nativeAccountId).catch(i=>{throw i instanceof ir&&Ni(i)&&(this.nativeExtensionProvider=void 0),i});return r.end({accountType:Zn(o.account),success:!0}),o}else throw F(LE);else throw F(PE)}catch(o){throw this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_FAILURE,$.Silent,null,o),r.end({success:!1},o),o}}async acquireTokenByCodeAsync(e){var o;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(T.AcquireTokenByCodeAsync,e.correlationId),(o=this.acquireTokenByCodeAsyncMeasurement)==null||o.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>{var s;return(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!0,fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker}),i}).catch(i=>{var s;throw(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(T.AcquireTokenFromCache,e.correlationId),t){case on.Default:case on.AccessToken:case on.AccessTokenAndRefreshToken:const r=this.createSilentCacheClient(e.correlationId);return D(r.acquireToken.bind(r),T.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw x(Er)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(T.AcquireTokenByRefreshToken,e.correlationId),t){case on.Default:case on.AccessTokenAndRefreshToken:case on.RefreshToken:case on.RefreshTokenAndNetwork:const r=this.createSilentRefreshClient(e.correlationId);return D(r.acquireToken.bind(r),T.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw x(Er)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(T.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return D(t.acquireToken.bind(t),T.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return Sv(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Ym(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return Vx(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return Wx(e,this.logger,this.browserStorage)}getAccountByUsername(e){return qx(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return Gx(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return Qx(e,this.logger,this.browserStorage)}setActiveAccount(e){Yx(e,this.browserStorage)}getActiveAccount(){return Jx(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=nt.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw F(cl);return new ns(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!sr.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case lt.NONE:case lt.CONSENT:case lt.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new p1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new g1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new T1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new nk(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new E1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new A1(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return YE(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){var t;try{(t=e.key)!=null&&t.includes(ot.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(z.ACTIVE_ACCOUNT_CHANGED);const r=e.newValue||e.oldValue;if(!r)return;const o=JSON.parse(r);if(typeof o!="object"||!nt.isAccountEntity(o))return;const s=ms.toObject(new nt,o).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(z.ACCOUNT_ADDED,void 0,s)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(z.ACCOUNT_REMOVED,void 0,s))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Dr():b.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||yv})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||yv})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(T.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Wl(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const o=e.account||this.getActiveAccount();if(!o)throw F(bE);r.add({accountType:Zn(o)});const i={clientId:this.config.auth.clientId,authority:e.authority||b.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:o.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},s=JSON.stringify(i),a=this.activeSilentTokenRequests.get(s);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const l=D(this.acquireTokenSilentAsync.bind(this),T.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},o).then(c=>(this.activeSilentTokenRequests.delete(s),r.end({success:!0,fromCache:c.fromCache,isNativeBroker:c.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c)).catch(c=>{throw this.activeSilentTokenRequests.delete(s),r.end({success:!1},c),c});return this.activeSilentTokenRequests.set(s,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),{...await a,state:e.state}}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(T.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,$.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const o=await D(r1,T.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),i=e.cacheLookupPolicy||on.Default;return this.acquireTokenSilentNoIframe(o,i).catch(async a=>{if(b1(a,i))if(this.activeIframeRequest)if(i!==on.Skip){const[c,u]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${u}`,o.correlationId);const d=this.performanceClient.startMeasurement(T.AwaitConcurrentIframe,o.correlationId);d.add({awaitIframeCorrelationId:u});const h=await c;if(d.end({success:h}),h)return this.logger.verbose(`Parallel iframe request with correlationId: ${u} succeeded. Retrying cache and/or RT redemption`,o.correlationId),this.acquireTokenSilentNoIframe(o,i);throw this.logger.info(`Iframe request with correlationId: ${u} failed. Interaction is required.`),a}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",o.correlationId),D(this.acquireTokenBySilentIframe.bind(this),T.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o);else{let c;return this.activeIframeRequest=[new Promise(u=>{c=u}),o.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",o.correlationId),D(this.acquireTokenBySilentIframe.bind(this),T.AcquireTokenBySilentIframe,this.logger,this.performanceClient,o.correlationId)(o).then(u=>(c(!0),u)).catch(u=>{throw c(!1),u}).finally(()=>{this.activeIframeRequest=void 0})}else throw a}).then(a=>(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,$.Silent,a),e.correlationId&&this.performanceClient.addFields({fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker},e.correlationId),a)).catch(a=>{throw this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Silent,null,a),a}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,t){return sr.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,be.acquireTokenSilent_silentFlow).catch(async r=>{throw r instanceof ir&&Ni(r)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,x(Er)):r})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),D(this.acquireTokenFromCache.bind(this),T.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(r=>{if(t===on.AccessToken)throw r;return this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_NETWORK_START,$.Silent,e),D(this.acquireTokenByRefreshToken.bind(this),T.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}function b1(n,e){const t=!(n instanceof $n&&n.subError!==Qu),r=n.errorCode===cn.INVALID_GRANT_ERROR||n.errorCode===Er,o=t&&r||n.errorCode===Zc||n.errorCode===Lm,i=ux.includes(e);return o&&i}/*! @azure/msal-browser v3.28.1 2025-01-14 */async function R1(n,e){const t=new ci(n);return await t.initialize(),nd.createController(t,e)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class rd{static async createPublicClientApplication(e){const t=await R1(e);return new rd(e,t)}constructor(e,t){this.controller=t||new nd(new ci(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const N1={initialize:()=>Promise.reject(qe(Xe)),acquireTokenPopup:()=>Promise.reject(qe(Xe)),acquireTokenRedirect:()=>Promise.reject(qe(Xe)),acquireTokenSilent:()=>Promise.reject(qe(Xe)),acquireTokenByCode:()=>Promise.reject(qe(Xe)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject(qe(Xe)),loginPopup:()=>Promise.reject(qe(Xe)),loginRedirect:()=>Promise.reject(qe(Xe)),logout:()=>Promise.reject(qe(Xe)),logoutRedirect:()=>Promise.reject(qe(Xe)),logoutPopup:()=>Promise.reject(qe(Xe)),ssoSilent:()=>Promise.reject(qe(Xe)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw qe(Xe)},getLogger:()=>{throw qe(Xe)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw qe(Xe)},hydrateCache:()=>Promise.reject(qe(Xe)),clearCache:()=>Promise.reject(qe(Xe))};/*! @azure/msal-browser v3.28.1 2025-01-14 */class x1{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case z.LOGIN_START:return it.Login;case z.SSO_SILENT_START:return it.SsoSilent;case z.ACQUIRE_TOKEN_START:if(e.interactionType===$.Redirect||e.interactionType===$.Popup)return it.AcquireToken;break;case z.HANDLE_REDIRECT_START:return it.HandleRedirect;case z.LOGOUT_START:return it.Logout;case z.SSO_SILENT_SUCCESS:case z.SSO_SILENT_FAILURE:if(t&&t!==it.SsoSilent)break;return it.None;case z.LOGOUT_END:if(t&&t!==it.Logout)break;return it.None;case z.HANDLE_REDIRECT_END:if(t&&t!==it.HandleRedirect)break;return it.None;case z.LOGIN_SUCCESS:case z.LOGIN_FAILURE:case z.ACQUIRE_TOKEN_SUCCESS:case z.ACQUIRE_TOKEN_FAILURE:case z.RESTORE_FROM_BFCACHE:if(e.interactionType===$.Redirect||e.interactionType===$.Popup){if(t&&t!==it.Login&&t!==it.AcquireToken)break;return it.None}break}return null}}/*! @azure/msal-react v2.2.0 2024-11-05 */const O1={instance:N1,inProgress:it.None,accounts:[],logger:new Pr({})},eg=S.createContext(O1);eg.Consumer;/*! @azure/msal-react v2.2.0 2024-11-05 */function Iv(n,e){if(n.length!==e.length)return!1;const t=[...e];return n.every(r=>{const o=t.shift();return!r||!o?!1:r.homeAccountId===o.homeAccountId&&r.localAccountId===o.localAccountId&&r.username===o.username})}/*! @azure/msal-react v2.2.0 2024-11-05 */const M1="@azure/msal-react",Av="2.2.0";/*! @azure/msal-react v2.2.0 2024-11-05 */const nu={UNBLOCK_INPROGRESS:"UNBLOCK_INPROGRESS",EVENT:"EVENT"},_1=(n,e)=>{const{type:t,payload:r}=e;let o=n.inProgress;switch(t){case nu.UNBLOCK_INPROGRESS:n.inProgress===it.Startup&&(o=it.None,r.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case nu.EVENT:const s=r.message,a=x1.getInteractionStatusFromEvent(s,n.inProgress);a&&(r.logger.info(`MsalProvider - ${s.eventType} results in setting inProgress from ${n.inProgress} to ${a}`),o=a);break;default:throw new Error(`Unknown action type: ${t}`)}const i=r.instance.getAllAccounts();return o!==n.inProgress&&!Iv(i,n.accounts)?{...n,inProgress:o,accounts:i}:o!==n.inProgress?{...n,inProgress:o}:Iv(i,n.accounts)?n:{...n,accounts:i}};function P1({instance:n,children:e}){S.useEffect(()=>{n.initializeWrapperLibrary(ax.React,Av)},[n]);const t=S.useMemo(()=>n.getLogger().clone(M1,Av),[n]),[r,o]=S.useReducer(_1,void 0,()=>({inProgress:it.Startup,accounts:n.getAllAccounts()}));S.useEffect(()=>{const s=n.addEventCallback(a=>{o({payload:{instance:n,logger:t,message:a},type:nu.EVENT})});return t.verbose(`MsalProvider - Registered event callback with id: ${s}`),n.initialize().then(()=>{n.handleRedirectPromise().catch(()=>{}).finally(()=>{o({payload:{instance:n,logger:t},type:nu.UNBLOCK_INPROGRESS})})}).catch(()=>{}),()=>{s&&(t.verbose(`MsalProvider - Removing event callback ${s}`),n.removeEventCallback(s))}},[n,t]);const i={instance:n,inProgress:r.inProgress,accounts:r.accounts,logger:t};return ie.createElement(eg.Provider,{value:i},e)}/*! @azure/msal-react v2.2.0 2024-11-05 */const tg=()=>S.useContext(eg),ik={auth:{clientId:"9d415839-9ee7-4830-8dc3-ccf5a34af2b9",authority:"https://login.microsoftonline.com/54df8ee5-42ab-4c14-b444-1b54f749b225",redirectUri:window.location.origin},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},ru={scopes:["User.Read","User.ReadBasic.All","People.Read"]};function ve(n,e,t,r){function o(i){return i instanceof t?i:new t(function(s){s(i)})}return new(t||(t=Promise))(function(i,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?i(u.value):o(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}var an;(function(n){n.GET="GET",n.PATCH="PATCH",n.POST="POST",n.PUT="PUT",n.DELETE="DELETE"})(an||(an={}));const D1="v1.0",L1="https://graph.microsoft.com/",U1=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class ui extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new ui,t.customError=e),t}constructor(e){super(e),Object.setPrototypeOf(this,ui.prototype)}}const H1=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],F1=n=>{const e=i=>i.replace(/\/+$/,""),t=i=>i.replace(/^\/+/,""),r=(i,s)=>[e(i),t(s)].join("/");return Array.prototype.slice.call(n).reduce(r)},lh=n=>{const e=n&&n.constructor&&n.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof n=="string")return n;if(e==="ArrayBuffer")n=Buffer.from(n);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")n=Buffer.from(n.buffer);else try{n=JSON.stringify(n)}catch{throw new Error("Unable to stringify the content")}return n},sk=n=>lk(n),ak=(n,e)=>(e.forEach(t=>B1(t)),lk(n,e)),lk=(n,e=U1)=>{if(n=n.toLowerCase(),n.indexOf("https://")!==-1){n=n.replace("https://","");const t=n.indexOf(":"),r=n.indexOf("/");let o="";if(r!==-1)return t!==-1&&t<r?(o=n.substring(0,t),e.has(o)):(o=n.substring(0,r),e.has(o))}return!1},B1=n=>{if(n.indexOf("/")!==-1)throw new ui("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class di{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const r=t.constructor;this.middlewareOptions.set(r,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const z1=()=>{let n="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(n+="-"),n+=Math.floor(Math.random()*16).toString(16);return n},ck=(n,e,t)=>{let r=null;if(typeof Request<"u"&&n instanceof Request)r=n.headers.get(t);else if(typeof e<"u"&&e.headers!==void 0)if(typeof Headers<"u"&&e.headers instanceof Headers)r=e.headers.get(t);else if(e.headers instanceof Array){const o=e.headers;for(let i=0,s=o.length;i<s;i++)if(o[i][0]===t){r=o[i][1];break}}else e.headers[t]!==void 0&&(r=e.headers[t]);return r},uk=(n,e,t,r)=>{if(typeof Request<"u"&&n instanceof Request)n.headers.set(t,r);else if(typeof e<"u")if(e.headers===void 0)e.headers=new Headers({[t]:r});else if(typeof Headers<"u"&&e.headers instanceof Headers)e.headers.set(t,r);else if(e.headers instanceof Array){let o=0;const i=e.headers.length;for(;o<i;o++){const s=e.headers[o];if(s[0]===t){s[1]=r;break}}o===i&&e.headers.push([t,r])}else Object.assign(e.headers,{[t]:r})},dk=(n,e,t,r)=>{typeof Request<"u"&&n instanceof Request?n.headers.append(t,r):typeof e<"u"&&(e.headers===void 0?e.headers=new Headers({[t]:r}):typeof Headers<"u"&&e.headers instanceof Headers?e.headers.append(t,r):e.headers instanceof Array?e.headers.push([t,r]):e.headers===void 0?e.headers={[t]:r}:e.headers[t]===void 0?e.headers[t]=r:e.headers[t]+=`, ${r}`)},K1=(n,e)=>ve(void 0,void 0,void 0,function*(){const t=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:r,headers:o,referrer:i,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:f}=e;return new Request(n,{method:r,headers:o,body:t,referrer:i,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:f})});class j1{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var vs;(function(n){n[n.NONE=0]="NONE",n[n.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",n[n.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",n[n.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(vs||(vs={}));class yo{constructor(){this.featureUsage=vs.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof di?r=e.middlewareControl.getMiddlewareOptions(yo):e.middlewareControl=new di,typeof r>"u"&&(r=new yo,e.middlewareControl.setMiddlewareOptions(yo,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class ja{constructor(e){this.authenticationProvider=e}execute(e){return ve(this,void 0,void 0,function*(){const t=typeof e.request=="string"?e.request:e.request.url;if(sk(t)||e.customHosts&&ak(t,e.customHosts)){let r;e.middlewareControl instanceof di&&(r=e.middlewareControl.getMiddlewareOptions(j1));let o,i;r&&(o=r.authenticationProvider,i=r.authenticationProviderOptions),o||(o=this.authenticationProvider);const a=`Bearer ${yield o.getAccessToken(i)}`;dk(e.request,e.options,ja.AUTHORIZATION_HEADER,a),yo.updateFeatureUsageFlag(e,vs.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[ja.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}ja.AUTHORIZATION_HEADER="Authorization";class $1{execute(e){return ve(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}class Pe{constructor(e=Pe.DEFAULT_DELAY,t=Pe.DEFAULT_MAX_RETRIES,r=Pe.defaultShouldRetry){if(e>Pe.MAX_DELAY&&t>Pe.MAX_MAX_RETRIES){const o=new Error(`Delay and MaxRetries should not be more than ${Pe.MAX_DELAY} and ${Pe.MAX_MAX_RETRIES}`);throw o.name="MaxLimitExceeded",o}else if(e>Pe.MAX_DELAY){const o=new Error(`Delay should not be more than ${Pe.MAX_DELAY}`);throw o.name="MaxLimitExceeded",o}else if(t>Pe.MAX_MAX_RETRIES){const o=new Error(`MaxRetries should not be more than ${Pe.MAX_MAX_RETRIES}`);throw o.name="MaxLimitExceeded",o}else if(e<0&&t<0){const o=new Error("Delay and MaxRetries should not be negative");throw o.name="MinExpectationNotMet",o}else if(e<0){const o=new Error("Delay should not be negative");throw o.name="MinExpectationNotMet",o}else if(t<0){const o=new Error("MaxRetries should not be negative");throw o.name="MinExpectationNotMet",o}this.delay=Math.min(e,Pe.MAX_DELAY),this.maxRetries=Math.min(t,Pe.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return Pe.MAX_DELAY}}Pe.DEFAULT_DELAY=3;Pe.DEFAULT_MAX_RETRIES=3;Pe.MAX_DELAY=180;Pe.MAX_MAX_RETRIES=10;Pe.defaultShouldRetry=()=>!0;class vo{constructor(e=new Pe){this.options=e}isRetry(e){return vo.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,t){const r=typeof e=="string"?t.method:e.method;return!((r===an.PUT||r===an.PATCH||r===an.POST)&&ck(e,t,"Content-Type")==="application/octet-stream")}getDelay(e,t,r){const o=()=>Number(Math.random().toFixed(3)),i=e.headers!==void 0?e.headers.get(vo.RETRY_AFTER_HEADER):null;let s;return i!==null?Number.isNaN(Number(i))?s=Math.round((new Date(i).getTime()-Date.now())/1e3):s=Number(i):s=t>=2?this.getExponentialBackOffTime(t)+r+o():r+o(),Math.min(s,this.options.getMaxDelay()+o())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return ve(this,void 0,void 0,function*(){const t=e*1e3;return new Promise(r=>setTimeout(r,t))})}getOptions(e){let t;return e.middlewareControl instanceof di&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof t>"u"&&(t=Object.assign(new Pe,this.options)),t}executeWithRetry(e,t,r){return ve(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,uk(e.request,e.options,vo.RETRY_ATTEMPT_HEADER,t.toString());const o=this.getDelay(e.response,t,r.delay);return yield this.sleep(o),yield this.executeWithRetry(e,t,r)}else return})}execute(e){return ve(this,void 0,void 0,function*(){const r=this.getOptions(e);return yo.updateFeatureUsageFlag(e,vs.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,r)})}setNext(e){this.nextMiddleware=e}}vo.RETRY_STATUS_CODES=[429,503,504];vo.RETRY_ATTEMPT_HEADER="Retry-Attempt";vo.RETRY_AFTER_HEADER="Retry-After";class Rn{constructor(e=Rn.DEFAULT_MAX_REDIRECTS,t=Rn.defaultShouldRedirect){if(e>Rn.MAX_MAX_REDIRECTS){const r=new Error(`MaxRedirects should not be more than ${Rn.MAX_MAX_REDIRECTS}`);throw r.name="MaxLimitExceeded",r}if(e<0){const r=new Error("MaxRedirects should not be negative");throw r.name="MinExpectationNotMet",r}this.maxRedirects=e,this.shouldRedirect=t}}Rn.DEFAULT_MAX_REDIRECTS=5;Rn.MAX_MAX_REDIRECTS=20;Rn.defaultShouldRedirect=()=>!0;class un{constructor(e=new Rn){this.options=e}isRedirect(e){return un.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(un.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(un.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,t){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,o=r.exec(e);let i,s;o!==null&&(i=o[0]);const a=r.exec(t);return a!==null&&(s=a[0]),typeof i<"u"&&typeof s<"u"&&i!==s}updateRequestUrl(e,t){return ve(this,void 0,void 0,function*(){t.request=typeof t.request=="string"?e:yield K1(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof di&&(t=e.middlewareControl.getMiddlewareOptions(Rn)),typeof t>"u"&&(t=Object.assign(new Rn,this.options)),t}executeWithRedirect(e,t,r){return ve(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);const o=e.response;if(t<r.maxRedirects&&this.isRedirect(o)&&this.hasLocationHeader(o)&&r.shouldRedirect(o)){if(++t,o.status===un.STATUS_CODE_SEE_OTHER)e.options.method=an.GET,delete e.options.body;else{const i=this.getLocationHeader(o);!this.isRelativeURL(i)&&this.shouldDropAuthorizationHeader(o.url,i)&&delete e.options.headers[un.AUTHORIZATION_HEADER],yield this.updateRequestUrl(i,e)}yield this.executeWithRedirect(e,t,r)}else return})}execute(e){return ve(this,void 0,void 0,function*(){const r=this.getOptions(e);return e.options.redirect=un.MANUAL_REDIRECT,yo.updateFeatureUsageFlag(e,vs.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,r)})}setNext(e){this.nextMiddleware=e}}un.REDIRECT_STATUS_CODES=[301,302,303,307,308];un.STATUS_CODE_SEE_OTHER=303;un.LOCATION_HEADER="Location";un.AUTHORIZATION_HEADER="Authorization";un.MANUAL_REDIRECT="manual";const V1="3.0.7";class ln{execute(e){return ve(this,void 0,void 0,function*(){const t=typeof e.request=="string"?e.request:e.request.url;if(sk(t)||e.customHosts&&ak(t,e.customHosts)){let r=ck(e.request,e.options,ln.CLIENT_REQUEST_ID_HEADER);r||(r=z1(),uk(e.request,e.options,ln.CLIENT_REQUEST_ID_HEADER,r));let o=`${ln.PRODUCT_NAME}/${V1}`,i;if(e.middlewareControl instanceof di&&(i=e.middlewareControl.getMiddlewareOptions(yo)),i){const s=i.getFeatureUsage();o+=` (${ln.FEATURE_USAGE_STRING}=${s})`}dk(e.request,e.options,ln.SDK_VERSION_HEADER,o)}else delete e.options.headers[ln.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[ln.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}ln.CLIENT_REQUEST_ID_HEADER="client-request-id";ln.SDK_VERSION_HEADER="SdkVersion";ln.PRODUCT_NAME="graph-js";ln.FEATURE_USAGE_STRING="featureUsage";var bv;(function(n){n[n.MANUAL=0]="MANUAL",n[n.RANDOM=1]="RANDOM"})(bv||(bv={}));var nr;(function(n){n.ARRAYBUFFER="arraybuffer",n.BLOB="blob",n.DOCUMENT="document",n.JSON="json",n.RAW="raw",n.STREAM="stream",n.TEXT="text"})(nr||(nr={}));var $f;(function(n){n.TEXT_HTML="text/html",n.TEXT_XML="text/xml",n.APPLICATION_XML="application/xml",n.APPLICATION_XHTML="application/xhtml+xml"})($f||($f={}));var ou;(function(n){n.TEXT_PLAIN="text/plain",n.APPLICATION_JSON="application/json"})(ou||(ou={}));var iu;(function(n){n.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",n.IMAGE="^image\\/.+"})(iu||(iu={}));class pa{static parseDocumentResponse(e,t){return typeof DOMParser<"u"?new Promise((r,o)=>{e.text().then(i=>{try{const a=new DOMParser().parseFromString(i,t);r(a)}catch(s){o(s)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return ve(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let r;const o=e.headers.get("Content-type");switch(t){case nr.ARRAYBUFFER:r=yield e.arrayBuffer();break;case nr.BLOB:r=yield e.blob();break;case nr.DOCUMENT:r=yield pa.parseDocumentResponse(e,$f.TEXT_XML);break;case nr.JSON:r=yield e.json();break;case nr.STREAM:r=yield Promise.resolve(e.body);break;case nr.TEXT:r=yield e.text();break;default:if(o!==null){const i=o.split(";")[0];new RegExp(iu.DOCUMENT).test(i)?r=yield pa.parseDocumentResponse(e,i):new RegExp(iu.IMAGE).test(i)?r=e.blob():i===ou.TEXT_PLAIN?r=yield e.text():i===ou.APPLICATION_JSON?r=yield e.json():r=Promise.resolve(e.body)}else r=Promise.resolve(e.body);break}return r})}static getResponse(e,t,r){return ve(this,void 0,void 0,function*(){if(t===nr.RAW)return Promise.resolve(e);{const o=yield pa.convertResponse(e,t);if(e.ok)if(typeof r=="function")r(null,o);else return o;else throw o}})}}class W1{constructor(e){this.provider=e}getAccessToken(){return ve(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((r,o)=>ve(this,void 0,void 0,function*(){if(o)e(o);else{if(!r){const s="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";r=new ui(s)}const i=yield ui.setGraphClientError(r);t(i)}}))})})}}class ma extends Error{constructor(e=-1,t,r){super(t||r&&r.message),Object.setPrototypeOf(this,ma.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class su{static constructError(e,t,r){const o=new ma(t,"",e);return e.name!==void 0&&(o.code=e.name),o.body=e.toString(),o.date=new Date,o.headers=r==null?void 0:r.headers,o}static constructErrorFromResponse(e,t,r){const o=e.error,i=new ma(t,o.message);return i.code=o.code,o.innerError!==void 0&&(i.requestId=o.innerError["request-id"],i.date=new Date(o.innerError.date)),i.body=JSON.stringify(o),i.headers=r==null?void 0:r.headers,i}static getError(e=null,t=-1,r,o){return ve(this,void 0,void 0,function*(){let i;if(e&&e.error?i=su.constructErrorFromResponse(e,t,o):e instanceof Error?i=su.constructError(e,t,o):(i=new ma(t),i.body=e),typeof r=="function")r(i,null);else return i})}}class q1{constructor(e,t,r){this.parsePath=o=>{if(o.indexOf("https://")!==-1){o=o.replace("https://","");const s=o.indexOf("/");s!==-1&&(this.urlComponents.host="https://"+o.substring(0,s),o=o.substring(s+1,o.length));const a=o.indexOf("/");a!==-1&&(this.urlComponents.version=o.substring(0,a),o=o.substring(a+1,o.length))}o.charAt(0)==="/"&&(o=o.substr(1));const i=o.indexOf("?");if(i===-1)this.urlComponents.path=o;else{this.urlComponents.path=o.substr(0,i);const s=o.substring(i+1,o.length).split("&");for(const a of s)this.parseQueryParameter(a)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let o=[];r.length>1&&typeof t=="string"?o=Array.prototype.slice.call(r):typeof t=="string"?o.push(t):o=o.concat(t),this.urlComponents.oDataQueryParams[e]+=o.join(",")}buildFullUrl(){const e=F1([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(Object.keys(e.oDataQueryParams).length!==0)for(const r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&t.push(r+"="+e.oDataQueryParams[r]);if(Object.keys(e.otherURLQueryParams).length!==0)for(const r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(e.otherURLQueryOptions.length!==0)for(const r of e.otherURLQueryOptions)t.push(r);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){const t=e.split("&");for(const r of t)this.parseQueryParamenterString(r)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),r=e.substring(0,t),o=e.substring(t+1);this.setURLComponentsQueryParamater(r,o)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(H1.indexOf(e)!==-1){const r=this.urlComponents.oDataQueryParams[e],o=r&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=o?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return!(t===-1||e.indexOf("(")!==-1&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){const r=Object.assign({},this.config.fetchOptions);Object.assign(e,r),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){var o;return ve(this,void 0,void 0,function*(){let i;const s=new di(this._middlewareOptions);this.updateRequestOptions(t);const a=(o=this.config)===null||o===void 0?void 0:o.customHosts;try{return i=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:s,customHosts:a})).response,yield pa.getResponse(i,this._responseType,r)}catch(l){if(l instanceof ui)throw l;let c;throw i&&(c=i.status),yield su.getError(l,c,r,i)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}const e=Object.keys(this._headers);for(const t of e)if(t.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return ve(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:an.GET};return yield this.send(t,r,e)})}post(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:an.POST,body:lh(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?o.headers={}:(this.setHeaderContentType(),o.headers=this._headers),yield this.send(r,o,t)})}create(e,t){return ve(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:an.PUT,body:lh(e)};return yield this.send(r,o,t)})}patch(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const o={method:an.PATCH,body:lh(e)};return yield this.send(r,o,t)})}update(e,t){return ve(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return ve(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:an.DELETE};return yield this.send(t,r,e)})}del(e){return ve(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return ve(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:an.GET};return this.responseType(nr.STREAM),yield this.send(t,r,e)})}putStream(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl(),o={method:an.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(r,o,t)})}}class hk{constructor(...e){if(!e||!e.length){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,r)=>{r<e.length-1&&t.setNext(e[r+1])}),this.middleware=e[0]}sendRequest(e){return ve(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){const t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(e),e})}}const G1=()=>typeof process=="object"&&typeof require=="function";class ng{static createWithAuthenticationProvider(e){const t=new ja(e),r=new vo(new Pe),o=new ln,i=new $1;if(t.setNext(r),G1()){const s=new un(new Rn);r.setNext(s),s.setNext(o)}else r.setNext(o);return o.setNext(i),ng.createWithMiddleware(t)}static createWithMiddleware(...e){return new hk(...e)}}const Q1=()=>{if(typeof Promise>"u"&&typeof fetch>"u"){const n=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw n.name="PolyFillNotAvailable",n}else if(typeof Promise>"u"){const n=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw n.name="PolyFillNotAvailable",n}else if(typeof fetch>"u"){const n=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw n.name="PolyFillNotAvailable",n}return!0};class $a{static init(e){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=r==="authProvider"?new W1(e[r]):e[r]);return $a.initWithMiddleware(t)}static initWithMiddleware(e){return new $a(e)}constructor(e){this.config={baseUrl:L1,debugLogging:!1,defaultVersion:D1},Q1();for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.config[r]=e[r]);let t;if(e.authProvider!==void 0&&e.middleware!==void 0){const r=new Error;throw r.name="AmbiguityInInitialization",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",r}else if(e.authProvider!==void 0)t=ng.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)t=new hk(...[].concat(e.middleware));else{const r=new Error;throw r.name="InvalidMiddlewareChain",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",r}this.httpClient=t}api(e){return new q1(this.httpClient,this.config,e)}}const fk=S.createContext(void 0);function Y1({children:n}){const{instance:e,accounts:t}=tg(),[r,o]=S.useState(()=>{const a=localStorage.getItem("userPhotos");return a?JSON.parse(a):{}}),i=a=>r[a.toLowerCase()],s=async a=>{if(!(!t[0]||r[a.toLowerCase()]))try{const l=await e.acquireTokenSilent({...ru,account:t[0]}),c=$a.init({authProvider:u=>{u(null,l.accessToken)}});try{const u=await c.api(`/users/${a}/photo/$value`).get(),d=await new Promise(h=>{const f=new FileReader;f.onloadend=()=>h(f.result),f.readAsDataURL(u)});o(h=>{const f={...h,[a.toLowerCase()]:d};return localStorage.setItem("userPhotos",JSON.stringify(f)),f})}catch(u){console.error(`No photo found for user ${a}:`,u)}}catch(l){console.error(`Error fetching photo for ${a}:`,l)}};return E.jsx(fk.Provider,{value:{getUserPhoto:i,loadUserPhoto:s},children:n})}const J1=()=>{const n=S.useContext(fk);if(!n)throw new Error("useUserPhotos must be used within a UserPhotosProvider");return n};function X1(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return S.useMemo(()=>r=>{e.forEach(o=>o(r))},e)}const od=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function xs(n){const e=Object.prototype.toString.call(n);return e==="[object Window]"||e==="[object global]"}function rg(n){return"nodeType"in n}function $t(n){var e,t;return n?xs(n)?n:rg(n)&&(e=(t=n.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function og(n){const{Document:e}=$t(n);return n instanceof e}function dl(n){return xs(n)?!1:n instanceof $t(n).HTMLElement}function pk(n){return n instanceof $t(n).SVGElement}function Os(n){return n?xs(n)?n.document:rg(n)?og(n)?n:dl(n)||pk(n)?n.ownerDocument:document:document:document}const Vn=od?S.useLayoutEffect:S.useEffect;function id(n){const e=S.useRef(n);return Vn(()=>{e.current=n}),S.useCallback(function(){for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return e.current==null?void 0:e.current(...r)},[])}function Z1(){const n=S.useRef(null),e=S.useCallback((r,o)=>{n.current=setInterval(r,o)},[]),t=S.useCallback(()=>{n.current!==null&&(clearInterval(n.current),n.current=null)},[]);return[e,t]}function Va(n,e){e===void 0&&(e=[n]);const t=S.useRef(n);return Vn(()=>{t.current!==n&&(t.current=n)},e),t}function hl(n,e){const t=S.useRef();return S.useMemo(()=>{const r=n(t.current);return t.current=r,r},[...e])}function au(n){const e=id(n),t=S.useRef(null),r=S.useCallback(o=>{o!==t.current&&(e==null||e(o,t.current)),t.current=o},[]);return[t,r]}function lu(n){const e=S.useRef();return S.useEffect(()=>{e.current=n},[n]),e.current}let ch={};function fl(n,e){return S.useMemo(()=>{if(e)return e;const t=ch[n]==null?0:ch[n]+1;return ch[n]=t,n+"-"+t},[n,e])}function mk(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),o=1;o<t;o++)r[o-1]=arguments[o];return r.reduce((i,s)=>{const a=Object.entries(s);for(const[l,c]of a){const u=i[l];u!=null&&(i[l]=u+n*c)}return i},{...e})}}const rs=mk(1),cu=mk(-1);function eO(n){return"clientX"in n&&"clientY"in n}function sd(n){if(!n)return!1;const{KeyboardEvent:e}=$t(n.target);return e&&n instanceof e}function tO(n){if(!n)return!1;const{TouchEvent:e}=$t(n.target);return e&&n instanceof e}function uu(n){if(tO(n)){if(n.touches&&n.touches.length){const{clientX:e,clientY:t}=n.touches[0];return{x:e,y:t}}else if(n.changedTouches&&n.changedTouches.length){const{clientX:e,clientY:t}=n.changedTouches[0];return{x:e,y:t}}}return eO(n)?{x:n.clientX,y:n.clientY}:null}const Lr=Object.freeze({Translate:{toString(n){if(!n)return;const{x:e,y:t}=n;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(n){if(!n)return;const{scaleX:e,scaleY:t}=n;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(n){if(n)return[Lr.Translate.toString(n),Lr.Scale.toString(n)].join(" ")}},Transition:{toString(n){let{property:e,duration:t,easing:r}=n;return e+" "+t+"ms "+r}}}),Rv="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function nO(n){return n.matches(Rv)?n:n.querySelector(Rv)}const rO={display:"none"};function oO(n){let{id:e,value:t}=n;return ie.createElement("div",{id:e,style:rO},t)}function iO(n){let{id:e,announcement:t,ariaLiveType:r="assertive"}=n;const o={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return ie.createElement("div",{id:e,style:o,role:"status","aria-live":r,"aria-atomic":!0},t)}function sO(){const[n,e]=S.useState("");return{announce:S.useCallback(r=>{r!=null&&e(r)},[]),announcement:n}}const gk=S.createContext(null);function aO(n){const e=S.useContext(gk);S.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(n)},[n,e])}function lO(){const[n]=S.useState(()=>new Set),e=S.useCallback(r=>(n.add(r),()=>n.delete(r)),[n]);return[S.useCallback(r=>{let{type:o,event:i}=r;n.forEach(s=>{var a;return(a=s[o])==null?void 0:a.call(s,i)})},[n]),e]}const cO={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},uO={onDragStart(n){let{active:e}=n;return"Picked up draggable item "+e.id+"."},onDragOver(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(n){let{active:e}=n;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function dO(n){let{announcements:e=uO,container:t,hiddenTextDescribedById:r,screenReaderInstructions:o=cO}=n;const{announce:i,announcement:s}=sO(),a=fl("DndLiveRegion"),[l,c]=S.useState(!1);if(S.useEffect(()=>{c(!0)},[]),aO(S.useMemo(()=>({onDragStart(d){let{active:h}=d;i(e.onDragStart({active:h}))},onDragMove(d){let{active:h,over:f}=d;e.onDragMove&&i(e.onDragMove({active:h,over:f}))},onDragOver(d){let{active:h,over:f}=d;i(e.onDragOver({active:h,over:f}))},onDragEnd(d){let{active:h,over:f}=d;i(e.onDragEnd({active:h,over:f}))},onDragCancel(d){let{active:h,over:f}=d;i(e.onDragCancel({active:h,over:f}))}}),[i,e])),!l)return null;const u=ie.createElement(ie.Fragment,null,ie.createElement(oO,{id:r,value:o.draggable}),ie.createElement(iO,{id:a,announcement:s}));return t?no.createPortal(u,t):u}var et;(function(n){n.DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable"})(et||(et={}));function du(){}function hO(n,e){return S.useMemo(()=>({sensor:n,options:e??{}}),[n,e])}function fO(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return S.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const Wn=Object.freeze({x:0,y:0});function pO(n,e){const t=uu(n);if(!t)return"0 0";const r={x:(t.x-e.left)/e.width*100,y:(t.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function mO(n,e){let{data:{value:t}}=n,{data:{value:r}}=e;return r-t}function gO(n,e){if(!n||n.length===0)return null;const[t]=n;return t[e]}function yO(n,e){const t=Math.max(e.top,n.top),r=Math.max(e.left,n.left),o=Math.min(e.left+e.width,n.left+n.width),i=Math.min(e.top+e.height,n.top+n.height),s=o-r,a=i-t;if(r<o&&t<i){const l=e.width*e.height,c=n.width*n.height,u=s*a,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const vO=n=>{let{collisionRect:e,droppableRects:t,droppableContainers:r}=n;const o=[];for(const i of r){const{id:s}=i,a=t.get(s);if(a){const l=yO(a,e);l>0&&o.push({id:s,data:{droppableContainer:i,value:l}})}}return o.sort(mO)};function CO(n,e,t){return{...n,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function yk(n,e){return n&&e?{x:n.left-e.left,y:n.top-e.top}:Wn}function SO(n){return function(t){for(var r=arguments.length,o=new Array(r>1?r-1:0),i=1;i<r;i++)o[i-1]=arguments[i];return o.reduce((s,a)=>({...s,top:s.top+n*a.y,bottom:s.bottom+n*a.y,left:s.left+n*a.x,right:s.right+n*a.x}),{...t})}}const wO=SO(1);function vk(n){if(n.startsWith("matrix3d(")){const e=n.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(n.startsWith("matrix(")){const e=n.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function TO(n,e,t){const r=vk(e);if(!r)return n;const{scaleX:o,scaleY:i,x:s,y:a}=r,l=n.left-s-(1-o)*parseFloat(t),c=n.top-a-(1-i)*parseFloat(t.slice(t.indexOf(" ")+1)),u=o?n.width/o:n.width,d=i?n.height/i:n.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const EO={ignoreTransform:!1};function Ms(n,e){e===void 0&&(e=EO);let t=n.getBoundingClientRect();if(e.ignoreTransform){const{transform:c,transformOrigin:u}=$t(n).getComputedStyle(n);c&&(t=TO(t,c,u))}const{top:r,left:o,width:i,height:s,bottom:a,right:l}=t;return{top:r,left:o,width:i,height:s,bottom:a,right:l}}function Nv(n){return Ms(n,{ignoreTransform:!0})}function kO(n){const e=n.innerWidth,t=n.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function IO(n,e){return e===void 0&&(e=$t(n).getComputedStyle(n)),e.position==="fixed"}function AO(n,e){e===void 0&&(e=$t(n).getComputedStyle(n));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(o=>{const i=e[o];return typeof i=="string"?t.test(i):!1})}function ig(n,e){const t=[];function r(o){if(e!=null&&t.length>=e||!o)return t;if(og(o)&&o.scrollingElement!=null&&!t.includes(o.scrollingElement))return t.push(o.scrollingElement),t;if(!dl(o)||pk(o)||t.includes(o))return t;const i=$t(n).getComputedStyle(o);return o!==n&&AO(o,i)&&t.push(o),IO(o,i)?t:r(o.parentNode)}return n?r(n):t}function Ck(n){const[e]=ig(n,1);return e??null}function uh(n){return!od||!n?null:xs(n)?n:rg(n)?og(n)||n===Os(n).scrollingElement?window:dl(n)?n:null:null}function Sk(n){return xs(n)?n.scrollX:n.scrollLeft}function wk(n){return xs(n)?n.scrollY:n.scrollTop}function Vf(n){return{x:Sk(n),y:wk(n)}}var at;(function(n){n[n.Forward=1]="Forward",n[n.Backward=-1]="Backward"})(at||(at={}));function Tk(n){return!od||!n?!1:n===document.scrollingElement}function Ek(n){const e={x:0,y:0},t=Tk(n)?{height:window.innerHeight,width:window.innerWidth}:{height:n.clientHeight,width:n.clientWidth},r={x:n.scrollWidth-t.width,y:n.scrollHeight-t.height},o=n.scrollTop<=e.y,i=n.scrollLeft<=e.x,s=n.scrollTop>=r.y,a=n.scrollLeft>=r.x;return{isTop:o,isLeft:i,isBottom:s,isRight:a,maxScroll:r,minScroll:e}}const bO={x:.2,y:.2};function RO(n,e,t,r,o){let{top:i,left:s,right:a,bottom:l}=t;r===void 0&&(r=10),o===void 0&&(o=bO);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=Ek(n),f={x:0,y:0},p={x:0,y:0},m={height:e.height*o.y,width:e.width*o.x};return!c&&i<=e.top+m.height?(f.y=at.Backward,p.y=r*Math.abs((e.top+m.height-i)/m.height)):!u&&l>=e.bottom-m.height&&(f.y=at.Forward,p.y=r*Math.abs((e.bottom-m.height-l)/m.height)),!h&&a>=e.right-m.width?(f.x=at.Forward,p.x=r*Math.abs((e.right-m.width-a)/m.width)):!d&&s<=e.left+m.width&&(f.x=at.Backward,p.x=r*Math.abs((e.left+m.width-s)/m.width)),{direction:f,speed:p}}function NO(n){if(n===document.scrollingElement){const{innerWidth:i,innerHeight:s}=window;return{top:0,left:0,right:i,bottom:s,width:i,height:s}}const{top:e,left:t,right:r,bottom:o}=n.getBoundingClientRect();return{top:e,left:t,right:r,bottom:o,width:n.clientWidth,height:n.clientHeight}}function kk(n){return n.reduce((e,t)=>rs(e,Vf(t)),Wn)}function xO(n){return n.reduce((e,t)=>e+Sk(t),0)}function OO(n){return n.reduce((e,t)=>e+wk(t),0)}function Ik(n,e){if(e===void 0&&(e=Ms),!n)return;const{top:t,left:r,bottom:o,right:i}=e(n);Ck(n)&&(o<=0||i<=0||t>=window.innerHeight||r>=window.innerWidth)&&n.scrollIntoView({block:"center",inline:"center"})}const MO=[["x",["left","right"],xO],["y",["top","bottom"],OO]];class sg{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=ig(t),o=kk(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[i,s,a]of MO)for(const l of s)Object.defineProperty(this,l,{get:()=>{const c=a(r),u=o[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ga{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...t)})},this.target=e}add(e,t,r){var o;(o=this.target)==null||o.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function _O(n){const{EventTarget:e}=$t(n);return n instanceof e?n:Os(n)}function dh(n,e){const t=Math.abs(n.x),r=Math.abs(n.y);return typeof e=="number"?Math.sqrt(t**2+r**2)>e:"x"in e&&"y"in e?t>e.x&&r>e.y:"x"in e?t>e.x:"y"in e?r>e.y:!1}var Tn;(function(n){n.Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange"})(Tn||(Tn={}));function xv(n){n.preventDefault()}function PO(n){n.stopPropagation()}var he;(function(n){n.Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab"})(he||(he={}));const Ak={start:[he.Space,he.Enter],cancel:[he.Esc],end:[he.Space,he.Enter,he.Tab]},DO=(n,e)=>{let{currentCoordinates:t}=e;switch(n.code){case he.Right:return{...t,x:t.x+25};case he.Left:return{...t,x:t.x-25};case he.Down:return{...t,y:t.y+25};case he.Up:return{...t,y:t.y-25}}};class bk{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new ga(Os(t)),this.windowListeners=new ga($t(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Tn.Resize,this.handleCancel),this.windowListeners.add(Tn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Tn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&Ik(r),t(Wn)}handleKeyDown(e){if(sd(e)){const{active:t,context:r,options:o}=this.props,{keyboardCodes:i=Ak,coordinateGetter:s=DO,scrollBehavior:a="smooth"}=o,{code:l}=e;if(i.end.includes(l)){this.handleEnd(e);return}if(i.cancel.includes(l)){this.handleCancel(e);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Wn;this.referenceCoordinates||(this.referenceCoordinates=u);const d=s(e,{active:t,context:r.current,currentCoordinates:u});if(d){const h=cu(d,u),f={x:0,y:0},{scrollableAncestors:p}=r.current;for(const m of p){const v=e.code,{isTop:g,isRight:y,isLeft:C,isBottom:w,maxScroll:I,minScroll:A}=Ek(m),R=NO(m),k={x:Math.min(v===he.Right?R.right-R.width/2:R.right,Math.max(v===he.Right?R.left:R.left+R.width/2,d.x)),y:Math.min(v===he.Down?R.bottom-R.height/2:R.bottom,Math.max(v===he.Down?R.top:R.top+R.height/2,d.y))},M=v===he.Right&&!y||v===he.Left&&!C,O=v===he.Down&&!w||v===he.Up&&!g;if(M&&k.x!==d.x){const q=m.scrollLeft+h.x,de=v===he.Right&&q<=I.x||v===he.Left&&q>=A.x;if(de&&!h.y){m.scrollTo({left:q,behavior:a});return}de?f.x=m.scrollLeft-q:f.x=v===he.Right?m.scrollLeft-I.x:m.scrollLeft-A.x,f.x&&m.scrollBy({left:-f.x,behavior:a});break}else if(O&&k.y!==d.y){const q=m.scrollTop+h.y,de=v===he.Down&&q<=I.y||v===he.Up&&q>=A.y;if(de&&!h.x){m.scrollTo({top:q,behavior:a});return}de?f.y=m.scrollTop-q:f.y=v===he.Down?m.scrollTop-I.y:m.scrollTop-A.y,f.y&&m.scrollBy({top:-f.y,behavior:a});break}}this.handleMove(e,rs(cu(d,this.referenceCoordinates),f))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}bk.activators=[{eventName:"onKeyDown",handler:(n,e,t)=>{let{keyboardCodes:r=Ak,onActivation:o}=e,{active:i}=t;const{code:s}=n.nativeEvent;if(r.start.includes(s)){const a=i.activatorNode.current;return a&&n.target!==a?!1:(n.preventDefault(),o==null||o({event:n.nativeEvent}),!0)}return!1}}];function Ov(n){return!!(n&&"distance"in n)}function Mv(n){return!!(n&&"delay"in n)}class ag{constructor(e,t,r){var o;r===void 0&&(r=_O(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:i}=e,{target:s}=i;this.props=e,this.events=t,this.document=Os(s),this.documentListeners=new ga(this.document),this.listeners=new ga(r),this.windowListeners=new ga($t(s)),this.initialCoordinates=(o=uu(i))!=null?o:Wn,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Tn.Resize,this.handleCancel),this.windowListeners.add(Tn.DragStart,xv),this.windowListeners.add(Tn.VisibilityChange,this.handleCancel),this.windowListeners.add(Tn.ContextMenu,xv),this.documentListeners.add(Tn.Keydown,this.handleKeydown),t){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(Mv(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(Ov(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:o}=this.props;o(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Tn.Click,PO,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Tn.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:o,props:i}=this,{onMove:s,options:{activationConstraint:a}}=i;if(!o)return;const l=(t=uu(e))!=null?t:Wn,c=cu(o,l);if(!r&&a){if(Ov(a)){if(a.tolerance!=null&&dh(c,a.tolerance))return this.handleCancel();if(dh(c,a.distance))return this.handleStart()}if(Mv(a)&&dh(c,a.tolerance))return this.handleCancel();this.handlePending(a,c);return}e.cancelable&&e.preventDefault(),s(l)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===he.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const LO={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class lg extends ag{constructor(e){const{event:t}=e,r=Os(t.target);super(e,LO,r)}}lg.activators=[{eventName:"onPointerDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return!t.isPrimary||t.button!==0?!1:(r==null||r({event:t}),!0)}}];const UO={move:{name:"mousemove"},end:{name:"mouseup"}};var Wf;(function(n){n[n.RightClick=2]="RightClick"})(Wf||(Wf={}));class HO extends ag{constructor(e){super(e,UO,Os(e.event.target))}}HO.activators=[{eventName:"onMouseDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return t.button===Wf.RightClick?!1:(r==null||r({event:t}),!0)}}];const hh={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class FO extends ag{constructor(e){super(e,hh)}static setup(){return window.addEventListener(hh.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(hh.move.name,e)};function e(){}}}FO.activators=[{eventName:"onTouchStart",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;const{touches:o}=t;return o.length>1?!1:(r==null||r({event:t}),!0)}}];var ya;(function(n){n[n.Pointer=0]="Pointer",n[n.DraggableRect=1]="DraggableRect"})(ya||(ya={}));var hu;(function(n){n[n.TreeOrder=0]="TreeOrder",n[n.ReversedTreeOrder=1]="ReversedTreeOrder"})(hu||(hu={}));function BO(n){let{acceleration:e,activator:t=ya.Pointer,canScroll:r,draggingRect:o,enabled:i,interval:s=5,order:a=hu.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=n;const f=KO({delta:d,disabled:!i}),[p,m]=Z1(),v=S.useRef({x:0,y:0}),g=S.useRef({x:0,y:0}),y=S.useMemo(()=>{switch(t){case ya.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case ya.DraggableRect:return o}},[t,o,l]),C=S.useRef(null),w=S.useCallback(()=>{const A=C.current;if(!A)return;const R=v.current.x*g.current.x,k=v.current.y*g.current.y;A.scrollBy(R,k)},[]),I=S.useMemo(()=>a===hu.TreeOrder?[...c].reverse():c,[a,c]);S.useEffect(()=>{if(!i||!c.length||!y){m();return}for(const A of I){if((r==null?void 0:r(A))===!1)continue;const R=c.indexOf(A),k=u[R];if(!k)continue;const{direction:M,speed:O}=RO(A,k,y,e,h);for(const q of["x","y"])f[q][M[q]]||(O[q]=0,M[q]=0);if(O.x>0||O.y>0){m(),C.current=A,p(w,s),v.current=O,g.current=M;return}}v.current={x:0,y:0},g.current={x:0,y:0},m()},[e,w,r,m,i,s,JSON.stringify(y),JSON.stringify(f),p,c,I,u,JSON.stringify(h)])}const zO={x:{[at.Backward]:!1,[at.Forward]:!1},y:{[at.Backward]:!1,[at.Forward]:!1}};function KO(n){let{delta:e,disabled:t}=n;const r=lu(e);return hl(o=>{if(t||!r||!o)return zO;const i={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[at.Backward]:o.x[at.Backward]||i.x===-1,[at.Forward]:o.x[at.Forward]||i.x===1},y:{[at.Backward]:o.y[at.Backward]||i.y===-1,[at.Forward]:o.y[at.Forward]||i.y===1}}},[t,e,r])}function jO(n,e){const t=e!=null?n.get(e):void 0,r=t?t.node.current:null;return hl(o=>{var i;return e==null?null:(i=r??o)!=null?i:null},[r,e])}function $O(n,e){return S.useMemo(()=>n.reduce((t,r)=>{const{sensor:o}=r,i=o.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,r)}));return[...t,...i]},[]),[n,e])}var Wa;(function(n){n[n.Always=0]="Always",n[n.BeforeDragging=1]="BeforeDragging",n[n.WhileDragging=2]="WhileDragging"})(Wa||(Wa={}));var qf;(function(n){n.Optimized="optimized"})(qf||(qf={}));const _v=new Map;function VO(n,e){let{dragging:t,dependencies:r,config:o}=e;const[i,s]=S.useState(null),{frequency:a,measure:l,strategy:c}=o,u=S.useRef(n),d=v(),h=Va(d),f=S.useCallback(function(g){g===void 0&&(g=[]),!h.current&&s(y=>y===null?g:y.concat(g.filter(C=>!y.includes(C))))},[h]),p=S.useRef(null),m=hl(g=>{if(d&&!t)return _v;if(!g||g===_v||u.current!==n||i!=null){const y=new Map;for(let C of n){if(!C)continue;if(i&&i.length>0&&!i.includes(C.id)&&C.rect.current){y.set(C.id,C.rect.current);continue}const w=C.node.current,I=w?new sg(l(w),w):null;C.rect.current=I,I&&y.set(C.id,I)}return y}return g},[n,i,t,d,l]);return S.useEffect(()=>{u.current=n},[n]),S.useEffect(()=>{d||f()},[t,d]),S.useEffect(()=>{i&&i.length>0&&s(null)},[JSON.stringify(i)]),S.useEffect(()=>{d||typeof a!="number"||p.current!==null||(p.current=setTimeout(()=>{f(),p.current=null},a))},[a,d,f,...r]),{droppableRects:m,measureDroppableContainers:f,measuringScheduled:i!=null};function v(){switch(c){case Wa.Always:return!1;case Wa.BeforeDragging:return t;default:return!t}}}function cg(n,e){return hl(t=>n?t||(typeof e=="function"?e(n):n):null,[e,n])}function WO(n,e){return cg(n,e)}function qO(n){let{callback:e,disabled:t}=n;const r=id(e),o=S.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,t]);return S.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function ad(n){let{callback:e,disabled:t}=n;const r=id(e),o=S.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[t]);return S.useEffect(()=>()=>o==null?void 0:o.disconnect(),[o]),o}function GO(n){return new sg(Ms(n),n)}function Pv(n,e,t){e===void 0&&(e=GO);const[r,o]=S.useState(null);function i(){o(l=>{if(!n)return null;if(n.isConnected===!1){var c;return(c=l??t)!=null?c:null}const u=e(n);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const s=qO({callback(l){if(n)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(n)){i();break}}}}),a=ad({callback:i});return Vn(()=>{i(),n?(a==null||a.observe(n),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),s==null||s.disconnect())},[n]),r}function QO(n){const e=cg(n);return yk(n,e)}const Dv=[];function YO(n){const e=S.useRef(n),t=hl(r=>n?r&&r!==Dv&&n&&e.current&&n.parentNode===e.current.parentNode?r:ig(n):Dv,[n]);return S.useEffect(()=>{e.current=n},[n]),t}function JO(n){const[e,t]=S.useState(null),r=S.useRef(n),o=S.useCallback(i=>{const s=uh(i.target);s&&t(a=>a?(a.set(s,Vf(s)),new Map(a)):null)},[]);return S.useEffect(()=>{const i=r.current;if(n!==i){s(i);const a=n.map(l=>{const c=uh(l);return c?(c.addEventListener("scroll",o,{passive:!0}),[c,Vf(c)]):null}).filter(l=>l!=null);t(a.length?new Map(a):null),r.current=n}return()=>{s(n),s(i)};function s(a){a.forEach(l=>{const c=uh(l);c==null||c.removeEventListener("scroll",o)})}},[o,n]),S.useMemo(()=>n.length?e?Array.from(e.values()).reduce((i,s)=>rs(i,s),Wn):kk(n):Wn,[n,e])}function Lv(n,e){e===void 0&&(e=[]);const t=S.useRef(null);return S.useEffect(()=>{t.current=null},e),S.useEffect(()=>{const r=n!==Wn;r&&!t.current&&(t.current=n),!r&&t.current&&(t.current=null)},[n]),t.current?cu(n,t.current):Wn}function XO(n){S.useEffect(()=>{if(!od)return;const e=n.map(t=>{let{sensor:r}=t;return r.setup==null?void 0:r.setup()});return()=>{for(const t of e)t==null||t()}},n.map(e=>{let{sensor:t}=e;return t}))}function ZO(n,e){return S.useMemo(()=>n.reduce((t,r)=>{let{eventName:o,handler:i}=r;return t[o]=s=>{i(s,e)},t},{}),[n,e])}function Rk(n){return S.useMemo(()=>n?kO(n):null,[n])}const Uv=[];function eM(n,e){e===void 0&&(e=Ms);const[t]=n,r=Rk(t?$t(t):null),[o,i]=S.useState(Uv);function s(){i(()=>n.length?n.map(l=>Tk(l)?r:new sg(e(l),l)):Uv)}const a=ad({callback:s});return Vn(()=>{a==null||a.disconnect(),s(),n.forEach(l=>a==null?void 0:a.observe(l))},[n]),o}function Nk(n){if(!n)return null;if(n.children.length>1)return n;const e=n.children[0];return dl(e)?e:n}function tM(n){let{measure:e}=n;const[t,r]=S.useState(null),o=S.useCallback(c=>{for(const{target:u}of c)if(dl(u)){r(d=>{const h=e(u);return d?{...d,width:h.width,height:h.height}:h});break}},[e]),i=ad({callback:o}),s=S.useCallback(c=>{const u=Nk(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?e(u):null)},[e,i]),[a,l]=au(s);return S.useMemo(()=>({nodeRef:a,rect:t,setRef:l}),[t,a,l])}const nM=[{sensor:lg,options:{}},{sensor:bk,options:{}}],rM={current:{}},gc={draggable:{measure:Nv},droppable:{measure:Nv,strategy:Wa.WhileDragging,frequency:qf.Optimized},dragOverlay:{measure:Ms}};class va extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return(t=(r=this.get(e))==null?void 0:r.node.current)!=null?t:void 0}}const oM={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new va,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:du},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:gc,measureDroppableContainers:du,windowRect:null,measuringScheduled:!1},xk={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:du,draggableNodes:new Map,over:null,measureDroppableContainers:du},pl=S.createContext(xk),Ok=S.createContext(oM);function iM(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new va}}}function sM(n,e){switch(e.type){case et.DragStart:return{...n,draggable:{...n.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case et.DragMove:return n.draggable.active==null?n:{...n,draggable:{...n.draggable,translate:{x:e.coordinates.x-n.draggable.initialCoordinates.x,y:e.coordinates.y-n.draggable.initialCoordinates.y}}};case et.DragEnd:case et.DragCancel:return{...n,draggable:{...n.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case et.RegisterDroppable:{const{element:t}=e,{id:r}=t,o=new va(n.droppable.containers);return o.set(r,t),{...n,droppable:{...n.droppable,containers:o}}}case et.SetDroppableDisabled:{const{id:t,key:r,disabled:o}=e,i=n.droppable.containers.get(t);if(!i||r!==i.key)return n;const s=new va(n.droppable.containers);return s.set(t,{...i,disabled:o}),{...n,droppable:{...n.droppable,containers:s}}}case et.UnregisterDroppable:{const{id:t,key:r}=e,o=n.droppable.containers.get(t);if(!o||r!==o.key)return n;const i=new va(n.droppable.containers);return i.delete(t),{...n,droppable:{...n.droppable,containers:i}}}default:return n}}function aM(n){let{disabled:e}=n;const{active:t,activatorEvent:r,draggableNodes:o}=S.useContext(pl),i=lu(r),s=lu(t==null?void 0:t.id);return S.useEffect(()=>{if(!e&&!r&&i&&s!=null){if(!sd(i)||document.activeElement===i.target)return;const a=o.get(s);if(!a)return;const{activatorNode:l,node:c}=a;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=nO(u);if(d){d.focus();break}}})}},[r,e,o,s,i]),null}function Mk(n,e){let{transform:t,...r}=e;return n!=null&&n.length?n.reduce((o,i)=>i({transform:o,...r}),t):t}function lM(n){return S.useMemo(()=>({draggable:{...gc.draggable,...n==null?void 0:n.draggable},droppable:{...gc.droppable,...n==null?void 0:n.droppable},dragOverlay:{...gc.dragOverlay,...n==null?void 0:n.dragOverlay}}),[n==null?void 0:n.draggable,n==null?void 0:n.droppable,n==null?void 0:n.dragOverlay])}function cM(n){let{activeNode:e,measure:t,initialRect:r,config:o=!0}=n;const i=S.useRef(!1),{x:s,y:a}=typeof o=="boolean"?{x:o,y:o}:o;Vn(()=>{if(!s&&!a||!e){i.current=!1;return}if(i.current||!r)return;const c=e==null?void 0:e.node.current;if(!c||c.isConnected===!1)return;const u=t(c),d=yk(u,r);if(s||(d.x=0),a||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=Ck(c);h&&h.scrollBy({top:d.y,left:d.x})}},[e,s,a,r,t])}const ld=S.createContext({...Wn,scaleX:1,scaleY:1});var Gr;(function(n){n[n.Uninitialized=0]="Uninitialized",n[n.Initializing=1]="Initializing",n[n.Initialized=2]="Initialized"})(Gr||(Gr={}));const uM=S.memo(function(e){var t,r,o,i;let{id:s,accessibility:a,autoScroll:l=!0,children:c,sensors:u=nM,collisionDetection:d=vO,measuring:h,modifiers:f,...p}=e;const m=S.useReducer(sM,void 0,iM),[v,g]=m,[y,C]=lO(),[w,I]=S.useState(Gr.Uninitialized),A=w===Gr.Initialized,{draggable:{active:R,nodes:k,translate:M},droppable:{containers:O}}=v,q=R!=null?k.get(R):null,de=S.useRef({initial:null,translated:null}),pe=S.useMemo(()=>{var Je;return R!=null?{id:R,data:(Je=q==null?void 0:q.data)!=null?Je:rM,rect:de}:null},[R,q]),Ee=S.useRef(null),[tn,Wt]=S.useState(null),[He,L]=S.useState(null),V=Va(p,Object.values(p)),G=fl("DndDescribedBy",s),le=S.useMemo(()=>O.getEnabled(),[O]),te=lM(h),{droppableRects:_e,measureDroppableContainers:$e,measuringScheduled:ne}=VO(le,{dragging:A,dependencies:[M.x,M.y],config:te.droppable}),j=jO(k,R),J=S.useMemo(()=>He?uu(He):null,[He]),X=Nd(),se=WO(j,te.draggable.measure);cM({activeNode:R!=null?k.get(R):null,config:X.layoutShiftCompensation,initialRect:se,measure:te.draggable.measure});const B=Pv(j,te.draggable.measure,se),Ve=Pv(j?j.parentElement:null),ke=S.useRef({activatorEvent:null,active:null,activeNode:j,collisionRect:null,collisions:null,droppableRects:_e,draggableNodes:k,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),Ne=O.getNodeFor((t=ke.current.over)==null?void 0:t.id),we=tM({measure:te.dragOverlay.measure}),We=(r=we.nodeRef.current)!=null?r:j,fe=A?(o=we.rect)!=null?o:B:null,pt=!!(we.nodeRef.current&&we.rect),Pt=QO(pt?null:B),Ie=Rk(We?$t(We):null),Fe=YO(A?Ne??j:null),rt=eM(Fe),Po=Mk(f,{transform:{x:M.x-Pt.x,y:M.y-Pt.y,scaleX:1,scaleY:1},activatorEvent:He,active:pe,activeNodeRect:B,containerNodeRect:Ve,draggingNodeRect:fe,over:ke.current.over,overlayNodeRect:we.rect,scrollableAncestors:Fe,scrollableAncestorRects:rt,windowRect:Ie}),vl=J?rs(J,M):null,Do=JO(Fe),wi=Lv(Do),Ed=Lv(Do,[B]),Hr=rs(Po,wi),Fr=fe?wO(fe,Po):null,Lo=pe&&Fr?d({active:pe,collisionRect:Fr,droppableRects:_e,droppableContainers:le,pointerCoordinates:vl}):null,Ps=gO(Lo,"id"),[Qn,Cl]=S.useState(null),kd=pt?Po:rs(Po,Ed),Id=CO(kd,(i=Qn==null?void 0:Qn.rect)!=null?i:null,B),Ds=S.useRef(null),Sl=S.useCallback((Je,P)=>{let{sensor:Z,options:Sn}=P;if(Ee.current==null)return;const wn=k.get(Ee.current);if(!wn)return;const nn=Je.nativeEvent,Yn=new Z({active:Ee.current,activeNode:wn,event:nn,options:Sn,context:ke,onAbort(mt){if(!k.get(mt))return;const{onDragAbort:Jn}=V.current,pr={id:mt};Jn==null||Jn(pr),y({type:"onDragAbort",event:pr})},onPending(mt,Br,Jn,pr){if(!k.get(mt))return;const{onDragPending:Us}=V.current,zr={id:mt,constraint:Br,initialCoordinates:Jn,offset:pr};Us==null||Us(zr),y({type:"onDragPending",event:zr})},onStart(mt){const Br=Ee.current;if(Br==null)return;const Jn=k.get(Br);if(!Jn)return;const{onDragStart:pr}=V.current,Ls={activatorEvent:nn,active:{id:Br,data:Jn.data,rect:de}};no.unstable_batchedUpdates(()=>{pr==null||pr(Ls),I(Gr.Initializing),g({type:et.DragStart,initialCoordinates:mt,active:Br}),y({type:"onDragStart",event:Ls}),Wt(Ds.current),L(nn)})},onMove(mt){g({type:et.DragMove,coordinates:mt})},onEnd:Ti(et.DragEnd),onCancel:Ti(et.DragCancel)});Ds.current=Yn;function Ti(mt){return async function(){const{active:Jn,collisions:pr,over:Ls,scrollAdjustedTranslate:Us}=ke.current;let zr=null;if(Jn&&Us){const{cancelDrop:Hs}=V.current;zr={activatorEvent:nn,active:Jn,collisions:pr,delta:Us,over:Ls},mt===et.DragEnd&&typeof Hs=="function"&&await Promise.resolve(Hs(zr))&&(mt=et.DragCancel)}Ee.current=null,no.unstable_batchedUpdates(()=>{g({type:mt}),I(Gr.Uninitialized),Cl(null),Wt(null),L(null),Ds.current=null;const Hs=mt===et.DragEnd?"onDragEnd":"onDragCancel";if(zr){const xd=V.current[Hs];xd==null||xd(zr),y({type:Hs,event:zr})}})}}},[k]),Ad=S.useCallback((Je,P)=>(Z,Sn)=>{const wn=Z.nativeEvent,nn=k.get(Sn);if(Ee.current!==null||!nn||wn.dndKit||wn.defaultPrevented)return;const Yn={active:nn};Je(Z,P.options,Yn)===!0&&(wn.dndKit={capturedBy:P.sensor},Ee.current=Sn,Sl(Z,P))},[k,Sl]),wl=$O(u,Ad);XO(u),Vn(()=>{B&&w===Gr.Initializing&&I(Gr.Initialized)},[B,w]),S.useEffect(()=>{const{onDragMove:Je}=V.current,{active:P,activatorEvent:Z,collisions:Sn,over:wn}=ke.current;if(!P||!Z)return;const nn={active:P,activatorEvent:Z,collisions:Sn,delta:{x:Hr.x,y:Hr.y},over:wn};no.unstable_batchedUpdates(()=>{Je==null||Je(nn),y({type:"onDragMove",event:nn})})},[Hr.x,Hr.y]),S.useEffect(()=>{const{active:Je,activatorEvent:P,collisions:Z,droppableContainers:Sn,scrollAdjustedTranslate:wn}=ke.current;if(!Je||Ee.current==null||!P||!wn)return;const{onDragOver:nn}=V.current,Yn=Sn.get(Ps),Ti=Yn&&Yn.rect.current?{id:Yn.id,rect:Yn.rect.current,data:Yn.data,disabled:Yn.disabled}:null,mt={active:Je,activatorEvent:P,collisions:Z,delta:{x:wn.x,y:wn.y},over:Ti};no.unstable_batchedUpdates(()=>{Cl(Ti),nn==null||nn(mt),y({type:"onDragOver",event:mt})})},[Ps]),Vn(()=>{ke.current={activatorEvent:He,active:pe,activeNode:j,collisionRect:Fr,collisions:Lo,droppableRects:_e,draggableNodes:k,draggingNode:We,draggingNodeRect:fe,droppableContainers:O,over:Qn,scrollableAncestors:Fe,scrollAdjustedTranslate:Hr},de.current={initial:fe,translated:Fr}},[pe,j,Lo,Fr,k,We,fe,_e,O,Qn,Fe,Hr]),BO({...X,delta:M,draggingRect:Fr,pointerCoordinates:vl,scrollableAncestors:Fe,scrollableAncestorRects:rt});const bd=S.useMemo(()=>({active:pe,activeNode:j,activeNodeRect:B,activatorEvent:He,collisions:Lo,containerNodeRect:Ve,dragOverlay:we,draggableNodes:k,droppableContainers:O,droppableRects:_e,over:Qn,measureDroppableContainers:$e,scrollableAncestors:Fe,scrollableAncestorRects:rt,measuringConfiguration:te,measuringScheduled:ne,windowRect:Ie}),[pe,j,B,He,Lo,Ve,we,k,O,_e,Qn,$e,Fe,rt,te,ne,Ie]),Rd=S.useMemo(()=>({activatorEvent:He,activators:wl,active:pe,activeNodeRect:B,ariaDescribedById:{draggable:G},dispatch:g,draggableNodes:k,over:Qn,measureDroppableContainers:$e}),[He,wl,pe,B,g,G,k,Qn,$e]);return ie.createElement(gk.Provider,{value:C},ie.createElement(pl.Provider,{value:Rd},ie.createElement(Ok.Provider,{value:bd},ie.createElement(ld.Provider,{value:Id},c)),ie.createElement(aM,{disabled:(a==null?void 0:a.restoreFocus)===!1})),ie.createElement(dO,{...a,hiddenTextDescribedById:G}));function Nd(){const Je=(tn==null?void 0:tn.autoScrollEnabled)===!1,P=typeof l=="object"?l.enabled===!1:l===!1,Z=A&&!Je&&!P;return typeof l=="object"?{...l,enabled:Z}:{enabled:Z}}}),dM=S.createContext(null),Hv="button",hM="Draggable";function fM(n){let{id:e,data:t,disabled:r=!1,attributes:o}=n;const i=fl(hM),{activators:s,activatorEvent:a,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=S.useContext(pl),{role:f=Hv,roleDescription:p="draggable",tabIndex:m=0}=o??{},v=(l==null?void 0:l.id)===e,g=S.useContext(v?ld:dM),[y,C]=au(),[w,I]=au(),A=ZO(s,e),R=Va(t);Vn(()=>(d.set(e,{id:e,key:i,node:y,activatorNode:w,data:R}),()=>{const M=d.get(e);M&&M.key===i&&d.delete(e)}),[d,e]);const k=S.useMemo(()=>({role:f,tabIndex:m,"aria-disabled":r,"aria-pressed":v&&f===Hv?!0:void 0,"aria-roledescription":p,"aria-describedby":u.draggable}),[r,f,m,v,p,u.draggable]);return{active:l,activatorEvent:a,activeNodeRect:c,attributes:k,isDragging:v,listeners:r?void 0:A,node:y,over:h,setNodeRef:C,setActivatorNodeRef:I,transform:g}}function _k(){return S.useContext(Ok)}const pM="Droppable",mM={timeout:25};function gM(n){let{data:e,disabled:t=!1,id:r,resizeObserverConfig:o}=n;const i=fl(pM),{active:s,dispatch:a,over:l,measureDroppableContainers:c}=S.useContext(pl),u=S.useRef({disabled:t}),d=S.useRef(!1),h=S.useRef(null),f=S.useRef(null),{disabled:p,updateMeasurementsFor:m,timeout:v}={...mM,...o},g=Va(m??r),y=S.useCallback(()=>{if(!d.current){d.current=!0;return}f.current!=null&&clearTimeout(f.current),f.current=setTimeout(()=>{c(Array.isArray(g.current)?g.current:[g.current]),f.current=null},v)},[v]),C=ad({callback:y,disabled:p||!s}),w=S.useCallback((k,M)=>{C&&(M&&(C.unobserve(M),d.current=!1),k&&C.observe(k))},[C]),[I,A]=au(w),R=Va(e);return S.useEffect(()=>{!C||!I.current||(C.disconnect(),d.current=!1,C.observe(I.current))},[I,C]),S.useEffect(()=>(a({type:et.RegisterDroppable,element:{id:r,key:i,disabled:t,node:I,rect:h,data:R}}),()=>a({type:et.UnregisterDroppable,key:i,id:r})),[r]),S.useEffect(()=>{t!==u.current.disabled&&(a({type:et.SetDroppableDisabled,id:r,key:i,disabled:t}),u.current.disabled=t)},[r,i,t,a]),{active:s,rect:h,isOver:(l==null?void 0:l.id)===r,node:I,over:l,setNodeRef:A}}function yM(n){let{animation:e,children:t}=n;const[r,o]=S.useState(null),[i,s]=S.useState(null),a=lu(t);return!t&&!r&&a&&o(a),Vn(()=>{if(!i)return;const l=r==null?void 0:r.key,c=r==null?void 0:r.props.id;if(l==null||c==null){o(null);return}Promise.resolve(e(c,i)).then(()=>{o(null)})},[e,r,i]),ie.createElement(ie.Fragment,null,t,r?S.cloneElement(r,{ref:s}):null)}const vM={x:0,y:0,scaleX:1,scaleY:1};function CM(n){let{children:e}=n;return ie.createElement(pl.Provider,{value:xk},ie.createElement(ld.Provider,{value:vM},e))}const SM={position:"fixed",touchAction:"none"},wM=n=>sd(n)?"transform 250ms ease":void 0,TM=S.forwardRef((n,e)=>{let{as:t,activatorEvent:r,adjustScale:o,children:i,className:s,rect:a,style:l,transform:c,transition:u=wM}=n;if(!a)return null;const d=o?c:{...c,scaleX:1,scaleY:1},h={...SM,width:a.width,height:a.height,top:a.top,left:a.left,transform:Lr.Transform.toString(d),transformOrigin:o&&r?pO(r,a):void 0,transition:typeof u=="function"?u(r):u,...l};return ie.createElement(t,{className:s,style:h,ref:e},i)}),EM=n=>e=>{let{active:t,dragOverlay:r}=e;const o={},{styles:i,className:s}=n;if(i!=null&&i.active)for(const[a,l]of Object.entries(i.active))l!==void 0&&(o[a]=t.node.style.getPropertyValue(a),t.node.style.setProperty(a,l));if(i!=null&&i.dragOverlay)for(const[a,l]of Object.entries(i.dragOverlay))l!==void 0&&r.node.style.setProperty(a,l);return s!=null&&s.active&&t.node.classList.add(s.active),s!=null&&s.dragOverlay&&r.node.classList.add(s.dragOverlay),function(){for(const[l,c]of Object.entries(o))t.node.style.setProperty(l,c);s!=null&&s.active&&t.node.classList.remove(s.active)}},kM=n=>{let{transform:{initial:e,final:t}}=n;return[{transform:Lr.Transform.toString(e)},{transform:Lr.Transform.toString(t)}]},IM={duration:250,easing:"ease",keyframes:kM,sideEffects:EM({styles:{active:{opacity:"0"}}})};function AM(n){let{config:e,draggableNodes:t,droppableContainers:r,measuringConfiguration:o}=n;return id((i,s)=>{if(e===null)return;const a=t.get(i);if(!a)return;const l=a.node.current;if(!l)return;const c=Nk(s);if(!c)return;const{transform:u}=$t(s).getComputedStyle(s),d=vk(u);if(!d)return;const h=typeof e=="function"?e:bM(e);return Ik(l,o.draggable.measure),h({active:{id:i,data:a.data,node:l,rect:o.draggable.measure(l)},draggableNodes:t,dragOverlay:{node:s,rect:o.dragOverlay.measure(c)},droppableContainers:r,measuringConfiguration:o,transform:d})})}function bM(n){const{duration:e,easing:t,sideEffects:r,keyframes:o}={...IM,...n};return i=>{let{active:s,dragOverlay:a,transform:l,...c}=i;if(!e)return;const u={x:a.rect.left-s.rect.left,y:a.rect.top-s.rect.top},d={scaleX:l.scaleX!==1?s.rect.width*l.scaleX/a.rect.width:1,scaleY:l.scaleY!==1?s.rect.height*l.scaleY/a.rect.height:1},h={x:l.x-u.x,y:l.y-u.y,...d},f=o({...c,active:s,dragOverlay:a,transform:{initial:l,final:h}}),[p]=f,m=f[f.length-1];if(JSON.stringify(p)===JSON.stringify(m))return;const v=r==null?void 0:r({active:s,dragOverlay:a,...c}),g=a.node.animate(f,{duration:e,easing:t,fill:"forwards"});return new Promise(y=>{g.onfinish=()=>{v==null||v(),y()}})}}let Fv=0;function RM(n){return S.useMemo(()=>{if(n!=null)return Fv++,Fv},[n])}const NM=ie.memo(n=>{let{adjustScale:e=!1,children:t,dropAnimation:r,style:o,transition:i,modifiers:s,wrapperElement:a="div",className:l,zIndex:c=999}=n;const{activatorEvent:u,active:d,activeNodeRect:h,containerNodeRect:f,draggableNodes:p,droppableContainers:m,dragOverlay:v,over:g,measuringConfiguration:y,scrollableAncestors:C,scrollableAncestorRects:w,windowRect:I}=_k(),A=S.useContext(ld),R=RM(d==null?void 0:d.id),k=Mk(s,{activatorEvent:u,active:d,activeNodeRect:h,containerNodeRect:f,draggingNodeRect:v.rect,over:g,overlayNodeRect:v.rect,scrollableAncestors:C,scrollableAncestorRects:w,transform:A,windowRect:I}),M=cg(h),O=AM({config:r,draggableNodes:p,droppableContainers:m,measuringConfiguration:y}),q=M?v.setRef:void 0;return ie.createElement(CM,null,ie.createElement(yM,{animation:O},d&&R?ie.createElement(TM,{key:R,id:d.id,ref:q,as:a,activatorEvent:u,adjustScale:e,className:l,transition:i,rect:M,style:{zIndex:c,...o},transform:k},t):null))});function Ca(n,e,t){const r=n.slice();return r.splice(t<0?r.length+t:t,0,r.splice(e,1)[0]),r}function xM(n,e){return n.reduce((t,r,o)=>{const i=e.get(r);return i&&(t[o]=i),t},Array(n.length))}function ql(n){return n!==null&&n>=0}function OM(n,e){if(n===e)return!0;if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function MM(n){return typeof n=="boolean"?{draggable:n,droppable:n}:n}const Pk=n=>{let{rects:e,activeIndex:t,overIndex:r,index:o}=n;const i=Ca(e,r,t),s=e[o],a=i[o];return!a||!s?null:{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}},Dk="Sortable",Lk=ie.createContext({activeIndex:-1,containerId:Dk,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Pk,disabled:{draggable:!1,droppable:!1}});function _M(n){let{children:e,id:t,items:r,strategy:o=Pk,disabled:i=!1}=n;const{active:s,dragOverlay:a,droppableRects:l,over:c,measureDroppableContainers:u}=_k(),d=fl(Dk,t),h=a.rect!==null,f=S.useMemo(()=>r.map(A=>typeof A=="object"&&"id"in A?A.id:A),[r]),p=s!=null,m=s?f.indexOf(s.id):-1,v=c?f.indexOf(c.id):-1,g=S.useRef(f),y=!OM(f,g.current),C=v!==-1&&m===-1||y,w=MM(i);Vn(()=>{y&&p&&u(f)},[y,f,p,u]),S.useEffect(()=>{g.current=f},[f]);const I=S.useMemo(()=>({activeIndex:m,containerId:d,disabled:w,disableTransforms:C,items:f,overIndex:v,useDragOverlay:h,sortedRects:xM(f,l),strategy:o}),[m,d,w.draggable,w.droppable,C,f,v,l,h,o]);return ie.createElement(Lk.Provider,{value:I},e)}const PM=n=>{let{id:e,items:t,activeIndex:r,overIndex:o}=n;return Ca(t,r,o).indexOf(e)},DM=n=>{let{containerId:e,isSorting:t,wasDragging:r,index:o,items:i,newIndex:s,previousItems:a,previousContainerId:l,transition:c}=n;return!c||!r||a!==i&&o===s?!1:t?!0:s!==o&&e===l},LM={duration:200,easing:"ease"},Uk="transform",UM=Lr.Transition.toString({property:Uk,duration:0,easing:"linear"}),HM={roleDescription:"sortable"};function FM(n){let{disabled:e,index:t,node:r,rect:o}=n;const[i,s]=S.useState(null),a=S.useRef(t);return Vn(()=>{if(!e&&t!==a.current&&r.current){const l=o.current;if(l){const c=Ms(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&s(u)}}t!==a.current&&(a.current=t)},[e,t,r,o]),S.useEffect(()=>{i&&s(null)},[i]),i}function Hk(n){let{animateLayoutChanges:e=DM,attributes:t,disabled:r,data:o,getNewIndex:i=PM,id:s,strategy:a,resizeObserverConfig:l,transition:c=LM}=n;const{items:u,containerId:d,activeIndex:h,disabled:f,disableTransforms:p,sortedRects:m,overIndex:v,useDragOverlay:g,strategy:y}=S.useContext(Lk),C=BM(r,f),w=u.indexOf(s),I=S.useMemo(()=>({sortable:{containerId:d,index:w,items:u},...o}),[d,o,w,u]),A=S.useMemo(()=>u.slice(u.indexOf(s)),[u,s]),{rect:R,node:k,isOver:M,setNodeRef:O}=gM({id:s,data:I,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:A,...l}}),{active:q,activatorEvent:de,activeNodeRect:pe,attributes:Ee,setNodeRef:tn,listeners:Wt,isDragging:He,over:L,setActivatorNodeRef:V,transform:G}=fM({id:s,data:I,attributes:{...HM,...t},disabled:C.draggable}),le=X1(O,tn),te=!!q,_e=te&&!p&&ql(h)&&ql(v),$e=!g&&He,ne=$e&&_e?G:null,J=_e?ne??(a??y)({rects:m,activeNodeRect:pe,activeIndex:h,overIndex:v,index:w}):null,X=ql(h)&&ql(v)?i({id:s,items:u,activeIndex:h,overIndex:v}):w,se=q==null?void 0:q.id,B=S.useRef({activeId:se,items:u,newIndex:X,containerId:d}),Ve=u!==B.current.items,ke=e({active:q,containerId:d,isDragging:He,isSorting:te,id:s,index:w,items:u,newIndex:B.current.newIndex,previousItems:B.current.items,previousContainerId:B.current.containerId,transition:c,wasDragging:B.current.activeId!=null}),Ne=FM({disabled:!ke,index:w,node:k,rect:R});return S.useEffect(()=>{te&&B.current.newIndex!==X&&(B.current.newIndex=X),d!==B.current.containerId&&(B.current.containerId=d),u!==B.current.items&&(B.current.items=u)},[te,X,d,u]),S.useEffect(()=>{if(se===B.current.activeId)return;if(se&&!B.current.activeId){B.current.activeId=se;return}const We=setTimeout(()=>{B.current.activeId=se},50);return()=>clearTimeout(We)},[se]),{active:q,activeIndex:h,attributes:Ee,data:I,rect:R,index:w,newIndex:X,items:u,isOver:M,isSorting:te,isDragging:He,listeners:Wt,node:k,overIndex:v,over:L,setNodeRef:le,setActivatorNodeRef:V,setDroppableNodeRef:O,setDraggableNodeRef:tn,transform:Ne??J,transition:we()};function we(){if(Ne||Ve&&B.current.newIndex===w)return UM;if(!($e&&!sd(de)||!c)&&(te||ke))return Lr.Transition.toString({...c,property:Uk})}}function BM(n,e){var t,r;return typeof n=="boolean"?{draggable:n,droppable:!1}:{draggable:(t=n==null?void 0:n.draggable)!=null?t:e.draggable,droppable:(r=n==null?void 0:n.droppable)!=null?r:e.droppable}}he.Down,he.Right,he.Up,he.Left;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var zM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Mt=(n,e)=>{const t=S.forwardRef(({color:r="currentColor",size:o=24,strokeWidth:i=2,absoluteStrokeWidth:s,className:a="",children:l,...c},u)=>S.createElement("svg",{ref:u,...zM,width:o,height:o,stroke:r,strokeWidth:s?Number(i)*24/Number(o):i,className:["lucide",`lucide-${KM(n)}`,a].join(" "),...c},[...e.map(([d,h])=>S.createElement(d,h)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jM=Mt("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $M=Mt("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fk=Mt("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bk=Mt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gf=Mt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=Mt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=Mt("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qM=Mt("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=Mt("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=Mt("ListRestart",[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YM=Mt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=Mt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qf=Mt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bv=Mt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=Mt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yf=Mt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),zk="kanban_user_api_key",ZM=n=>{try{if(!n||typeof n!="string")throw new Error("Invalid API key provided");const e=n.trim();if(e.length===0)throw new Error("API key cannot be empty");localStorage.setItem(zk,e),console.log("API key saved successfully")}catch(e){throw console.error("Error saving API key:",e),e}},ug=()=>{try{const n=localStorage.getItem(zk);return n&&n.trim().length>0?n.trim():null}catch(n){return console.error("Error retrieving API key:",n),null}},e_=()=>{const n=ug();return n!==null&&n.length>0},t_=n=>{try{const e=n||ug();if(!e||e.length===0)return null;const t=e.length>20?5:4,r=e.slice(-t),o=Math.min(e.length-t,8);return`${"*".repeat(o)}${r}`}catch(e){return console.error("Error creating masked API key:",e),null}},n_=n=>{try{if(!n||typeof n!="string")return!1;const e=n.trim();return e.length<20?!1:/^[a-zA-Z0-9._-]+$/.test(e)}catch(e){return console.error("Error validating API key format:",e),!1}},zv=()=>{const n=e_(),e=n?t_():null;return{hasKey:n,maskedKey:e,displayText:n?e:"No API key set"}},r_="https://homeapi.quixy.com/api/Report/GetViewResult",o_="eyJhbGciOiJSUzI1NiIsImtpZCI6IkUzMDIwQkIwMTRGQzc0QjZBNEI3QjU5QTFBMTgzOENDIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE3NTE4NzYxOTAsImV4cCI6MTc1NDQ2ODE5MCwiaXNzIjoiaWRzcnYucXVpeHkuY29tIiwiY2xpZW50X2lkIjoiYW5ndWxhcl9zcGEiLCJzdWIiOiJ2YW1zaGlzYWlrcmlzaG5hLmFyZWxsaUBxdWl4eS5jb20iLCJhdXRoX3RpbWUiOjE3NTE4NzYxOTAsImlkcCI6IiIsIlVzZXJOYW1lIjoidmFtc2hpc2Fpa3Jpc2huYS5hcmVsbGlAcXVpeHkuY29tIiwiaHR0cDovL3NjaGVtYXMueG1sc29hcC5vcmcvd3MvMjAwNS8wNS9pZGVudGl0eS9jbGFpbXMvbmFtZSI6InZhbXNoaSBzYWkga3Jpc2huYWFyZWxsaTY5MzIiLCJVc2VySWQiOiIxNzA2MjAyNC0xODE0MTMxNDYtMjQxMTIxZTQtNjY0NC00ODFmLWEwZWEtZGRmOWUzODMyNTc1IiwiTmFtZSI6IlZhbXNoaSBTYWkgS3Jpc2huYSBBcmVsbGkiLCJFbWFpbElkIjoidmFtc2hpc2Fpa3Jpc2huYS5hcmVsbGlAcXVpeHkuY29tIiwiVXNlclR5cGUiOiJVc2VyIiwicm9sZSI6IlVzZXIiLCJPcmdhbml6YXRpb25JZCI6IjI5MTAyMDE5LTA5MzQzNDU0OC1hNGZlNDFiMC0xZmQwLTQ4OWEtYWMwOC1hMjliOTg4ODMxNDMiLCJBY2NlcHRlZFRlcm1zIjoiVHJ1ZSIsIklwQ29uZmlndXJhdGlvbkVuYWJsZWQiOiJGYWxzZSIsImlzU2Fhc0luc3RhbmNlIjoiVHJ1ZSIsImFwaVVybCI6IiIsImFwaUtleSI6IiIsIlNhbmRib3hUeXBlIjoiQWR2YW5jZWQiLCJTdGFnZUFjY2VzcyI6IkxpdmUiLCJBbGxvd2VkSXBzIjoiIiwiRGF0YWJhc2VOYW1lIjoiMjkxMDIwMTktMDkzNDM0NTQ4LWE0ZmU0MWIwLTFmZDAtNDg5YS1hYzA4LWEyOWI5ODg4MzE0MyIsIkRhdGVGb3JtYXQiOiJkZC9NTS95eXl5IiwiU3Vic2NyaXB0aW9uVHlwZSI6IlVzZXIiLCJUaW1lRm9ybWF0IjoiaGg6bW0gYSIsIkRvbWFpbiI6Imh0dHBzOi8vdml2aWRtaW5kcy5xdWl4eS5jb20iLCJBY2NlcHRlZFRlcm1zRGF0ZSI6IjYvMTgvMjAyNCA4OjM4OjI4IEFNIiwiaHR0cDovL3NjaGVtYXMubWljcm9zb2Z0LmNvbS93cy8yMDA4LzA2L2lkZW50aXR5L2NsYWltcy9yb2xlIjoiVXNlciIsIlRpbWVab25lIjoiSW5kaWEgU3RhbmRhcmQgVGltZSIsImp0aSI6IjI2MjlEMzhDNTU3NjFCMDBDNTVEOUUxNDFCNkYyMDFEIiwic2lkIjoiRTlFQTZEQTFGRjhDNEEwQzlGMkJFQjU5RTc3OUYwOTUiLCJpYXQiOjE3NTE4NzYxOTAsInNjb3BlIjpbIm9wZW5pZCIsInByb2ZpbGUiLCJyb2xlcyIsIm9mZmxpbmVfYWNjZXNzIl0sImFtciI6WyJleHRlcm5hbCJdfQ.g9a34AJ0A_lPjxCuADm2s1DXp1zv9q-9Iuo8To5LBqFt_PoMuUlqWI30AtYyIFZIApkXkLO8CQ9XXaErS4sJLb1dE0X8UMrFnnBs29XrnuQZpDhPnU4SMte9yojZjv02QZiRaVnzDyyI8FrGC_MAal_LDEieDO1GkLXUKQljKRcrS69FBQMgjXSRVbKoKiVJuHJWIgfcLcR2IIzYuetb0EugKnUgqLt4iJ-9vn62Ud5hl_-otEASVYSTk4Wj-QZ9VkMQqHlyLxZKI7eDIDNEM45Mr4tYciYjiekwLE0O-n7uckUPNviQ1bQ5AOZfg-KvWcT9whYQCuynQMV-GJN5SQ",dg=()=>{const n=ug();return n?(console.log("Using user-provided API key"),n):(console.log("Using fallback API token"),o_)};let ro=null;const Jf=new rd(ik);async function i_(n="DAP - 26"){let t=0,r=[],o=0,i=!0;const s={orderByFields:"",filters:{searchString:"",columns:"Actions,Sub Tasks,Issue Id,Sprint Name,Issue Type,Summary,Status,Assignee,Project Id,Record Id,Reporter,Estimated Hours,Detection Phase,Status Indicator,Team Member Email Id",groupedColumns:"",rowHeight:null,columnsOrder:"Actions,Sub Tasks,Issue Id,Sprint Name,Issue Type,Summary,Status,Issue Category,Sprint Rank,Reporter,Assignee,Created Date Time,Due Date,Updated On,Dependent Id,Priority,Estimated Hours,Logged Hours,Remaining Hours,Release,Browser,Bug Type,Detection Phase,Fix Branch,Injection Phase,Severity,Required Builds,Checkin Given Branch,Configurations Made,DB scripts,DB scripts exist,Impacted Features Of The Bug,Test Case Id,Project Name,Module,Sub Module,Resource Type,Release DateTime,Created DateTime,Bug Age,Client Name,Reporter Story Points,Assignee Story Points,Task Type,Feature,Sub Feature,Group Name,Bug Scenario,Coding Target Date,Test Cases Target Date,Unit Testing Target Date,Devbox Testing Target Date,System Testing Target Date,Impact Features Sharepoint Link,Issue Reproduced Or Not,Steps To Reproduce,Reason For Not Reproducing,POD,IssueType,Bug Fixed Date,POD Test Owner,POD Dev Owner,BA Owner,DB Type",resizedColumns:[],pageSize:100,filters:[],sorting:[],CustomUserViewFilters:[{Order:0,ColumnName:"Sprint Name",ElementType:"TextBox",ConditionType:"Equal",Value:n,IsEditable:!0,IsVisible:!1,SecondValue:"",SelectedValues:[n]},{ColumnName:"Issue Type",ElementType:"TextBox",ConditionType:"Is Not Any",Order:1,SecondValue:"",IsVisible:!1,IsEditable:!0,SelectedValues:["Bug","Task"],IsDynamicFilter:!0,IsMappedColumn:!1,SelectedValue:""}]}};try{for(console.log(`Starting to fetch tasks for sprint: ${n}`);i;){console.log(`Fetching page: skip=${t}, take=100`);const a=await fetch(`${r_}?skip=${t}&take=100&viewId=05072022-184836479-5888ab5b-d645-4e86-a937-f2d02d2414c1`,{method:"POST",headers:{Authorization:`Bearer ${dg()}`,"Content-Type":"application/json"},body:JSON.stringify(s)});if(!a.ok)throw new Error(`HTTP error! status: ${a.status}`);const l=await a.json();if(!l.Status)throw new Error("API returned unsuccessful status");t===0&&(o=l.__count,console.log(`Total records available: ${o}`));const c=JSON.parse(l.results);console.log(`Fetched ${c.length} tasks in this batch`),r=[...r,...c],t+=100,i=r.length<o&&c.length===100}if(console.log(`Finished fetching all tasks. Total tasks: ${r.length}`),r.length>0){const a=r[0]["Project Id"];a&&typeof a=="string"?(ro=a,console.log("Extracted Project ID from fetchTasks:",ro)):console.warn("No Project Id found in API response, keeping current Project ID:",ro)}else console.warn("No tasks found in API response, keeping current Project ID:",ro);return r.map((a,l)=>({id:l+1,columnId:a.Status,content:`Issue Id: ${a["Issue Id"]}
Summary: ${a.Summary}
Assignee: ${a.Assignee}
Issue Type: ${a["Issue Type"]}`,rowData:{"Issue Id":a["Issue Id"],Summary:a.Summary,Assignee:a.Assignee,"Issue Type":a["Issue Type"],Status:a.Status,"Record Id":a["Record Id"],"Project Id":a["Project Id"],Reporter:a.Reporter,"Estimated Hours":a["Estimated Hours"],"Detection Phase":a["Detection Phase"],"Status Indicator":a["Status Indicator"],"Sprint Name":a["Sprint Name"],"Team Member Email Id":a["Team Member Email Id"]}}))}catch(a){throw console.error("Error fetching tasks:",a),a}}function s_(){return ro}const a_=()=>{try{const n=Jf.getAllAccounts();if(n.length===0)return console.log("No MSAL accounts found - user not logged in"),!1;const e=n[0];return!e||!e.username?(console.log("No valid active account found"),!1):localStorage.getItem("userData")?(console.log("User is authenticated:",e.username),!0):(console.log("No user data in localStorage - user may not be fully authenticated"),!1)}catch(n){return console.error("Error checking authentication status:",n),!1}},l_=()=>{try{const n=localStorage.getItem("userData");if(n){const t=JSON.parse(n),o=Jf.getAllAccounts()[0];return{fullName:t.displayName||(o==null?void 0:o.name)||"",username:(o==null?void 0:o.username)||"",email:(o==null?void 0:o.username)||""}}const e=Jf.getAllAccounts();if(e.length>0){const t=e[0];return{fullName:t.name||"",username:t.username||"",email:t.username||""}}return{fullName:"",username:"",email:""}}catch(n){return console.error("Error getting user information:",n),{fullName:"",username:"",email:""}}};async function c_(n,e){console.log("Checking authentication status for updateTaskStatus...");const t=a_();if(console.log("Authentication check result:",t),!t)throw new Error("AUTHENTICATION_REQUIRED");const r="https://homeapi.quixy.com/api/App/SaveAppData?appName=Change%20Issue%20Status&users=&startDate=null&dueDate=null",o=n.rowData||{},i=new Date().toISOString(),s=o["Project Id"]||s_(),a=l_();if(!a.email||!a.fullName)throw alert("Unable to retrieve user information. Please try logging in again."),new Error("User information not available. Please re-authenticate.");const l={"var Project Id":s,"var Issue Record Id":o["Record Id"]||"","var Issue Id":o["Issue Id"]||"","Issue Id":null,Status:"","Project Id":s,"var Issue Type":o["Issue Type"]||"","Issue Type":o["Issue Type"]||"","var Current Assignee":o.Assignee||"","var Issue Current Status":o.Status||"","var Summary":o.Summary||"","Current Status":o.Status||"","Estimated Hours":o["Estimated Hours"]||"","Detection Phase":o["Detection Phase"]||"","New Status":e,"Change Remarks":"","Release Datetime":"","Review Closed Task By":"",Configurations:"",Scripts:"","Environment level":"","Specific details":"","Select Branch":"","Select Required Components":"","Any DB Scripts Exists":"","Issue Remarks":"","Mention the DB script":"","Any configuration changes made":"","Specify the configuration change":"","Configurations added":"","DB Scripts":"","Migration scripts":"","Configurations Files":"","DB Files":"","Migration files":"","Dev Remarks":"","Specify Impact Feature Related To Bug":"","Var Sub Task Id":"","status Indicator Project Id":s,"status Indicator Issue Type":o["Issue Type"]||"","status Indicator Status":o.Status||"","Status Indicator":o["Status Indicator"]||"In Progress","Updated Date Time":i,"Issue Id for watch":null,"Logged In User Name":a.fullName,"Watch List Details":[],"Assignee Story Points":null,"Status Changed User":o["Team Member Email Id"]||a.email,"Sprint Name":o["Sprint Name"]||"","Story points Issue Id":o["Issue Id"]||"","Get Assignee Story Points":"","Story Sub Task Id":null,"Sub task Story Points":"","Get ready for QA Issue id":null,"Get ready for QA Issue id Grid":"",_AppId:"01022021-064254831-3920198f-f15c-4ea9-b8f3-22913911c281",_AppName:"Change Issue Status",_CurrentStepNumber:1,_WorkSpaceId:"03012021-192624661-c4d2d235-e371-4983-973f-c82b074f9b21",_OrganizationId:"29102019-093434548-a4fe41b0-1fd0-489a-ac08-a29b98883143",_NextGroupName:"Done",_IsCompleted:!0,_ExternalApiIds:"",_InternalApiIds:"",_DataFunctionIds:"",_UserFunctionIds:"",_UserId:"17062024-181413146-241121e4-6644-481f-a0ea-ddf9e3832575",_Username:a.username,_FullName:a.fullName,_UpdatedUserId:"",_UpdatedUsername:"",_UpdatedEmailId:"",_UserEmailId:a.email,_NextStepUsers:"",_UpdatedLocation:"",_WorkFlowAction:"Start - Submit"};try{console.log("Making status update API request to:",r),console.log("Update payload:",JSON.stringify(l,null,2));const c=await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${dg()}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(console.log("Update response status:",c.status),console.log("Update response ok:",c.ok),!c.ok){const d=await c.text();throw console.error("Update response error text:",d),new Error(`HTTP error! status: ${c.status}, message: ${d}`)}const u=await c.json();return console.log("Update API response:",u),{Status:u.Status||!0,results:u.results,message:u.message}}catch(c){throw console.error("Error updating task status:",c),c}}async function u_(n,e,t){const r="https://homeapi.quixy.com/api/DataTable/GetDataTableDataByReference";let o;ro?(o=ro,console.log("Using stored Project ID from last fetchTasks call:",ro)):(o="70",console.warn('No Project ID available, using fallback value "70". Make sure fetchTasks has been called at least once.')),console.log("Using Project ID for status check:",o);const i={DataTableFunctionId:"01022021-064148735-3f601026-cf68-4b03-abd5-ca71c5215f97",DataTableId:"03012021-220616917-65360d6b-ab63-4cf6-9977-2d6c91e005d8",ReferencedElements:"",DataTableDataReferenceDataDTOs:[{IsFocused:!1,ReferenceName:"Project Id",Value:o,SelectedValue:""},{IsFocused:!1,ReferenceName:"Issue Type",Value:n,SelectedValue:""},{IsFocused:!1,ReferenceName:"Current Status",Value:e,SelectedValue:""},{IsFocused:!0,ReferenceName:"Next Status",Value:"",SelectedValue:""}]};try{console.log("Making API request to:",r),console.log("Request payload:",JSON.stringify(i,null,2));const s=await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${dg()}`,"Content-Type":"application/json"},body:JSON.stringify(i)});if(console.log("Response status:",s.status),console.log("Response ok:",s.ok),!s.ok){const l=await s.text();throw console.error("Response error text:",l),new Error(`HTTP error! status: ${s.status}, message: ${l}`)}const a=await s.json();if(console.log("Full API response:",a),console.log("API response type:",Array.isArray(a)?"Array":"Object"),Array.isArray(a)){console.log("Response is an array, treating as direct data");const l={Status:!0,results:JSON.stringify(a),__count:a.length};return console.log("Formatted response:",l),l}if(console.log("API response Status field:",a.Status),console.log("API response results field:",a.results),!a.Status)throw console.error("API returned unsuccessful status. Full response:",a),new Error("API returned unsuccessful status");return a}catch(s){throw console.error("Error checking task status:",s),s}}function d_(n){switch(n==null?void 0:n.toLowerCase()){case"feature":return"bg-blue-500";case"improvement":return"bg-green-500";case"bug":return"bg-red-500";case"task":return"bg-violet-500";default:return"bg-gray-500"}}function h_(n){switch(n){case 1:return"text-yellow-500 fill-yellow-500";case 2:return"text-rose-500 fill-rose-500";default:return"text-gray-400"}}function f_(n){const e=n.split(`
`),t={};return e.forEach(r=>{const[o,i]=r.split(": ");if(o&&i)switch(o.trim()){case"Issue Id":t.issueId=i.trim();break;case"Summary":t.summary=i.trim();break;case"Issue Type":t.issueType=i.trim();break;case"Assignee":t.assignee=i.trim();break}}),t}function Kk({task:n,onStatusCheckResult:e,isHighlighted:t,isSuccess:r,isUpdating:o}){const[i,s]=S.useState(!1),[a,l]=S.useState(!1),{getUserPhoto:c,loadUserPhoto:u}=J1(),d=f_(n.content),[h,f]=S.useState(()=>JSON.parse(localStorage.getItem("taskBookmarks")||"{}")[d.issueId||""]||0),{setNodeRef:p,attributes:m,listeners:v,transform:g,transition:y,isDragging:C}=Hk({id:n.id,data:{type:"Task",task:n}});S.useEffect(()=>{d.assignee&&u(d.assignee)},[d.assignee,u]);const w={transition:y,transform:Lr.Transform.toString(g)},I=async()=>{const M=`${d.issueId}: ${d.summary}`;try{await navigator.clipboard.writeText(M),s(!0),setTimeout(()=>s(!1),2e3)}catch(O){console.error("Failed to copy text: ",O)}},A=()=>{const M=(h+1)%3;f(M);const O=JSON.parse(localStorage.getItem("taskBookmarks")||"{}");d.issueId&&(M===0?delete O[d.issueId]:O[d.issueId]=M,localStorage.setItem("taskBookmarks",JSON.stringify(O)))},R=async()=>{if(!d.issueType||!n.columnId){console.error("Missing required data for status check:",{issueType:d.issueType,currentStatus:n.columnId});return}l(!0);try{const M=await u_(d.issueType,n.columnId);if(console.log("Status check response:",M),M.results)try{console.log("Raw API response.results:",M.results);const O=JSON.parse(M.results);console.log("Parsed API results:",O);const q=[];Array.isArray(O)&&O.forEach(de=>{console.log("Processing item:",de),de.AppData&&typeof de.AppData=="string"&&(q.push(de.AppData),console.log("Added target status:",de.AppData))}),console.log("Final extracted target statuses:",q),console.log("onStatusCheckResult callback exists:",!!e),console.log("Task ID:",n.id),e&&q.length>0?(console.log("Calling onStatusCheckResult with:",n.id,q),e(n.id,q)):console.log("Not calling callback - onStatusCheckResult:",!!e,"targetStatuses.length:",q.length)}catch(O){console.error("Failed to parse API response:",O)}else console.log("No response.results found")}catch(M){console.error("Failed to check task status:",M)}finally{l(!1)}};if(C)return E.jsx("div",{ref:p,style:w,className:"relative cursor-grab rounded-xl border-2 border-rose-500 bg-[#0c1015] opacity-30"});const k=d.assignee?c(d.assignee):void 0;return E.jsxs("div",{ref:p,style:w,...m,...v,className:`relative ${C?"cursor-grabbing":"cursor-grab"} rounded-xl bg-[#0c1015] overflow-hidden w-[300px] ${o?"ring-2 ring-inset ring-blue-500 opacity-75":t?"ring-2 ring-inset ring-blue-500":r?"ring-2 ring-inset ring-green-500":"hover:ring-2 hover:ring-inset hover:ring-rose-500"}`,children:[E.jsxs("div",{className:"p-3 border-b border-gray-700",children:[E.jsxs("div",{className:"flex justify-between items-center mb-2",children:[E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:"text-gray-400 text-xs font-mono",children:d.issueId}),o&&E.jsx(Qf,{className:"h-3 w-3 text-blue-500 animate-spin"})]}),E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("span",{className:`text-xs px-2 py-1 rounded-full text-white ${d_(d.issueType)}`,children:d.issueType}),E.jsx("button",{onClick:A,className:"hover:scale-110 transition-transform duration-200",children:E.jsx(Fk,{size:16,className:`${h_(h)} transition-colors duration-200`})})]})]}),E.jsx("h3",{className:"text-white font-medium text-sm",children:d.summary})]}),E.jsxs("div",{className:"p-3 flex items-center justify-between",children:[E.jsxs("div",{className:"flex items-center",children:[k?E.jsx("img",{src:k,alt:d.assignee,className:"w-5 h-5 rounded-full mr-2 object-cover"}):E.jsx(Gf,{size:20,className:"text-gray-400 mr-2"}),E.jsx("span",{className:"text-gray-400 text-xs",children:d.assignee})]}),E.jsxs("div",{className:"flex items-center gap-1",children:[E.jsx("button",{onClick:M=>{M.stopPropagation(),R()},disabled:a,className:"rounded p-1 hover:bg-[#181b21] transition-colors duration-200 disabled:opacity-50",title:"Check Next Status",children:a?E.jsx(Qf,{className:"h-4 w-4 text-gray-400 animate-spin"}):E.jsx(jM,{className:"h-4 w-4 text-gray-400 hover:text-white"})}),E.jsx("button",{onClick:I,className:"rounded p-1 hover:bg-[#181b21] transition-colors duration-200",title:"Copy Issue ID and Summary",children:i?E.jsx(Bk,{className:"h-4 w-4 text-green-500"}):E.jsx(VM,{className:"h-4 w-4 text-gray-400 hover:text-white"})})]})]})]})}function p_({column:n,tasks:e,onStatusCheckResult:t,highlightedTaskId:r,successTaskId:o,updatingTaskId:i}){n.isHighlighted&&console.log(`Column ${n.id} is highlighted:`,n.isHighlighted);const{setNodeRef:s,attributes:a,listeners:l,transform:c,transition:u,isDragging:d}=Hk({id:n.id,data:{type:"Column",column:n}}),h={transition:u,transform:Lr.Transform.toString(c)};return E.jsxs("div",{ref:s,style:h,className:`h-full rounded-lg flex flex-col ${n.isHighlighted?"border-2 border-blue-500 bg-blue-900/20":"bg-[#181b21]"}`,children:[E.jsx("div",{className:"p-4 border-b border-[#2D3139] bg-[#1C1F26] rounded-t-lg",children:E.jsx("div",{className:"flex items-center justify-between",children:E.jsxs("div",{className:"flex items-center gap-2",children:[E.jsx("h2",{className:"font-bold text-white text-sm",children:n.title}),E.jsx("span",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-[#0c1015] px-2 text-xs text-white border border-[#2D3139]",children:e.length})]})})}),E.jsx(_M,{items:e.map(f=>f.id),children:E.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 column-scroll",children:e.map(f=>E.jsx(Kk,{task:f,onStatusCheckResult:t,isHighlighted:r===f.id,isSuccess:o===f.id,isUpdating:i===f.id},f.id))})})]})}const Xf=["Reopened","Hold","New","Requirement Gathering","Design","Design Review","Design Completed","Ready for TC Preparation","Test Case Preparation","Test Case Review","Test Case Completed","Technical Document Review","In Progress","Coding","Unit Testing","White Box Testing","Coding Review","Devbox Testing","Ready for QA","System Testing","Closed","Release","Other Status"];function Gl(n){const e=Xf.indexOf(n);return e===-1?Xf.length-1:e}function m_(){const{instance:n,accounts:e}=tg(),[t,r]=S.useState(()=>{const s=localStorage.getItem("userData");return s?JSON.parse(s):{}}),o=()=>{n.loginPopup(ru).catch(s=>{console.error("Login failed:",s)})},i=()=>{localStorage.removeItem("userData"),r({}),n.logoutPopup().catch(s=>{console.error("Logout failed:",s)})};return S.useEffect(()=>{(async()=>{if(e[0])try{const a=await n.acquireTokenSilent({...ru,account:e[0]}),c=await $a.init({authProvider:u=>{u(null,a.accessToken)}}).api("/me").get();try{const u=await fetch("https://graph.microsoft.com/v1.0/me/photo/$value",{headers:{Authorization:`Bearer ${a.accessToken}`}});if(u.ok){const d=await u.blob(),h=await new Promise(p=>{const m=new FileReader;m.onloadend=()=>p(m.result),m.readAsDataURL(d)}),f={displayName:c.displayName,photo:h};r(f),localStorage.setItem("userData",JSON.stringify(f))}else throw new Error("Failed to fetch photo")}catch(u){console.error("Error fetching photo:",u);const d={displayName:c.displayName};r(d),localStorage.setItem("userData",JSON.stringify(d))}}catch(a){console.error("Error fetching user data:",a)}})()},[e,n]),e.length>0?E.jsxs("div",{className:"relative group",children:[t.photo?E.jsx("img",{src:t.photo,alt:t.displayName,className:"w-8 h-8 rounded-full cursor-pointer object-cover",onClick:i}):E.jsx(Gf,{size:32,className:"text-white cursor-pointer",onClick:i}),E.jsxs("div",{className:"absolute right-0 mt-2 w-48 py-2 bg-[#181b21] rounded-lg shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[E.jsx("div",{className:"px-4 py-2 text-sm text-white",children:t.displayName}),E.jsx("button",{onClick:i,className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-[#2D3139]",children:"Sign out"})]})]}):E.jsxs("button",{onClick:o,className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-[#181b21] text-white hover:bg-[#1C1F26] transition-colors duration-200",children:[E.jsx(Gf,{size:20}),"Sign in"]})}function vt(n){this.content=n}vt.prototype={constructor:vt,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,o=r.find(n),i=r.content.slice();return o==-1?i.push(t||n,e):(i[o+1]=e,t&&(i[o]=t)),new vt(i)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new vt(t)},addToStart:function(n,e){return new vt([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new vt(t)},addBefore:function(n,e,t){var r=this.remove(e),o=r.content.slice(),i=r.find(n);return o.splice(i==-1?o.length:i,0,e,t),new vt(o)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=vt.from(n),n.size?new vt(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=vt.from(n),n.size?new vt(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=vt.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};vt.from=function(n){if(n instanceof vt)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new vt(e)};function jk(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let o=n.child(r),i=e.child(r);if(o==i){t+=o.nodeSize;continue}if(!o.sameMarkup(i))return t;if(o.isText&&o.text!=i.text){for(let s=0;o.text[s]==i.text[s];s++)t++;return t}if(o.content.size||i.content.size){let s=jk(o.content,i.content,t+1);if(s!=null)return s}t+=o.nodeSize}}function $k(n,e,t,r){for(let o=n.childCount,i=e.childCount;;){if(o==0||i==0)return o==i?null:{a:t,b:r};let s=n.child(--o),a=e.child(--i),l=s.nodeSize;if(s==a){t-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let c=$k(s.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class N{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,o=0,i){for(let s=0,a=0;a<t;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,o+a,i||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,o+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,o){let i="",s=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?o?typeof o=="function"?o(a):o:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:i+=r),i+=c},0),i}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,o=this.content.slice(),i=0;for(t.isText&&t.sameMarkup(r)&&(o[o.length-1]=t.withText(t.text+r.text),i=1);i<e.content.length;i++)o.push(e.content[i]);return new N(o,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],o=0;if(t>e)for(let i=0,s=0;s<t;i++){let a=this.content[i],l=s+a.nodeSize;l>e&&((s<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),o+=a.nodeSize),s=l}return new N(r,o)}cutByIndex(e,t){return e==t?N.empty:e==0&&t==this.content.length?this:new N(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let o=this.content.slice(),i=this.size+t.nodeSize-r.nodeSize;return o[e]=t,new N(o,i)}addToStart(e){return new N([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new N(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let o=this.content[t];e(o,r,t),r+=o.nodeSize}}findDiffStart(e,t=0){return jk(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return $k(this,e,t,r)}findIndex(e,t=-1){if(e==0)return Ql(0,e);if(e==this.size)return Ql(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,o=0;;r++){let i=this.child(r),s=o+i.nodeSize;if(s>=e)return s==e||t>0?Ql(r+1,s):Ql(r,o);o=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return N.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new N(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return N.empty;let t,r=0;for(let o=0;o<e.length;o++){let i=e[o];r+=i.nodeSize,o&&i.isText&&e[o-1].sameMarkup(i)?(t||(t=e.slice(0,o)),t[t.length-1]=i.withText(t[t.length-1].text+i.text)):t&&t.push(i)}return new N(t||e,r)}static from(e){if(!e)return N.empty;if(e instanceof N)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new N([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}N.empty=new N([],0);const fh={index:0,offset:0};function Ql(n,e){return fh.index=n,fh.offset=e,fh}function fu(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!fu(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!fu(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Se=class Zf{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let o=0;o<e.length;o++){let i=e[o];if(this.eq(i))return e;if(this.type.excludes(i.type))t||(t=e.slice(0,o));else{if(i.type.excludes(this.type))return e;!r&&i.type.rank>this.type.rank&&(t||(t=e.slice(0,o)),t.push(this),r=!0),t&&t.push(i)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&fu(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let o=r.create(t.attrs);return r.checkAttrs(o.attrs),o}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Zf.none;if(e instanceof Zf)return[e];let t=e.slice();return t.sort((r,o)=>r.type.rank-o.type.rank),t}};Se.none=[];class pu extends Error{}class U{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Wk(this.content,e+this.openStart,t);return r&&new U(r,this.openStart,this.openEnd)}removeBetween(e,t){return new U(Vk(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return U.empty;let r=t.openStart||0,o=t.openEnd||0;if(typeof r!="number"||typeof o!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new U(N.fromJSON(e,t.content),r,o)}static maxOpen(e,t=!0){let r=0,o=0;for(let i=e.firstChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.firstChild)r++;for(let i=e.lastChild;i&&!i.isLeaf&&(t||!i.type.spec.isolating);i=i.lastChild)o++;return new U(e,r,o)}}U.empty=new U(N.empty,0,0);function Vk(n,e,t){let{index:r,offset:o}=n.findIndex(e),i=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(o==e||i.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,i.copy(Vk(i.content,e-o-1,t-o-1)))}function Wk(n,e,t,r){let{index:o,offset:i}=n.findIndex(e),s=n.maybeChild(o);if(i==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=Wk(s.content,e-i-1,t);return a&&n.replaceChild(o,s.copy(a))}function g_(n,e,t){if(t.openStart>n.depth)throw new pu("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new pu("Inconsistent open depths");return qk(n,e,t,0)}function qk(n,e,t,r){let o=n.index(r),i=n.node(r);if(o==e.index(r)&&r<n.depth-t.openStart){let s=qk(n,e,t,r+1);return i.copy(i.content.replaceChild(o,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return Jo(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=y_(t,n);return Jo(i,Qk(n,s,a,e,r))}else return Jo(i,mu(n,e,r))}function Gk(n,e){if(!e.type.compatibleContent(n.type))throw new pu("Cannot join "+e.type.name+" onto "+n.type.name)}function ep(n,e,t){let r=n.node(t);return Gk(r,e.node(t)),r}function Yo(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function Sa(n,e,t,r){let o=(e||n).node(t),i=0,s=e?e.index(t):o.childCount;n&&(i=n.index(t),n.depth>t?i++:n.textOffset&&(Yo(n.nodeAfter,r),i++));for(let a=i;a<s;a++)Yo(o.child(a),r);e&&e.depth==t&&e.textOffset&&Yo(e.nodeBefore,r)}function Jo(n,e){return n.type.checkContent(e),n.copy(e)}function Qk(n,e,t,r,o){let i=n.depth>o&&ep(n,e,o+1),s=r.depth>o&&ep(t,r,o+1),a=[];return Sa(null,n,o,a),i&&s&&e.index(o)==t.index(o)?(Gk(i,s),Yo(Jo(i,Qk(n,e,t,r,o+1)),a)):(i&&Yo(Jo(i,mu(n,e,o+1)),a),Sa(e,t,o,a),s&&Yo(Jo(s,mu(t,r,o+1)),a)),Sa(r,null,o,a),new N(a)}function mu(n,e,t){let r=[];if(Sa(null,n,t,r),n.depth>t){let o=ep(n,e,t+1);Yo(Jo(o,mu(n,e,t+1)),r)}return Sa(e,null,t,r),new N(r)}function y_(n,e){let t=e.depth-n.openStart,o=e.node(t).copy(n.content);for(let i=t-1;i>=0;i--)o=e.node(i).copy(N.from(o));return{start:o.resolveNoCache(n.openStart+t),end:o.resolveNoCache(o.content.size-n.openEnd-t)}}class qa{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],o=e.child(t);return r?e.child(t).cut(r):o}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],o=t==0?0:this.path[t*3-1]+1;for(let i=0;i<e;i++)o+=r.child(i).nodeSize;return o}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Se.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),o=e.maybeChild(t);if(!r){let a=r;r=o,o=a}let i=r.marks;for(var s=0;s<i.length;s++)i[s].type.spec.inclusive===!1&&(!o||!i[s].isInSet(o.marks))&&(i=i[s--].removeFromSet(i));return i}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,o=e.parent.maybeChild(e.index());for(var i=0;i<r.length;i++)r[i].type.spec.inclusive===!1&&(!o||!r[i].isInSet(o.marks))&&(r=r[i--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new gu(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],o=0,i=t;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(i),c=i-l;if(r.push(s,a,o+l),!c||(s=s.child(a),s.isText))break;i=c-1,o+=l+1}return new qa(t,r,i)}static resolveCached(e,t){let r=Kv.get(e);if(r)for(let i=0;i<r.elts.length;i++){let s=r.elts[i];if(s.pos==t)return s}else Kv.set(e,r=new v_);let o=r.elts[r.i]=qa.resolve(e,t);return r.i=(r.i+1)%C_,o}}class v_{constructor(){this.elts=[],this.i=0}}const C_=12,Kv=new WeakMap;class gu{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const S_=Object.create(null);let Co=class tp{constructor(e,t,r,o=Se.none){this.type=e,this.attrs=t,this.marks=o,this.content=r||N.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,o=0){this.content.nodesBetween(e,t,r,o,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,o){return this.content.textBetween(e,t,r,o)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&fu(this.attrs,t||e.defaultAttrs||S_)&&Se.sameSet(this.marks,r||Se.none)}copy(e=null){return e==this.content?this:new tp(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new tp(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return U.empty;let o=this.resolve(e),i=this.resolve(t),s=r?0:o.sharedDepth(t),a=o.start(s),c=o.node(s).content.cut(o.pos-a,i.pos-a);return new U(c,o.depth-s,i.depth-s)}replace(e,t,r){return g_(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:o}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(o==e||t.isText)return t;e-=o+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let o=this.content.child(t-1);return{node:o,index:t-1,offset:r-o.nodeSize}}resolve(e){return qa.resolveCached(this,e)}resolveNoCache(e){return qa.resolve(this,e)}rangeHasMark(e,t,r){let o=!1;return t>e&&this.nodesBetween(e,t,i=>(r.isInSet(i.marks)&&(o=!0),!o)),o}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),Yk(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=N.empty,o=0,i=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,o,i),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=o;l<i;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,o){if(o&&!this.type.allowsMarks(o))return!1;let i=this.contentMatchAt(e).matchType(r),s=i&&i.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Se.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Se.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let o=N.fromJSON(e,t.content),i=e.nodeType(t.type).create(t.attrs,o,r);return i.type.checkAttrs(i.attrs),i}};Co.prototype.text=void 0;class yu extends Co{constructor(e,t,r,o){if(super(e,t,null,o),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):Yk(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new yu(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new yu(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function Yk(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class hi{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new w_(e,t);if(r.next==null)return hi.empty;let o=Jk(r);r.next&&r.err("Unexpected trailing text");let i=R_(b_(o));return N_(i,r),i}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let o=this;for(let i=t;o&&i<r;i++)o=o.matchType(e.child(i).type);return o}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let o=[this];function i(s,a){let l=s.matchFragment(e,r);if(l&&(!t||l.validEnd))return N.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&o.indexOf(d)==-1){o.push(d);let h=i(d,a.concat(u));if(h)return h}}return null}return i(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let o=r.shift(),i=o.match;if(i.matchType(e)){let s=[];for(let a=o;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<i.next.length;s++){let{type:a,next:l}=i.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!o.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:o}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let o=0;o<r.next.length;o++)e.indexOf(r.next[o].next)==-1&&t(r.next[o].next)}return t(this),e.map((r,o)=>{let i=o+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)i+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return i}).join(`
`)}}hi.empty=new hi(!0);class w_{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Jk(n){let e=[];do e.push(T_(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function T_(n){let e=[];do e.push(E_(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function E_(n){let e=A_(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=k_(n,e);else break;return e}function jv(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function k_(n,e){let t=jv(n),r=t;return n.eat(",")&&(n.next!="}"?r=jv(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function I_(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let o=[];for(let i in t){let s=t[i];s.isInGroup(e)&&o.push(s)}return o.length==0&&n.err("No node type or group '"+e+"' found"),o}function A_(n){if(n.eat("(")){let e=Jk(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=I_(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function b_(n){let e=[[]];return o(i(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function o(s,a){s.forEach(l=>l.to=a)}function i(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(i(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=i(s.exprs[l],a);if(l==s.exprs.length-1)return c;o(c,a=t())}else if(s.type=="star"){let l=t();return r(a,l),o(i(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=t();return o(i(s.expr,a),l),o(i(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(i(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=t();o(i(s.expr,l),u),l=u}if(s.max==-1)o(i(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=t();r(l,u),o(i(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Xk(n,e){return e-n}function $v(n,e){let t=[];return r(e),t.sort(Xk);function r(o){let i=n[o];if(i.length==1&&!i[0].term)return r(i[0].to);t.push(o);for(let s=0;s<i.length;s++){let{term:a,to:l}=i[s];!a&&t.indexOf(l)==-1&&r(l)}}}function R_(n){let e=Object.create(null);return t($v(n,0));function t(r){let o=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<o.length;u++)o[u][0]==a&&(c=o[u][1]);$v(n,l).forEach(u=>{c||o.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let i=e[r.join(",")]=new hi(r.indexOf(n.length-1)>-1);for(let s=0;s<o.length;s++){let a=o[s][1].sort(Xk);i.next.push({type:o[s][0],next:e[a.join(",")]||t(a)})}return i}}function N_(n,e){for(let t=0,r=[n];t<r.length;t++){let o=r[t],i=!o.validEnd,s=[];for(let a=0;a<o.next.length;a++){let{type:l,next:c}=o.next[a];s.push(l.name),i&&!(l.isText||l.hasRequiredAttrs())&&(i=!1),r.indexOf(c)==-1&&r.push(c)}i&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Zk(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function eI(n,e){let t=Object.create(null);for(let r in n){let o=e&&e[r];if(o===void 0){let i=n[r];if(i.hasDefault)o=i.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=o}return t}function tI(n,e,t,r){for(let o in e)if(!(o in n))throw new RangeError(`Unsupported attribute ${o} for ${t} of type ${o}`);for(let o in n){let i=n[o];i.validate&&i.validate(e[o])}}function nI(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new O_(n,r,e[r]);return t}let Vv=class rI{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=nI(e,r.attrs),this.defaultAttrs=Zk(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==hi.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:eI(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new Co(this,this.computeAttrs(e),N.from(t),Se.setFrom(r))}createChecked(e=null,t,r){return t=N.from(t),this.checkContent(t),new Co(this,this.computeAttrs(e),t,Se.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=N.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let o=this.contentMatch.matchFragment(t),i=o&&o.fillBefore(N.empty,!0);return i?new Co(this,e,t.append(i),Se.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){tI(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Se.none:e}static compile(e,t){let r=Object.create(null);e.forEach((i,s)=>r[i]=new rI(i,t,s));let o=t.spec.topNode||"doc";if(!r[o])throw new RangeError("Schema is missing its top node type ('"+o+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let i in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function x_(n,e,t){let r=t.split("|");return o=>{let i=o===null?"null":typeof o;if(r.indexOf(i)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${i}`)}}class O_{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?x_(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class cd{constructor(e,t,r,o){this.name=e,this.rank=t,this.schema=r,this.spec=o,this.attrs=nI(e,o.attrs),this.excluded=null;let i=Zk(this.attrs);this.instance=i?new Se(this,i):null}create(e=null){return!e&&this.instance?this.instance:new Se(this,eI(this.attrs,e))}static compile(e,t){let r=Object.create(null),o=0;return e.forEach((i,s)=>r[i]=new cd(i,o++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){tI(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class oI{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let o in e)t[o]=e[o];t.nodes=vt.from(e.nodes),t.marks=vt.from(e.marks||{}),this.nodes=Vv.compile(this.spec.nodes,this),this.marks=cd.compile(this.spec.marks,this);let r=Object.create(null);for(let o in this.nodes){if(o in this.marks)throw new RangeError(o+" can not be both a node and a mark");let i=this.nodes[o],s=i.spec.content||"",a=i.spec.marks;if(i.contentMatch=r[s]||(r[s]=hi.parse(s,this.nodes)),i.inlineContent=i.contentMatch.inlineContent,i.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!i.isInline||!i.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=i}i.markSet=a=="_"?null:a?Wv(this,a.split(" ")):a==""||!i.inlineContent?[]:null}for(let o in this.marks){let i=this.marks[o],s=i.spec.excludes;i.excluded=s==null?[i]:s==""?[]:Wv(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,o){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof Vv){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,o)}text(e,t){let r=this.nodes.text;return new yu(r,r.defaultAttrs,e,Se.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return Co.fromJSON(this,e)}markFromJSON(e){return Se.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Wv(n,e){let t=[];for(let r=0;r<e.length;r++){let o=e[r],i=n.marks[o],s=i;if(i)t.push(i);else for(let a in n.marks){let l=n.marks[a];(o=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(o)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function M_(n){return n.tag!=null}function __(n){return n.style!=null}let wa=class np{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(o=>{if(M_(o))this.tags.push(o);else if(__(o)){let i=/[^=]*/.exec(o.style)[0];r.indexOf(i)<0&&r.push(i),this.styles.push(o)}}),this.normalizeLists=!this.tags.some(o=>{if(!/^(ul|ol)\b/.test(o.tag)||!o.node)return!1;let i=e.nodes[o.node];return i.contentMatch.matchType(i)})}parse(e,t={}){let r=new Gv(this,t,!1);return r.addAll(e,Se.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new Gv(this,t,!0);return r.addAll(e,Se.none,t.from,t.to),U.maxOpen(r.finish())}matchTag(e,t,r){for(let o=r?this.tags.indexOf(r)+1:0;o<this.tags.length;o++){let i=this.tags[o];if(L_(e,i.tag)&&(i.namespace===void 0||e.namespaceURI==i.namespace)&&(!i.context||t.matchesContext(i.context))){if(i.getAttrs){let s=i.getAttrs(e);if(s===!1)continue;i.attrs=s||void 0}return i}}}matchStyle(e,t,r,o){for(let i=o?this.styles.indexOf(o)+1:0;i<this.styles.length;i++){let s=this.styles[i],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let t=[];function r(o){let i=o.priority==null?50:o.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<i)break}t.splice(s,0,o)}for(let o in e.marks){let i=e.marks[o].spec.parseDOM;i&&i.forEach(s=>{r(s=Qv(s)),s.mark||s.ignore||s.clearMark||(s.mark=o)})}for(let o in e.nodes){let i=e.nodes[o].spec.parseDOM;i&&i.forEach(s=>{r(s=Qv(s)),s.node||s.ignore||s.mark||(s.node=o)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new np(e,np.schemaRules(e)))}};const iI={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},P_={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},sI={ol:!0,ul:!0},Ga=1,rp=2,Ta=4;function qv(n,e,t){return e!=null?(e?Ga:0)|(e==="full"?rp:0):n&&n.whitespace=="pre"?Ga|rp:t&~Ta}class Yl{constructor(e,t,r,o,i,s){this.type=e,this.attrs=t,this.marks=r,this.solid=o,this.options=s,this.content=[],this.activeMarks=Se.none,this.match=i||(s&Ta?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(N.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,o;return(o=r.findWrapping(e.type))?(this.match=r,o):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Ga)){let r=this.content[this.content.length-1],o;if(r&&r.isText&&(o=/[ \t\r\n\u000c]+$/.exec(r.text))){let i=r;r.text.length==o[0].length?this.content.pop():this.content[this.content.length-1]=i.withText(i.text.slice(0,i.text.length-o[0].length))}}let t=N.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(N.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!iI.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class Gv{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let o=t.topNode,i,s=qv(null,t.preserveWhitespace,0)|(r?Ta:0);o?i=new Yl(o.type,o.attrs,Se.none,!0,t.topMatch||o.type.contentMatch,s):r?i=new Yl(null,null,Se.none,!0,null,s):i=new Yl(e.schema.topNodeType,null,Se.none,!0,null,s),this.nodes=[i],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,o=this.top,i=o.options&rp?"full":this.localPreserveWS||(o.options&Ga)>0;if(i==="full"||o.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(i)i!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=o.content[o.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t,!/\S/.test(r)),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let o=this.localPreserveWS,i=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;sI.hasOwnProperty(s)&&this.parser.normalizeLists&&D_(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:P_.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(iI.hasOwnProperty(s))i.content.length&&i.content[0].isInline&&this.open&&(this.open--,i=this.top),c=!0,i.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let d=l&&l.skip?t:this.readStyles(e,t);d&&this.addAll(e,d),c&&this.sync(i),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=o}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t,!0)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let o=0;o<this.parser.matchedStyles.length;o++){let i=this.parser.matchedStyles[o],s=r.getPropertyValue(i);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(i,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,o){let i,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r,e.nodeName=="BR")||this.leafFallback(e,r);else{let l=this.enter(s,t.attrs||null,r,t.preserveWhitespace);l&&(i=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(o)this.addElement(e,r,o);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r,!1));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}i&&this.sync(a)&&this.open--}addAll(e,t,r,o){let i=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=o==null?null:e.childNodes[o];s!=a;s=s.nextSibling,++i)this.findAtPoint(e,i),this.addDOM(s,t);this.findAtPoint(e,i)}findPlace(e,t,r){let o,i;for(let s=this.open,a=0;s>=0;s--){let l=this.nodes[s],c=l.findWrapping(e);if(c&&(!o||o.length>c.length+a)&&(o=c,i=l,!c.length))break;if(l.solid){if(r)break;a+=2}}if(!o)return null;this.sync(i);for(let s=0;s<o.length;s++)t=this.enterInner(o[s],null,t,!1);return t}insertNode(e,t,r){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let o=this.findPlace(e,t,r);if(o){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let s=Se.none;for(let a of o.concat(e.marks))(i.type?i.type.allowsMarkType(a.type):Yv(a.type,e.type))&&(s=a.addToSet(s));return i.content.push(e.mark(s)),!0}return!1}enter(e,t,r,o){let i=this.findPlace(e.create(t),r,!1);return i&&(i=this.enterInner(e,t,r,!0,o)),i}enterInner(e,t,r,o=!1,i){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=qv(e,i,s.options);s.options&Ta&&s.content.length==0&&(a|=Ta);let l=Se.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Yv(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new Yl(e,t,l,o,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Ga)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let o=r.length-1;o>=0;o--)e+=r[o].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let o=0;o<this.find.length;o++)this.find[o].pos==null&&e.nodeType==1&&e.contains(this.find[o].node)&&t.compareDocumentPosition(this.find[o].node)&(r?2:4)&&(this.find[o].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,o=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),i=-(r?r.depth+1:0)+(o?0:1),s=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=i;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&o?this.nodes[l].type:r&&l>=i?r.node(l-i).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function D_(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&sI.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function L_(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Qv(n){let e={};for(let t in n)e[t]=n[t];return e}function Yv(n,e){let t=e.schema.nodes;for(let r in t){let o=t[r];if(!o.allowsMarkType(n))continue;let i=[],s=a=>{i.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||i.indexOf(u)<0&&s(u))return!0}};if(s(o.contentMatch))return!0}}class Si{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=ph(t).createDocumentFragment());let o=r,i=[];return e.forEach(s=>{if(i.length||s.marks.length){let a=0,l=0;for(;a<i.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(i[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<i.length;)o=i.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,t);u&&(i.push([c,o]),o.appendChild(u.dom),o=u.contentDOM||u.dom)}}o.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:o}=yc(ph(t),this.nodes[e.type.name](e),null,e.attrs);if(o){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,o)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let o=e.marks.length-1;o>=0;o--){let i=this.serializeMark(e.marks[o],e.isInline,t);i&&((i.contentDOM||i.dom).appendChild(r),r=i.dom)}return r}serializeMark(e,t,r={}){let o=this.marks[e.type.name];return o&&yc(ph(r),o(e,t),null,e.attrs)}static renderSpec(e,t,r=null,o){return yc(e,t,r,o)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new Si(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Jv(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Jv(e.marks)}}function Jv(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function ph(n){return n.document||window.document}const Xv=new WeakMap;function U_(n){let e=Xv.get(n);return e===void 0&&Xv.set(n,e=H_(n)),e}function H_(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let o=0;o<r.length;o++)t(r[o]);else for(let o in r)t(r[o])}return t(n),e}function yc(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let o=e[0],i;if(typeof o!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(i=U_(r))&&i.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=o.indexOf(" ");s>0&&(t=o.slice(0,s),o=o.slice(s+1));let a,l=t?n.createElementNS(t,o):n.createElement(o),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:f,contentDOM:p}=yc(n,h,t,r);if(l.appendChild(f),p){if(a)throw new RangeError("Multiple content holes");a=p}}}return{dom:l,contentDOM:a}}const aI=65535,lI=Math.pow(2,16);function F_(n,e){return n+e*lI}function Zv(n){return n&aI}function B_(n){return(n-(n&aI))/lI}const cI=1,uI=2,vc=4,dI=8;class op{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&dI)>0}get deletedBefore(){return(this.delInfo&(cI|vc))>0}get deletedAfter(){return(this.delInfo&(uI|vc))>0}get deletedAcross(){return(this.delInfo&vc)>0}}class dn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&dn.empty)return dn.empty}recover(e){let t=0,r=Zv(e);if(!this.inverted)for(let o=0;o<r;o++)t+=this.ranges[o*3+2]-this.ranges[o*3+1];return this.ranges[r*3]+t+B_(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let o=0,i=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?o:0);if(l>e)break;let c=this.ranges[a+i],u=this.ranges[a+s],d=l+c;if(e<=d){let h=c?e==l?-1:e==d?1:t:t,f=l+o+(h<0?0:u);if(r)return f;let p=e==(t<0?l:d)?null:F_(a/3,e-l),m=e==l?uI:e==d?cI:vc;return(t<0?e!=l:e!=d)&&(m|=dI),new op(f,m,p)}o+=u-c}return r?e+o:new op(e+o,0,null)}touches(e,t){let r=0,o=Zv(t),i=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+i],u=l+c;if(e<=u&&a==o*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let o=0,i=0;o<this.ranges.length;o+=3){let s=this.ranges[o],a=s-(this.inverted?i:0),l=s+(this.inverted?0:i),c=this.ranges[o+t],u=this.ranges[o+r];e(a,a+c,l,l+u),i+=u-c}}invert(){return new dn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?dn.empty:new dn(e<0?[0,-e,0]:[0,0,e])}}dn.empty=new dn([]);class Qa{constructor(e,t,r=0,o=e?e.length:0){this.mirror=t,this.from=r,this.to=o,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Qa(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let o=e.getMirror(t);this.appendMap(e._maps[t],o!=null&&o<t?r+o:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let o=e.getMirror(t);this.appendMap(e._maps[t].invert(),o!=null&&o>t?r-o-1:void 0)}}invert(){let e=new Qa;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let o=0;for(let i=this.from;i<this.to;i++){let s=this._maps[i],a=s.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(i);if(l!=null&&l>i&&l<this.to){i=l,e=this._maps[l].recover(a.recover);continue}}o|=a.delInfo,e=a.pos}return r?e:new op(e,o,null)}}const mh=Object.create(null);class _t{getMap(){return dn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=mh[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in mh)throw new RangeError("Duplicate use of step JSON ID "+e);return mh[e]=t,t.prototype.jsonID=e,t}}class Ye{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ye(e,null)}static fail(e){return new Ye(null,e)}static fromReplace(e,t,r,o){try{return Ye.ok(e.replace(t,r,o))}catch(i){if(i instanceof pu)return Ye.fail(i.message);throw i}}}function hg(n,e,t){let r=[];for(let o=0;o<n.childCount;o++){let i=n.child(o);i.content.size&&(i=i.copy(hg(i.content,e,i))),i.isInline&&(i=e(i,t,o)),r.push(i)}return N.fromArray(r)}class oo extends _t{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),o=r.node(r.sharedDepth(this.to)),i=new U(hg(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),o),t.openStart,t.openEnd);return Ye.fromReplace(e,this.from,this.to,i)}invert(){return new ar(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new oo(t.pos,r.pos,this.mark)}merge(e){return e instanceof oo&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new oo(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new oo(t.from,t.to,e.markFromJSON(t.mark))}}_t.jsonID("addMark",oo);class ar extends _t{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new U(hg(t.content,o=>o.mark(this.mark.removeFromSet(o.marks)),e),t.openStart,t.openEnd);return Ye.fromReplace(e,this.from,this.to,r)}invert(){return new oo(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ar(t.pos,r.pos,this.mark)}merge(e){return e instanceof ar&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ar(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new ar(t.from,t.to,e.markFromJSON(t.mark))}}_t.jsonID("removeMark",ar);class io extends _t{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ye.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Ye.fromReplace(e,this.pos,this.pos+1,new U(N.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let o=0;o<t.marks.length;o++)if(!t.marks[o].isInSet(r))return new io(this.pos,t.marks[o]);return new io(this.pos,this.mark)}}return new fi(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new io(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new io(t.pos,e.markFromJSON(t.mark))}}_t.jsonID("addNodeMark",io);class fi extends _t{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ye.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Ye.fromReplace(e,this.pos,this.pos+1,new U(N.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new io(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new fi(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new fi(t.pos,e.markFromJSON(t.mark))}}_t.jsonID("removeNodeMark",fi);class ct extends _t{constructor(e,t,r,o=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=o}apply(e){return this.structure&&ip(e,this.from,this.to)?Ye.fail("Structure replace would overwrite content"):Ye.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new dn([this.from,this.to-this.from,this.slice.size])}invert(e){return new ct(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new ct(t.pos,Math.max(t.pos,r.pos),this.slice,this.structure)}merge(e){if(!(e instanceof ct)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?U.empty:new U(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ct(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?U.empty:new U(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ct(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ct(t.from,t.to,U.fromJSON(e,t.slice),!!t.structure)}}_t.jsonID("replace",ct);class dt extends _t{constructor(e,t,r,o,i,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=o,this.slice=i,this.insert=s,this.structure=a}apply(e){if(this.structure&&(ip(e,this.from,this.gapFrom)||ip(e,this.gapTo,this.to)))return Ye.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Ye.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Ye.fromReplace(e,this.from,this.to,r):Ye.fail("Content does not fit in gap")}getMap(){return new dn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new dt(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),o=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),i=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||o<t.pos||i>r.pos?null:new dt(t.pos,r.pos,o,i,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new dt(t.from,t.to,t.gapFrom,t.gapTo,U.fromJSON(e,t.slice),t.insert,!!t.structure)}}_t.jsonID("replaceAround",dt);function ip(n,e,t){let r=n.resolve(e),o=t-e,i=r.depth;for(;o>0&&i>0&&r.indexAfter(i)==r.node(i).childCount;)i--,o--;if(o>0){let s=r.node(i).maybeChild(r.indexAfter(i));for(;o>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,o--}}return!1}function z_(n,e,t,r){let o=[],i=[],s,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),f=Math.min(c+l.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(s&&s.to==h&&s.mark.eq(d[m])?s.to=f:o.push(s=new ar(h,f,d[m])));a&&a.to==h?a.to=f:i.push(a=new oo(h,f,r))}}),o.forEach(l=>n.step(l)),i.forEach(l=>n.step(l))}function K_(n,e,t,r){let o=[],i=0;n.doc.nodesBetween(e,t,(s,a)=>{if(!s.isInline)return;i++;let l=null;if(r instanceof cd){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],h;for(let f=0;f<o.length;f++){let p=o[f];p.step==i-1&&d.eq(o[f].style)&&(h=p)}h?(h.to=c,h.step=i):o.push({style:d,from:Math.max(a,e),to:c,step:i})}}}),o.forEach(s=>n.step(new ar(s.from,s.to,s.style)))}function fg(n,e,t,r=t.contentMatch,o=!0){let i=n.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<i.childCount;l++){let c=i.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)s.push(new ct(a,u,U.empty));else{r=d;for(let h=0;h<c.marks.length;h++)t.allowsMarkType(c.marks[h].type)||n.step(new ar(a,u,c.marks[h]));if(o&&c.isText&&t.whitespace!="pre"){let h,f=/\r?\n|\r/g,p;for(;h=f.exec(c.text);)p||(p=new U(N.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),s.push(new ct(a+h.index,a+h.index+h[0].length,p))}}a=u}if(!r.validEnd){let l=r.fillBefore(N.empty,!0);n.replace(a,a,new U(l,0,0))}for(let l=s.length-1;l>=0;l--)n.step(s[l])}function j_(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function _s(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let o=n.$from.node(r),i=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&o.canReplace(i,s,t))return r;if(r==0||o.type.spec.isolating||!j_(o,i,s))break}return null}function $_(n,e,t){let{$from:r,$to:o,depth:i}=e,s=r.before(i+1),a=o.after(i+1),l=s,c=a,u=N.empty,d=0;for(let p=i,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=N.from(r.node(p).copy(u)),d++):l--;let h=N.empty,f=0;for(let p=i,m=!1;p>t;p--)m||o.after(p+1)<o.end(p)?(m=!0,h=N.from(o.node(p).copy(h)),f++):c++;n.step(new dt(l,c,s,a,new U(u.append(h),d,f),u.size-d,!0))}function pg(n,e,t=null,r=n){let o=V_(n,e),i=o&&W_(r,e);return i?o.map(eC).concat({type:e,attrs:t}).concat(i.map(eC)):null}function eC(n){return{type:n,attrs:null}}function V_(n,e){let{parent:t,startIndex:r,endIndex:o}=n,i=t.contentMatchAt(r).findWrapping(e);if(!i)return null;let s=i.length?i[0]:e;return t.canReplaceWith(r,o,s)?i:null}function W_(n,e){let{parent:t,startIndex:r,endIndex:o}=n,i=t.child(r),s=e.contentMatch.findWrapping(i.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<o;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:s}function q_(n,e,t){let r=N.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let a=t[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=N.from(t[s].type.create(t[s].attrs,r))}let o=e.start,i=e.end;n.step(new dt(o,i,o,i,new U(r,0,0),t.length,!0))}function G_(n,e,t,r,o){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let i=n.steps.length;n.doc.nodesBetween(e,t,(s,a)=>{let l=typeof o=="function"?o(s):o;if(s.isTextblock&&!s.hasMarkup(r,l)&&Q_(n.doc,n.mapping.slice(i).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!p?c=!1:!f&&p&&(c=!0)}c===!1&&fI(n,s,a,i),fg(n,n.mapping.slice(i).map(a,1),r,void 0,c===null);let u=n.mapping.slice(i),d=u.map(a,1),h=u.map(a+s.nodeSize,1);return n.step(new dt(d,h,d+1,h-1,new U(N.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&hI(n,s,a,i),!1}})}function hI(n,e,t,r){e.forEach((o,i)=>{if(o.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(o.text);){let l=n.mapping.slice(r).map(t+1+i+s.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function fI(n,e,t,r){e.forEach((o,i)=>{if(o.type==o.type.schema.linebreakReplacement){let s=n.mapping.slice(r).map(t+1+i);n.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function Q_(n,e,t){let r=n.resolve(e),o=r.index();return r.parent.canReplaceWith(o,o+1,t)}function Y_(n,e,t,r,o){let i=n.doc.nodeAt(e);if(!i)throw new RangeError("No node at given position");t||(t=i.type);let s=t.create(r,null,o||i.marks);if(i.isLeaf)return n.replaceWith(e,e+i.nodeSize,s);if(!t.validContent(i.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new dt(e,e+i.nodeSize,e+1,e+i.nodeSize-1,new U(N.from(s),0,0),1,!0))}function Rr(n,e,t=1,r){let o=n.resolve(e),i=o.depth-t,s=r&&r[r.length-1]||o.parent;if(i<0||o.parent.type.spec.isolating||!o.parent.canReplace(o.index(),o.parent.childCount)||!s.type.validContent(o.parent.content.cutByIndex(o.index(),o.parent.childCount)))return!1;for(let c=o.depth-1,u=t-2;c>i;c--,u--){let d=o.node(c),h=o.index(c);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(h,d.childCount),p=r&&r[u+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!m.type.validContent(f))return!1}let a=o.indexAfter(i),l=r&&r[0];return o.node(i).canReplaceWith(a,a,l?l.type:o.node(i+1).type)}function J_(n,e,t=1,r){let o=n.doc.resolve(e),i=N.empty,s=N.empty;for(let a=o.depth,l=o.depth-t,c=t-1;a>l;a--,c--){i=N.from(o.node(a).copy(i));let u=r&&r[c];s=N.from(u?u.type.create(u.attrs,s):o.node(a).copy(s))}n.step(new ct(e,e,new U(i.append(s),t,t),!0))}function Oo(n,e){let t=n.resolve(e),r=t.index();return pI(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function X_(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let o=0;o<e.childCount;o++){let i=e.child(o),s=i.type==r?n.type.schema.nodes.text:i.type;if(t=t.matchType(s),!t||!n.type.allowsMarks(i.marks))return!1}return t.validEnd}function pI(n,e){return!!(n&&e&&!n.isLeaf&&X_(n,e))}function ud(n,e,t=-1){let r=n.resolve(e);for(let o=r.depth;;o--){let i,s,a=r.index(o);if(o==r.depth?(i=r.nodeBefore,s=r.nodeAfter):t>0?(i=r.node(o+1),a++,s=r.node(o).maybeChild(a)):(i=r.node(o).maybeChild(a-1),s=r.node(o+1)),i&&!i.isTextblock&&pI(i,s)&&r.node(o).canReplace(a,a+1))return e;if(o==0)break;e=t<0?r.before(o):r.after(o)}}function Z_(n,e,t){let r=null,{linebreakReplacement:o}=n.doc.type.schema,i=n.doc.resolve(e-t),s=i.node().type;if(o&&s.inlineContent){let u=s.whitespace=="pre",d=!!s.contentMatch.matchType(o);u&&!d?r=!1:!u&&d&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);fI(n,u.node(),u.before(),a)}s.inlineContent&&fg(n,e+t-1,s,i.node().contentMatchAt(i.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new ct(c,l.map(e+t,-1),U.empty,!0)),r===!0){let u=n.doc.resolve(c);hI(n,u.node(),u.before(),n.steps.length)}return n}function eP(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let o=r.depth-1;o>=0;o--){let i=r.index(o);if(r.node(o).canReplaceWith(i,i,t))return r.before(o+1);if(i>0)return null}if(r.parentOffset==r.parent.content.size)for(let o=r.depth-1;o>=0;o--){let i=r.indexAfter(o);if(r.node(o).canReplaceWith(i,i,t))return r.after(o+1);if(i<r.node(o).childCount)return null}return null}function mI(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let o=t.content;for(let i=0;i<t.openStart;i++)o=o.firstChild.content;for(let i=1;i<=(t.openStart==0&&t.size?2:1);i++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(i==1)u=c.canReplace(l,l,o);else{let d=c.contentMatchAt(l).findWrapping(o.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function dd(n,e,t=e,r=U.empty){if(e==t&&!r.size)return null;let o=n.resolve(e),i=n.resolve(t);return gI(o,i,r)?new ct(e,t,r):new tP(o,i,r).fit()}function gI(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class tP{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=N.empty;for(let o=0;o<=e.depth;o++){let i=e.node(o);this.frontier.push({type:i.type,match:i.contentMatchAt(e.indexAfter(o))})}for(let o=e.depth;o>0;o--)this.placed=N.from(e.node(o).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,o=this.close(e<0?this.$to:r.doc.resolve(e));if(!o)return null;let i=this.placed,s=r.depth,a=o.depth;for(;s&&a&&i.childCount==1;)i=i.firstChild.content,s--,a--;let l=new U(i,s,a);return e>-1?new dt(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new ct(r.pos,o.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,o=this.unplaced.openEnd;r<e;r++){let i=t.firstChild;if(t.childCount>1&&(o=0),i.type.spec.isolating&&o<=r){e=r;break}t=i.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let o,i=null;r?(i=gh(this.unplaced.content,r-1).firstChild,o=i.content):o=this.unplaced.content;let s=o.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(s?c.matchType(s.type)||(d=c.fillBefore(N.from(s),!1)):i&&l.compatibleContent(i.type)))return{sliceDepth:r,frontierDepth:a,parent:i,inject:d};if(t==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:i,wrap:u};if(i&&c.matchType(i.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,o=gh(e,t);return!o.childCount||o.firstChild.isLeaf?!1:(this.unplaced=new U(e,t+1,Math.max(r,o.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,o=gh(e,t);if(o.childCount<=1&&t>0){let i=e.size-t<=t+o.size;this.unplaced=new U(Zs(e,t-1,1),t-1,i?t-1:r)}else this.unplaced=new U(Zs(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:o,wrap:i}){for(;this.depth>t;)this.closeFrontierNode();if(i)for(let m=0;m<i.length;m++)this.openFrontierNode(i[m]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[t];if(o){for(let m=0;m<o.childCount;m++)u.push(o.child(m));d=d.matchFragment(o)}let f=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let m=a.child(c),v=d.matchType(m.type);if(!v)break;c++,(c>1||l==0||m.content.size)&&(d=v,u.push(yI(m.mark(h.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=ea(this.placed,t,N.from(u)),this.frontier[t].match=d,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,v=a;m<f;m++){let g=v.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),v=g.content}this.unplaced=p?e==0?U.empty:new U(Zs(s.content,e-1,1),e-1,f<0?s.openEnd:e-1):new U(Zs(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!yh(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,o=this.$to.after(r);for(;r>1&&o==this.$to.end(--r);)++o;return o}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:o}=this.frontier[t],i=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=yh(e,t,o,r,i);if(s){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=yh(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:i?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=ea(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let o=e.node(r),i=o.type.contentMatch.fillBefore(o.content,!0,e.index(r));this.openFrontierNode(o.type,o.attrs,i)}return e}openFrontierNode(e,t=null,r){let o=this.frontier[this.depth];o.match=o.match.matchType(e),this.placed=ea(this.placed,this.depth,N.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(N.empty,!0);t.childCount&&(this.placed=ea(this.placed,this.frontier.length,t))}}function Zs(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Zs(n.firstChild.content,e-1,t)))}function ea(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(ea(n.lastChild.content,e-1,t)))}function gh(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function yI(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,yI(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(N.empty,!0)))),n.copy(r)}function yh(n,e,t,r,o){let i=n.node(e),s=o?n.indexAfter(e):n.index(e);if(s==i.childCount&&!t.compatibleContent(i.type))return null;let a=r.fillBefore(i.content,!0,s);return a&&!nP(t,i.content,s)?a:null}function nP(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function rP(n){return n.spec.defining||n.spec.definingForContent}function oP(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let o=n.doc.resolve(e),i=n.doc.resolve(t);if(gI(o,i,r))return n.step(new ct(e,t,r));let s=CI(o,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let a=-(o.depth+1);s.unshift(a);for(let h=o.depth,f=o.pos-1;h>0;h--,f--){let p=o.node(h).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;s.indexOf(h)>-1?a=h:o.before(h)==f&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],u=r.openStart;for(let h=r.content,f=0;;f++){let p=h.firstChild;if(c.push(p),f==r.openStart)break;h=p.content}for(let h=u-1;h>=0;h--){let f=c[h],p=rP(f.type);if(p&&!f.sameMarkup(o.node(Math.abs(a)-1)))u=h;else if(p||!f.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let f=(h+u+1)%(r.openStart+1),p=c[f];if(p)for(let m=0;m<s.length;m++){let v=s[(m+l)%s.length],g=!0;v<0&&(g=!1,v=-v);let y=o.node(v-1),C=o.index(v-1);if(y.canReplaceWith(C,C,p.type,p.marks))return n.replace(o.before(v),g?i.after(v):t,new U(vI(r.content,0,r.openStart,f),f,r.openEnd))}}let d=n.steps.length;for(let h=s.length-1;h>=0&&(n.replace(e,t,r),!(n.steps.length>d));h--){let f=s[h];f<0||(e=o.before(f),t=i.after(f))}}function vI(n,e,t,r,o){if(e<t){let i=n.firstChild;n=n.replaceChild(0,i.copy(vI(i.content,e+1,t,r,i)))}if(e>r){let i=o.contentMatchAt(0),s=i.fillBefore(n).append(n);n=s.append(i.matchFragment(s).fillBefore(N.empty,!0))}return n}function iP(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let o=eP(n.doc,e,r.type);o!=null&&(e=t=o)}n.replaceRange(e,t,new U(N.from(r),0,0))}function sP(n,e,t){let r=n.doc.resolve(e),o=n.doc.resolve(t),i=CI(r,o);for(let s=0;s<i.length;s++){let a=i[s],l=s==i.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),o.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),o.indexAfter(a-1))))return n.delete(r.before(a),o.after(a))}for(let s=1;s<=r.depth&&s<=o.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&o.end(s)-t!=o.depth-s&&r.start(s-1)==o.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),o.index(s-1)))return n.delete(r.before(s),t);n.delete(e,t)}function CI(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let o=r;o>=0;o--){let i=n.start(o);if(i<n.pos-(n.depth-o)||e.end(o)>e.pos+(e.depth-o)||n.node(o).type.spec.isolating||e.node(o).type.spec.isolating)break;(i==e.start(o)||o==n.depth&&o==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&o&&e.start(o-1)==i-1)&&t.push(o)}return t}class is extends _t{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ye.fail("No node at attribute step's position");let r=Object.create(null);for(let i in t.attrs)r[i]=t.attrs[i];r[this.attr]=this.value;let o=t.type.create(r,null,t.marks);return Ye.fromReplace(e,this.pos,this.pos+1,new U(N.from(o),0,t.isLeaf?0:1))}getMap(){return dn.empty}invert(e){return new is(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new is(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new is(t.pos,t.attr,t.value)}}_t.jsonID("attr",is);class Ya extends _t{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let o in e.attrs)t[o]=e.attrs[o];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return Ye.ok(r)}getMap(){return dn.empty}invert(e){return new Ya(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ya(t.attr,t.value)}}_t.jsonID("docAttr",Ya);let Cs=class extends Error{};Cs=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};Cs.prototype=Object.create(Error.prototype);Cs.prototype.constructor=Cs;Cs.prototype.name="TransformError";class aP{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Qa}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new Cs(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=U.empty){let o=dd(this.doc,e,t,r);return o&&this.step(o),this}replaceWith(e,t,r){return this.replace(e,t,new U(N.from(r),0,0))}delete(e,t){return this.replace(e,t,U.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return oP(this,e,t,r),this}replaceRangeWith(e,t,r){return iP(this,e,t,r),this}deleteRange(e,t){return sP(this,e,t),this}lift(e,t){return $_(this,e,t),this}join(e,t=1){return Z_(this,e,t),this}wrap(e,t){return q_(this,e,t),this}setBlockType(e,t=e,r,o=null){return G_(this,e,t,r,o),this}setNodeMarkup(e,t,r=null,o){return Y_(this,e,t,r,o),this}setNodeAttribute(e,t,r){return this.step(new is(e,t,r)),this}setDocAttribute(e,t){return this.step(new Ya(e,t)),this}addNodeMark(e,t){return this.step(new io(e,t)),this}removeNodeMark(e,t){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t instanceof Se)t.isInSet(r.marks)&&this.step(new fi(e,t));else{let o=r.marks,i,s=[];for(;i=t.isInSet(o);)s.push(new fi(e,i)),o=i.removeFromSet(o);for(let a=s.length-1;a>=0;a--)this.step(s[a])}return this}split(e,t=1,r){return J_(this,e,t,r),this}addMark(e,t,r){return z_(this,e,t,r),this}removeMark(e,t,r){return K_(this,e,t,r),this}clearIncompatible(e,t,r){return fg(this,e,t,r),this}}const vh=Object.create(null);class ee{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new lP(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=U.empty){let r=t.content.lastChild,o=null;for(let a=0;a<t.openEnd;a++)o=r,r=r.lastChild;let i=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(i);e.replaceRange(u.map(l.pos),u.map(c.pos),a?U.empty:t),a==0&&rC(e,i,(r?r.isInline:o&&o.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,o=this.ranges;for(let i=0;i<o.length;i++){let{$from:s,$to:a}=o[i],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);i?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),rC(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let o=e.parent.inlineContent?new Y(e):xi(e.node(0),e.parent,e.pos,e.index(),t,r);if(o)return o;for(let i=e.depth-1;i>=0;i--){let s=t<0?xi(e.node(0),e.node(i),e.before(i+1),e.index(i),t,r):xi(e.node(0),e.node(i),e.after(i+1),e.index(i)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new gn(e.node(0))}static atStart(e){return xi(e,e,0,0,1)||new gn(e)}static atEnd(e){return xi(e,e,e.content.size,e.childCount,-1)||new gn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=vh[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in vh)throw new RangeError("Duplicate use of selection JSON ID "+e);return vh[e]=t,t.prototype.jsonID=e,t}getBookmark(){return Y.between(this.$anchor,this.$head).getBookmark()}}ee.prototype.visible=!0;class lP{constructor(e,t){this.$from=e,this.$to=t}}let tC=!1;function nC(n){!tC&&!n.parent.inlineContent&&(tC=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class Y extends ee{constructor(e,t=e){nC(e),nC(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return ee.near(r);let o=e.resolve(t.map(this.anchor));return new Y(o.parent.inlineContent?o:r,r)}replace(e,t=U.empty){if(super.replace(e,t),t==U.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof Y&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new hd(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new Y(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let o=e.resolve(t);return new this(o,r==t?o:e.resolve(r))}static between(e,t,r){let o=e.pos-t.pos;if((!r||o)&&(r=o>=0?1:-1),!t.parent.inlineContent){let i=ee.findFrom(t,r,!0)||ee.findFrom(t,-r,!0);if(i)t=i.$head;else return ee.near(t,r)}return e.parent.inlineContent||(o==0?e=t:(e=(ee.findFrom(e,-r,!0)||ee.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=o<0&&(e=t))),new Y(e,t)}}ee.jsonID("text",Y);class hd{constructor(e,t){this.anchor=e,this.head=t}map(e){return new hd(e.map(this.anchor),e.map(this.head))}resolve(e){return Y.between(e.resolve(this.anchor),e.resolve(this.head))}}class W extends ee{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:o}=t.mapResult(this.anchor),i=e.resolve(o);return r?ee.near(i):new W(i)}content(){return new U(N.from(this.node),0,0)}eq(e){return e instanceof W&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new mg(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new W(e.resolve(t.anchor))}static create(e,t){return new W(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}W.prototype.visible=!1;ee.jsonID("node",W);class mg{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new hd(r,r):new mg(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&W.isSelectable(r)?new W(t):ee.near(t)}}class gn extends ee{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=U.empty){if(t==U.empty){e.delete(0,e.doc.content.size);let r=ee.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new gn(e)}map(e){return new gn(e)}eq(e){return e instanceof gn}getBookmark(){return cP}}ee.jsonID("all",gn);const cP={map(){return this},resolve(n){return new gn(n)}};function xi(n,e,t,r,o,i=!1){if(e.inlineContent)return Y.create(n,t);for(let s=r-(o>0?0:1);o>0?s<e.childCount:s>=0;s+=o){let a=e.child(s);if(a.isAtom){if(!i&&W.isSelectable(a))return W.create(n,t-(o<0?a.nodeSize:0))}else{let l=xi(n,a,t+o,o<0?a.childCount:0,o,i);if(l)return l}t+=a.nodeSize*o}return null}function rC(n,e,t){let r=n.steps.length-1;if(r<e)return;let o=n.steps[r];if(!(o instanceof ct||o instanceof dt))return;let i=n.mapping.maps[r],s;i.forEach((a,l,c,u)=>{s==null&&(s=u)}),n.setSelection(ee.near(n.doc.resolve(s),t))}const oC=1,Jl=2,iC=4;class uP extends aP{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|oC)&~Jl,this.storedMarks=null,this}get selectionSet(){return(this.updated&oC)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Jl,this}ensureMarks(e){return Se.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Jl)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Jl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Se.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let o=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(o.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let i=this.storedMarks;if(!i){let s=this.doc.resolve(t);i=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,o.text(e,i)),this.selection.empty||this.setSelection(ee.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=iC,this}get scrolledIntoView(){return(this.updated&iC)>0}}function sC(n,e){return!e||!n?n:n.bind(e)}class ta{constructor(e,t,r){this.name=e,this.init=sC(t.init,r),this.apply=sC(t.apply,r)}}const dP=[new ta("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new ta("selection",{init(n,e){return n.selection||ee.atStart(e.doc)},apply(n){return n.selection}}),new ta("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new ta("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class Ch{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=dP.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new ta(r.key,r.spec.state,r))})}}class qi{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let o=this.config.plugins[r];if(o.spec.filterTransaction&&!o.spec.filterTransaction.call(o,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),o=null;for(;;){let i=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=o?o[s].n:0,c=o?o[s].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!o){o=[];for(let d=0;d<this.config.plugins.length;d++)o.push(d<s?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),i=!0}o&&(o[s]={state:r,n:t.length})}}if(!i)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new qi(this.config),r=this.config.fields;for(let o=0;o<r.length;o++){let i=r[o];t[i.name]=i.apply(e,this[i.name],this,t)}return t}get tr(){return new uP(this)}static create(e){let t=new Ch(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new qi(t);for(let o=0;o<t.fields.length;o++)r[t.fields[o].name]=t.fields[o].init(e,r);return r}reconfigure(e){let t=new Ch(this.schema,e.plugins),r=t.fields,o=new qi(t);for(let i=0;i<r.length;i++){let s=r[i].name;o[s]=this.hasOwnProperty(s)?this[s]:r[i].init(e,o)}return o}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let o=e[r],i=o.spec.state;i&&i.toJSON&&(t[r]=i.toJSON.call(o,this[o.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let o=new Ch(e.schema,e.plugins),i=new qi(o);return o.fields.forEach(s=>{if(s.name=="doc")i.doc=Co.fromJSON(e.schema,t.doc);else if(s.name=="selection")i.selection=ee.fromJSON(i.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(i.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){i[s.name]=c.fromJSON.call(l,e,t[a],i);return}}i[s.name]=s.init(e,i)}}),i}}function SI(n,e,t){for(let r in n){let o=n[r];o instanceof Function?o=o.bind(e):r=="handleDOMEvents"&&(o=SI(o,e,{})),t[r]=o}return t}class Vt{constructor(e){this.spec=e,this.props={},e.props&&SI(e.props,this,this.props),this.key=e.key?e.key.key:wI("plugin")}getState(e){return e[this.key]}}const Sh=Object.create(null);function wI(n){return n in Sh?n+"$"+ ++Sh[n]:(Sh[n]=0,n+"$")}class Gn{constructor(e="key"){this.key=wI(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const Ct=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},Ss=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let sp=null;const Cr=function(n,e,t){let r=sp||(sp=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},hP=function(){sp=null},pi=function(n,e,t,r){return t&&(aC(n,e,t,r,-1)||aC(n,e,t,r,1))},fP=/^(img|br|input|textarea|hr)$/i;function aC(n,e,t,r,o){for(var i;;){if(n==t&&e==r)return!0;if(e==(o<0?0:An(n))){let s=n.parentNode;if(!s||s.nodeType!=1||ml(n)||fP.test(n.nodeName)||n.contentEditable=="false")return!1;e=Ct(n)+(o<0?0:1),n=s}else if(n.nodeType==1){let s=n.childNodes[e+(o<0?-1:0)];if(s.nodeType==1&&s.contentEditable=="false")if(!((i=s.pmViewDesc)===null||i===void 0)&&i.ignoreForSelection)e+=o;else return!1;else n=s,e=o<0?An(n):0}else return!1}}function An(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function pP(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=An(n)}else if(n.parentNode&&!ml(n))e=Ct(n),n=n.parentNode;else return null}}function mP(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!ml(n))e=Ct(n)+1,n=n.parentNode;else return null}}function gP(n,e,t){for(let r=e==0,o=e==An(n);r||o;){if(n==t)return!0;let i=Ct(n);if(n=n.parentNode,!n)return!1;r=r&&i==0,o=o&&i==An(n)}}function ml(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const fd=function(n){return n.focusNode&&pi(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function Fo(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function yP(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function vP(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(An(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(An(r.startContainer),r.startOffset)}}}const hr=typeof navigator<"u"?navigator:null,lC=typeof document<"u"?document:null,Mo=hr&&hr.userAgent||"",ap=/Edge\/(\d+)/.exec(Mo),TI=/MSIE \d/.exec(Mo),lp=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Mo),Zt=!!(TI||lp||ap),So=TI?document.documentMode:lp?+lp[1]:ap?+ap[1]:0,qn=!Zt&&/gecko\/(\d+)/i.test(Mo);qn&&+(/Firefox\/(\d+)/.exec(Mo)||[0,0])[1];const cp=!Zt&&/Chrome\/(\d+)/.exec(Mo),Nt=!!cp,EI=cp?+cp[1]:0,Ht=!Zt&&!!hr&&/Apple Computer/.test(hr.vendor),ws=Ht&&(/Mobile\/\w+/.test(Mo)||!!hr&&hr.maxTouchPoints>2),En=ws||(hr?/Mac/.test(hr.platform):!1),CP=hr?/Win/.test(hr.platform):!1,Ir=/Android \d/.test(Mo),gl=!!lC&&"webkitFontSmoothing"in lC.documentElement.style,SP=gl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function wP(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function gr(n,e){return typeof n=="number"?n:n[e]}function TP(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function cC(n,e,t){let r=n.someProp("scrollThreshold")||0,o=n.someProp("scrollMargin")||5,i=n.dom.ownerDocument;for(let s=t||n.dom;s;){if(s.nodeType!=1){s=Ss(s);continue}let a=s,l=a==i.body,c=l?wP(i):TP(a),u=0,d=0;if(e.top<c.top+gr(r,"top")?d=-(c.top-e.top+gr(o,"top")):e.bottom>c.bottom-gr(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+gr(o,"top")-c.top:e.bottom-c.bottom+gr(o,"bottom")),e.left<c.left+gr(r,"left")?u=-(c.left-e.left+gr(o,"left")):e.right>c.right-gr(r,"right")&&(u=e.right-c.right+gr(o,"right")),u||d)if(l)i.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,p=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let m=a.scrollLeft-f,v=a.scrollTop-p;e={left:e.left-m,top:e.top-v,right:e.right-m,bottom:e.bottom-v}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:Ss(s)}}function EP(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,o;for(let i=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=n.root.elementFromPoint(i,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,o=l.top;break}}return{refDOM:r,refTop:o,stack:kI(n.dom)}}function kI(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=Ss(r));return e}function kP({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;II(t,r==0?0:r-e)}function II(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:o,left:i}=n[t];r.scrollTop!=o+e&&(r.scrollTop=o+e),r.scrollLeft!=i&&(r.scrollLeft=i)}}let Ii=null;function IP(n){if(n.setActive)return n.setActive();if(Ii)return n.focus(Ii);let e=kI(n);n.focus(Ii==null?{get preventScroll(){return Ii={preventScroll:!0},!0}}:void 0),Ii||(Ii=!1,II(e,0))}function AI(n,e){let t,r=2e8,o,i=0,s=e.top,a=e.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=Cr(u).getClientRects();else continue;for(let f=0;f<h.length;f++){let p=h[f];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=u,r=m,o=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&m&&(i=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!l&&p.left<=e.left&&p.right>=e.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(i=d+1)}}return!t&&l&&(t=l,o=c,r=0),t&&t.nodeType==3?AP(t,o):!t||r&&t.nodeType==1?{node:n,offset:i}:AI(t,o)}function AP(n,e){let t=n.nodeValue.length,r=document.createRange();for(let o=0;o<t;o++){r.setEnd(n,o+1),r.setStart(n,o);let i=Vr(r,1);if(i.top!=i.bottom&&gg(e,i))return{node:n,offset:o+(e.left>=(i.left+i.right)/2?1:0)}}return{node:n,offset:0}}function gg(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function bP(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function RP(n,e,t){let{node:r,offset:o}=AI(e,t),i=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();i=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,o,i)}function NP(n,e,t,r){let o=-1;for(let i=e,s=!1;i!=n.dom;){let a=n.docView.nearestDesc(i,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!s&&l.left>r.left||l.top>r.top?o=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(o=a.posAfter),s=!0),!a.contentDOM&&o<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;i=a.dom.parentNode}return o>-1?o:n.docView.posFromDOM(e,t,-1)}function bI(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let o=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),i=o;;){let s=n.childNodes[i];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(gg(e,c))return bI(s,e,c)}}if((i=(i+1)%r)==o)break}return n}function xP(n,e){let t=n.dom.ownerDocument,r,o=0,i=vP(t,e.left,e.top);i&&({node:r,offset:o}=i);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=n.dom.getBoundingClientRect();if(!gg(e,c)||(s=bI(n.dom,e,c),!s))return null}if(Ht)for(let c=s;r&&c;c=Ss(c))c.draggable&&(r=void 0);if(s=bP(s,e),r){if(qn&&r.nodeType==1&&(o=Math.min(o,r.childNodes.length),o<r.childNodes.length)){let u=r.childNodes[o],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&o++}let c;gl&&o&&r.nodeType==1&&(c=r.childNodes[o-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&o--,r==n.dom&&o==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(o==0||r.nodeType!=1||r.childNodes[o-1].nodeName!="BR")&&(a=NP(n,r,o,e))}a==null&&(a=RP(n,s,e));let l=n.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function uC(n){return n.top<n.bottom||n.left<n.right}function Vr(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(uC(r))return r}return Array.prototype.find.call(t,uC)||n.getBoundingClientRect()}const OP=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function RI(n,e,t){let{node:r,offset:o,atom:i}=n.docView.domFromPos(e,t<0?-1:1),s=gl||qn;if(r.nodeType==3)if(s&&(OP.test(r.nodeValue)||(t<0?!o:o==r.nodeValue.length))){let l=Vr(Cr(r,o,o),t);if(qn&&o&&/\s/.test(r.nodeValue[o-1])&&o<r.nodeValue.length){let c=Vr(Cr(r,o-1,o-1),-1);if(c.top==l.top){let u=Vr(Cr(r,o,o+1),-1);if(u.top!=l.top)return qs(u,u.left<c.left)}}return l}else{let l=o,c=o,u=t<0?1:-1;return t<0&&!o?(c++,u=-1):t>=0&&o==r.nodeValue.length?(l--,u=1):t<0?l--:c++,qs(Vr(Cr(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(i||0)).parent.inlineContent){if(i==null&&o&&(t<0||o==An(r))){let l=r.childNodes[o-1];if(l.nodeType==1)return wh(l.getBoundingClientRect(),!1)}if(i==null&&o<An(r)){let l=r.childNodes[o];if(l.nodeType==1)return wh(l.getBoundingClientRect(),!0)}return wh(r.getBoundingClientRect(),t>=0)}if(i==null&&o&&(t<0||o==An(r))){let l=r.childNodes[o-1],c=l.nodeType==3?Cr(l,An(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return qs(Vr(c,1),!1)}if(i==null&&o<An(r)){let l=r.childNodes[o];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?Cr(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return qs(Vr(c,-1),!0)}return qs(Vr(r.nodeType==3?Cr(r):r,-t),t>=0)}function qs(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function wh(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function NI(n,e,t){let r=n.state,o=n.root.activeElement;r!=e&&n.updateState(e),o!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),o!=n.dom&&o&&o.focus()}}function MP(n,e,t){let r=e.selection,o=t=="up"?r.$from:r.$to;return NI(n,e,()=>{let{node:i}=n.docView.domFromPos(o.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(i,!0);if(!a)break;if(a.node.isBlock){i=a.contentDOM||a.dom;break}i=a.dom.parentNode}let s=RI(n,o.pos,1);for(let a=i.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=Cr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const _P=/[\u0590-\u08ac]/;function PP(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let o=r.parentOffset,i=!o,s=o==r.parent.content.size,a=n.domSelection();return a?!_P.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?i:s:NI(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",t,"character");let f=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),v=p&&!f.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==m;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),v}):r.pos==r.start()||r.pos==r.end()}let dC=null,hC=null,fC=!1;function DP(n,e,t){return dC==e&&hC==t?fC:(dC=e,hC=t,fC=t=="up"||t=="down"?MP(n,e,t):PP(n,e,t))}const xn=0,pC=1,Vo=2,fr=3;class yl{constructor(e,t,r,o){this.parent=e,this.children=t,this.dom=r,this.contentDOM=o,this.dirty=xn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let o=this.children[t];if(o==e)return r;r+=o.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let i,s;if(e==this.contentDOM)i=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.previousSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.previousSibling;return i?this.posBeforeChild(s)+s.size:this.posAtStart}else{let i,s;if(e==this.contentDOM)i=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;i=e.nextSibling}for(;i&&!((s=i.pmViewDesc)&&s.parent==this);)i=i.nextSibling;return i?this.posBeforeChild(s):this.posAtEnd}let o;if(e==this.dom&&this.contentDOM)o=t>Ct(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))o=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let i=e;;i=i.parentNode){if(i==this.dom){o=!1;break}if(i.previousSibling)break}if(o==null&&t==e.childNodes.length)for(let i=e;;i=i.parentNode){if(i==this.dom){o=!0;break}if(i.nextSibling)break}}return o??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,o=e;o;o=o.parentNode){let i=this.getDesc(o),s;if(i&&(!t||i.node))if(r&&(s=i.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return i}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let o=e;o;o=o.parentNode){let i=this.getDesc(o);if(i)return i.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let o=this.children[t],i=r+o.size;if(r==e&&i!=r){for(;!o.border&&o.children.length;)for(let s=0;s<o.children.length;s++){let a=o.children[s];if(a.size){o=a;break}}return o}if(e<i)return o.descAt(e-r-o.border);r=i}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,o=0;for(let i=0;r<this.children.length;r++){let s=this.children[r],a=i+s.size;if(a>e||s instanceof OI){o=e-i;break}i=a}if(o)return this.children[r].domFromPos(o-this.children[r].border,t);for(let i;r&&!(i=this.children[r-1]).size&&i instanceof xI&&i.side>=0;r--);if(t<=0){let i,s=!0;for(;i=r?this.children[r-1]:null,!(!i||i.dom.parentNode==this.contentDOM);r--,s=!1);return i&&t&&s&&!i.border&&!i.domAtom?i.domFromPos(i.size,t):{node:this.contentDOM,offset:i?Ct(i.dom)+1:0}}else{let i,s=!0;for(;i=r<this.children.length?this.children[r]:null,!(!i||i.dom.parentNode==this.contentDOM);r++,s=!1);return i&&s&&!i.border&&!i.domAtom?i.domFromPos(0,t):{node:this.contentDOM,offset:i?Ct(i.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let o=-1,i=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(o==-1&&e<=c){let u=s+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=s;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){o=Ct(h.dom)+1;break}e-=h.size}o==-1&&(o=0)}if(o>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){i=Ct(d.dom);break}t+=d.size}i==-1&&(i=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:t,fromOffset:o,toOffset:i}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,o=!1){let i=Math.min(e,t),s=Math.max(e,t);for(let f=0,p=0;f<this.children.length;f++){let m=this.children[f],v=p+m.size;if(i>p&&s<v)return m.setSelection(e-p-m.border,t-p-m.border,r,o);p=v}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((qn||Ht)&&e==t){let{node:f,offset:p}=a;if(f.nodeType==3){if(d=!!(p&&f.nodeValue[p-1]==`
`),d&&p==f.nodeValue.length)for(let m=f,v;m;m=m.parentNode){if(v=m.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:Ct(v)+1});break}let g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let m=f.childNodes[p-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(qn&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let f=u.focusNode.childNodes[u.focusOffset];f&&f.contentEditable=="false"&&(o=!0)}if(!(o||d&&Ht)&&pi(a.node,a.offset,u.anchorNode,u.anchorOffset)&&pi(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==t)&&!d){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>t){let p=a;a=l,l=p}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,o=0;o<this.children.length;o++){let i=this.children[o],s=r+i.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let a=r+i.border,l=s-i.border;if(e>=a&&t<=l){this.dirty=e==r||t==s?Vo:pC,e==a&&t==l&&(i.contentLost||i.dom.parentNode!=this.contentDOM)?i.dirty=fr:i.markDirty(e-a,t-a);return}else i.dirty=i.dom==i.contentDOM&&i.dom.parentNode==this.contentDOM&&!i.children.length?Vo:fr}r=s}this.dirty=Vo}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Vo:pC;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}get ignoreForSelection(){return!1}isText(e){return!1}}class xI extends yl{constructor(e,t,r,o){let i,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!i)return o;if(i.parent)return i.parent.posBeforeChild(i)})),!t.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,i=this}matchesWidget(e){return this.dirty==xn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get ignoreForSelection(){return!!this.widget.type.spec.relaxedSide}get side(){return this.widget.type.side}}class LP extends yl{constructor(e,t,r,o){super(e,[],t,null),this.textDOM=r,this.text=o}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class mi extends yl{constructor(e,t,r,o,i){super(e,[],r,o),this.mark=t,this.spec=i}static create(e,t,r,o){let i=o.nodeViews[t.type.name],s=i&&i(t,o,r);return(!s||!s.dom)&&(s=Si.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new mi(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&fr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=fr&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=xn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=xn}}slice(e,t,r){let o=mi.create(this.parent,this.mark,!0,r),i=this.children,s=this.size;t<s&&(i=dp(i,t,s,r)),e>0&&(i=dp(i,0,e,r));for(let a=0;a<i.length;a++)i[a].parent=o;return o.children=i,o}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class wo extends yl{constructor(e,t,r,o,i,s,a,l,c){super(e,[],i,s),this.node=t,this.outerDeco=r,this.innerDeco=o,this.nodeDOM=a}static create(e,t,r,o,i,s){let a=i.nodeViews[t.type.name],l,c=a&&a(t,i,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,o),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=Si.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let h=u;return u=PI(u,r,t),c?l=new UP(e,t,r,o,u,d||null,h,c,i,s+1):t.isText?new pd(e,t,r,o,u,h,i):new wo(e,t,r,o,u,d||null,h,i,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>N.empty)}return e}matchesNode(e,t,r){return this.dirty==xn&&e.eq(this.node)&&vu(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,o=t,i=e.composing?this.localCompositionInfo(e,t):null,s=i&&i.pos>-1?i:null,a=i&&i.pos<0,l=new FP(this,s&&s.node,e);KP(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Se.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,o)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,e);let f;l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>o&&e.state.selection.to<o+c.nodeSize&&(f=l.findIndexWithChild(i.node))>-1&&l.updateNodeAt(c,u,d,f,e)||l.updateNextNode(c,u,d,e,h,o)||l.addNode(c,u,d,e,o),o+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Vo)&&(s&&this.protectLocalComposition(e,s),MI(this.contentDOM,this.children,e),ws&&jP(this.dom))}localCompositionInfo(e,t){let{from:r,to:o}=e.state.selection;if(!(e.state.selection instanceof Y)||r<t||o>t+this.node.content.size)return null;let i=e.input.compositionNode;if(!i||!this.dom.contains(i.parentNode))return null;if(this.node.inlineContent){let s=i.nodeValue,a=$P(this.node.content,s,r-t,o-t);return a<0?null:{node:i,pos:a,text:s}}else return{node:i,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:o}){if(this.getDesc(t))return;let i=t;for(;i.parentNode!=this.contentDOM;i=i.parentNode){for(;i.previousSibling;)i.parentNode.removeChild(i.previousSibling);for(;i.nextSibling;)i.parentNode.removeChild(i.nextSibling);i.pmViewDesc&&(i.pmViewDesc=void 0)}let s=new LP(this,i,t,o);e.input.compositionNodes.push(s),this.children=dp(this.children,r,r+o.length,e,s)}update(e,t,r,o){return this.dirty==fr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,o),!0)}updateInner(e,t,r,o){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(o,this.posAtStart),this.dirty=xn}updateOuterDeco(e){if(vu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=_I(this.dom,this.nodeDOM,up(this.outerDeco,this.node,t),up(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function mC(n,e,t,r,o){PI(r,e,n);let i=new wo(void 0,n,e,t,r,r,r,o,0);return i.contentDOM&&i.updateChildren(o,0),i}class pd extends wo{constructor(e,t,r,o,i,s,a){super(e,t,r,o,i,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,o){return this.dirty==fr||this.dirty!=xn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=xn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,o.trackWrites==this.nodeDOM&&(o.trackWrites=null)),this.node=e,this.dirty=xn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let o=this.node.cut(e,t),i=document.createTextNode(o.text);return new pd(this.parent,o,this.outerDeco,this.innerDeco,i,i,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=fr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class OI extends yl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==xn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class UP extends wo{constructor(e,t,r,o,i,s,a,l,c,u){super(e,t,r,o,i,s,a,c,u),this.spec=l}update(e,t,r,o){if(this.dirty==fr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let i=this.spec.update(e,t,r);return i&&this.updateInner(e,t,r,o),i}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,o)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,o){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,o)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function MI(n,e,t){let r=n.firstChild,o=!1;for(let i=0;i<e.length;i++){let s=e[i],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=gC(r),o=!0;r=r.nextSibling}else o=!0,n.insertBefore(a,r);if(s instanceof mi){let l=r?r.previousSibling:n.lastChild;MI(s.contentDOM,s.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=gC(r),o=!0;o&&t.trackWrites==n&&(t.trackWrites=null)}const Ea=function(n){n&&(this.nodeName=n)};Ea.prototype=Object.create(null);const Wo=[new Ea];function up(n,e,t){if(n.length==0)return Wo;let r=t?Wo[0]:new Ea,o=[r];for(let i=0;i<n.length;i++){let s=n[i].type.attrs;if(s){s.nodeName&&o.push(r=new Ea(s.nodeName));for(let a in s){let l=s[a];l!=null&&(t&&o.length==1&&o.push(r=new Ea(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return o}function _I(n,e,t,r){if(t==Wo&&r==Wo)return e;let o=e;for(let i=0;i<r.length;i++){let s=r[i],a=t[i];if(i){let l;a&&a.nodeName==s.nodeName&&o!=n&&(l=o.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(o),a=Wo[0]),o=l}HP(o,a||Wo[0],s)}return o}function HP(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],o=t.class?t.class.split(" ").filter(Boolean):[];for(let i=0;i<r.length;i++)o.indexOf(r[i])==-1&&n.classList.remove(r[i]);for(let i=0;i<o.length;i++)r.indexOf(o[i])==-1&&n.classList.add(o[i]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,o;for(;o=r.exec(e.style);)n.style.removeProperty(o[1])}t.style&&(n.style.cssText+=t.style)}}function PI(n,e,t){return _I(n,n,Wo,up(e,t,n.nodeType!=1))}function vu(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function gC(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class FP{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=BP(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let o=0,i=this.stack.length>>1,s=Math.min(i,e.length);for(;o<s&&(o==i-1?this.top:this.stack[o+1<<1]).matchesMark(e[o])&&e[o].type.spec.spanning!==!1;)o++;for(;o<i;)this.destroyRest(),this.top.dirty=xn,this.index=this.stack.pop(),this.top=this.stack.pop(),i--;for(;i<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[i])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=mi.create(this.top,e[i],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,i++}}findNodeMatch(e,t,r,o){let i=-1,s;if(o>=this.preMatch.index&&(s=this.preMatch.matches[o-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))i=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){i=a;break}}return i<0?!1:(this.destroyBetween(this.index,i),this.index++,!0)}updateNodeAt(e,t,r,o,i){let s=this.top.children[o];return s.dirty==fr&&s.dom==s.contentDOM&&(s.dirty=Vo),s.update(e,t,r,i)?(this.destroyBetween(this.index,o),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let o=this.index;o<this.top.children.length;o++)if(this.top.children[o]==r)return o}return-1}e=t}}updateNextNode(e,t,r,o,i,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof wo){let c=this.preMatch.matched.get(l);if(c!=null&&c!=i)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=fr&&vu(t,l.outerDeco));if(!h&&l.update(e,t,r,o))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,t,r,o,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Vo,d.updateChildren(o,s+1),d.dirty=xn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,o,i,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!vu(r,e.outerDeco)||!o.eq(e.innerDeco))return null;let a=wo.create(this.top,t,r,o,i,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,o,i){let s=wo.create(this.top,e,t,r,o,i);s.contentDOM&&s.updateChildren(o,i+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let o=this.index<this.top.children.length?this.top.children[this.index]:null;if(o&&o.matchesWidget(e)&&(e==o.widget||!o.widget.type.toDOM.parentNode))this.index++;else{let i=new xI(this.top,e,t,r);this.top.children.splice(this.index++,0,i),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof mi;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof pd)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Ht||Nt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let o=new OI(this.top,[],r,null);t!=this.top?t.children.push(o):t.children.splice(this.index++,0,o),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function BP(n,e){let t=e,r=t.children.length,o=n.childCount,i=new Map,s=[];e:for(;o>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof mi)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(o-1))break;--o,i.set(a,o),s.push(a)}}return{index:o,matched:i,matches:s.reverse()}}function zP(n,e){return n.type.side-e.type.side}function KP(n,e,t,r){let o=e.locals(n),i=0;if(o.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,o,e.forChild(i,u),c),i+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d;for(;s<o.length&&o[s].to==i;){let v=o[s++];v.widget&&(u?(d||(d=[u])).push(v):u=v)}if(u)if(d){d.sort(zP);for(let v=0;v<d.length;v++)t(d[v],c,!!l)}else t(u,c,!!l);let h,f;if(l)f=-1,h=l,l=null;else if(c<n.childCount)f=c,h=n.child(c++);else break;for(let v=0;v<a.length;v++)a[v].to<=i&&a.splice(v--,1);for(;s<o.length&&o[s].from<=i&&o[s].to>i;)a.push(o[s++]);let p=i+h.nodeSize;if(h.isText){let v=p;s<o.length&&o[s].from<v&&(v=o[s].from);for(let g=0;g<a.length;g++)a[g].to<v&&(v=a[g].to);v<p&&(l=h.cut(v-i),h=h.cut(0,v-i),p=v,f=-1)}else for(;s<o.length&&o[s].to<p;)s++;let m=h.isInline&&!h.isLeaf?a.filter(v=>!v.inline):a.slice();r(h,m,e.forChild(i,h),f),i=p}}function jP(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function $P(n,e,t,r){for(let o=0,i=0;o<n.childCount&&i<=r;){let s=n.child(o++),a=i;if(i+=s.nodeSize,!s.isText)continue;let l=s.text;for(;o<n.childCount;){let c=n.child(o++);if(i+=c.nodeSize,!c.isText)break;l+=c.text}if(i>=t){if(i>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function dp(n,e,t,r,o){let i=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],c=a,u=a+=l.size;c>=t||u<=e?i.push(l):(c<e&&i.push(l.slice(0,e-c,r)),o&&(i.push(o),o=void 0),u>t&&i.push(l.slice(t-c,l.size,r)))}return i}function yg(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let o=n.docView.nearestDesc(t.focusNode),i=o&&o.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(fd(t)){for(l=s;o&&!o.node;)o=o.parent;let d=o.node;if(o&&d.isAtom&&W.isSelectable(d)&&o.parent&&!(d.isInline&&gP(t.focusNode,t.focusOffset,o.dom))){let h=o.posBefore;c=new W(s==h?a:r.resolve(h))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let d=s,h=s;for(let f=0;f<t.rangeCount;f++){let p=t.getRangeAt(f);d=Math.min(d,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),h=Math.max(h,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[l,s]=h==n.state.selection.anchor?[h,d]:[d,h],a=r.resolve(s)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||n.state.selection.head<a.pos&&!i?1:-1;c=vg(n,u,a,d)}return c}function DI(n){return n.editable?n.hasFocus():UI(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Nr(n,e=!1){let t=n.state.selection;if(LI(n,t),!!DI(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&Nt){let r=n.domSelectionRange(),o=n.domObserver.currentSelection;if(r.anchorNode&&o.anchorNode&&pi(r.anchorNode,r.anchorOffset,o.anchorNode,o.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)WP(n);else{let{anchor:r,head:o}=t,i,s;yC&&!(t instanceof Y)&&(t.$from.parent.inlineContent||(i=vC(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=vC(n,t.to))),n.docView.setSelection(r,o,n,e),yC&&(i&&CC(i),s&&CC(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&VP(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const yC=Ht||Nt&&EI<63;function vC(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),o=r<t.childNodes.length?t.childNodes[r]:null,i=r?t.childNodes[r-1]:null;if(Ht&&o&&o.contentEditable=="false")return Th(o);if((!o||o.contentEditable=="false")&&(!i||i.contentEditable=="false")){if(o)return Th(o);if(i)return Th(i)}}function Th(n){return n.contentEditable="true",Ht&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function CC(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function VP(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,o=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=o)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!DI(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function WP(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,o=r.nodeName=="IMG";o?t.setStart(r.parentNode,Ct(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!o&&!n.state.selection.visible&&Zt&&So<=11&&(r.disabled=!0,r.disabled=!1)}function LI(n,e){if(e instanceof W){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(SC(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else SC(n)}function SC(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function vg(n,e,t,r){return n.someProp("createSelectionBetween",o=>o(n,e,t))||Y.between(e,t,r)}function wC(n){return n.editable&&!n.hasFocus()?!1:UI(n)}function UI(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function qP(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return pi(e.node,e.offset,t.anchorNode,t.anchorOffset)}function hp(n,e){let{$anchor:t,$head:r}=n.selection,o=e>0?t.max(r):t.min(r),i=o.parent.inlineContent?o.depth?n.doc.resolve(e>0?o.after():o.before()):null:o;return i&&ee.findFrom(i,e)}function Qr(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function TC(n,e,t){let r=n.state.selection;if(r instanceof Y)if(t.indexOf("s")>-1){let{$head:o}=r,i=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter;if(!i||i.isText||!i.isLeaf)return!1;let s=n.state.doc.resolve(o.pos+i.nodeSize*(e<0?-1:1));return Qr(n,new Y(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let o=hp(n.state,e);return o&&o instanceof W?Qr(n,o):!1}else if(!(En&&t.indexOf("m")>-1)){let o=r.$head,i=o.textOffset?null:e<0?o.nodeBefore:o.nodeAfter,s;if(!i||i.isText)return!1;let a=e<0?o.pos-i.nodeSize:o.pos;return i.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?W.isSelectable(i)?Qr(n,new W(e<0?n.state.doc.resolve(o.pos-i.nodeSize):o)):gl?Qr(n,new Y(n.state.doc.resolve(e<0?a:a+i.nodeSize))):!1:!1}}else return!1;else{if(r instanceof W&&r.node.isInline)return Qr(n,new Y(e>0?r.$to:r.$from));{let o=hp(n.state,e);return o?Qr(n,o):!1}}}function Cu(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function ka(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function Ai(n,e){return e<0?GP(n):QP(n)}function GP(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let o,i,s=!1;for(qn&&t.nodeType==1&&r<Cu(t)&&ka(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(ka(a,-1))o=t,i=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(HI(t))break;{let a=t.previousSibling;for(;a&&ka(a,-1);)o=t.parentNode,i=Ct(a),a=a.previousSibling;if(a)t=a,r=Cu(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?fp(n,t,r):o&&fp(n,o,i)}function QP(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let o=Cu(t),i,s;for(;;)if(r<o){if(t.nodeType!=1)break;let a=t.childNodes[r];if(ka(a,1))i=t,s=++r;else break}else{if(HI(t))break;{let a=t.nextSibling;for(;a&&ka(a,1);)i=a.parentNode,s=Ct(a)+1,a=a.nextSibling;if(a)t=a,r=0,o=Cu(t);else{if(t=t.parentNode,t==n.dom)break;r=o=0}}}i&&fp(n,i,s)}function HI(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function YP(n,e){for(;n&&e==n.childNodes.length&&!ml(n);)e=Ct(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function JP(n,e){for(;n&&!e&&!ml(n);)e=Ct(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function fp(n,e,t){if(e.nodeType!=3){let i,s;(s=YP(e,t))?(e=s,t=0):(i=JP(e,t))&&(e=i,t=i.nodeValue.length)}let r=n.domSelection();if(!r)return;if(fd(r)){let i=document.createRange();i.setEnd(e,t),i.setStart(e,t),r.removeAllRanges(),r.addRange(i)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:o}=n;setTimeout(()=>{n.state==o&&Nr(n)},50)}function EC(n,e){let t=n.state.doc.resolve(e);if(!(Nt||CP)&&t.parent.inlineContent){let o=n.coordsAtPos(e);if(e>t.start()){let i=n.coordsAtPos(e-1),s=(i.top+i.bottom)/2;if(s>o.top&&s<o.bottom&&Math.abs(i.left-o.left)>1)return i.left<o.left?"ltr":"rtl"}if(e<t.end()){let i=n.coordsAtPos(e+1),s=(i.top+i.bottom)/2;if(s>o.top&&s<o.bottom&&Math.abs(i.left-o.left)>1)return i.left>o.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function kC(n,e,t){let r=n.state.selection;if(r instanceof Y&&!r.empty||t.indexOf("s")>-1||En&&t.indexOf("m")>-1)return!1;let{$from:o,$to:i}=r;if(!o.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=hp(n.state,e);if(s&&s instanceof W)return Qr(n,s)}if(!o.parent.inlineContent){let s=e<0?o:i,a=r instanceof gn?ee.near(s,e):ee.findFrom(s,e);return a?Qr(n,a):!1}return!1}function IC(n,e){if(!(n.state.selection instanceof Y))return!0;let{$head:t,$anchor:r,empty:o}=n.state.selection;if(!t.sameParent(r))return!0;if(!o)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let i=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(i&&!i.isText){let s=n.state.tr;return e<0?s.delete(t.pos-i.nodeSize,t.pos):s.delete(t.pos,t.pos+i.nodeSize),n.dispatch(s),!0}return!1}function AC(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function XP(n){if(!Ht||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;AC(n,r,"true"),setTimeout(()=>AC(n,r,"false"),20)}return!1}function ZP(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function eD(n,e){let t=e.keyCode,r=ZP(e);if(t==8||En&&t==72&&r=="c")return IC(n,-1)||Ai(n,-1);if(t==46&&!e.shiftKey||En&&t==68&&r=="c")return IC(n,1)||Ai(n,1);if(t==13||t==27)return!0;if(t==37||En&&t==66&&r=="c"){let o=t==37?EC(n,n.state.selection.from)=="ltr"?-1:1:-1;return TC(n,o,r)||Ai(n,o)}else if(t==39||En&&t==70&&r=="c"){let o=t==39?EC(n,n.state.selection.from)=="ltr"?1:-1:1;return TC(n,o,r)||Ai(n,o)}else{if(t==38||En&&t==80&&r=="c")return kC(n,-1,r)||Ai(n,-1);if(t==40||En&&t==78&&r=="c")return XP(n)||kC(n,1,r)||Ai(n,1);if(r==(En?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function Cg(n,e){n.someProp("transformCopied",f=>{e=f(e,n)});let t=[],{content:r,openStart:o,openEnd:i}=e;for(;o>1&&i>1&&r.childCount==1&&r.firstChild.childCount==1;){o--,i--;let f=r.firstChild;t.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let s=n.someProp("clipboardSerializer")||Si.fromSchema(n.state.schema),a=$I(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=jI[c.nodeName.toLowerCase()]);){for(let f=u.length-1;f>=0;f--){let p=a.createElement(u[f]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${o} ${i}${d?` -${d}`:""} ${JSON.stringify(t)}`);let h=n.someProp("clipboardTextSerializer",f=>f(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function FI(n,e,t,r,o){let i=o.parent.type.spec.code,s,a;if(!t&&!e)return null;let l=e&&(r||i||!t);if(l){if(n.someProp("transformPastedText",h=>{e=h(e,i||r,n)}),i)return e?new U(N.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):U.empty;let d=n.someProp("clipboardTextParser",h=>h(e,o,r,n));if(d)a=d;else{let h=o.marks(),{schema:f}=n.state,p=Si.fromSchema(f);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let v=s.appendChild(document.createElement("p"));m&&v.appendChild(p.serializeNode(f.text(m,h)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),s=oD(t),gl&&iD(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||wa.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:o,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!tD.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=sD(bC(a,+u[1],+u[2]),u[4]);else if(a=U.maxOpen(nD(a.content,o),!0),a.openStart||a.openEnd){let d=0,h=0;for(let f=a.content.firstChild;d<a.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=a.content.lastChild;h<a.openEnd&&!f.type.spec.isolating;h++,f=f.lastChild);a=bC(a,d,h)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const tD=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function nD(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let o=e.node(t).contentMatchAt(e.index(t)),i,s=[];if(n.forEach(a=>{if(!s)return;let l=o.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&i.length&&zI(l,i,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=KI(s[s.length-1],i.length));let u=BI(a,l);s.push(u),o=o.matchType(u.type),i=l}}),s)return N.from(s)}return n}function BI(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,N.from(n));return n}function zI(n,e,t,r,o){if(o<n.length&&o<e.length&&n[o]==e[o]){let i=zI(n,e,t,r.lastChild,o+1);if(i)return r.copy(r.content.replaceChild(r.childCount-1,i));if(r.contentMatchAt(r.childCount).matchType(o==n.length-1?t.type:n[o+1]))return r.copy(r.content.append(N.from(BI(t,n,o+1))))}}function KI(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,KI(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(N.empty,!0);return n.copy(t.append(r))}function pp(n,e,t,r,o,i){let s=e<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(i=0),o<r-1&&(a=pp(a,e,t,r,o+1,i)),o>=t&&(a=e<0?s.contentMatchAt(0).fillBefore(a,i<=o).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(N.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(a))}function bC(n,e,t){return e<n.openStart&&(n=new U(pp(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new U(pp(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const jI={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let RC=null;function $I(){return RC||(RC=document.implementation.createHTMLDocument("title"))}let Eh=null;function rD(n){let e=window.trustedTypes;return e?(Eh||(Eh=e.defaultPolicy||e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),Eh.createHTML(n)):n}function oD(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=$I().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),o;if((o=r&&jI[r[1].toLowerCase()])&&(n=o.map(i=>"<"+i+">").join("")+n+o.map(i=>"</"+i+">").reverse().join("")),t.innerHTML=rD(n),o)for(let i=0;i<o.length;i++)t=t.querySelector(o[i])||t;return t}function iD(n){let e=n.querySelectorAll(Nt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function sD(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:o,openStart:i,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;o=N.from(l.create(r[a+1],o)),i++,s++}return new U(o,i,s)}const Ft={},Bt={},aD={touchstart:!0,touchmove:!0};class lD{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:"",button:0},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function cD(n){for(let e in Ft){let t=Ft[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{dD(n,r)&&!Sg(n,r)&&(n.editable||!(r.type in Bt))&&t(n,r)},aD[e]?{passive:!0}:void 0)}Ht&&n.dom.addEventListener("input",()=>null),mp(n)}function so(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function uD(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function mp(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>Sg(n,r))})}function Sg(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function dD(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function hD(n,e){!Sg(n,e)&&Ft[e.type]&&(n.editable||!(e.type in Bt))&&Ft[e.type](n,e)}Bt.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!WI(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Ir&&Nt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),ws&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",o=>o(n,Fo(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||eD(n,t)?t.preventDefault():so(n,"key")};Bt.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Bt.keypress=(n,e)=>{let t=e;if(WI(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||En&&t.metaKey)return;if(n.someProp("handleKeyPress",o=>o(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof Y)||!r.$from.sameParent(r.$to)){let o=String.fromCharCode(t.charCode),i=()=>n.state.tr.insertText(o).scrollIntoView();!/[\r\n]/.test(o)&&!n.someProp("handleTextInput",s=>s(n,r.$from.pos,r.$to.pos,o,i))&&n.dispatch(i()),t.preventDefault()}};function md(n){return{left:n.clientX,top:n.clientY}}function fD(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function wg(n,e,t,r,o){if(r==-1)return!1;let i=n.state.doc.resolve(r);for(let s=i.depth+1;s>0;s--)if(n.someProp(e,a=>s>i.depth?a(n,t,i.nodeAfter,i.before(s),o,!0):a(n,t,i.node(s),i.before(s),o,!1)))return!0;return!1}function ss(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function pD(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&W.isSelectable(r)?(ss(n,new W(t)),!0):!1}function mD(n,e){if(e==-1)return!1;let t=n.state.selection,r,o;t instanceof W&&(r=t.node);let i=n.state.doc.resolve(e);for(let s=i.depth+1;s>0;s--){let a=s>i.depth?i.nodeAfter:i.node(s);if(W.isSelectable(a)){r&&t.$from.depth>0&&s>=t.$from.depth&&i.before(t.$from.depth+1)==t.$from.pos?o=i.before(t.$from.depth):o=i.before(s);break}}return o!=null?(ss(n,W.create(n.state.doc,o)),!0):!1}function gD(n,e,t,r,o){return wg(n,"handleClickOn",e,t,r)||n.someProp("handleClick",i=>i(n,e,r))||(o?mD(n,t):pD(n,t))}function yD(n,e,t,r){return wg(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",o=>o(n,e,r))}function vD(n,e,t,r){return wg(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",o=>o(n,e,r))||CD(n,t,r)}function CD(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(ss(n,Y.create(r,0,r.content.size)),!0):!1;let o=r.resolve(e);for(let i=o.depth+1;i>0;i--){let s=i>o.depth?o.nodeAfter:o.node(i),a=o.before(i);if(s.inlineContent)ss(n,Y.create(r,a+1,a+1+s.content.size));else if(W.isSelectable(s))ss(n,W.create(r,a));else continue;return!0}}function Tg(n){return Su(n)}const VI=En?"metaKey":"ctrlKey";Ft.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=Tg(n),o=Date.now(),i="singleClick";o-n.input.lastClick.time<500&&fD(t,n.input.lastClick)&&!t[VI]&&n.input.lastClick.button==t.button&&(n.input.lastClick.type=="singleClick"?i="doubleClick":n.input.lastClick.type=="doubleClick"&&(i="tripleClick")),n.input.lastClick={time:o,x:t.clientX,y:t.clientY,type:i,button:t.button};let s=n.posAtCoords(md(t));s&&(i=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new SD(n,s,t,!!r)):(i=="doubleClick"?yD:vD)(n,s.pos,s.inside,t)?t.preventDefault():so(n,"pointer"))};class SD{constructor(e,t,r,o){this.view=e,this.pos=t,this.event=r,this.flushed=o,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[VI],this.allowDefault=r.shiftKey;let i,s;if(t.inside>-1)i=e.state.doc.nodeAt(t.inside),s=t.inside;else{let u=e.state.doc.resolve(t.pos);i=u.parent,s=u.depth?u.before():0}const a=o?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&i.type.spec.draggable&&i.type.spec.selectable!==!1||c instanceof W&&c.from<=s&&c.to>s)&&(this.mightDrag={node:i,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&qn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),so(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Nr(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(md(e))),this.updateAllowDefault(e),this.allowDefault||!t?so(this.view,"pointer"):gD(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Ht&&this.mightDrag&&!this.mightDrag.node.isAtom||Nt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ss(this.view,ee.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):so(this.view,"pointer")}move(e){this.updateAllowDefault(e),so(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Ft.touchstart=n=>{n.input.lastTouch=Date.now(),Tg(n),so(n,"pointer")};Ft.touchmove=n=>{n.input.lastTouch=Date.now(),so(n,"pointer")};Ft.contextmenu=n=>Tg(n);function WI(n,e){return n.composing?!0:Ht&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const wD=Ir?5e3:-1;Bt.compositionstart=Bt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof Y&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),Su(n,!0),n.markCursor=null;else if(Su(n,!e.selection.empty),qn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let o=r.focusNode,i=r.focusOffset;o&&o.nodeType==1&&i!=0;){let s=i<0?o.lastChild:o.childNodes[i-1];if(!s)break;if(s.nodeType==3){let a=n.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else o=s,i=-1}}n.input.composing=!0}qI(n,wD)};Bt.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,qI(n,20))};function qI(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>Su(n),e))}function GI(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=ED());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function TD(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=pP(e.focusNode,e.focusOffset),r=mP(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let o=r.pmViewDesc,i=n.domObserver.lastChangedTextNode;if(t==i||r==i)return i;if(!o||!o.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t||r}function ED(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function Su(n,e=!1){if(!(Ir&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),GI(n),e||n.docView&&n.docView.dirty){let t=yg(n),r=n.state.selection;return t&&!t.eq(r)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!r.$from.node(r.$from.sharedDepth(r.to)).inlineContent?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function kD(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),o=document.createRange();o.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(o),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const Ja=Zt&&So<15||ws&&SP<604;Ft.copy=Bt.cut=(n,e)=>{let t=e,r=n.state.selection,o=t.type=="cut";if(r.empty)return;let i=Ja?null:t.clipboardData,s=r.content(),{dom:a,text:l}=Cg(n,s);i?(t.preventDefault(),i.clearData(),i.setData("text/html",a.innerHTML),i.setData("text/plain",l)):kD(n,a),o&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function ID(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function AD(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let o=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Xa(n,r.value,null,o,e):Xa(n,r.textContent,r.innerHTML,o,e)},50)}function Xa(n,e,t,r,o){let i=FI(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,o,i||U.empty)))return!0;if(!i)return!1;let s=ID(i),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(i);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function QI(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Bt.paste=(n,e)=>{let t=e;if(n.composing&&!Ir)return;let r=Ja?null:t.clipboardData,o=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Xa(n,QI(r),r.getData("text/html"),o,t)?t.preventDefault():AD(n,t)};class YI{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const bD=En?"altKey":"ctrlKey";function JI(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[bD]}Ft.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let o=n.state.selection,i=o.empty?null:n.posAtCoords(md(t)),s;if(!(i&&i.pos>=o.from&&i.pos<=(o instanceof W?o.to-1:o.to))){if(r&&r.mightDrag)s=W.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(s=W.create(n.state.doc,d.posBefore))}}let a=(s||n.state.selection).content(),{dom:l,text:c,slice:u}=Cg(n,a);(!t.dataTransfer.files.length||!Nt||EI>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(Ja?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",Ja||t.dataTransfer.setData("text/plain",c),n.dragging=new YI(u,JI(n,t),s)};Ft.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Bt.dragover=Bt.dragenter=(n,e)=>e.preventDefault();Bt.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let o=n.posAtCoords(md(t));if(!o)return;let i=n.state.doc.resolve(o.pos),s=r&&r.slice;s?n.someProp("transformPasted",p=>{s=p(s,n)}):s=FI(n,QI(t.dataTransfer),Ja?null:t.dataTransfer.getData("text/html"),!1,i);let a=!!(r&&JI(n,t));if(n.someProp("handleDrop",p=>p(n,t,s||U.empty,a))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?mI(n.state.doc,i.pos,s):i.pos;l==null&&(l=i.pos);let c=n.state.tr;if(a){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(h))return;let f=c.doc.resolve(u);if(d&&W.isSelectable(s.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new W(f));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,v,g,y)=>p=y),c.setSelection(vg(n,f,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Ft.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Nr(n)},20))};Ft.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Ft.beforeinput=(n,e)=>{if(Nt&&Ir&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",i=>i(n,Fo(8,"Backspace")))))return;let{$cursor:o}=n.state.selection;o&&o.pos>0&&n.dispatch(n.state.tr.delete(o.pos-1,o.pos).scrollIntoView())},50)}};for(let n in Bt)Ft[n]=Bt[n];function Za(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class wu{constructor(e,t){this.toDOM=e,this.spec=t||Xo,this.side=this.spec.side||0}map(e,t,r,o){let{pos:i,deleted:s}=e.mapResult(t.from+o,this.side<0?-1:1);return s?null:new pn(i-r,i-r,this)}valid(){return!0}eq(e){return this==e||e instanceof wu&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Za(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class To{constructor(e,t){this.attrs=e,this.spec=t||Xo}map(e,t,r,o){let i=e.map(t.from+o,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+o,this.spec.inclusiveEnd?1:-1)-r;return i>=s?null:new pn(i,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof To&&Za(this.attrs,e.attrs)&&Za(this.spec,e.spec)}static is(e){return e.type instanceof To}destroy(){}}class Eg{constructor(e,t){this.attrs=e,this.spec=t||Xo}map(e,t,r,o){let i=e.mapResult(t.from+o,1);if(i.deleted)return null;let s=e.mapResult(t.to+o,-1);return s.deleted||s.pos<=i.pos?null:new pn(i.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:o}=e.content.findIndex(t.from),i;return o==t.from&&!(i=e.child(r)).isText&&o+i.nodeSize==t.to}eq(e){return this==e||e instanceof Eg&&Za(this.attrs,e.attrs)&&Za(this.spec,e.spec)}destroy(){}}class pn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new pn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new pn(e,e,new wu(t,r))}static inline(e,t,r,o){return new pn(e,t,new To(r,o))}static node(e,t,r,o){return new pn(e,t,new Eg(r,o))}get spec(){return this.type.spec}get inline(){return this.type instanceof To}get widget(){return this.type instanceof wu}}const Oi=[],Xo={};class Ge{constructor(e,t){this.local=e.length?e:Oi,this.children=t.length?t:Oi}static create(e,t){return t.length?Tu(t,e,0,Xo):It}find(e,t,r){let o=[];return this.findInner(e??0,t??1e9,o,0,r),o}findInner(e,t,r,o,i){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=t&&a.to>=e&&(!i||i(a.spec))&&r.push(a.copy(a.from+o,a.to+o))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,t-a,r,o+a,i)}}map(e,t,r){return this==It||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Xo)}mapInner(e,t,r,o,i){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,o);l&&l.type.valid(t,l)?(s||(s=[])).push(l):i.onRemove&&i.onRemove(this.local[a].spec)}return this.children.length?RD(this.children,s||[],e,t,r,o,i):s?new Ge(s.sort(Zo),Oi):It}add(e,t){return t.length?this==It?Ge.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let o,i=0;e.forEach((a,l)=>{let c=l+r,u;if(u=ZI(t,a,c)){for(o||(o=this.children.slice());i<o.length&&o[i]<l;)i+=3;o[i]==l?o[i+2]=o[i+2].addInner(a,u,c+1):o.splice(i,0,l,l+a.nodeSize,Tu(u,a,c+1,Xo)),i+=3}});let s=XI(i?eA(t):t,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new Ge(s.length?this.local.concat(s).sort(Zo):this.local,o||this.children)}remove(e){return e.length==0||this==It?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,o=this.local;for(let i=0;i<r.length;i+=3){let s,a=r[i]+t,l=r[i+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[i+2].removeInner(s,a+1);c!=It?r[i+2]=c:(r.splice(i,3),i-=3)}if(o.length){for(let i=0,s;i<e.length;i++)if(s=e[i])for(let a=0;a<o.length;a++)o[a].eq(s,t)&&(o==this.local&&(o=this.local.slice()),o.splice(a--,1))}return r==this.children&&o==this.local?this:o.length||r.length?new Ge(o,r):It}forChild(e,t){if(this==It)return this;if(t.isLeaf)return Ge.empty;let r,o;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let i=e+1,s=i+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>i&&l.type instanceof To){let c=Math.max(i,l.from)-i,u=Math.min(s,l.to)-i;c<u&&(o||(o=[])).push(l.copy(c,u))}}if(o){let a=new Ge(o.sort(Zo),Oi);return r?new Zr([a,r]):a}return r||It}eq(e){if(this==e)return!0;if(!(e instanceof Ge)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return kg(this.localsInner(e))}localsInner(e){if(this==It)return Oi;if(e.inlineContent||!this.local.some(To.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof To||t.push(this.local[r]);return t}forEachSet(e){e(this)}}Ge.empty=new Ge([],[]);Ge.removeOverlap=kg;const It=Ge.empty;class Zr{constructor(e){this.members=e}map(e,t){const r=this.members.map(o=>o.map(e,t,Xo));return Zr.from(r)}forChild(e,t){if(t.isLeaf)return Ge.empty;let r=[];for(let o=0;o<this.members.length;o++){let i=this.members[o].forChild(e,t);i!=It&&(i instanceof Zr?r=r.concat(i.members):r.push(i))}return Zr.from(r)}eq(e){if(!(e instanceof Zr)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let o=0;o<this.members.length;o++){let i=this.members[o].localsInner(e);if(i.length)if(!t)t=i;else{r&&(t=t.slice(),r=!1);for(let s=0;s<i.length;s++)t.push(i[s])}}return t?kg(r?t:t.sort(Zo)):Oi}static from(e){switch(e.length){case 0:return It;case 1:return e[0];default:return new Zr(e.every(t=>t instanceof Ge)?e:e.reduce((t,r)=>t.concat(r instanceof Ge?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function RD(n,e,t,r,o,i,s){let a=n.slice();for(let c=0,u=i;c<t.maps.length;c++){let d=0;t.maps[c].forEach((h,f,p,m)=>{let v=m-p-(f-h);for(let g=0;g<a.length;g+=3){let y=a[g+1];if(y<0||h>y+u-d)continue;let C=a[g]+u-d;f>=C?a[g+1]=h<=C?-2:-1:h>=u&&v&&(a[g]+=v,a[g+1]+=v)}d+=v}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+i),d=u-o;if(d<0||d>=r.content.size){l=!0;continue}let h=t.map(n[c+1]+i,-1),f=h-o,{index:p,offset:m}=r.content.findIndex(d),v=r.maybeChild(p);if(v&&m==d&&m+v.nodeSize==f){let g=a[c+2].mapInner(t,v,u+1,n[c]+i+1,s);g!=It?(a[c]=d,a[c+1]=f,a[c+2]=g):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=ND(a,n,e,t,o,i,s),u=Tu(c,r,0,s);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let f=u.children[d];for(;h<a.length&&a[h]<f;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Ge(e.sort(Zo),a)}function XI(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let o=n[r];t.push(new pn(o.from+e,o.to+e,o.type))}return t}function ND(n,e,t,r,o,i,s){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,o,c);d?t.push(d):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+i+1);return t}function ZI(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,o=null;for(let i=0,s;i<n.length;i++)(s=n[i])&&s.from>t&&s.to<r&&((o||(o=[])).push(s),n[i]=null);return o}function eA(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function Tu(n,e,t,r){let o=[],i=!1;e.forEach((a,l)=>{let c=ZI(n,a,l+t);if(c){i=!0;let u=Tu(c,a,t+l+1,r);u!=It&&o.push(l,l+a.nodeSize,u)}});let s=XI(i?eA(n):n,-t).sort(Zo);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||o.length?new Ge(s,o):It}function Zo(n,e){return n.from-e.from||n.to-e.to}function kg(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let o=t+1;o<e.length;o++){let i=e[o];if(i.from==r.from){i.to!=r.to&&(e==n&&(e=n.slice()),e[o]=i.copy(i.from,r.to),NC(e,o+1,i.copy(r.to,i.to)));continue}else{i.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,i.from),NC(e,o,r.copy(i.from,r.to)));break}}}return e}function NC(n,e,t){for(;e<n.length&&Zo(t,n[e])>0;)e++;n.splice(e,0,t)}function kh(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=It&&e.push(r)}),n.cursorWrapper&&e.push(Ge.create(n.state.doc,[n.cursorWrapper.deco])),Zr.from(e)}const xD={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},OD=Zt&&So<=11;class MD{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class _D{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new MD,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let o=0;o<r.length;o++)this.queue.push(r[o]);Zt&&So<=11&&r.some(o=>o.type=="childList"&&o.removedNodes.length||o.type=="characterData"&&o.oldValue.length>o.target.nodeValue.length)?this.flushSoon():this.flush()}),OD&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,xD)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(wC(this.view)){if(this.suppressingSelectionUpdates)return Nr(this.view);if(Zt&&So<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&pi(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let i=e.focusNode;i;i=Ss(i))t.add(i);for(let i=e.anchorNode;i;i=Ss(i))if(t.has(i)){r=i;break}let o=r&&this.view.docView.nearestDesc(r);if(o&&o.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),o=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&wC(e)&&!this.ignoreSelectionChange(r),i=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(i=i<0?d.from:Math.min(d.from,i),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(qn&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let f=h.parentNode;f&&f.nodeName=="LI"&&(!d||LD(e,d)!=f)&&h.remove()}}}let c=null;i<0&&o&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&fd(r)&&(c=yg(e))&&c.eq(ee.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Nr(e),this.currentSelection.set(r),e.scrollToSelection()):(i>-1||o)&&(i>-1&&(e.docView.markDirty(i,s),PD(e)),this.handleDOMChange(i,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Nr(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];t.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let o=e.previousSibling,i=e.nextSibling;if(Zt&&So<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(o=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(i=h)}let s=o&&o.parentNode==e.target?Ct(o)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=i&&i.parentNode==e.target?Ct(i):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let xC=new WeakMap,OC=!1;function PD(n){if(!xC.has(n)&&(xC.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=qn,OC)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),OC=!0}}function MC(n,e){let t=e.startContainer,r=e.startOffset,o=e.endContainer,i=e.endOffset,s=n.domAtPos(n.state.selection.anchor);return pi(s.node,s.offset,o,i)&&([t,r,o,i]=[o,i,t,r]),{anchorNode:t,anchorOffset:r,focusNode:o,focusOffset:i}}function DD(n,e){if(e.getComposedRanges){let o=e.getComposedRanges(n.root)[0];if(o)return MC(n,o)}let t;function r(o){o.preventDefault(),o.stopImmediatePropagation(),t=o.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?MC(n,t):null}function LD(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function UD(n,e,t){let{node:r,fromOffset:o,toOffset:i,from:s,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],fd(l)||c.push({node:l.focusNode,offset:l.focusOffset})),Nt&&n.input.lastKeyCode===8)for(let v=i;v>o;v--){let g=r.childNodes[v-1],y=g.pmViewDesc;if(g.nodeName=="BR"&&!y){i=v;break}if(!y||y.size)break}let d=n.state.doc,h=n.someProp("domParser")||wa.fromSchema(n.state.schema),f=d.resolve(s),p=null,m=h.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:o,to:i,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:HD,context:f});if(c&&c[0].pos!=null){let v=c[0].pos,g=c[1]&&c[1].pos;g==null&&(g=v),p={anchor:v+s,head:g+s}}return{doc:m,sel:p,from:s,to:a}}function HD(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Ht&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Ht&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const FD=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function BD(n,e,t,r,o){let i=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let k=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,M=yg(n,k);if(M&&!n.state.selection.eq(M)){if(Nt&&Ir&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",q=>q(n,Fo(13,"Enter"))))return;let O=n.state.tr.setSelection(M);k=="pointer"?O.setMeta("pointer",!0):k=="key"&&O.scrollIntoView(),i&&O.setMeta("composition",i),n.dispatch(O)}return}let s=n.state.doc.resolve(e),a=s.sharedDepth(t);e=s.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=UD(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),h,f;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(h=n.state.selection.to,f="end"):(h=n.state.selection.from,f="start"),n.input.lastKeyCode=null;let p=jD(d.content,c.doc.content,c.from,h,f);if(p&&n.input.domChangeCount++,(ws&&n.input.lastIOSEnter>Date.now()-225||Ir)&&o.some(k=>k.nodeType==1&&!FD.test(k.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",k=>k(n,Fo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof Y&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let k=_C(n,n.state.doc,c.sel);if(k&&!k.eq(n.state.selection)){let M=n.state.tr.setSelection(k);i&&M.setMeta("composition",i),n.dispatch(M)}}return}n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof Y&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Zt&&So<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)=="  "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),v=c.doc.resolveNoCache(p.endB-c.from),g=u.resolve(p.start),y=m.sameParent(v)&&m.parent.inlineContent&&g.end()>=p.endA,C;if((ws&&n.input.lastIOSEnter>Date.now()-225&&(!y||o.some(k=>k.nodeName=="DIV"||k.nodeName=="P"))||!y&&m.pos<c.doc.content.size&&(!m.sameParent(v)||!m.parent.inlineContent)&&!/\S/.test(c.doc.textBetween(m.pos,v.pos,"",""))&&(C=ee.findFrom(c.doc.resolve(m.pos+1),1,!0))&&C.head>m.pos)&&n.someProp("handleKeyDown",k=>k(n,Fo(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&KD(u,p.start,p.endA,m,v)&&n.someProp("handleKeyDown",k=>k(n,Fo(8,"Backspace")))){Ir&&Nt&&n.domObserver.suppressSelectionUpdates();return}Nt&&p.endB==p.start&&(n.input.lastChromeDelete=Date.now()),Ir&&!y&&m.start()!=v.start()&&v.parentOffset==0&&m.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,v=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(k){return k(n,Fo(13,"Enter"))})},20));let w=p.start,I=p.endA,A=k=>{let M=k||n.state.tr.replace(w,I,c.doc.slice(p.start-c.from,p.endB-c.from));if(c.sel){let O=_C(n,M.doc,c.sel);O&&!(Nt&&n.composing&&O.empty&&(p.start!=p.endB||n.input.lastChromeDelete<Date.now()-100)&&(O.head==w||O.head==M.mapping.map(I)-1)||Zt&&O.empty&&O.head==w)&&M.setSelection(O)}return i&&M.setMeta("composition",i),M.scrollIntoView()},R;if(y){if(m.pos==v.pos){Zt&&So<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Nr(n),20));let k=A(n.state.tr.delete(w,I)),M=u.resolve(p.start).marksAcross(u.resolve(p.endA));M&&k.ensureMarks(M),n.dispatch(k)}else if(p.endA==p.endB&&(R=zD(m.parent.content.cut(m.parentOffset,v.parentOffset),g.parent.content.cut(g.parentOffset,p.endA-g.start())))){let k=A(n.state.tr);R.type=="add"?k.addMark(w,I,R.mark):k.removeMark(w,I,R.mark),n.dispatch(k)}else if(m.parent.child(m.index()).isText&&m.index()==v.index()-(v.textOffset?0:1)){let k=m.parent.textBetween(m.parentOffset,v.parentOffset),M=()=>A(n.state.tr.insertText(k,w,I));n.someProp("handleTextInput",O=>O(n,w,I,k,M))||n.dispatch(M())}}else n.dispatch(A())}function _C(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:vg(n,e.resolve(t.anchor),e.resolve(t.head))}function zD(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,o=t,i=r,s,a,l;for(let u=0;u<r.length;u++)o=r[u].removeFromSet(o);for(let u=0;u<t.length;u++)i=t[u].removeFromSet(i);if(o.length==1&&i.length==0)a=o[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(o.length==0&&i.length==1)a=i[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(N.from(c).eq(n))return{mark:a,type:s}}function KD(n,e,t,r,o){if(t-e<=o.pos-r.pos||Ih(r,!0,!1)<o.pos)return!1;let i=n.resolve(e);if(!r.parent.isTextblock){let a=i.nodeAfter;return a!=null&&t==e+a.nodeSize}if(i.parentOffset<i.parent.content.size||!i.parent.isTextblock)return!1;let s=n.resolve(Ih(i,!0,!0));return!s.parent.isTextblock||s.pos>t||Ih(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function Ih(n,e,t){let r=n.depth,o=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,o++,e=!1;if(t){let i=n.node(r).maybeChild(n.indexAfter(r));for(;i&&!i.isLeaf;)i=i.firstChild,o++}return o}function jD(n,e,t,r,o){let i=n.findDiffStart(e,t);if(i==null)return null;let{a:s,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(o=="end"){let l=Math.max(0,i-Math.min(s,a));r-=s+l-i}if(s<i&&n.size<e.size){let l=r<=i&&r>=s?i-r:0;i-=l,i&&i<e.size&&PC(e.textBetween(i-1,i+1))&&(i+=l?1:-1),a=i+(a-s),s=i}else if(a<i){let l=r<=i&&r>=a?i-r:0;i-=l,i&&i<n.size&&PC(n.textBetween(i-1,i+1))&&(i+=l?1:-1),s=i+(s-a),a=i}return{start:i,endA:s,endB:a}}function PC(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class tA{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new lD,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(FC),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=UC(this),LC(this),this.nodeViews=HC(this),this.docView=mC(this.state.doc,DC(this),kh(this),this.dom,this),this.domObserver=new _D(this,(r,o,i,s)=>BD(this,r,o,i,s)),this.domObserver.start(),cD(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&mp(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(FC),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let o=this.state,i=!1,s=!1;e.storedMarks&&this.composing&&(GI(this),s=!0),this.state=e;let a=o.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let f=HC(this);VD(f,this.nodeViews)&&(this.nodeViews=f,i=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&mp(this),this.editable=UC(this),LC(this);let l=kh(this),c=DC(this),u=o.plugins!=e.plugins&&!o.doc.eq(e.doc)?"reset":e.scrollToSelection>o.scrollToSelection?"to selection":"preserve",d=i||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(o.selection))&&(s=!0);let h=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&EP(this);if(s){this.domObserver.stop();let f=d&&(Zt||Nt)&&!this.composing&&!o.selection.empty&&!e.selection.empty&&$D(o.selection,e.selection);if(d){let p=Nt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=TD(this)),(i||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=mC(e.doc,c,l,this.dom,this)),p&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&qP(this))?Nr(this,f):(LI(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(o),!((r=this.dragging)===null||r===void 0)&&r.node&&!o.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,o),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&kP(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof W){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&cC(this,t.getBoundingClientRect(),e)}else cC(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,o=-1;if(this.state.doc.nodeAt(r.from)==r.node)o=r.from;else{let i=r.from+(this.state.doc.content.size-t.doc.content.size);(i>0&&this.state.doc.nodeAt(i))==r.node&&(o=i)}this.dragging=new YI(e.slice,e.move,o<0?void 0:W.create(this.state.doc,o))}someProp(e,t){let r=this._props&&this._props[e],o;if(r!=null&&(o=t?t(r):r))return o;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(o=t?t(a):a))return o}let i=this.state.plugins;if(i)for(let s=0;s<i.length;s++){let a=i[s].props[e];if(a!=null&&(o=t?t(a):a))return o}}hasFocus(){if(Zt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&IP(this.dom),Nr(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return xP(this,e)}coordsAtPos(e,t=1){return RI(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let o=this.docView.posFromDOM(e,t,r);if(o==null)throw new RangeError("DOM position not inside the editor");return o}endOfTextblock(e,t){return DP(this,t||this.state,e)}pasteHTML(e,t){return Xa(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Xa(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return Cg(this,e)}destroy(){this.docView&&(uD(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],kh(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,hP())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return hD(this,e)}domSelectionRange(){let e=this.domSelection();return e?Ht&&this.root.nodeType===11&&yP(this.dom.ownerDocument)==this.dom&&DD(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}tA.prototype.dispatch=function(n){let e=this._props.dispatchTransaction;e?e.call(this,n):this.updateState(this.state.apply(n))};function DC(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[pn.node(0,n.state.doc.content.size,e)]}function LC(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:pn.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function UC(n){return!n.someProp("editable",e=>e(n.state)===!1)}function $D(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function HC(n){let e=Object.create(null);function t(r){for(let o in r)Object.prototype.hasOwnProperty.call(e,o)||(e[o]=r[o])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function VD(n,e){let t=0,r=0;for(let o in n){if(n[o]!=e[o])return!0;t++}for(let o in e)r++;return t!=r}function FC(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ao={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},Eu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},WD=typeof navigator<"u"&&/Mac/.test(navigator.platform),qD=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var St=0;St<10;St++)Ao[48+St]=Ao[96+St]=String(St);for(var St=1;St<=24;St++)Ao[St+111]="F"+St;for(var St=65;St<=90;St++)Ao[St]=String.fromCharCode(St+32),Eu[St]=String.fromCharCode(St);for(var Ah in Ao)Eu.hasOwnProperty(Ah)||(Eu[Ah]=Ao[Ah]);function GD(n){var e=WD&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||qD&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?Eu:Ao)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const QD=typeof navigator<"u"&&/Mac|iP(hone|[oa]d)/.test(navigator.platform),YD=typeof navigator<"u"&&/Win/.test(navigator.platform);function JD(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,o,i,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))QD?s=!0:o=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),o&&(t="Ctrl-"+t),s&&(t="Meta-"+t),i&&(t="Shift-"+t),t}function XD(n){let e=Object.create(null);for(let t in n)e[JD(t)]=n[t];return e}function bh(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function ZD(n){return new Vt({props:{handleKeyDown:nA(n)}})}function nA(n){let e=XD(n);return function(t,r){let o=GD(r),i,s=e[bh(o,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(o.length==1&&o!=" "){if(r.shiftKey){let a=e[bh(o,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.altKey||r.metaKey||r.ctrlKey)&&!(YD&&r.ctrlKey&&r.altKey)&&(i=Ao[r.keyCode])&&i!=o){let a=e[bh(i,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const Ig=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function rA(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const oA=(n,e,t)=>{let r=rA(n,t);if(!r)return!1;let o=Ag(r);if(!o){let s=r.blockRange(),a=s&&_s(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let i=o.nodeBefore;if(fA(n,o,e,-1))return!0;if(r.parent.content.size==0&&(Ts(i,"end")||W.isSelectable(i)))for(let s=r.depth;;s--){let a=dd(n.doc,r.before(s),r.after(s),U.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Ts(i,"end")?ee.findFrom(l.doc.resolve(l.mapping.map(o.pos,-1)),-1):W.create(l.doc,o.pos-i.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return i.isAtom&&o.depth==r.depth-1?(e&&e(n.tr.delete(o.pos-i.nodeSize,o.pos).scrollIntoView()),!0):!1},eL=(n,e,t)=>{let r=rA(n,t);if(!r)return!1;let o=Ag(r);return o?iA(n,o,e):!1},tL=(n,e,t)=>{let r=aA(n,t);if(!r)return!1;let o=bg(r);return o?iA(n,o,e):!1};function iA(n,e,t){let r=e.nodeBefore,o=r,i=e.pos-1;for(;!o.isTextblock;i--){if(o.type.spec.isolating)return!1;let u=o.lastChild;if(!u)return!1;o=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=dd(n.doc,i,l,U.empty);if(!c||c.from!=i||c instanceof ct&&c.slice.size>=l-i)return!1;if(t){let u=n.tr.step(c);u.setSelection(Y.create(u.doc,i)),t(u.scrollIntoView())}return!0}function Ts(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const sA=(n,e,t)=>{let{$head:r,empty:o}=n.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;i=Ag(r)}let s=i&&i.nodeBefore;return!s||!W.isSelectable(s)?!1:(e&&e(n.tr.setSelection(W.create(n.doc,i.pos-s.nodeSize)).scrollIntoView()),!0)};function Ag(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function aA(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const lA=(n,e,t)=>{let r=aA(n,t);if(!r)return!1;let o=bg(r);if(!o)return!1;let i=o.nodeAfter;if(fA(n,o,e,1))return!0;if(r.parent.content.size==0&&(Ts(i,"start")||W.isSelectable(i))){let s=dd(n.doc,r.before(),r.after(),U.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(Ts(i,"start")?ee.findFrom(a.doc.resolve(a.mapping.map(o.pos)),1):W.create(a.doc,a.mapping.map(o.pos))),e(a.scrollIntoView())}return!0}}return i.isAtom&&o.depth==r.depth-1?(e&&e(n.tr.delete(o.pos,o.pos+i.nodeSize).scrollIntoView()),!0):!1},cA=(n,e,t)=>{let{$head:r,empty:o}=n.selection,i=r;if(!o)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;i=bg(r)}let s=i&&i.nodeAfter;return!s||!W.isSelectable(s)?!1:(e&&e(n.tr.setSelection(W.create(n.doc,i.pos)).scrollIntoView()),!0)};function bg(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const nL=(n,e)=>{let t=n.selection,r=t instanceof W,o;if(r){if(t.node.isTextblock||!Oo(n.doc,t.from))return!1;o=t.from}else if(o=ud(n.doc,t.from,-1),o==null)return!1;if(e){let i=n.tr.join(o);r&&i.setSelection(W.create(i.doc,o-n.doc.resolve(o).nodeBefore.nodeSize)),e(i.scrollIntoView())}return!0},rL=(n,e)=>{let t=n.selection,r;if(t instanceof W){if(t.node.isTextblock||!Oo(n.doc,t.to))return!1;r=t.to}else if(r=ud(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},oL=(n,e)=>{let{$from:t,$to:r}=n.selection,o=t.blockRange(r),i=o&&_s(o);return i==null?!1:(e&&e(n.tr.lift(o,i).scrollIntoView()),!0)},uA=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function Rg(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const iL=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let o=t.node(-1),i=t.indexAfter(-1),s=Rg(o.contentMatchAt(i));if(!s||!o.canReplaceWith(i,i,s))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(ee.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},dA=(n,e)=>{let t=n.selection,{$from:r,$to:o}=t;if(t instanceof gn||r.parent.inlineContent||o.parent.inlineContent)return!1;let i=Rg(o.parent.contentMatchAt(o.indexAfter()));if(!i||!i.isTextblock)return!1;if(e){let s=(!r.parentOffset&&o.index()<o.parent.childCount?r:o).pos,a=n.tr.insert(s,i.createAndFill());a.setSelection(Y.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},hA=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let i=t.before();if(Rr(n.doc,i))return e&&e(n.tr.split(i).scrollIntoView()),!0}let r=t.blockRange(),o=r&&_s(r);return o==null?!1:(e&&e(n.tr.lift(r,o).scrollIntoView()),!0)};function sL(n){return(e,t)=>{let{$from:r,$to:o}=e.selection;if(e.selection instanceof W&&e.selection.node.isBlock)return!r.parentOffset||!Rr(e.doc,r.pos)?!1:(t&&t(e.tr.split(r.pos).scrollIntoView()),!0);if(!r.depth)return!1;let i=[],s,a,l=!1,c=!1;for(let f=r.depth;;f--)if(r.node(f).isBlock){l=r.end(f)==r.pos+(r.depth-f),c=r.start(f)==r.pos-(r.depth-f),a=Rg(r.node(f-1).contentMatchAt(r.indexAfter(f-1))),i.unshift(l&&a?{type:a}:null),s=f;break}else{if(f==1)return!1;i.unshift(null)}let u=e.tr;(e.selection instanceof Y||e.selection instanceof gn)&&u.deleteSelection();let d=u.mapping.map(r.pos),h=Rr(u.doc,d,i.length,i);if(h||(i[0]=a?{type:a}:null,h=Rr(u.doc,d,i.length,i)),!h)return!1;if(u.split(d,i.length,i),!l&&c&&r.node(s).type!=a){let f=u.mapping.map(r.before(s)),p=u.doc.resolve(f);a&&r.node(s-1).canReplaceWith(p.index(),p.index()+1,a)&&u.setNodeMarkup(u.mapping.map(r.before(s)),a)}return t&&t(u.scrollIntoView()),!0}}const aL=sL(),lL=(n,e)=>{let{$from:t,to:r}=n.selection,o,i=t.sharedDepth(r);return i==0?!1:(o=t.before(i),e&&e(n.tr.setSelection(W.create(n.doc,o))),!0)};function cL(n,e,t){let r=e.nodeBefore,o=e.nodeAfter,i=e.index();return!r||!o||!r.type.compatibleContent(o.type)?!1:!r.content.size&&e.parent.canReplace(i-1,i)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(i,i+1)||!(o.isTextblock||Oo(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function fA(n,e,t,r){let o=e.nodeBefore,i=e.nodeAfter,s,a,l=o.type.spec.isolating||i.type.spec.isolating;if(!l&&cL(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=o.contentMatchAt(o.childCount)).findWrapping(i.type))&&a.matchType(s[0]||i.type).validEnd){if(t){let f=e.pos+i.nodeSize,p=N.empty;for(let g=s.length-1;g>=0;g--)p=N.from(s[g].create(null,p));p=N.from(o.copy(p));let m=n.tr.step(new dt(e.pos-1,f,e.pos,f,new U(p,1,0),s.length,!0)),v=m.doc.resolve(f+2*s.length);v.nodeAfter&&v.nodeAfter.type==o.type&&Oo(m.doc,v.pos)&&m.join(v.pos),t(m.scrollIntoView())}return!0}let u=i.type.spec.isolating||r>0&&l?null:ee.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),h=d&&_s(d);if(h!=null&&h>=e.depth)return t&&t(n.tr.lift(d,h).scrollIntoView()),!0;if(c&&Ts(i,"start",!0)&&Ts(o,"end")){let f=o,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let m=i,v=1;for(;!m.isTextblock;m=m.firstChild)v++;if(f.canReplace(f.childCount,f.childCount,m.content)){if(t){let g=N.empty;for(let C=p.length-1;C>=0;C--)g=N.from(p[C].copy(g));let y=n.tr.step(new dt(e.pos-p.length,e.pos+i.nodeSize,e.pos+v,e.pos+i.nodeSize-v,new U(g,p.length,0),0,!0));t(y.scrollIntoView())}return!0}}return!1}function pA(n){return function(e,t){let r=e.selection,o=n<0?r.$from:r.$to,i=o.depth;for(;o.node(i).isInline;){if(!i)return!1;i--}return o.node(i).isTextblock?(t&&t(e.tr.setSelection(Y.create(e.doc,n<0?o.start(i):o.end(i)))),!0):!1}}const uL=pA(-1),dL=pA(1);function hL(n,e=null){return function(t,r){let{$from:o,$to:i}=t.selection,s=o.blockRange(i),a=s&&pg(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function BC(n,e=null){return function(t,r){let o=!1;for(let i=0;i<t.selection.ranges.length&&!o;i++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[i];t.doc.nodesBetween(s,a,(l,c)=>{if(o)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)o=!0;else{let u=t.doc.resolve(c),d=u.index();o=u.parent.canReplaceWith(d,d+1,n)}})}if(!o)return!1;if(r){let i=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[s];i.setBlockType(a,l,n,e)}r(i.scrollIntoView())}return!0}}function Ng(...n){return function(e,t,r){for(let o=0;o<n.length;o++)if(n[o](e,t,r))return!0;return!1}}Ng(Ig,oA,sA);Ng(Ig,lA,cA);Ng(uA,dA,hA,aL);typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function fL(n,e=null){return function(t,r){let{$from:o,$to:i}=t.selection,s=o.blockRange(i);if(!s)return!1;let a=r?t.tr:null;return pL(a,s,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function pL(n,e,t,r=null){let o=!1,i=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);i=new gu(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new gu(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),o=!0}let a=pg(i,t,r,e);return a?(n&&mL(n,e,a,o,t),!0):!1}function mL(n,e,t,r,o){let i=N.empty;for(let u=t.length-1;u>=0;u--)i=N.from(t[u].type.create(t[u].attrs,i));n.step(new dt(e.start-(r?2:0),e.end,e.start,e.end,new U(i,0,0),t.length,!0));let s=0;for(let u=0;u<t.length;u++)t[u].type==o&&(s=u+1);let a=t.length-s,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&Rr(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function gL(n){return function(e,t){let{$from:r,$to:o}=e.selection,i=r.blockRange(o,s=>s.childCount>0&&s.firstChild.type==n);return i?t?r.node(i.depth-1).type==n?yL(e,t,n,i):vL(e,t,i):!0:!1}}function yL(n,e,t,r){let o=n.tr,i=r.end,s=r.$to.end(r.depth);i<s&&(o.step(new dt(i-1,s,i,s,new U(N.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new gu(o.doc.resolve(r.$from.pos),o.doc.resolve(s),r.depth));const a=_s(r);if(a==null)return!1;o.lift(r,a);let l=o.doc.resolve(o.mapping.map(i,-1)-1);return Oo(o.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&o.join(l.pos),e(o.scrollIntoView()),!0}function vL(n,e,t){let r=n.tr,o=t.parent;for(let f=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)f-=o.child(p).nodeSize,r.delete(f-1,f+1);let i=r.doc.resolve(t.start),s=i.nodeAfter;if(r.mapping.map(t.end)!=t.start+i.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==o.childCount,c=i.node(-1),u=i.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?N.empty:N.from(o))))return!1;let d=i.pos,h=d+s.nodeSize;return r.step(new dt(d-(a?1:0),h+(l?1:0),d+1,h-1,new U((a?N.empty:N.from(o.copy(N.empty))).append(l?N.empty:N.from(o.copy(N.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function CL(n){return function(e,t){let{$from:r,$to:o}=e.selection,i=r.blockRange(o,c=>c.childCount>0&&c.firstChild.type==n);if(!i)return!1;let s=i.startIndex;if(s==0)return!1;let a=i.parent,l=a.child(s-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=N.from(c?n.create():null),d=new U(N.from(n.create(null,N.from(a.type.create(null,u)))),c?3:1,0),h=i.start,f=i.end;t(e.tr.step(new dt(h-(c?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function gd(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:o}=t,{storedMarks:i}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return i},get selection(){return r},get doc(){return o},get tr(){return r=t.selection,o=t.doc,i=t.storedMarks,t}}}class yd{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:o}=t,{tr:i}=r,s=this.buildProps(i);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(s);return!i.getMeta("preventDispatch")&&!this.hasCustomState&&o.dispatch(i),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:o,state:i}=this,{view:s}=o,a=[],l=!!e,c=e||i.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,f])=>[h,(...m)=>{const v=this.buildProps(c,t),g=f(...m)(v);return a.push(g),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,o=!1,i=e||r.tr,s=this.buildProps(i,o);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(i,o)}}buildProps(e,t=!0){const{rawCommands:r,editor:o,state:i}=this,{view:s}=o,a={tr:e,editor:o,view:s,state:gd({state:i,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class SL{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(o=>o.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(o=>o!==t):delete this.callbacks[e]),this}once(e,t){const r=(...o)=>{this.off(e,r),t.apply(this,o)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function K(n,e,t){return n.config[e]===void 0&&n.parent?K(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?K(n.parent,e,t):null}):n.config[e]}function vd(n){const e=n.filter(o=>o.type==="extension"),t=n.filter(o=>o.type==="node"),r=n.filter(o=>o.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function mA(n){const e=[],{nodeExtensions:t,markExtensions:r}=vd(n),o=[...t,...r],i={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:o},l=K(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,f])=>{e.push({type:d,name:h,attribute:{...i,...f}})})})})}),o.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=K(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...i,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:s.name,name:u,attribute:h})})}),e}function ft(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function zt(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([o,i])=>{if(!r[o]){r[o]=i;return}if(o==="class"){const a=i?String(i).split(" "):[],l=r[o]?r[o].split(" "):[],c=a.filter(u=>!l.includes(u));r[o]=[...l,...c].join(" ")}else if(o==="style"){const a=i?i.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[o]?r[o].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),a.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),r[o]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[o]=i}),r},{})}function gp(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>zt(t,r),{})}function gA(n){return typeof n=="function"}function oe(n,e=void 0,...t){return gA(n)?e?n.bind(e)(...t):n(...t):n}function wL(n={}){return Object.keys(n).length===0&&n.constructor===Object}function TL(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function zC(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const o=e.reduce((i,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(t):TL(t.getAttribute(s.name));return a==null?i:{...i,[s.name]:a}},{});return{...r,...o}}}}function KC(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&wL(t)?!1:t!=null))}function EL(n,e){var t;const r=mA(n),{nodeExtensions:o,markExtensions:i}=vd(n),s=(t=o.find(c=>K(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(o.map(c=>{const u=r.filter(g=>g.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((g,y)=>{const C=K(y,"extendNodeSchema",d);return{...g,...C?C(c):{}}},{}),f=KC({...h,content:oe(K(c,"content",d)),marks:oe(K(c,"marks",d)),group:oe(K(c,"group",d)),inline:oe(K(c,"inline",d)),atom:oe(K(c,"atom",d)),selectable:oe(K(c,"selectable",d)),draggable:oe(K(c,"draggable",d)),code:oe(K(c,"code",d)),whitespace:oe(K(c,"whitespace",d)),linebreakReplacement:oe(K(c,"linebreakReplacement",d)),defining:oe(K(c,"defining",d)),isolating:oe(K(c,"isolating",d)),attrs:Object.fromEntries(u.map(g=>{var y;return[g.name,{default:(y=g==null?void 0:g.attribute)===null||y===void 0?void 0:y.default}]}))}),p=oe(K(c,"parseHTML",d));p&&(f.parseDOM=p.map(g=>zC(g,u)));const m=K(c,"renderHTML",d);m&&(f.toDOM=g=>m({node:g,HTMLAttributes:gp(g,u)}));const v=K(c,"renderText",d);return v&&(f.toText=v),[c.name,f]})),l=Object.fromEntries(i.map(c=>{const u=r.filter(v=>v.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((v,g)=>{const y=K(g,"extendMarkSchema",d);return{...v,...y?y(c):{}}},{}),f=KC({...h,inclusive:oe(K(c,"inclusive",d)),excludes:oe(K(c,"excludes",d)),group:oe(K(c,"group",d)),spanning:oe(K(c,"spanning",d)),code:oe(K(c,"code",d)),attrs:Object.fromEntries(u.map(v=>{var g;return[v.name,{default:(g=v==null?void 0:v.attribute)===null||g===void 0?void 0:g.default}]}))}),p=oe(K(c,"parseHTML",d));p&&(f.parseDOM=p.map(v=>zC(v,u)));const m=K(c,"renderHTML",d);return m&&(f.toDOM=v=>m({mark:v,HTMLAttributes:gp(v,u)})),[c.name,f]}));return new oI({topNode:s,nodes:a,marks:l})}function Rh(n,e){return e.nodes[n]||e.marks[n]||null}function jC(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function xg(n,e){const t=Si.fromSchema(e).serializeFragment(n),o=document.implementation.createHTMLDocument().createElement("div");return o.appendChild(t),o.innerHTML}const kL=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(o,i,s,a)=>{var l,c;const u=((c=(l=o.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:o,pos:i,parent:s,index:a}))||o.textContent||"%leaf%";t+=o.isAtom&&!o.isText?u:u.slice(0,Math.max(0,r-i))}),t};function Og(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class Cd{constructor(e){this.find=e.find,this.handler=e.handler}}const IL=(n,e)=>{if(Og(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function Xl(n){var e;const{editor:t,from:r,to:o,text:i,rules:s,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=kL(c)+i;return s.forEach(h=>{if(u)return;const f=IL(d,h.find);if(!f)return;const p=l.state.tr,m=gd({state:l.state,transaction:p}),v={from:r-(f[0].length-i.length),to:o},{commands:g,chain:y,can:C}=new yd({editor:t,state:m});h.handler({state:m,range:v,match:f,commands:g,chain:y,can:C})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:o,text:i}),l.dispatch(p),u=!0)}),u}function AL(n){const{editor:e,rules:t}=n,r=new Vt({state:{init(){return null},apply(o,i,s){const a=o.getMeta(r);if(a)return a;const l=o.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=xg(N.from(u),s.schema);const{from:d}=l,h=d+u.length;Xl({editor:e,from:d,to:h,text:u,rules:t,plugin:r})}),o.selectionSet||o.docChanged?null:i}},props:{handleTextInput(o,i,s,a){return Xl({editor:e,from:i,to:s,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:o=>(setTimeout(()=>{const{$cursor:i}=o.state.selection;i&&Xl({editor:e,from:i.pos,to:i.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(o,i){if(i.key!=="Enter")return!1;const{$cursor:s}=o.state.selection;return s?Xl({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function bL(n){return Object.prototype.toString.call(n).slice(8,-1)}function Zl(n){return bL(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function Sd(n,e){const t={...n};return Zl(n)&&Zl(e)&&Object.keys(e).forEach(r=>{Zl(e[r])&&Zl(n[r])?t[r]=Sd(n[r],e[r]):t[r]=e[r]}),t}class bo{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=oe(K(this,"addOptions",{name:this.name}))),this.storage=oe(K(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new bo(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Sd(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new bo(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=oe(K(t,"addOptions",{name:t.name})),t.storage=oe(K(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,o=e.state.selection.$from;if(o.pos===o.end()){const s=o.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",o.pos),e.view.dispatch(r),!0}return!1}}function RL(n){return typeof n=="number"}class NL{constructor(e){this.find=e.find,this.handler=e.handler}}const xL=(n,e,t)=>{if(Og(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(o=>{const i=[o.text];return i.index=o.index,i.input=n,i.data=o.data,o.replaceWith&&(o.text.includes(o.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),i.push(o.replaceWith)),i}):[]};function OL(n){const{editor:e,state:t,from:r,to:o,rule:i,pasteEvent:s,dropEvent:a}=n,{commands:l,chain:c,can:u}=new yd({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,o,(f,p)=>{if(!f.isTextblock||f.type.spec.code)return;const m=Math.max(r,p),v=Math.min(o,p+f.content.size),g=f.textBetween(m-p,v-p,void 0,"￼");xL(g,i.find,s).forEach(C=>{if(C.index===void 0)return;const w=m+C.index+1,I=w+C[0].length,A={from:t.tr.mapping.map(w),to:t.tr.mapping.map(I)},R=i.handler({state:t,range:A,match:C,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(R)})}),d.every(f=>f!==null)}let ec=null;const ML=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function _L(n){const{editor:e,rules:t}=n;let r=null,o=!1,i=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:h,rule:f,pasteEvt:p})=>{const m=u.tr,v=gd({state:u,transaction:m});if(!(!OL({editor:e,state:v,from:Math.max(d-1,0),to:h.b-1,rule:f,pasteEvent:p,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return t.map(u=>new Vt({view(d){const h=p=>{var m;r=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?d.dom.parentElement:null,r&&(ec=e)},f=()=>{ec&&(ec=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(i=r===d.dom.parentElement,a=h,!i){const f=ec;f&&setTimeout(()=>{const p=f.state.selection;p&&f.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,h)=>{var f;const p=(f=h.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return s=h,o=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,f)=>{const p=d[0],m=p.getMeta("uiEvent")==="paste"&&!o,v=p.getMeta("uiEvent")==="drop"&&!i,g=p.getMeta("applyPasteRules"),y=!!g;if(!m&&!v&&!y)return;if(y){let{text:I}=g;typeof I=="string"?I=I:I=xg(N.from(I),f.schema);const{from:A}=g,R=A+I.length,k=ML(I);return l({rule:u,state:f,from:A,to:{b:R},pasteEvt:k})}const C=h.doc.content.findDiffStart(f.doc.content),w=h.doc.content.findDiffEnd(f.doc.content);if(!(!RL(C)||!w||C===w.b))return l({rule:u,state:f,from:C,to:w,pasteEvt:s})}}))}function PL(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class Gi{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Gi.resolve(e),this.schema=EL(this.extensions,t),this.setupExtensions()}static resolve(e){const t=Gi.sort(Gi.flatten(e)),r=PL(t.map(o=>o.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(o=>`'${o}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},o=K(t,"addExtensions",r);return o?[t,...this.flatten(o())]:t}).flat(10)}static sort(e){return e.sort((r,o)=>{const i=K(r,"priority")||100,s=K(o,"priority")||100;return i>s?-1:i<s?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:Rh(t.name,this.schema)},o=K(t,"addCommands",r);return o?{...e,...o()}:e},{})}get plugins(){const{editor:e}=this,t=Gi.sort([...this.extensions].reverse()),r=[],o=[],i=t.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:Rh(s.name,this.schema)},l=[],c=K(s,"addKeyboardShortcuts",a);let u={};if(s.type==="mark"&&K(s,"exitable",a)&&(u.ArrowRight=()=>bo.handleExit({editor:e,mark:s})),c){const m=Object.fromEntries(Object.entries(c()).map(([v,g])=>[v,()=>g({editor:e})]));u={...u,...m}}const d=ZD(u);l.push(d);const h=K(s,"addInputRules",a);jC(s,e.options.enableInputRules)&&h&&r.push(...h());const f=K(s,"addPasteRules",a);jC(s,e.options.enablePasteRules)&&f&&o.push(...f());const p=K(s,"addProseMirrorPlugins",a);if(p){const m=p();l.push(...m)}return l}).flat();return[AL({editor:e,rules:r}),..._L({editor:e,rules:o}),...i]}get attributes(){return mA(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=vd(this.extensions);return Object.fromEntries(t.filter(r=>!!K(r,"addNodeView")).map(r=>{const o=this.attributes.filter(l=>l.type===r.name),i={name:r.name,options:r.options,storage:r.storage,editor:e,type:ft(r.name,this.schema)},s=K(r,"addNodeView",i);if(!s)return[];const a=(l,c,u,d,h)=>{const f=gp(l,o);return s()({node:l,view:c,getPos:u,decorations:d,innerDecorations:h,editor:e,extension:r,HTMLAttributes:f})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:Rh(e.name,this.schema)};e.type==="mark"&&(!((t=oe(K(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const o=K(e,"onBeforeCreate",r),i=K(e,"onCreate",r),s=K(e,"onUpdate",r),a=K(e,"onSelectionUpdate",r),l=K(e,"onTransaction",r),c=K(e,"onFocus",r),u=K(e,"onBlur",r),d=K(e,"onDestroy",r);o&&this.editor.on("beforeCreate",o),i&&this.editor.on("create",i),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class Ot{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=oe(K(this,"addOptions",{name:this.name}))),this.storage=oe(K(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Ot(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Sd(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Ot({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=oe(K(t,"addOptions",{name:t.name})),t.storage=oe(K(t,"addStorage",{name:t.name,options:t.options})),t}}function yA(n,e,t){const{from:r,to:o}=e,{blockSeparator:i=`

`,textSerializers:s={}}=t||{};let a="";return n.nodesBetween(r,o,(l,c,u,d)=>{var h;l.isBlock&&c>r&&(a+=i);const f=s==null?void 0:s[l.type.name];if(f)return u&&(a+=f({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,o-c))}),a}function vA(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const DL=Ot.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new Vt({key:new Gn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:o}=e,{ranges:i}=o,s=Math.min(...i.map(u=>u.$from.pos)),a=Math.max(...i.map(u=>u.$to.pos)),l=vA(t);return yA(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),LL=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),UL=(n=!1)=>({commands:e})=>e.setContent("",n),HL=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:o}=r;return t&&o.forEach(({$from:i,$to:s})=>{n.doc.nodesBetween(i.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),f=d.blockRange(h);if(!f)return;const p=_s(f);if(a.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(f.start,m)}(p||p===0)&&e.lift(f,p)})}),!0},FL=n=>e=>n(e),BL=()=>({state:n,dispatch:e})=>dA(n,e),zL=(n,e)=>({editor:t,tr:r})=>{const{state:o}=t,i=o.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,i.content),r.setSelection(new Y(r.doc.resolve(s-1))),!0},KL=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const o=n.selection.$anchor;for(let i=o.depth;i>0;i-=1)if(o.node(i).type===r.type){if(e){const a=o.before(i),l=o.after(i);n.delete(a,l).scrollIntoView()}return!0}return!1},jL=n=>({tr:e,state:t,dispatch:r})=>{const o=ft(n,t.schema),i=e.selection.$anchor;for(let s=i.depth;s>0;s-=1)if(i.node(s).type===o){if(r){const l=i.before(s),c=i.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},$L=n=>({tr:e,dispatch:t})=>{const{from:r,to:o}=n;return t&&e.delete(r,o),!0},VL=()=>({state:n,dispatch:e})=>Ig(n,e),WL=()=>({commands:n})=>n.keyboardShortcut("Enter"),qL=()=>({state:n,dispatch:e})=>iL(n,e);function ku(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(o=>t.strict?e[o]===n[o]:Og(e[o])?e[o].test(n[o]):e[o]===n[o]):!0}function CA(n,e,t={}){return n.find(r=>r.type===e&&ku(Object.fromEntries(Object.keys(t).map(o=>[o,r.attrs[o]])),t))}function $C(n,e,t={}){return!!CA(n,e,t)}function Mg(n,e,t){var r;if(!n||!e)return;let o=n.parent.childAfter(n.parentOffset);if((!o.node||!o.node.marks.some(u=>u.type===e))&&(o=n.parent.childBefore(n.parentOffset)),!o.node||!o.node.marks.some(u=>u.type===e)||(t=t||((r=o.node.marks[0])===null||r===void 0?void 0:r.attrs),!CA([...o.node.marks],e,t)))return;let s=o.index,a=n.start()+o.offset,l=s+1,c=a+o.node.nodeSize;for(;s>0&&$C([...n.parent.child(s-1).marks],e,t);)s-=1,a-=n.parent.child(s).nodeSize;for(;l<n.parent.childCount&&$C([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function _o(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const GL=(n,e={})=>({tr:t,state:r,dispatch:o})=>{const i=_o(n,r.schema),{doc:s,selection:a}=t,{$from:l,from:c,to:u}=a;if(o){const d=Mg(l,i,e);if(d&&d.from<=c&&d.to>=u){const h=Y.create(s,d.from,d.to);t.setSelection(h)}}return!0},QL=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function SA(n){return n instanceof Y}function qo(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function wA(n,e=null){if(!e)return null;const t=ee.atStart(n),r=ee.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const o=t.from,i=r.to;return e==="all"?Y.create(n,qo(0,o,i),qo(n.content.size,o,i)):Y.create(n,qo(e,o,i),qo(e,o,i))}function YL(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function _g(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const JL=(n=null,e={})=>({editor:t,view:r,tr:o,dispatch:i})=>{e={scrollIntoView:!0,...e};const s=()=>{(_g()||YL())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(i&&n===null&&!SA(t.state.selection))return s(),!0;const a=wA(o.doc,n)||t.state.selection,l=t.state.selection.eq(a);return i&&(l||o.setSelection(a),l&&o.storedMarks&&o.setStoredMarks(o.storedMarks),s()),!0},XL=(n,e)=>t=>n.every((r,o)=>e(r,{...t,index:o})),ZL=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),TA=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&TA(r)}return n};function tc(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return TA(t)}function el(n,e,t){if(n instanceof Co||n instanceof N)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,o=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return N.fromArray(n.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(n);return t.errorOnInvalidContent&&s.check(),s}catch(i){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:i});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",i),el("",e,t)}if(o){if(t.errorOnInvalidContent){let s=!1,a="";const l=new oI({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?wa.fromSchema(l).parseSlice(tc(n),t.parseOptions):wa.fromSchema(l).parse(tc(n),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const i=wa.fromSchema(e);return t.slice?i.parseSlice(tc(n),t.parseOptions).content:i.parse(tc(n),t.parseOptions)}return el("",e,t)}function eU(n,e,t){const r=n.steps.length-1;if(r<e)return;const o=n.steps[r];if(!(o instanceof ct||o instanceof dt))return;const i=n.mapping.maps[r];let s=0;i.forEach((a,l,c,u)=>{s===0&&(s=u)}),n.setSelection(ee.near(n.doc.resolve(s),t))}const tU=n=>!("type"in n),nU=(n,e,t)=>({tr:r,dispatch:o,editor:i})=>{var s;if(o){t={parseOptions:i.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;const l=v=>{i.emit("contentError",{editor:i,error:v,disableCollaboration:()=>{i.storage.collaboration&&(i.storage.collaboration.isDisabled=!0)}})},c={preserveWhitespace:"full",...t.parseOptions};if(!t.errorOnInvalidContent&&!i.options.enableContentCheck&&i.options.emitContentError)try{el(e,i.schema,{parseOptions:c,errorOnInvalidContent:!0})}catch(v){l(v)}try{a=el(e,i.schema,{parseOptions:c,errorOnInvalidContent:(s=t.errorOnInvalidContent)!==null&&s!==void 0?s:i.options.enableContentCheck})}catch(v){return l(v),!1}let{from:u,to:d}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},h=!0,f=!0;if((tU(a)?a:[a]).forEach(v=>{v.check(),h=h?v.isText&&v.marks.length===0:!1,f=f?v.isBlock:!1}),u===d&&f){const{parent:v}=r.doc.resolve(u);v.isTextblock&&!v.type.spec.code&&!v.childCount&&(u-=1,d+=1)}let m;if(h){if(Array.isArray(e))m=e.map(v=>v.text||"").join("");else if(e instanceof N){let v="";e.forEach(g=>{g.text&&(v+=g.text)}),m=v}else typeof e=="object"&&e&&e.text?m=e.text:m=e;r.insertText(m,u,d)}else m=a,r.replaceWith(u,d,m);t.updateSelection&&eU(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:u,text:m}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:u,text:m})}return!0},rU=()=>({state:n,dispatch:e})=>nL(n,e),oU=()=>({state:n,dispatch:e})=>rL(n,e),iU=()=>({state:n,dispatch:e})=>oA(n,e),sU=()=>({state:n,dispatch:e})=>lA(n,e),aU=()=>({state:n,dispatch:e,tr:t})=>{try{const r=ud(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},lU=()=>({state:n,dispatch:e,tr:t})=>{try{const r=ud(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},cU=()=>({state:n,dispatch:e})=>eL(n,e),uU=()=>({state:n,dispatch:e})=>tL(n,e);function EA(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function dU(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,o,i,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))o=!0;else if(/^s(hift)?$/i.test(l))i=!0;else if(/^mod$/i.test(l))_g()||EA()?s=!0:o=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),o&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),i&&(t=`Shift-${t}`),t}const hU=n=>({editor:e,view:t,tr:r,dispatch:o})=>{const i=dU(n).split(/-(?!$)/),s=i.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:i.includes("Alt"),ctrlKey:i.includes("Ctrl"),metaKey:i.includes("Meta"),shiftKey:i.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&o&&r.maybeStep(u)}),!0};function tl(n,e,t={}){const{from:r,to:o,empty:i}=n.selection,s=e?ft(e,n.schema):null,a=[];n.doc.nodesBetween(r,o,(d,h)=>{if(d.isText)return;const f=Math.max(r,h),p=Math.min(o,h+d.nodeSize);a.push({node:d,from:f,to:p})});const l=o-r,c=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>ku(d.node.attrs,t,{strict:!1}));return i?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}const fU=(n,e={})=>({state:t,dispatch:r})=>{const o=ft(n,t.schema);return tl(t,o,e)?oL(t,r):!1},pU=()=>({state:n,dispatch:e})=>hA(n,e),mU=n=>({state:e,dispatch:t})=>{const r=ft(n,e.schema);return gL(r)(e,t)},gU=()=>({state:n,dispatch:e})=>uA(n,e);function wd(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function VC(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,o)=>(t.includes(o)||(r[o]=n[o]),r),{})}const yU=(n,e)=>({tr:t,state:r,dispatch:o})=>{let i=null,s=null;const a=wd(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=ft(n,r.schema)),a==="mark"&&(s=_o(n,r.schema)),o&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{i&&i===c.type&&t.setNodeMarkup(u,void 0,VC(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&t.addMark(u,u+c.nodeSize,s.create(VC(d.attrs,e)))})})}),!0):!1},vU=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),CU=()=>({tr:n,dispatch:e})=>{if(e){const t=new gn(n.doc);n.setSelection(t)}return!0},SU=()=>({state:n,dispatch:e})=>sA(n,e),wU=()=>({state:n,dispatch:e})=>cA(n,e),TU=()=>({state:n,dispatch:e})=>lL(n,e),EU=()=>({state:n,dispatch:e})=>dL(n,e),kU=()=>({state:n,dispatch:e})=>uL(n,e);function yp(n,e,t={},r={}){return el(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const IU=(n,e=!1,t={},r={})=>({editor:o,tr:i,dispatch:s,commands:a})=>{var l,c;const{doc:u}=i;if(t.preserveWhitespace!=="full"){const d=yp(n,o.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:o.options.enableContentCheck});return s&&i.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return s&&i.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:o.options.enableContentCheck})};function kA(n,e){const t=_o(e,n.schema),{from:r,to:o,empty:i}=n.selection,s=[];i?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,o,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function AU(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function bU(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function Pg(n){return e=>bU(e.$from,n)}function RU(n,e){const t={from:0,to:n.content.size};return yA(n,t,e)}function NU(n,e){const t=ft(e,n.schema),{from:r,to:o}=n.selection,i=[];n.doc.nodesBetween(r,o,a=>{i.push(a)});const s=i.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function xU(n,e){const t=wd(typeof e=="string"?e:e.name,n.schema);return t==="node"?NU(n,e):t==="mark"?kA(n,e):{}}function IA(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(o=>{const i=t.resolve(n),s=Mg(i,o.type);s&&r.push({mark:o,...s})}):t.nodesBetween(n,e,(o,i)=>{!o||(o==null?void 0:o.nodeSize)===void 0||r.push(...o.marks.map(s=>({from:i,to:i+o.nodeSize,mark:s})))}),r}function Cc(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const o=n.find(i=>i.type===e&&i.name===r);return o?o.attribute.keepOnSplit:!1}))}function vp(n,e,t={}){const{empty:r,ranges:o}=n.selection,i=e?_o(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>i?i.name===d.type.name:!0).find(d=>ku(d.attrs,t,{strict:!1}));let s=0;const a=[];if(o.forEach(({$from:d,$to:h})=>{const f=d.pos,p=h.pos;n.doc.nodesBetween(f,p,(m,v)=>{if(!m.isText&&!m.marks.length)return;const g=Math.max(f,v),y=Math.min(p,v+m.nodeSize),C=y-g;s+=C,a.push(...m.marks.map(w=>({mark:w,from:g,to:y})))})}),s===0)return!1;const l=a.filter(d=>i?i.name===d.mark.type.name:!0).filter(d=>ku(d.mark.attrs,t,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>i?d.mark.type!==i&&d.mark.type.excludes(i):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=s}function OU(n,e,t={}){if(!e)return tl(n,null,t)||vp(n,null,t);const r=wd(e,n.schema);return r==="node"?tl(n,e,t):r==="mark"?vp(n,e,t):!1}function WC(n,e){const{nodeExtensions:t}=vd(e),r=t.find(s=>s.name===n);if(!r)return!1;const o={name:r.name,options:r.options,storage:r.storage},i=oe(K(r,"group",o));return typeof i!="string"?!1:i.split(" ").includes("list")}function Td(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let o=!0;return n.content.forEach(i=>{o!==!1&&(Td(i,{ignoreWhitespace:t,checkChildren:e})||(o=!1))}),o}return!1}function MU(n){return n instanceof W}function _U(n,e,t){var r;const{selection:o}=e;let i=null;if(SA(o)&&(i=o.$cursor),i){const a=(r=n.storedMarks)!==null&&r!==void 0?r:i.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:s}=o;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const f=!h||h.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=f&&p}return!c}),c})}const PU=(n,e={})=>({tr:t,state:r,dispatch:o})=>{const{selection:i}=t,{empty:s,ranges:a}=i,l=_o(n,r.schema);if(o)if(s){const c=kA(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,f)=>{const p=Math.max(f,u),m=Math.min(f+h.nodeSize,d);h.marks.find(g=>g.type===l)?h.marks.forEach(g=>{l===g.type&&t.addMark(p,m,l.create({...g.attrs,...e}))}):t.addMark(p,m,l.create(e))})});return _U(r,t,l)},DU=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),LU=(n,e={})=>({state:t,dispatch:r,chain:o})=>{const i=ft(n,t.schema);let s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),i.isTextblock?o().command(({commands:a})=>BC(i,{...s,...e})(t)?!0:a.clearNodes()).command(({state:a})=>BC(i,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},UU=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,o=qo(n,0,r.content.size),i=W.create(r,o);e.setSelection(i)}return!0},HU=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:o,to:i}=typeof n=="number"?{from:n,to:n}:n,s=Y.atStart(r).from,a=Y.atEnd(r).to,l=qo(o,s,a),c=qo(i,s,a),u=Y.create(r,l,c);e.setSelection(u)}return!0},FU=n=>({state:e,dispatch:t})=>{const r=ft(n,e.schema);return CL(r)(e,t)};function qC(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(o=>e==null?void 0:e.includes(o.type.name));n.tr.ensureMarks(r)}}const BU=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:o})=>{const{selection:i,doc:s}=e,{$from:a,$to:l}=i,c=o.extensionManager.attributes,u=Cc(c,a.node().type.name,a.node().attrs);if(i instanceof W&&i.node.isBlock)return!a.parentOffset||!Rr(s,a.pos)?!1:(r&&(n&&qC(t,o.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:AU(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&h?[{type:h,attrs:u}]:void 0,p=Rr(e.doc,e.mapping.map(a.pos),1,f);if(!f&&!p&&Rr(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(p=!0,f=h?[{type:h,attrs:u}]:void 0),r){if(p&&(i instanceof Y&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,f),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const m=e.mapping.map(a.before()),v=e.doc.resolve(m);a.node(-1).canReplaceWith(v.index(),v.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}n&&qC(t,o.extensionManager.splittableMarks),e.scrollIntoView()}return p},zU=(n,e={})=>({tr:t,state:r,dispatch:o,editor:i})=>{var s;const a=ft(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=i.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(o){let g=N.empty;const y=l.index(-1)?1:l.index(-2)?2:3;for(let k=l.depth-y;k>=l.depth-3;k-=1)g=N.from(l.node(k).copy(g));const C=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,w={...Cc(h,l.node().type.name,l.node().attrs),...e},I=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(w))||void 0;g=g.append(N.from(a.createAndFill(null,I)||void 0));const A=l.before(l.depth-(y-1));t.replace(A,l.after(-C),new U(g,4-y,0));let R=-1;t.doc.nodesBetween(A,t.doc.content.size,(k,M)=>{if(R>-1)return!1;k.isTextblock&&k.content.size===0&&(R=M+1)}),R>-1&&t.setSelection(Y.near(t.doc.resolve(R))),t.scrollIntoView()}return!0}const f=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,p={...Cc(h,d.type.name,d.attrs),...e},m={...Cc(h,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const v=f?[{type:a,attrs:p},{type:f,attrs:m}]:[{type:a,attrs:p}];if(!Rr(t.doc,l.pos,2))return!1;if(o){const{selection:g,storedMarks:y}=r,{splittableMarks:C}=i.extensionManager,w=y||g.$to.parentOffset&&g.$from.marks();if(t.split(l.pos,2,v).scrollIntoView(),!w||!o)return!0;const I=w.filter(A=>C.includes(A.type.name));t.ensureMarks(I)}return!0},Nh=(n,e)=>{const t=Pg(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const o=n.doc.nodeAt(r);return t.node.type===(o==null?void 0:o.type)&&Oo(n.doc,t.pos)&&n.join(t.pos),!0},xh=(n,e)=>{const t=Pg(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const o=n.doc.nodeAt(r);return t.node.type===(o==null?void 0:o.type)&&Oo(n.doc,r)&&n.join(r),!0},KU=(n,e,t,r={})=>({editor:o,tr:i,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=o.extensionManager,f=ft(n,s.schema),p=ft(e,s.schema),{selection:m,storedMarks:v}=s,{$from:g,$to:y}=m,C=g.blockRange(y),w=v||m.$to.parentOffset&&m.$from.marks();if(!C)return!1;const I=Pg(A=>WC(A.type.name,d))(m);if(C.depth>=1&&I&&C.depth-I.depth<=1){if(I.node.type===f)return c.liftListItem(p);if(WC(I.node.type.name,d)&&f.validContent(I.node.content)&&a)return l().command(()=>(i.setNodeMarkup(I.pos,f),!0)).command(()=>Nh(i,f)).command(()=>xh(i,f)).run()}return!t||!w||!a?l().command(()=>u().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>Nh(i,f)).command(()=>xh(i,f)).run():l().command(()=>{const A=u().wrapInList(f,r),R=w.filter(k=>h.includes(k.type.name));return i.ensureMarks(R),A?!0:c.clearNodes()}).wrapInList(f,r).command(()=>Nh(i,f)).command(()=>xh(i,f)).run()},jU=(n,e={},t={})=>({state:r,commands:o})=>{const{extendEmptyMarkRange:i=!1}=t,s=_o(n,r.schema);return vp(r,s,e)?o.unsetMark(s,{extendEmptyMarkRange:i}):o.setMark(s,e)},$U=(n,e,t={})=>({state:r,commands:o})=>{const i=ft(n,r.schema),s=ft(e,r.schema),a=tl(r,i,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?o.setNode(s,l):o.setNode(i,{...l,...t})},VU=(n,e={})=>({state:t,commands:r})=>{const o=ft(n,t.schema);return tl(t,o,e)?r.lift(o):r.wrapIn(o,e)},WU=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const o=t[r];let i;if(o.spec.isInputRules&&(i=o.getState(n))){if(e){const s=n.tr,a=i.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(i.text){const l=s.doc.resolve(i.from).marks();s.replaceWith(i.from,i.to,n.schema.text(i.text,l))}else s.delete(i.from,i.to)}return!0}}return!1},qU=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:o}=t;return r||e&&o.forEach(i=>{n.removeMark(i.$from.pos,i.$to.pos)}),!0},GU=(n,e={})=>({tr:t,state:r,dispatch:o})=>{var i;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,l=_o(n,r.schema),{$from:c,empty:u,ranges:d}=a;if(!o)return!0;if(u&&s){let{from:h,to:f}=a;const p=(i=c.marks().find(v=>v.type===l))===null||i===void 0?void 0:i.attrs,m=Mg(c,l,p);m&&(h=m.from,f=m.to),t.removeMark(h,f,l)}else d.forEach(h=>{t.removeMark(h.$from.pos,h.$to.pos,l)});return t.removeStoredMark(l),!0},QU=(n,e={})=>({tr:t,state:r,dispatch:o})=>{let i=null,s=null;const a=wd(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(i=ft(n,r.schema)),a==="mark"&&(s=_o(n,r.schema)),o&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,h,f,p;t.selection.empty?r.doc.nodesBetween(c,u,(m,v)=>{i&&i===m.type&&(f=Math.max(v,c),p=Math.min(v+m.nodeSize,u),d=v,h=m)}):r.doc.nodesBetween(c,u,(m,v)=>{v<c&&i&&i===m.type&&(f=Math.max(v,c),p=Math.min(v+m.nodeSize,u),d=v,h=m),v>=c&&v<=u&&(i&&i===m.type&&t.setNodeMarkup(v,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(g=>{if(s===g.type){const y=Math.max(v,c),C=Math.min(v+m.nodeSize,u);t.addMark(y,C,s.create({...g.attrs,...e}))}}))}),h&&(d!==void 0&&t.setNodeMarkup(d,void 0,{...h.attrs,...e}),s&&h.marks.length&&h.marks.forEach(m=>{s===m.type&&t.addMark(f,p,s.create({...m.attrs,...e}))}))}),!0):!1},YU=(n,e={})=>({state:t,dispatch:r})=>{const o=ft(n,t.schema);return hL(o,e)(t,r)},JU=(n,e={})=>({state:t,dispatch:r})=>{const o=ft(n,t.schema);return fL(o,e)(t,r)};var XU=Object.freeze({__proto__:null,blur:LL,clearContent:UL,clearNodes:HL,command:FL,createParagraphNear:BL,cut:zL,deleteCurrentNode:KL,deleteNode:jL,deleteRange:$L,deleteSelection:VL,enter:WL,exitCode:qL,extendMarkRange:GL,first:QL,focus:JL,forEach:XL,insertContent:ZL,insertContentAt:nU,joinBackward:iU,joinDown:oU,joinForward:sU,joinItemBackward:aU,joinItemForward:lU,joinTextblockBackward:cU,joinTextblockForward:uU,joinUp:rU,keyboardShortcut:hU,lift:fU,liftEmptyBlock:pU,liftListItem:mU,newlineInCode:gU,resetAttributes:yU,scrollIntoView:vU,selectAll:CU,selectNodeBackward:SU,selectNodeForward:wU,selectParentNode:TU,selectTextblockEnd:EU,selectTextblockStart:kU,setContent:IU,setMark:PU,setMeta:DU,setNode:LU,setNodeSelection:UU,setTextSelection:HU,sinkListItem:FU,splitBlock:BU,splitListItem:zU,toggleList:KU,toggleMark:jU,toggleNode:$U,toggleWrap:VU,undoInputRule:WU,unsetAllMarks:qU,unsetMark:GU,updateAttributes:QU,wrapIn:YU,wrapInList:JU});const ZU=Ot.create({name:"commands",addCommands(){return{...XU}}}),e2=Ot.create({name:"drop",addProseMirrorPlugins(){return[new Vt({key:new Gn("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),t2=Ot.create({name:"editable",addProseMirrorPlugins(){return[new Vt({key:new Gn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),n2=new Gn("focusEvents"),r2=Ot.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new Vt({key:n2,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),o2=Ot.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:f}=d,p=d.parent.isTextblock&&h>0?a.doc.resolve(h-1):d,m=p.parent.type.spec.isolating,v=d.pos-d.parentOffset,g=m&&p.parent.childCount===1?v===d.pos:ee.atStart(c).from===h;return!u||!f.type.isTextblock||f.textContent.length||!g||g&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},o={...r},i={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return _g()||EA()?i:o},addProseMirrorPlugins(){return[new Vt({key:new Gn("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(m=>m.getMeta("composition")))return;const r=n.some(m=>m.docChanged)&&!e.doc.eq(t.doc),o=n.some(m=>m.getMeta("preventClearDocument"));if(!r||o)return;const{empty:i,from:s,to:a}=e.selection,l=ee.atStart(e.doc).from,c=ee.atEnd(e.doc).to;if(i||!(s===l&&a===c)||!Td(t.doc))return;const h=t.tr,f=gd({state:t,transaction:h}),{commands:p}=new yd({editor:this.editor,state:f});if(p.clearNodes(),!!h.steps.length)return h}})]}}),i2=Ot.create({name:"paste",addProseMirrorPlugins(){return[new Vt({key:new Gn("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),s2=Ot.create({name:"tabindex",addProseMirrorPlugins(){return[new Vt({key:new Gn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Bo{get name(){return this.node.type.name}constructor(e,t,r=!1,o=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=o}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Bo(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Bo(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Bo(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const o=t.isBlock&&!t.isTextblock,i=t.isAtom&&!t.isText,s=this.pos+r+(i?0:1);if(s<0||s>this.resolvedPos.doc.nodeSize-2)return;const a=this.resolvedPos.doc.resolve(s);if(!o&&a.depth<=this.depth)return;const l=new Bo(a,this.editor,o,o?t:null);o&&(l.actualDepth=this.depth+1),e.push(new Bo(a,this.editor,o,o?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,o=this.parent;for(;o&&!r;){if(o.node.type.name===e)if(Object.keys(t).length>0){const i=o.node.attrs,s=Object.keys(t);for(let a=0;a<s.length;a+=1){const l=s[a];if(i[l]!==t[l])break}}else r=o;o=o.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let o=[];if(!this.children||this.children.length===0)return o;const i=Object.keys(t);return this.children.forEach(s=>{r&&o.length>0||(s.node.type.name===e&&i.every(l=>t[l]===s.node.attrs[l])&&o.push(s),!(r&&o.length>0)&&(o=o.concat(s.querySelectorAll(e,t,r))))}),o}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const a2=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function l2(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const o=document.createElement("style");return e&&o.setAttribute("nonce",e),o.setAttribute("data-tiptap-style",""),o.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(o),o}class c2 extends SL{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,emitContentError:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:o})=>this.options.onDrop(t,r,o)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=l2(a2,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=gA(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],o=this.state.reconfigure({plugins:r});return this.view.updateState(o),o}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(i=>{const s=typeof i=="string"?`${i}$`:i.key;r=r.filter(a=>!a.key.startsWith(s))}),t.length===r.length)return;const o=this.state.reconfigure({plugins:r});return this.view.updateState(o),o}createExtensionManager(){var e,t;const o=[...this.options.enableCoreExtensions?[t2,DL.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),ZU,r2,o2,s2,e2,i2].filter(i=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[i.name]!==!1:!0):[],...this.options.extensions].filter(i=>["extension","node","mark"].includes(i==null?void 0:i.type));this.extensionManager=new Gi(o,this)}createCommandManager(){this.commandManager=new yd({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=yp(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=yp(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=wA(t,this.options.autofocus);this.view=new tA(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:qi.create({doc:t,selection:r||void 0})});const o=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(o),this.createNodeViews(),this.prependClass();const i=this.view.dom;i.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const o=e.getMeta("focus"),i=e.getMeta("blur");o&&this.emit("focus",{editor:this,event:o.event,transaction:e}),i&&this.emit("blur",{editor:this,event:i.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return xU(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,o=typeof e=="string"?t:e;return OU(this.state,r,o)}getJSON(){return this.state.doc.toJSON()}getHTML(){return xg(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return RU(this.state.doc,{blockSeparator:t,textSerializers:{...vA(this.schema),...r}})}get isEmpty(){return Td(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Bo(t,this)}get $doc(){return this.$pos(0)}}function Es(n){return new Cd({find:n.find,handler:({state:e,range:t,match:r})=>{const o=oe(n.getAttributes,void 0,r);if(o===!1||o===null)return null;const{tr:i}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=t.from+a.indexOf(s),u=c+s.length;if(IA(t.from,t.to,e.doc).filter(f=>f.mark.type.excluded.find(m=>m===n.type&&m!==f.mark.type)).filter(f=>f.to>c).length)return null;u<t.to&&i.delete(u,t.to),c>t.from&&i.delete(t.from+l,c);const h=t.from+l+s.length;i.addMark(t.from+l,h,n.type.create(o||{})),i.removeStoredMark(n.type)}}})}function u2(n){return new Cd({find:n.find,handler:({state:e,range:t,match:r})=>{const o=oe(n.getAttributes,void 0,r)||{},{tr:i}=e,s=t.from;let a=t.to;const l=n.type.create(o);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];i.insertText(d,s+r[0].length-1),i.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?s:s-1;i.insert(c,n.type.create(o)).delete(i.mapping.map(s),i.mapping.map(a))}i.scrollIntoView()}})}function Cp(n){return new Cd({find:n.find,handler:({state:e,range:t,match:r})=>{const o=e.doc.resolve(t.from),i=oe(n.getAttributes,void 0,r)||{};if(!o.node(-1).canReplaceWith(o.index(-1),o.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,i)}})}function nl(n){return new Cd({find:n.find,handler:({state:e,range:t,match:r,chain:o})=>{const i=oe(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),c=l&&pg(l,n.type,i);if(!c)return null;if(s.wrap(l,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:f}=n.editor.extensionManager,p=h||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(v=>f.includes(v.type.name));s.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";o().updateAttributes(d,i).run()}const u=s.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Oo(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&s.join(t.from-1)}})}class en{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=oe(K(this,"addOptions",{name:this.name}))),this.storage=oe(K(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new en(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>Sd(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new en(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=oe(K(t,"addOptions",{name:t.name})),t.storage=oe(K(t,"addStorage",{name:t.name,options:t.options})),t}}function ks(n){return new NL({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:o})=>{const i=oe(n.getAttributes,void 0,r,o);if(i===!1||i===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),d=t.from+l.indexOf(a),h=d+a.length;if(IA(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(v=>v===n.type&&v!==p.mark.type)).filter(p=>p.to>d).length)return null;h<t.to&&s.delete(h,t.to),d>t.from&&s.delete(t.from+u,d),c=t.from+u+a.length,s.addMark(t.from+u,c,n.type.create(i||{})),s.removeStoredMark(n.type)}}})}function d2(n,e){const{selection:t}=n,{$from:r}=t;if(t instanceof W){const i=r.index();return r.parent.canReplaceWith(i,i+1,e)}let o=r.depth;for(;o>=0;){const i=r.index(o);if(r.node(o).contentMatchAt(i).matchType(e))return!0;o-=1}return!1}function h2(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var AA={exports:{}},Oh={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var GC;function f2(){if(GC)return Oh;GC=1;var n=ie;function e(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,o=n.useEffect,i=n.useLayoutEffect,s=n.useDebugValue;function a(d,h){var f=h(),p=r({inst:{value:f,getSnapshot:h}}),m=p[0].inst,v=p[1];return i(function(){m.value=f,m.getSnapshot=h,l(m)&&v({inst:m})},[d,f,h]),o(function(){return l(m)&&v({inst:m}),d(function(){l(m)&&v({inst:m})})},[d]),s(f),f}function l(d){var h=d.getSnapshot;d=d.value;try{var f=h();return!t(d,f)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return Oh.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,Oh}AA.exports=f2();var Dg=AA.exports;const p2=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},m2=({contentComponent:n})=>{const e=Dg.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return ie.createElement(ie.Fragment,null,Object.values(e))};function g2(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:iR.createPortal(r.reactElement,r.element,t)},n.forEach(o=>o())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(o=>o())}}}class y2 extends ie.Component{constructor(e){var t;super(e),this.editorContentRef=ie.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((t=e.editor)===null||t===void 0)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=g2(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...r}=this.props;return ie.createElement(ie.Fragment,null,ie.createElement("div",{ref:p2(t,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&ie.createElement(m2,{contentComponent:e.contentComponent}))}}const v2=S.forwardRef((n,e)=>{const t=ie.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return ie.createElement(y2,{key:t,innerRef:e,...n})}),C2=ie.memo(v2);var S2=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,o,i;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(o=r;o--!==0;)if(!n(e[o],t[o]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(o of e.entries())if(!t.has(o[0]))return!1;for(o of e.entries())if(!n(o[1],t.get(o[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(o of e.entries())if(!t.has(o[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(o=r;o--!==0;)if(e[o]!==t[o])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(i=Object.keys(e),r=i.length,r!==Object.keys(t).length)return!1;for(o=r;o--!==0;)if(!Object.prototype.hasOwnProperty.call(t,i[o]))return!1;for(o=r;o--!==0;){var s=i[o];if(!(s==="_owner"&&e.$$typeof)&&!n(e[s],t[s]))return!1}return!0}return e!==e&&t!==t},w2=h2(S2),bA={exports:{}},Mh={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var QC;function T2(){if(QC)return Mh;QC=1;var n=ie,e=Dg;function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,o=e.useSyncExternalStore,i=n.useRef,s=n.useEffect,a=n.useMemo,l=n.useDebugValue;return Mh.useSyncExternalStoreWithSelector=function(c,u,d,h,f){var p=i(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=a(function(){function g(A){if(!y){if(y=!0,C=A,A=h(A),f!==void 0&&m.hasValue){var R=m.value;if(f(R,A))return w=R}return w=A}if(R=w,r(C,A))return R;var k=h(A);return f!==void 0&&f(R,k)?R:(C=A,w=k)}var y=!1,C,w,I=d===void 0?null:d;return[function(){return g(u())},I===null?void 0:function(){return g(I())}]},[u,d,h,f]);var v=o(c,p[0],p[1]);return s(function(){m.hasValue=!0,m.value=v},[v]),l(v),v},Mh}bA.exports=T2();var E2=bA.exports;const k2=typeof window<"u"?S.useLayoutEffect:S.useEffect;class I2{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(o=>o())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}}function A2(n){var e;const[t]=S.useState(()=>new I2(n.editor)),r=E2.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!==null&&e!==void 0?e:w2);return k2(()=>t.watch(n.editor),[n.editor,t]),S.useDebugValue(r),r}const b2=!1,Sp=typeof window>"u",R2=Sp||!!(typeof window<"u"&&window.next);class Lg{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){return this.options.current.immediatelyRender===void 0?Sp||R2?null:this.createEditor():(this.options.current.immediatelyRender,this.options.current.immediatelyRender?this.createEditor():null)}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var o,i;return(i=(o=this.options.current).onBeforeCreate)===null||i===void 0?void 0:i.call(o,...r)},onBlur:(...r)=>{var o,i;return(i=(o=this.options.current).onBlur)===null||i===void 0?void 0:i.call(o,...r)},onCreate:(...r)=>{var o,i;return(i=(o=this.options.current).onCreate)===null||i===void 0?void 0:i.call(o,...r)},onDestroy:(...r)=>{var o,i;return(i=(o=this.options.current).onDestroy)===null||i===void 0?void 0:i.call(o,...r)},onFocus:(...r)=>{var o,i;return(i=(o=this.options.current).onFocus)===null||i===void 0?void 0:i.call(o,...r)},onSelectionUpdate:(...r)=>{var o,i;return(i=(o=this.options.current).onSelectionUpdate)===null||i===void 0?void 0:i.call(o,...r)},onTransaction:(...r)=>{var o,i;return(i=(o=this.options.current).onTransaction)===null||i===void 0?void 0:i.call(o,...r)},onUpdate:(...r)=>{var o,i;return(i=(o=this.options.current).onUpdate)===null||i===void 0?void 0:i.call(o,...r)},onContentError:(...r)=>{var o,i;return(i=(o=this.options.current).onContentError)===null||i===void 0?void 0:i.call(o,...r)},onDrop:(...r)=>{var o,i;return(i=(o=this.options.current).onDrop)===null||i===void 0?void 0:i.call(o,...r)},onPaste:(...r)=>{var o,i;return(i=(o=this.options.current).onPaste)===null||i===void 0?void 0:i.call(o,...r)}};return new c2(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((o,i)=>{var s;return o===((s=t.extensions)===null||s===void 0?void 0:s[i])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?Lg.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,o)=>r===e[o]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function N2(n={},e=[]){const t=S.useRef(n);t.current=n;const[r]=S.useState(()=>new Lg(t)),o=Dg.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return S.useDebugValue(o),S.useEffect(r.onRender(e)),A2({editor:o,selector:({transactionNumber:i})=>n.shouldRerenderOnTransaction===!1?null:n.immediatelyRender&&i===0?0:i+1}),o}const x2=S.createContext({editor:null});x2.Consumer;const O2=S.createContext({onDragStart:void 0}),M2=()=>S.useContext(O2);ie.forwardRef((n,e)=>{const{onDragStart:t}=M2(),r=n.as||"div";return ie.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});const _2=/^\s*>\s$/,P2=en.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[nl({find:_2,type:this.type})]}}),D2=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,L2=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,U2=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,H2=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,F2=bo.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Es({find:D2,type:this.type}),Es({find:U2,type:this.type})]},addPasteRules(){return[ks({find:L2,type:this.type}),ks({find:H2,type:this.type})]}}),B2="listItem",YC="textStyle",JC=/^\s*([-+*])\s$/,z2=en.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(B2,this.editor.getAttributes(YC)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=nl({find:JC,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=nl({find:JC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(YC),editor:this.editor})),[n]}}),K2=/(^|[^`])`([^`]+)`(?!`)/,j2=/(^|[^`])`([^`]+)`(?!`)/g,$2=bo.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Es({find:K2,type:this.type})]},addPasteRules(){return[ks({find:j2,type:this.type})]}}),V2=/^```([a-z]+)?[\s\n]$/,W2=/^~~~([a-z]+)?[\s\n]$/,q2=en.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,i=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return i||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",zt(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:o}=t;if(!o||r.parent.type!==this.type)return!1;const i=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!i||!s?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:o,empty:i}=t;if(!i||o.parent.type!==this.type||!(o.parentOffset===o.parent.nodeSize-2))return!1;const a=o.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(ee.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[Cp({find:V2,type:this.type,getAttributes:n=>({language:n[1]})}),Cp({find:W2,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new Vt({key:new Gn("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),o=r?JSON.parse(r):void 0,i=o==null?void 0:o.mode;if(!t||!i)return!1;const{tr:s,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:i},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(Y.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),G2=en.create({name:"doc",topNode:!0,content:"block+"});function Q2(n={}){return new Vt({view(e){return new Y2(e,n)}})}class Y2{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(o=>{let i=s=>{this[o](s)};return e.dom.addEventListener(o,i),{name:o,handler:i}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r,o=this.editorView.dom,i=o.getBoundingClientRect(),s=i.width/o.offsetWidth,a=i.height/o.offsetHeight;if(t){let d=e.nodeBefore,h=e.nodeAfter;if(d||h){let f=this.editorView.nodeDOM(this.cursorPos-(d?d.nodeSize:0));if(f){let p=f.getBoundingClientRect(),m=d?p.bottom:p.top;d&&h&&(m=(m+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2);let v=this.width/2*a;r={left:p.left,right:p.right,top:m-v,bottom:m+v}}}}if(!r){let d=this.editorView.coordsAtPos(this.cursorPos),h=this.width/2*s;r={left:d.left-h,right:d.left+h,top:d.top,bottom:d.bottom}}let l=this.editorView.dom.offsetParent;this.element||(this.element=l.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let c,u;if(!l||l==document.body&&getComputedStyle(l).position=="static")c=-pageXOffset,u=-pageYOffset;else{let d=l.getBoundingClientRect(),h=d.width/l.offsetWidth,f=d.height/l.offsetHeight;c=d.left-l.scrollLeft*h,u=d.top-l.scrollTop*f}this.element.style.left=(r.left-c)/s+"px",this.element.style.top=(r.top-u)/a+"px",this.element.style.width=(r.right-r.left)/s+"px",this.element.style.height=(r.bottom-r.top)/a+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),o=r&&r.type.spec.disableDropCursor,i=typeof o=="function"?o(this.editorView,t,e):o;if(t&&!i){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=mI(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){this.editorView.dom.contains(e.relatedTarget)||this.setCursor(null)}}const J2=Ot.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[Q2(this.options)]}});class ze extends ee{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return ze.valid(r)?new ze(r):ee.near(r)}content(){return U.empty}eq(e){return e instanceof ze&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new ze(e.resolve(t.pos))}getBookmark(){return new Ug(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!X2(e)||!Z2(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let o=t.contentMatchAt(e.index()).defaultType;return o&&o.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&ze.valid(e))return e;let o=e.pos,i=null;for(let s=e.depth;;s--){let a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){i=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;o+=t;let l=e.doc.resolve(o);if(ze.valid(l))return l}for(;;){let s=t>0?i.firstChild:i.lastChild;if(!s){if(i.isAtom&&!i.isText&&!W.isSelectable(i)){e=e.doc.resolve(o+i.nodeSize*t),r=!1;continue e}break}i=s,o+=t;let a=e.doc.resolve(o);if(ze.valid(a))return a}return null}}}ze.prototype.visible=!1;ze.findFrom=ze.findGapCursorFrom;ee.jsonID("gapcursor",ze);class Ug{constructor(e){this.pos=e}map(e){return new Ug(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return ze.valid(t)?new ze(t):ee.near(t)}}function X2(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let o=r.child(t-1);;o=o.lastChild){if(o.childCount==0&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}function Z2(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let o=r.child(t);;o=o.firstChild){if(o.childCount==0&&!o.inlineContent||o.isAtom||o.type.spec.isolating)return!0;if(o.inlineContent)return!1}}return!0}function eH(){return new Vt({props:{decorations:oH,createSelectionBetween(n,e,t){return e.pos==t.pos&&ze.valid(t)?new ze(t):null},handleClick:nH,handleKeyDown:tH,handleDOMEvents:{beforeinput:rH}}})}const tH=nA({ArrowLeft:nc("horiz",-1),ArrowRight:nc("horiz",1),ArrowUp:nc("vert",-1),ArrowDown:nc("vert",1)});function nc(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,o,i){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof Y){if(!i.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=ze.findGapCursorFrom(a,e,l);return c?(o&&o(r.tr.setSelection(new ze(c))),!0):!1}}function nH(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!ze.valid(r))return!1;let o=n.posAtCoords({left:t.clientX,top:t.clientY});return o&&o.inside>-1&&W.isSelectable(n.state.doc.nodeAt(o.inside))?!1:(n.dispatch(n.state.tr.setSelection(new ze(r))),!0)}function rH(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof ze))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let o=N.empty;for(let s=r.length-1;s>=0;s--)o=N.from(r[s].createAndFill(null,o));let i=n.state.tr.replace(t.pos,t.pos,new U(o,0,0));return i.setSelection(Y.near(i.doc.resolve(t.pos+1))),n.dispatch(i),!1}function oH(n){if(!(n.selection instanceof ze))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ge.create(n.doc,[pn.widget(n.selection.head,e,{key:"gapcursor"})])}const iH=Ot.create({name:"gapCursor",addProseMirrorPlugins(){return[eH()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=oe(K(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),sH=en.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",zt(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:o,storedMarks:i}=t;if(o.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=i||o.$to.parentOffset&&o.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const d=l.filter(h=>a.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),aH=en.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,zt(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>Cp({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var Iu=200,ht=function(){};ht.prototype.append=function(e){return e.length?(e=ht.from(e),!this.length&&e||e.length<Iu&&this.leafAppend(e)||this.length<Iu&&e.leafPrepend(this)||this.appendInner(e)):this};ht.prototype.prepend=function(e){return e.length?ht.from(e).append(this):this};ht.prototype.appendInner=function(e){return new lH(this,e)};ht.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?ht.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};ht.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};ht.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};ht.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var o=[];return this.forEach(function(i,s){return o.push(e(i,s))},t,r),o};ht.from=function(e){return e instanceof ht?e:e&&e.length?new RA(e):ht.empty};var RA=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(o,i){return o==0&&i==this.length?this:new e(this.values.slice(o,i))},e.prototype.getInner=function(o){return this.values[o]},e.prototype.forEachInner=function(o,i,s,a){for(var l=i;l<s;l++)if(o(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(o,i,s,a){for(var l=i-1;l>=s;l--)if(o(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(o){if(this.length+o.length<=Iu)return new e(this.values.concat(o.flatten()))},e.prototype.leafPrepend=function(o){if(this.length+o.length<=Iu)return new e(o.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(ht);ht.empty=new RA([]);var lH=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,o,i,s){var a=this.left.length;if(o<a&&this.left.forEachInner(r,o,Math.min(i,a),s)===!1||i>a&&this.right.forEachInner(r,Math.max(o-a,0),Math.min(this.length,i)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,o,i,s){var a=this.left.length;if(o>a&&this.right.forEachInvertedInner(r,o-a,Math.max(i,a)-a,s+a)===!1||i<a&&this.left.forEachInvertedInner(r,Math.min(o,a),i,s)===!1)return!1},e.prototype.sliceInner=function(r,o){if(r==0&&o==this.length)return this;var i=this.left.length;return o<=i?this.left.slice(r,o):r>=i?this.right.slice(r-i,o-i):this.left.slice(r,i).append(this.right.slice(0,o-i))},e.prototype.leafAppend=function(r){var o=this.right.leafAppend(r);if(o)return new e(this.left,o)},e.prototype.leafPrepend=function(r){var o=this.left.leafPrepend(r);if(o)return new e(o,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(ht);const cH=500;class Hn{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let o,i;t&&(o=this.remapping(r,this.items.length),i=o.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){o||(o=this.remapping(r,h+1),i=o.maps.length),i--,u.push(d);return}if(o){u.push(new tr(d.map));let f=d.step.map(o.slice(i)),p;f&&s.maybeStep(f).doc&&(p=s.mapping.maps[s.mapping.maps.length-1],c.push(new tr(p,void 0,void 0,c.length+u.length))),i--,p&&o.appendMap(p,i)}else s.maybeStep(d.step);if(d.selection)return a=o?d.selection.map(o.slice(i)):d.selection,l=new Hn(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,t,r,o){let i=[],s=this.eventCount,a=this.items,l=!o&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new tr(e.mapping.maps[u],d,t),f;(f=l&&l.merge(h))&&(h=f,u?i.pop():a=a.slice(0,a.length-1)),i.push(h),t&&(s++,t=void 0),o||(l=h)}let c=s-r.depth;return c>dH&&(a=uH(a,c),s-=c),new Hn(a.append(i),s)}remapping(e,t){let r=new Qa;return this.items.forEach((o,i)=>{let s=o.mirrorOffset!=null&&i-o.mirrorOffset>=e?r.maps.length-o.mirrorOffset:void 0;r.appendMap(o.map,s)},e,t),r}addMaps(e){return this.eventCount==0?this:new Hn(this.items.append(e.map(t=>new tr(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],o=Math.max(0,this.items.length-t),i=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},o);let l=t;this.items.forEach(h=>{let f=i.getMirror(--l);if(f==null)return;s=Math.min(s,f);let p=i.maps[f];if(h.step){let m=e.steps[f].invert(e.docs[f]),v=h.selection&&h.selection.map(i.slice(l+1,f));v&&a++,r.push(new tr(p,m,v))}else r.push(new tr(p))},o);let c=[];for(let h=t;h<s;h++)c.push(new tr(i.maps[h]));let u=this.items.slice(0,o).append(c).append(r),d=new Hn(u,a);return d.emptyItemCount()>cH&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,o=[],i=0;return this.items.forEach((s,a)=>{if(a>=e)o.push(s),s.selection&&i++;else if(s.step){let l=s.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=s.selection&&s.selection.map(t.slice(r));u&&i++;let d=new tr(c.invert(),l,u),h,f=o.length-1;(h=o.length&&o[f].merge(d))?o[f]=h:o.push(d)}}else s.map&&r--},this.items.length,0),new Hn(ht.from(o.reverse()),i)}}Hn.empty=new Hn(ht.empty,0);function uH(n,e){let t;return n.forEach((r,o)=>{if(r.selection&&e--==0)return t=o,!1}),n.slice(t)}class tr{constructor(e,t,r,o){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=o}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new tr(t.getMap().invert(),t,this.selection)}}}class Yr{constructor(e,t,r,o,i){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=o,this.prevComposition=i}}const dH=20;function hH(n,e,t,r){let o=t.getMeta(ei),i;if(o)return o.historyState;t.getMeta(mH)&&(n=new Yr(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(ei))return s.getMeta(ei).redo?new Yr(n.done.addTransform(t,void 0,r,Sc(e)),n.undone,XC(t.mapping.maps),n.prevTime,n.prevComposition):new Yr(n.done,n.undone.addTransform(t,void 0,r,Sc(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!fH(t,n.prevRanges)),c=s?_h(n.prevRanges,t.mapping):XC(t.mapping.maps);return new Yr(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,Sc(e)),Hn.empty,c,t.time,a??n.prevComposition)}else return(i=t.getMeta("rebased"))?new Yr(n.done.rebased(t,i),n.undone.rebased(t,i),_h(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new Yr(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),_h(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function fH(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,o)=>{for(let i=0;i<e.length;i+=2)r<=e[i+1]&&o>=e[i]&&(t=!0)}),t}function XC(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,o,i,s)=>e.push(i,s));return e}function _h(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let o=e.map(n[r],1),i=e.map(n[r+1],-1);o<=i&&t.push(o,i)}return t}function pH(n,e,t){let r=Sc(e),o=ei.get(e).spec.config,i=(t?n.undone:n.done).popEvent(e,r);if(!i)return null;let s=i.selection.resolve(i.transform.doc),a=(t?n.done:n.undone).addTransform(i.transform,e.selection.getBookmark(),o,r),l=new Yr(t?a:i.remaining,t?i.remaining:a,null,0,-1);return i.transform.setSelection(s).setMeta(ei,{redo:t,historyState:l})}let Ph=!1,ZC=null;function Sc(n){let e=n.plugins;if(ZC!=e){Ph=!1,ZC=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ph=!0;break}}return Ph}const ei=new Gn("history"),mH=new Gn("closeHistory");function gH(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new Vt({key:ei,state:{init(){return new Yr(Hn.empty,Hn.empty,null,0,-1)},apply(e,t,r){return hH(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,o=r=="historyUndo"?xA:r=="historyRedo"?OA:null;return o?(t.preventDefault(),o(e.state,e.dispatch)):!1}}}})}function NA(n,e){return(t,r)=>{let o=ei.getState(t);if(!o||(n?o.undone:o.done).eventCount==0)return!1;if(r){let i=pH(o,t,n);i&&r(e?i.scrollIntoView():i)}return!0}}const xA=NA(!1,!0),OA=NA(!0,!0),yH=Ot.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>xA(n,e),redo:()=>({state:n,dispatch:e})=>OA(n,e)}},addProseMirrorPlugins(){return[gH(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),vH=en.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",zt(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{if(!d2(e,e.schema.nodes[this.name]))return!1;const{selection:t}=e,{$from:r,$to:o}=t,i=n();return r.parentOffset===0?i.insertContentAt({from:Math.max(r.pos-1,0),to:o.pos},{type:this.name}):MU(t)?i.insertContentAt(o.pos,{type:this.name}):i.insertContent({type:this.name}),i.command(({tr:s,dispatch:a})=>{var l;if(a){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(Y.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(W.create(s.doc,c.pos)):s.setSelection(Y.create(s.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(s.insert(u,d),s.setSelection(Y.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[u2({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),CH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,SH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,wH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,TH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,EH=bo.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Es({find:CH,type:this.type}),Es({find:wH,type:this.type})]},addPasteRules(){return[ks({find:SH,type:this.type}),ks({find:TH,type:this.type})]}}),kH=en.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",zt(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),IH="listItem",eS="textStyle",tS=/^(\d+)\.\s$/,AH=en.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",zt(this.options.HTMLAttributes,t),0]:["ol",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(IH,this.editor.getAttributes(eS)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=nl({find:tS,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=nl({find:tS,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(eS)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),bH=en.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),RH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,NH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,xH=bo.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",zt(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Es({find:RH,type:this.type})]},addPasteRules(){return[ks({find:NH,type:this.type})]}}),OH=en.create({name:"text",group:"inline"}),MH=Ot.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(F2.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(P2.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(z2.configure(this.options.bulletList)),this.options.code!==!1&&n.push($2.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(q2.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(G2.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(J2.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(iH.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(sH.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(aH.configure(this.options.heading)),this.options.history!==!1&&n.push(yH.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(vH.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(EH.configure(this.options.italic)),this.options.listItem!==!1&&n.push(kH.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(AH.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(bH.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(xH.configure(this.options.strike)),this.options.text!==!1&&n.push(OH.configure(this.options.text)),n}}),_H=Ot.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new Vt({key:new Gn("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,o=[];if(!t)return null;const i=this.editor.isEmpty;return n.descendants((s,a)=>{const l=r>=a&&r<=a+s.nodeSize,c=!s.isLeaf&&Td(s);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];i&&u.push(this.options.emptyEditorClass);const d=pn.node(a,a+s.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});o.push(d)}return this.options.includeChildren}),Ge.create(n,o)}}})]}}),PH=({isOpen:n,onClose:e})=>{const t=N2({extensions:[MH,_H.configure({placeholder:"Write your notes here..."})],content:localStorage.getItem("userNotes")||"",onUpdate:({editor:o})=>{localStorage.setItem("userNotes",o.getHTML())}});if(!n)return null;const r=({onClick:o,children:i,isActive:s=!1})=>E.jsx("button",{onClick:o,className:`p-2 rounded hover:bg-[#2D3139] transition-colors duration-200 ${s?"bg-[#2D3139] text-rose-500":"text-white"}`,children:i});return E.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:E.jsxs("div",{className:"w-[800px] h-[80vh] flex flex-col bg-[#181b21] bg-opacity-70 backdrop-blur-md rounded-lg shadow-xl border border-[#2D3139]",children:[E.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-[#2D3139]",children:[E.jsx("h2",{className:"text-lg font-semibold text-white",children:"Notes"}),E.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors duration-200",children:E.jsx(Yf,{size:16})})]}),E.jsxs("div",{className:"p-2 border-b border-[#2D3139] flex gap-2",children:[E.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleBold().run(),isActive:t==null?void 0:t.isActive("bold"),children:E.jsx($M,{size:18})}),E.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleItalic().run(),isActive:t==null?void 0:t.isActive("italic"),children:E.jsx(WM,{size:18})}),E.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleBulletList().run(),isActive:t==null?void 0:t.isActive("bulletList"),children:E.jsx(YM,{size:18})}),E.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleOrderedList().run(),isActive:t==null?void 0:t.isActive("orderedList"),children:E.jsx(GM,{size:18})})]}),E.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:E.jsx(C2,{editor:t,className:"prose prose-invert max-w-none focus:outline-none"})})]})})},MA="kanban_sprint_name",_A="kanban_sprint_name_history",Au="DAP - 26",DH=10,LH="kanban_search_value",UH=()=>{try{return localStorage.getItem(MA)||Au}catch(n){return console.error("Error loading sprint name from localStorage:",n),Au}},nS=n=>{try{localStorage.setItem(MA,n)}catch(e){console.error("Error saving sprint name to localStorage:",e)}},wc=()=>{try{const n=localStorage.getItem(_A);return n?JSON.parse(n):[Au]}catch(n){return console.error("Error loading sprint name history from localStorage:",n),[Au]}},HH=n=>{try{localStorage.setItem(_A,JSON.stringify(n))}catch(e){console.error("Error saving sprint name history to localStorage:",e)}},rS=n=>{if(!n.trim())return;const t=wc().filter(o=>o!==n),r=[n,...t].slice(0,DH);HH(r)},FH=n=>{try{localStorage.setItem(LH,n)}catch(e){console.error("Error saving search value to localStorage:",e)}};function BH(n){switch(n){case 1:return"bg-yellow-500 hover:bg-yellow-600";case 2:return"bg-rose-500 hover:bg-rose-600";default:return"bg-[#181b21] hover:bg-[#1C1F26]"}}function zH({tasks:n,selectedIssueTypes:e,selectedAssignees:t,onIssueTypeChange:r,onAssigneeChange:o,bookmarkFilter:i,onBookmarkFilterChange:s,onRefresh:a,searchValue:l,onSearchChange:c,filteredTasksCount:u}){const[d,h]=S.useState(!1),[f,p]=S.useState(!1),[m,v]=S.useState(""),[g,y]=S.useState(!1),[C,w]=S.useState(!1),[I,A]=S.useState(null),[R,k]=S.useState(!1),[M,O]=S.useState(()=>UH()),[q,de]=S.useState(!1),[pe,Ee]=S.useState(()=>wc()),[tn,Wt]=S.useState(!1),[He,L]=S.useState(!1),[V,G]=S.useState(!1),[le,te]=S.useState(""),[_e,$e]=S.useState(()=>zv()),[ne,j]=S.useState(null),J=S.useRef(null),X=S.useRef(null),se=S.useRef(null),B=S.useRef(null),[Ve,ke]=S.useState(!1),[Ne,we]=S.useState(!1),[We,fe]=S.useState(!1),[pt,Pt]=S.useState(!1),[Ie,Fe]=S.useState(!1),[rt,Po]=S.useState(l),vl=S.useCallback((()=>{let P;return Z=>{clearTimeout(P),P=setTimeout(()=>{c(Z),FH(Z)},300)}})(),[c]);S.useEffect(()=>{Po(l)},[l]);const Do=Array.from(new Set(n.map(P=>{if(P.rowData&&typeof P.rowData=="object"){const Z=P.rowData["Issue Type"];return Z&&typeof Z=="string"?Z:null}return null}).filter(P=>P!==null))).sort((P,Z)=>P.localeCompare(Z)),wi=Array.from(new Set(n.map(P=>{if(P.rowData&&typeof P.rowData=="object"){const Z=P.rowData.Assignee;return Z&&typeof Z=="string"?Z:null}return null}).filter(P=>P!==null))).sort((P,Z)=>P.localeCompare(Z)),Ed=wi.filter(P=>P.toLowerCase().includes(m.toLowerCase()));S.useEffect(()=>{function P(Z){J.current&&!J.current.contains(Z.target)&&h(!1),X.current&&!X.current.contains(Z.target)&&p(!1),se.current&&!se.current.contains(Z.target)&&de(!1)}return document.addEventListener("mousedown",P),()=>document.removeEventListener("mousedown",P)},[]),S.useEffect(()=>{rt.trim()&&fe(!0)},[]);const Hr=P=>{O(P),nS(P),L(!0)},Fr=P=>{O(P),nS(P),de(!1),L(!1),rS(P),Ee(wc())},Lo=P=>{P.key==="Enter"&&(rS(M),Ee(wc()),Ps())},Ps=async()=>{w(!0),A(null),k(!1);try{await a(M),k(!0),setTimeout(()=>k(!1),2e3)}catch(P){A(P instanceof Error?P.message:"Failed to refresh")}finally{w(!1)}},Qn=()=>{_e.hasKey&&te(""),G(!0),j(null)},Cl=()=>{if(!le.trim()){j("Please enter an API key");return}if(!n_(le.trim())){j("Invalid API key format");return}try{ZM(le.trim()),$e(zv()),te(""),G(!1),j(null),console.log("API key saved successfully")}catch(P){j(P instanceof Error?P.message:"Failed to save API key")}},kd=P=>{P.key==="Enter"?Cl():P.key==="Escape"&&(G(!1),te(""),j(null))},Id=()=>{setTimeout(()=>{le.trim()||(G(!1),j(null))},150)},Ds=()=>{e.length===Do.length?r([]):r([...Do])},Sl=()=>{t.length===wi.length?o([]):o([...wi])},Ad=()=>{s((i+1)%3)};S.useEffect(()=>{if(!pt&&!Ie&&!rt.trim()&&We){const Z=setTimeout(()=>{fe(!1)},150);return()=>clearTimeout(Z)}},[pt,Ie,rt,We]);const wl=()=>{Fe(!0),fe(!0)},bd=()=>{Fe(!1)},Rd=()=>{Pt(!0),fe(!0)},Nd=()=>{Pt(!1)},Je=P=>{Po(P),vl(P),P.trim()&&fe(!0)};return E.jsxs(E.Fragment,{children:[E.jsxs("div",{className:"flex gap-4 items-center justify-end py-2 px-4 bg-[#000] border-b border-[#181b21]",children:[E.jsxs("div",{className:"flex items-center gap-2 mr-auto",children:[E.jsx("span",{className:"text-white text-sm",children:rt.trim()||e.length>0||t.length>0||i>0?"Filtered Tasks:":"Total Tasks:"}),E.jsx("span",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-[#181b21] px-2 text-xs text-white border border-[#2D3139]",children:u}),(rt.trim()||e.length>0||t.length>0||i>0)&&E.jsxs("span",{className:"text-gray-400 text-xs",children:["of ",n.length]}),E.jsxs("div",{ref:se,className:"relative",onMouseEnter:()=>Wt(!0),onMouseLeave:()=>{Wt(!1),q||setTimeout(()=>{tn||de(!1)},100)},children:[E.jsx("input",{type:"text",value:M,onChange:P=>Hr(P.target.value),onKeyDown:Lo,onFocus:()=>{de(!0),L(!1)},className:"bg-[#181b21] text-white px-3 py-1 rounded-lg border border-[#2D3139] text-sm focus:outline-none focus:border-rose-500 w-[90px]",placeholder:"Sprint Name"}),E.jsx("div",{className:`absolute top-full left-0 mt-2 w-48 rounded-lg shadow-lg z-20 bg-[#181b21] bg-opacity-70 backdrop-blur-md
              transition-all duration-300 ease-in-out ${q||tn?"opacity-100 max-h-screen":"opacity-0 max-h-0 overflow-hidden"}`,style:{transitionProperty:"opacity, max-height"},children:E.jsxs("div",{className:"p-2 max-h-60 overflow-y-auto column-scroll",children:[pe.filter(P=>!He||P.toLowerCase().includes(M.toLowerCase())).sort((P,Z)=>P.localeCompare(Z)).map((P,Z)=>E.jsx("div",{onClick:()=>Fr(P),className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer",children:E.jsx("span",{className:"text-sm text-white",children:P})},Z)),pe.filter(P=>!He||P.toLowerCase().includes(M.toLowerCase())).length===0&&E.jsx("div",{className:"p-2 text-sm text-gray-400 text-center",children:"No matching sprint names"})]})})]}),E.jsxs("button",{onClick:Ps,disabled:C,className:`
              p-2 rounded-full transition-colors duration-200 relative group
              ${I?"bg-rose-500 hover:bg-rose-600":"bg-[#181b21] hover:bg-[#1C1F26]"}
              text-white
            `,title:I||"Refresh tasks",children:[C?E.jsx(Qf,{className:"w-4 h-4 animate-spin"}):R?E.jsx(Bk,{className:"w-4 h-4 text-green-500"}):I?E.jsx(XM,{className:"w-4 h-4"}):E.jsx(QM,{className:"w-4 h-4"}),I&&E.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-2 transform translate-y-full w-48 bg-rose-500 text-white text-xs rounded-lg py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-50",children:I})]}),E.jsxs("div",{className:"relative flex items-center",children:[E.jsxs("div",{className:`
              flex items-center rounded-full transition-all duration-300 ease-in-out
              ${V?"bg-[#181b21] border border-[#2D3139] px-3 py-1":"bg-[#181b21] hover:bg-[#1C1F26]"}
              ${_e.hasKey?"ring-1 ring-green-500/30":""}
            `,children:[E.jsx("button",{onClick:Qn,className:`
                  p-2 rounded-full transition-colors duration-200 text-white
                  ${V?"":"hover:bg-[#1C1F26]"}
                  ${_e.hasKey?"text-green-400":""}
                `,title:_e.hasKey?`API Key: ${_e.maskedKey}`:"Set API Key",children:E.jsx(qM,{className:"w-4 h-4"})}),V&&E.jsx("input",{type:"password",value:le,onChange:P=>te(P.target.value),onKeyDown:kd,onBlur:Id,placeholder:_e.hasKey?"Enter new API key...":"Enter your API key...",className:"flex-1 bg-transparent text-white text-sm placeholder-gray-400 focus:outline-none min-w-[200px]",autoFocus:!0})]}),ne&&E.jsx("div",{className:"absolute top-full left-0 mt-1 px-2 py-1 bg-rose-500 text-white text-xs rounded shadow-lg whitespace-nowrap z-30",children:ne})]})]}),E.jsx("div",{className:"relative flex items-center",onMouseEnter:wl,onMouseLeave:bd,children:E.jsxs("div",{className:`
              flex items-center transition-all duration-300 ease-in-out
              ${We?"w-[300px] h-[32px]":"w-8 h-8"}
              bg-[#181b21] hover:bg-[#1C1F26] rounded-full
              border border-transparent hover:border-[#2D3139]
            `,children:[E.jsx("div",{className:"p-2 flex-shrink-0",children:E.jsx(Bv,{size:16,className:"transition-transform duration-200 hover:scale-110"})}),We&&E.jsx("input",{ref:B,type:"text",value:rt,onChange:P=>Je(P.target.value),onFocus:Rd,onBlur:Nd,placeholder:"Search by Issue ID, Summary, Assignee...",className:`
                  flex-1 bg-transparent text-white text-sm placeholder-gray-400
                  focus:outline-none transition-all duration-300 ease-in-out
                  ${rt.trim()?"pr-8":"pr-4"}
                `,style:{transition:"opacity 300ms ease-in-out, width 300ms ease-in-out"}}),rt.trim()&&We&&E.jsx("button",{type:"button",onClick:()=>Je(""),className:"absolute right-2 p-1 text-gray-400 hover:text-white transition-colors duration-200",title:"Clear search",children:E.jsx(Yf,{size:14})})]})}),E.jsx("button",{onClick:()=>y(!0),className:"p-2 rounded-full transition-colors duration-200 text-white bg-[#181b21] hover:bg-[#1C1F26]",title:"Open Notes",children:E.jsx(JM,{size:16,className:"transition-transform duration-200 hover:scale-110"})}),E.jsx("button",{onClick:Ad,className:`
            p-2 rounded-full transition-colors duration-200
            text-white ${BH(i)}
          `,title:i===0?"Filter bookmarks":i===1?"Show yellow bookmarks":"Show red bookmarks",children:E.jsx(Fk,{size:16,className:`${i>0?"fill-white":""} transition-transform duration-200 hover:scale-110`})}),E.jsxs("div",{ref:J,className:"relative",onMouseEnter:()=>ke(!0),onMouseLeave:()=>{ke(!1),d||setTimeout(()=>{Ve||h(!1)},100)},children:[E.jsxs("button",{onClick:()=>h(!d),className:`
              px-3 py-1.5 rounded-full text-sm font-medium transition-colors duration-200
              ${e.length>0?"bg-rose-500 text-white hover:bg-rose-600":"bg-[#181b21] text-white hover:bg-[#1C1F26]"}
            `,children:["Issue Type ",e.length>0&&`(${e.length})`]}),E.jsxs("div",{className:`absolute top-full right-0 mt-2 w-48 rounded-lg shadow-lg z-20 bg-[#181b21] bg-opacity-70 backdrop-blur-md
            transition-all duration-300 ease-in-out ${d||Ve?"opacity-100 max-h-screen":"opacity-0 max-h-0 overflow-hidden"}`,style:{transitionProperty:"opacity, max-height"},children:[E.jsx("div",{className:"p-2",children:E.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer border-b border-[#2D3139]",children:[E.jsx("input",{type:"checkbox",checked:e.length===Do.length,onChange:Ds,className:"mr-2"}),E.jsx("span",{className:"text-sm text-white font-medium",children:"Select All"})]})}),E.jsx("div",{className:"p-2 max-h-60 overflow-y-auto column-scroll",children:Do.map(P=>E.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer",children:[E.jsx("input",{type:"checkbox",checked:e.includes(P),onChange:()=>{const Z=e.includes(P)?e.filter(Sn=>Sn!==P):[...e,P];r(Z)},className:"mr-2"}),E.jsx("span",{className:"text-sm text-white",children:P})]},P))})]})]}),E.jsxs("div",{ref:X,className:"relative",onMouseEnter:()=>we(!0),onMouseLeave:()=>{we(!1),f||setTimeout(()=>{Ne||p(!1)},100)},children:[E.jsxs("button",{onClick:()=>p(!f),className:`
              px-3 py-1.5 rounded-full text-sm font-medium transition-colors duration-200
              ${t.length>0?"bg-rose-500 text-white hover:bg-rose-600":"bg-[#181b21] text-white hover:bg-[#1C1F26]"}
            `,children:["Assignee ",t.length>0&&`(${t.length})`]}),E.jsxs("div",{className:`absolute top-full right-0 mt-2 w-80 rounded-lg shadow-lg z-20 bg-[#181b21] bg-opacity-70 backdrop-blur-md
            transition-all duration-300 ease-in-out ${f||Ne?"opacity-100 max-h-screen":"opacity-0 max-h-0 overflow-hidden"}`,style:{transitionProperty:"opacity, max-height"},children:[E.jsxs("div",{className:"p-2",children:[E.jsxs("div",{className:"relative mb-2",children:[E.jsx("input",{type:"text",placeholder:"Search assignees...",value:m,onChange:P=>v(P.target.value),className:"w-full bg-[#0c1015] border border-[#2D3139] rounded-full px-3 py-1.5 pl-8 text-sm text-white placeholder-gray-400 focus:outline-none focus:border-rose-500"}),E.jsx(Bv,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),m&&E.jsx("button",{type:"button",onClick:()=>v(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:E.jsx(Yf,{className:"h-4 w-4"})})]}),E.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer border-b border-[#2D3139]",children:[E.jsx("input",{type:"checkbox",checked:t.length===wi.length,onChange:Sl,className:"mr-2"}),E.jsx("span",{className:"text-sm text-white font-medium",children:"Select All"})]})]}),E.jsx("div",{className:"p-2 max-h-60 overflow-y-auto column-scroll",children:Ed.map(P=>E.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer",children:[E.jsx("input",{type:"checkbox",checked:t.includes(P),onChange:()=>{const Z=t.includes(P)?t.filter(Sn=>Sn!==P):[...t,P];o(Z)},className:"mr-2"}),E.jsx("span",{className:"text-sm text-white",children:P})]},P))})]})]}),E.jsx(m_,{})]}),E.jsx(PH,{isOpen:g,onClose:()=>y(!1)})]})}const KH="kanban_sprint_name",oS="DAP - 26",jH="kanban_search_value",$H=()=>{try{return localStorage.getItem(KH)||oS}catch(n){return console.error("Error loading sprint name from localStorage:",n),oS}},VH=()=>{try{return localStorage.getItem(jH)||""}catch(n){return console.error("Error loading search value from localStorage:",n),""}};function WH(){const{instance:n}=tg(),[e,t]=S.useState([]),[r,o]=S.useState([]),[i,s]=S.useState(null),[a,l]=S.useState([]),[c,u]=S.useState([]),[d,h]=S.useState(0),[f,p]=S.useState(()=>VH()),[m,v]=S.useState(!0),[g,y]=S.useState(null),[C,w]=S.useState(!1),[I,A]=S.useState(!1),[R,k]=S.useState(null),[M,O]=S.useState(null),[q,de]=S.useState(null),[pe,Ee]=S.useState(null);S.useEffect(()=>{tn($H())},[]);const tn=async ne=>{try{y(null),w(!1),k(null),O(null),t(se=>se.map(B=>({...B,isHighlighted:!1})));const j=await i_(ne),X=[...Array.from(new Set(j.map(se=>{var B;return(B=se.rowData)==null?void 0:B.Status}))).filter(se=>Xf.includes(se)).map(se=>({id:se,title:se,isHighlighted:!1})),{id:"Other Status",title:"Other Status",isHighlighted:!1}].sort((se,B)=>Gl(se.id)-Gl(B.id));t(X),o(j)}catch(j){console.error("Error loading task data:",j),y("Failed to load tasks. Please try again later."),w(!0)}finally{v(!1)}},Wt=(ne,j)=>{console.log("handleStatusCheckResult called with:",{taskId:ne,targetStatuses:j}),console.log("Current columns before processing:",e.map(J=>({id:J.id,title:J.title,isHighlighted:J.isHighlighted}))),k(null),O(null),t(J=>J.map(X=>({...X,isHighlighted:!1}))),setTimeout(()=>{k(ne),console.log("Set highlighted task ID to:",ne),t(J=>{const X=[...J],se=new Set(X.map(B=>B.id));return console.log("Existing column IDs:",Array.from(se)),j.forEach(B=>{if(console.log("Processing target status:",B),se.has(B))console.log("Column already exists for status:",B);else{console.log("Creating new column for status:",B);const Ve={id:B,title:B,isHighlighted:!0},ke=X.findIndex(Ne=>Gl(B)<Gl(Ne.id));ke===-1?X.push(Ve):X.splice(ke,0,Ve),se.add(B)}}),X.forEach(B=>{const Ve=B.id,ke=j.includes(Ve);console.log(`Column comparison - ID: "${Ve}", Target statuses: [${j.map(Ne=>`"${Ne}"`).join(", ")}], shouldHighlight: ${ke}`),B.isHighlighted=ke}),console.log("Final columns after processing:",X.map(B=>({id:B.id,title:B.title,isHighlighted:B.isHighlighted}))),X})},10)},He=()=>{console.log("clearHighlighting called"),k(null),O(null),t(ne=>{const j=ne.map(J=>({...J,isHighlighted:!1}));return console.log("Cleared highlighting for columns:",j.map(J=>({id:J.id,isHighlighted:J.isHighlighted}))),j})},L=()=>{n.loginPopup(ru).then(()=>{A(!1),console.log("Login successful")}).catch(ne=>{console.error("Login failed:",ne),A(!1)})},V=()=>{A(!1)},G=fO(hO(lg,{activationConstraint:{distance:3}}));function le(ne){var j,J;if(((j=ne.active.data.current)==null?void 0:j.type)==="Task"){const X=ne.active.data.current.task;s(X),Ee(X.columnId),console.log("Drag started - Task:",(J=X.rowData)==null?void 0:J["Issue Id"],"Original Column:",X.columnId)}}function te(ne){var Ne,we,We;const{active:j,over:J}=ne;if(!J)return;const X=j.id,se=J.id;if(X===se)return;const B=((Ne=j.data.current)==null?void 0:Ne.type)==="Task",Ve=((we=J.data.current)==null?void 0:we.type)==="Task";if(!B)return;B&&Ve&&o(fe=>{const pt=fe.findIndex(Ie=>Ie.id===X),Pt=fe.findIndex(Ie=>Ie.id===se);return fe[pt].columnId!==fe[Pt].columnId&&(fe[pt].columnId=fe[Pt].columnId),Ca(fe,pt,Pt)});const ke=((We=J.data.current)==null?void 0:We.type)==="Column";B&&ke&&o(fe=>{const pt=fe.findIndex(Pt=>Pt.id===X);return fe[pt].columnId=se,Ca(fe,pt,pt)})}async function _e(ne){var We,fe,pt,Pt;const{active:j,over:J}=ne;if(s(null),!J){Ee(null);return}const X=j.id,se=J.id;if(X===se){Ee(null);return}const B=((We=j.data.current)==null?void 0:We.type)==="Task",Ve=((fe=J.data.current)==null?void 0:fe.type)==="Task",ke=((pt=J.data.current)==null?void 0:pt.type)==="Column";if(!B){Ee(null);return}const Ne=r.find(Ie=>Ie.id===X);if(!Ne){Ee(null);return}let we;if(Ve){const Ie=r.find(Fe=>Fe.id===se);if(!Ie){Ee(null);return}we=Ie.columnId}else if(ke)we=se;else{Ee(null);return}if(console.log("Drag end - Original Column:",pe,"New Column:",we,"Should update:",pe&&pe!==we),pe&&pe!==we)try{console.log(`Updating task ${(Pt=Ne.rowData)==null?void 0:Pt["Issue Id"]} from ${pe} to ${we}`),de(X),await c_(Ne,we),console.log("Task status updated successfully"),o(Ie=>Ie.map(Fe=>Fe.id===X?{...Fe,rowData:{...Fe.rowData,Status:we}}:Fe)),k(null),O(X),t(Ie=>Ie.map(Fe=>({...Fe,isHighlighted:!1})))}catch(Ie){console.error("Failed to update task status:",Ie),o(Fe=>Fe.map(rt=>rt.id===X?{...rt,columnId:pe,rowData:{...rt.rowData,Status:pe}}:rt)),Ie instanceof Error&&Ie.message==="AUTHENTICATION_REQUIRED"?(console.log("Authentication required - showing login popup"),A(!0)):(y(`Failed to update task status: ${Ie instanceof Error?Ie.message:"Unknown error"}`),w(!0))}finally{de(null)}Ee(null)}const $e=r.filter(ne=>{const j=typeof ne.rowData=="object"?ne.rowData:{},J=a.length===0||a.includes(j["Issue Type"]),X=c.length===0||c.includes(j.Assignee),B=JSON.parse(localStorage.getItem("taskBookmarks")||"{}")[j["Issue Id"]]||0,Ve=d===0||B===d,ke=!f.trim()||(()=>{const Ne=f.toLowerCase().trim(),we=(j["Issue Id"]||"").toLowerCase(),We=(j.Summary||"").toLowerCase(),fe=(j.Assignee||"").toLowerCase();return we.includes(Ne)||We.includes(Ne)||fe.includes(Ne)})();return J&&X&&Ve&&ke});return E.jsxs("div",{className:"h-screen flex flex-col",children:[m&&E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-rose-500"})}),C&&g&&E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsxs("div",{className:"text-center bg-[#181b21] p-6 rounded-lg shadow-xl border border-[#2D3139]",children:[E.jsx("p",{className:"text-rose-500 mb-4",children:g}),E.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-rose-500 rounded-lg hover:bg-rose-600 transition-colors",children:"Okay"})]})}),I&&E.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:E.jsxs("div",{className:"text-center bg-[#181b21] p-6 rounded-lg shadow-xl border border-[#2D3139]",children:[E.jsx("p",{className:"text-rose-500 mb-4",children:"Please log in with your Microsoft account to update task status."}),E.jsxs("div",{className:"flex gap-3 justify-center",children:[E.jsx("button",{onClick:L,className:"px-4 py-2 bg-rose-500 rounded-lg hover:bg-rose-600 transition-colors text-white",children:"Login"}),E.jsx("button",{onClick:V,className:"px-4 py-2 bg-gray-600 rounded-lg hover:bg-gray-700 transition-colors text-white",children:"Cancel"})]})]})}),E.jsx(zH,{tasks:r,selectedIssueTypes:a,selectedAssignees:c,onIssueTypeChange:l,onAssigneeChange:u,bookmarkFilter:d,onBookmarkFilterChange:h,onRefresh:tn,searchValue:f,onSearchChange:p,filteredTasksCount:$e.length}),E.jsxs(uM,{sensors:G,onDragStart:le,onDragOver:te,onDragEnd:_e,children:[E.jsx("div",{className:"flex-1 overflow-x-auto overflow-y-hidden p-4 hide-scrollbar",onClick:ne=>{ne.target===ne.currentTarget&&He()},children:E.jsx("div",{className:"flex gap-4",children:e.map(ne=>{const j=$e.filter(J=>J.columnId===ne.id);return E.jsx("div",{className:"flex flex-col h-[calc(100vh-5.5rem)] min-h-[400px] w-[350px]",children:E.jsx(p_,{column:ne,tasks:j,onStatusCheckResult:Wt,highlightedTaskId:R,successTaskId:M,updatingTaskId:q})},ne.id)})})}),no.createPortal(E.jsx(NM,{children:i&&E.jsx(Kk,{task:i,onStatusCheckResult:Wt,isHighlighted:R===i.id,isSuccess:M===i.id,isUpdating:q===i.id})}),document.body)]})]})}function qH(){return E.jsx("div",{className:"h-screen bg-[#000] text-white overflow-hidden",children:E.jsx(WH,{})})}const GH=new rd(ik);vT(document.getElementById("root")).render(E.jsx(S.StrictMode,{children:E.jsx(P1,{instance:GH,children:E.jsx(Y1,{children:E.jsx(qH,{})})})}));
