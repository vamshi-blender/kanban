(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const o of i)if(o.type==="childList")for(const s of o.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&r(s)}).observe(document,{childList:!0,subtree:!0});function t(i){const o={};return i.integrity&&(o.integrity=i.integrity),i.referrerPolicy&&(o.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?o.credentials="include":i.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(i){if(i.ep)return;i.ep=!0;const o=t(i);fetch(i.href,o)}})();function KC(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var $C={exports:{}},Cu={},VC={exports:{}},oe={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Za=Symbol.for("react.element"),yI=Symbol.for("react.portal"),vI=Symbol.for("react.fragment"),CI=Symbol.for("react.strict_mode"),SI=Symbol.for("react.profiler"),wI=Symbol.for("react.provider"),TI=Symbol.for("react.context"),EI=Symbol.for("react.forward_ref"),kI=Symbol.for("react.suspense"),II=Symbol.for("react.memo"),AI=Symbol.for("react.lazy"),kg=Symbol.iterator;function bI(n){return n===null||typeof n!="object"?null:(n=kg&&n[kg]||n["@@iterator"],typeof n=="function"?n:null)}var WC={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},GC=Object.assign,qC={};function Ts(n,e,t){this.props=n,this.context=e,this.refs=qC,this.updater=t||WC}Ts.prototype.isReactComponent={};Ts.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};Ts.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function QC(){}QC.prototype=Ts.prototype;function sp(n,e,t){this.props=n,this.context=e,this.refs=qC,this.updater=t||WC}var ap=sp.prototype=new QC;ap.constructor=sp;GC(ap,Ts.prototype);ap.isPureReactComponent=!0;var Ig=Array.isArray,YC=Object.prototype.hasOwnProperty,lp={current:null},JC={key:!0,ref:!0,__self:!0,__source:!0};function XC(n,e,t){var r,i={},o=null,s=null;if(e!=null)for(r in e.ref!==void 0&&(s=e.ref),e.key!==void 0&&(o=""+e.key),e)YC.call(e,r)&&!JC.hasOwnProperty(r)&&(i[r]=e[r]);var a=arguments.length-2;if(a===1)i.children=t;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];i.children=l}if(n&&n.defaultProps)for(r in a=n.defaultProps,a)i[r]===void 0&&(i[r]=a[r]);return{$$typeof:Za,type:n,key:o,ref:s,props:i,_owner:lp.current}}function RI(n,e){return{$$typeof:Za,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function cp(n){return typeof n=="object"&&n!==null&&n.$$typeof===Za}function NI(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var Ag=/\/+/g;function gd(n,e){return typeof n=="object"&&n!==null&&n.key!=null?NI(""+n.key):e.toString(36)}function Ql(n,e,t,r,i){var o=typeof n;(o==="undefined"||o==="boolean")&&(n=null);var s=!1;if(n===null)s=!0;else switch(o){case"string":case"number":s=!0;break;case"object":switch(n.$$typeof){case Za:case yI:s=!0}}if(s)return s=n,i=i(s),n=r===""?"."+gd(s,0):r,Ig(i)?(t="",n!=null&&(t=n.replace(Ag,"$&/")+"/"),Ql(i,e,t,"",function(c){return c})):i!=null&&(cp(i)&&(i=RI(i,t+(!i.key||s&&s.key===i.key?"":(""+i.key).replace(Ag,"$&/")+"/")+n)),e.push(i)),1;if(s=0,r=r===""?".":r+":",Ig(n))for(var a=0;a<n.length;a++){o=n[a];var l=r+gd(o,a);s+=Ql(o,e,t,l,i)}else if(l=bI(n),typeof l=="function")for(n=l.call(n),a=0;!(o=n.next()).done;)o=o.value,l=r+gd(o,a++),s+=Ql(o,e,t,l,i);else if(o==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return s}function pl(n,e,t){if(n==null)return n;var r=[],i=0;return Ql(n,r,"","",function(o){return e.call(t,o,i++)}),r}function xI(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var Ht={current:null},Yl={transition:null},OI={ReactCurrentDispatcher:Ht,ReactCurrentBatchConfig:Yl,ReactCurrentOwner:lp};function ZC(){throw Error("act(...) is not supported in production builds of React.")}oe.Children={map:pl,forEach:function(n,e,t){pl(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return pl(n,function(){e++}),e},toArray:function(n){return pl(n,function(e){return e})||[]},only:function(n){if(!cp(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};oe.Component=Ts;oe.Fragment=vI;oe.Profiler=SI;oe.PureComponent=sp;oe.StrictMode=CI;oe.Suspense=kI;oe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=OI;oe.act=ZC;oe.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var r=GC({},n.props),i=n.key,o=n.ref,s=n._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,s=lp.current),e.key!==void 0&&(i=""+e.key),n.type&&n.type.defaultProps)var a=n.type.defaultProps;for(l in e)YC.call(e,l)&&!JC.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:Za,type:n.type,key:i,ref:o,props:r,_owner:s}};oe.createContext=function(n){return n={$$typeof:TI,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:wI,_context:n},n.Consumer=n};oe.createElement=XC;oe.createFactory=function(n){var e=XC.bind(null,n);return e.type=n,e};oe.createRef=function(){return{current:null}};oe.forwardRef=function(n){return{$$typeof:EI,render:n}};oe.isValidElement=cp;oe.lazy=function(n){return{$$typeof:AI,_payload:{_status:-1,_result:n},_init:xI}};oe.memo=function(n,e){return{$$typeof:II,type:n,compare:e===void 0?null:e}};oe.startTransition=function(n){var e=Yl.transition;Yl.transition={};try{n()}finally{Yl.transition=e}};oe.unstable_act=ZC;oe.useCallback=function(n,e){return Ht.current.useCallback(n,e)};oe.useContext=function(n){return Ht.current.useContext(n)};oe.useDebugValue=function(){};oe.useDeferredValue=function(n){return Ht.current.useDeferredValue(n)};oe.useEffect=function(n,e){return Ht.current.useEffect(n,e)};oe.useId=function(){return Ht.current.useId()};oe.useImperativeHandle=function(n,e,t){return Ht.current.useImperativeHandle(n,e,t)};oe.useInsertionEffect=function(n,e){return Ht.current.useInsertionEffect(n,e)};oe.useLayoutEffect=function(n,e){return Ht.current.useLayoutEffect(n,e)};oe.useMemo=function(n,e){return Ht.current.useMemo(n,e)};oe.useReducer=function(n,e,t){return Ht.current.useReducer(n,e,t)};oe.useRef=function(n){return Ht.current.useRef(n)};oe.useState=function(n){return Ht.current.useState(n)};oe.useSyncExternalStore=function(n,e,t){return Ht.current.useSyncExternalStore(n,e,t)};oe.useTransition=function(){return Ht.current.useTransition()};oe.version="18.3.1";VC.exports=oe;var S=VC.exports;const re=KC(S);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MI=S,_I=Symbol.for("react.element"),PI=Symbol.for("react.fragment"),DI=Object.prototype.hasOwnProperty,LI=MI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,UI={key:!0,ref:!0,__self:!0,__source:!0};function eS(n,e,t){var r,i={},o=null,s=null;t!==void 0&&(o=""+t),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(s=e.ref);for(r in e)DI.call(e,r)&&!UI.hasOwnProperty(r)&&(i[r]=e[r]);if(n&&n.defaultProps)for(r in e=n.defaultProps,e)i[r]===void 0&&(i[r]=e[r]);return{$$typeof:_I,type:n,key:o,ref:s,props:i,_owner:LI.current}}Cu.Fragment=PI;Cu.jsx=eS;Cu.jsxs=eS;$C.exports=Cu;var k=$C.exports,tS={exports:{}},yn={},nS={exports:{}},rS={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(D,K){var q=D.length;D.push(K);e:for(;0<q;){var de=q-1>>>1,ie=D[de];if(0<i(ie,K))D[de]=K,D[q]=ie,q=de;else break e}}function t(D){return D.length===0?null:D[0]}function r(D){if(D.length===0)return null;var K=D[0],q=D.pop();if(q!==K){D[0]=q;e:for(var de=0,ie=D.length,qe=ie>>>1;de<qe;){var ye=2*(de+1)-1,ee=D[ye],W=ye+1,Y=D[W];if(0>i(ee,q))W<ie&&0>i(Y,ee)?(D[de]=Y,D[W]=q,de=W):(D[de]=ee,D[ye]=q,de=ye);else if(W<ie&&0>i(Y,q))D[de]=Y,D[W]=q,de=W;else break e}}return K}function i(D,K){var q=D.sortIndex-K.sortIndex;return q!==0?q:D.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;n.unstable_now=function(){return o.now()}}else{var s=Date,a=s.now();n.unstable_now=function(){return s.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,v=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function C(D){for(var K=t(c);K!==null;){if(K.callback===null)r(c);else if(K.startTime<=D)r(c),K.sortIndex=K.expirationTime,e(l,K);else break;K=t(c)}}function w(D){if(m=!1,C(D),!p)if(t(l)!==null)p=!0,Kt(E);else{var K=t(c);K!==null&&He(w,K.startTime-D)}}function E(D,K){p=!1,m&&(m=!1,g(R),R=-1),f=!0;var q=h;try{for(C(K),d=t(l);d!==null&&(!(d.expirationTime>K)||D&&!V());){var de=d.callback;if(typeof de=="function"){d.callback=null,h=d.priorityLevel;var ie=de(d.expirationTime<=K);K=n.unstable_now(),typeof ie=="function"?d.callback=ie:d===t(l)&&r(l),C(K)}else r(l);d=t(l)}if(d!==null)var qe=!0;else{var ye=t(c);ye!==null&&He(w,ye.startTime-K),qe=!1}return qe}finally{d=null,h=q,f=!1}}var I=!1,b=null,R=-1,N=5,_=-1;function V(){return!(n.unstable_now()-_<N)}function ue(){if(b!==null){var D=n.unstable_now();_=D;var K=!0;try{K=b(!0,D)}finally{K?me():(I=!1,b=null)}}else I=!1}var me;if(typeof y=="function")me=function(){y(ue)};else if(typeof MessageChannel<"u"){var Ee=new MessageChannel,Zt=Ee.port2;Ee.port1.onmessage=ue,me=function(){Zt.postMessage(null)}}else me=function(){v(ue,0)};function Kt(D){b=D,I||(I=!0,me())}function He(D,K){R=v(function(){D(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(D){D.callback=null},n.unstable_continueExecution=function(){p||f||(p=!0,Kt(E))},n.unstable_forceFrameRate=function(D){0>D||125<D?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<D?Math.floor(1e3/D):5},n.unstable_getCurrentPriorityLevel=function(){return h},n.unstable_getFirstCallbackNode=function(){return t(l)},n.unstable_next=function(D){switch(h){case 1:case 2:case 3:var K=3;break;default:K=h}var q=h;h=K;try{return D()}finally{h=q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(D,K){switch(D){case 1:case 2:case 3:case 4:case 5:break;default:D=3}var q=h;h=D;try{return K()}finally{h=q}},n.unstable_scheduleCallback=function(D,K,q){var de=n.unstable_now();switch(typeof q=="object"&&q!==null?(q=q.delay,q=typeof q=="number"&&0<q?de+q:de):q=de,D){case 1:var ie=-1;break;case 2:ie=250;break;case 5:ie=1073741823;break;case 4:ie=1e4;break;default:ie=5e3}return ie=q+ie,D={id:u++,callback:K,priorityLevel:D,startTime:q,expirationTime:ie,sortIndex:-1},q>de?(D.sortIndex=q,e(c,D),t(l)===null&&D===t(c)&&(m?(g(R),R=-1):m=!0,He(w,q-de))):(D.sortIndex=ie,e(l,D),p||f||(p=!0,Kt(E))),D},n.unstable_shouldYield=V,n.unstable_wrapCallback=function(D){var K=h;return function(){var q=h;h=K;try{return D.apply(this,arguments)}finally{h=q}}}})(rS);nS.exports=rS;var HI=nS.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var FI=S,gn=HI;function M(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iS=new Set,wa={};function co(n,e){ns(n,e),ns(n+"Capture",e)}function ns(n,e){for(wa[n]=e,n=0;n<e.length;n++)iS.add(e[n])}var br=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Sh=Object.prototype.hasOwnProperty,BI=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,bg={},Rg={};function zI(n){return Sh.call(Rg,n)?!0:Sh.call(bg,n)?!1:BI.test(n)?Rg[n]=!0:(bg[n]=!0,!1)}function jI(n,e,t,r){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function KI(n,e,t,r){if(e===null||typeof e>"u"||jI(n,e,t,r))return!0;if(r)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ft(n,e,t,r,i,o,s){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=o,this.removeEmptyString=s}var yt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){yt[n]=new Ft(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];yt[e]=new Ft(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){yt[n]=new Ft(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){yt[n]=new Ft(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){yt[n]=new Ft(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){yt[n]=new Ft(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){yt[n]=new Ft(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){yt[n]=new Ft(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){yt[n]=new Ft(n,5,!1,n.toLowerCase(),null,!1,!1)});var up=/[\-:]([a-z])/g;function dp(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(up,dp);yt[e]=new Ft(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(up,dp);yt[e]=new Ft(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(up,dp);yt[e]=new Ft(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){yt[n]=new Ft(n,1,!1,n.toLowerCase(),null,!1,!1)});yt.xlinkHref=new Ft("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){yt[n]=new Ft(n,1,!1,n.toLowerCase(),null,!0,!0)});function hp(n,e,t,r){var i=yt.hasOwnProperty(e)?yt[e]:null;(i!==null?i.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(KI(e,t,i,r)&&(t=null),r||i===null?zI(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):i.mustUseProperty?n[i.propertyName]=t===null?i.type===3?!1:"":t:(e=i.attributeName,r=i.attributeNamespace,t===null?n.removeAttribute(e):(i=i.type,t=i===3||i===4&&t===!0?"":""+t,r?n.setAttributeNS(r,e,t):n.setAttribute(e,t))))}var Pr=FI.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ml=Symbol.for("react.element"),bo=Symbol.for("react.portal"),Ro=Symbol.for("react.fragment"),fp=Symbol.for("react.strict_mode"),wh=Symbol.for("react.profiler"),oS=Symbol.for("react.provider"),sS=Symbol.for("react.context"),pp=Symbol.for("react.forward_ref"),Th=Symbol.for("react.suspense"),Eh=Symbol.for("react.suspense_list"),mp=Symbol.for("react.memo"),$r=Symbol.for("react.lazy"),aS=Symbol.for("react.offscreen"),Ng=Symbol.iterator;function Ds(n){return n===null||typeof n!="object"?null:(n=Ng&&n[Ng]||n["@@iterator"],typeof n=="function"?n:null)}var Ue=Object.assign,yd;function $s(n){if(yd===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);yd=e&&e[1]||""}return`
`+yd+n}var vd=!1;function Cd(n,e){if(!n||vd)return"";vd=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(n,[],e)}else{try{e.call()}catch(c){r=c}n.call(e.prototype)}else{try{throw Error()}catch(c){r=c}n()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var i=c.stack.split(`
`),o=r.stack.split(`
`),s=i.length-1,a=o.length-1;1<=s&&0<=a&&i[s]!==o[a];)a--;for(;1<=s&&0<=a;s--,a--)if(i[s]!==o[a]){if(s!==1||a!==1)do if(s--,a--,0>a||i[s]!==o[a]){var l=`
`+i[s].replace(" at new "," at ");return n.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",n.displayName)),l}while(1<=s&&0<=a);break}}}finally{vd=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?$s(n):""}function $I(n){switch(n.tag){case 5:return $s(n.type);case 16:return $s("Lazy");case 13:return $s("Suspense");case 19:return $s("SuspenseList");case 0:case 2:case 15:return n=Cd(n.type,!1),n;case 11:return n=Cd(n.type.render,!1),n;case 1:return n=Cd(n.type,!0),n;default:return""}}function kh(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case Ro:return"Fragment";case bo:return"Portal";case wh:return"Profiler";case fp:return"StrictMode";case Th:return"Suspense";case Eh:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case sS:return(n.displayName||"Context")+".Consumer";case oS:return(n._context.displayName||"Context")+".Provider";case pp:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case mp:return e=n.displayName||null,e!==null?e:kh(n.type)||"Memo";case $r:e=n._payload,n=n._init;try{return kh(n(e))}catch{}}return null}function VI(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return kh(e);case 8:return e===fp?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Si(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function lS(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function WI(n){var e=lS(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),r=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var i=t.get,o=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return i.call(this)},set:function(s){r=""+s,o.call(this,s)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return r},setValue:function(s){r=""+s},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function gl(n){n._valueTracker||(n._valueTracker=WI(n))}function cS(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),r="";return n&&(r=lS(n)?n.checked?"true":"false":n.value),n=r,n!==t?(e.setValue(n),!0):!1}function fc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function Ih(n,e){var t=e.checked;return Ue({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function xg(n,e){var t=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;t=Si(e.value!=null?e.value:t),n._wrapperState={initialChecked:r,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function uS(n,e){e=e.checked,e!=null&&hp(n,"checked",e,!1)}function Ah(n,e){uS(n,e);var t=Si(e.value),r=e.type;if(t!=null)r==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(r==="submit"||r==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?bh(n,e.type,t):e.hasOwnProperty("defaultValue")&&bh(n,e.type,Si(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function Og(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function bh(n,e,t){(e!=="number"||fc(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var Vs=Array.isArray;function $o(n,e,t,r){if(n=n.options,e){e={};for(var i=0;i<t.length;i++)e["$"+t[i]]=!0;for(t=0;t<n.length;t++)i=e.hasOwnProperty("$"+n[t].value),n[t].selected!==i&&(n[t].selected=i),i&&r&&(n[t].defaultSelected=!0)}else{for(t=""+Si(t),e=null,i=0;i<n.length;i++){if(n[i].value===t){n[i].selected=!0,r&&(n[i].defaultSelected=!0);return}e!==null||n[i].disabled||(e=n[i])}e!==null&&(e.selected=!0)}}function Rh(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(M(91));return Ue({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function Mg(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(M(92));if(Vs(t)){if(1<t.length)throw Error(M(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Si(t)}}function dS(n,e){var t=Si(e.value),r=Si(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),r!=null&&(n.defaultValue=""+r)}function _g(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function hS(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Nh(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?hS(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var yl,fS=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,r,i){MSApp.execUnsafeLocalFunction(function(){return n(e,t,r,i)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(yl=yl||document.createElement("div"),yl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=yl.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Ta(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var Xs={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},GI=["Webkit","ms","Moz","O"];Object.keys(Xs).forEach(function(n){GI.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),Xs[e]=Xs[n]})});function pS(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||Xs.hasOwnProperty(n)&&Xs[n]?(""+e).trim():e+"px"}function mS(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var r=t.indexOf("--")===0,i=pS(t,e[t],r);t==="float"&&(t="cssFloat"),r?n.setProperty(t,i):n[t]=i}}var qI=Ue({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function xh(n,e){if(e){if(qI[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(M(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(M(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(M(61))}if(e.style!=null&&typeof e.style!="object")throw Error(M(62))}}function Oh(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Mh=null;function gp(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var _h=null,Vo=null,Wo=null;function Pg(n){if(n=nl(n)){if(typeof _h!="function")throw Error(M(280));var e=n.stateNode;e&&(e=ku(e),_h(n.stateNode,n.type,e))}}function gS(n){Vo?Wo?Wo.push(n):Wo=[n]:Vo=n}function yS(){if(Vo){var n=Vo,e=Wo;if(Wo=Vo=null,Pg(n),e)for(n=0;n<e.length;n++)Pg(e[n])}}function vS(n,e){return n(e)}function CS(){}var Sd=!1;function SS(n,e,t){if(Sd)return n(e,t);Sd=!0;try{return vS(n,e,t)}finally{Sd=!1,(Vo!==null||Wo!==null)&&(CS(),yS())}}function Ea(n,e){var t=n.stateNode;if(t===null)return null;var r=ku(t);if(r===null)return null;t=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(n=n.type,r=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!r;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(M(231,e,typeof t));return t}var Ph=!1;if(br)try{var Ls={};Object.defineProperty(Ls,"passive",{get:function(){Ph=!0}}),window.addEventListener("test",Ls,Ls),window.removeEventListener("test",Ls,Ls)}catch{Ph=!1}function QI(n,e,t,r,i,o,s,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(t,c)}catch(u){this.onError(u)}}var Zs=!1,pc=null,mc=!1,Dh=null,YI={onError:function(n){Zs=!0,pc=n}};function JI(n,e,t,r,i,o,s,a,l){Zs=!1,pc=null,QI.apply(YI,arguments)}function XI(n,e,t,r,i,o,s,a,l){if(JI.apply(this,arguments),Zs){if(Zs){var c=pc;Zs=!1,pc=null}else throw Error(M(198));mc||(mc=!0,Dh=c)}}function uo(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function wS(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function Dg(n){if(uo(n)!==n)throw Error(M(188))}function ZI(n){var e=n.alternate;if(!e){if(e=uo(n),e===null)throw Error(M(188));return e!==n?null:n}for(var t=n,r=e;;){var i=t.return;if(i===null)break;var o=i.alternate;if(o===null){if(r=i.return,r!==null){t=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===t)return Dg(i),n;if(o===r)return Dg(i),e;o=o.sibling}throw Error(M(188))}if(t.return!==r.return)t=i,r=o;else{for(var s=!1,a=i.child;a;){if(a===t){s=!0,t=i,r=o;break}if(a===r){s=!0,r=i,t=o;break}a=a.sibling}if(!s){for(a=o.child;a;){if(a===t){s=!0,t=o,r=i;break}if(a===r){s=!0,r=o,t=i;break}a=a.sibling}if(!s)throw Error(M(189))}}if(t.alternate!==r)throw Error(M(190))}if(t.tag!==3)throw Error(M(188));return t.stateNode.current===t?n:e}function TS(n){return n=ZI(n),n!==null?ES(n):null}function ES(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=ES(n);if(e!==null)return e;n=n.sibling}return null}var kS=gn.unstable_scheduleCallback,Lg=gn.unstable_cancelCallback,eA=gn.unstable_shouldYield,tA=gn.unstable_requestPaint,ze=gn.unstable_now,nA=gn.unstable_getCurrentPriorityLevel,yp=gn.unstable_ImmediatePriority,IS=gn.unstable_UserBlockingPriority,gc=gn.unstable_NormalPriority,rA=gn.unstable_LowPriority,AS=gn.unstable_IdlePriority,Su=null,sr=null;function iA(n){if(sr&&typeof sr.onCommitFiberRoot=="function")try{sr.onCommitFiberRoot(Su,n,void 0,(n.current.flags&128)===128)}catch{}}var Hn=Math.clz32?Math.clz32:aA,oA=Math.log,sA=Math.LN2;function aA(n){return n>>>=0,n===0?32:31-(oA(n)/sA|0)|0}var vl=64,Cl=4194304;function Ws(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function yc(n,e){var t=n.pendingLanes;if(t===0)return 0;var r=0,i=n.suspendedLanes,o=n.pingedLanes,s=t&268435455;if(s!==0){var a=s&~i;a!==0?r=Ws(a):(o&=s,o!==0&&(r=Ws(o)))}else s=t&~i,s!==0?r=Ws(s):o!==0&&(r=Ws(o));if(r===0)return 0;if(e!==0&&e!==r&&!(e&i)&&(i=r&-r,o=e&-e,i>=o||i===16&&(o&4194240)!==0))return e;if(r&4&&(r|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=r;0<e;)t=31-Hn(e),i=1<<t,r|=n[t],e&=~i;return r}function lA(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function cA(n,e){for(var t=n.suspendedLanes,r=n.pingedLanes,i=n.expirationTimes,o=n.pendingLanes;0<o;){var s=31-Hn(o),a=1<<s,l=i[s];l===-1?(!(a&t)||a&r)&&(i[s]=lA(a,e)):l<=e&&(n.expiredLanes|=a),o&=~a}}function Lh(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function bS(){var n=vl;return vl<<=1,!(vl&4194240)&&(vl=64),n}function wd(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function el(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Hn(e),n[e]=t}function uA(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var r=n.eventTimes;for(n=n.expirationTimes;0<t;){var i=31-Hn(t),o=1<<i;e[i]=0,r[i]=-1,n[i]=-1,t&=~o}}function vp(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var r=31-Hn(t),i=1<<r;i&e|n[r]&e&&(n[r]|=e),t&=~i}}var pe=0;function RS(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var NS,Cp,xS,OS,MS,Uh=!1,Sl=[],oi=null,si=null,ai=null,ka=new Map,Ia=new Map,Qr=[],dA="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ug(n,e){switch(n){case"focusin":case"focusout":oi=null;break;case"dragenter":case"dragleave":si=null;break;case"mouseover":case"mouseout":ai=null;break;case"pointerover":case"pointerout":ka.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ia.delete(e.pointerId)}}function Us(n,e,t,r,i,o){return n===null||n.nativeEvent!==o?(n={blockedOn:e,domEventName:t,eventSystemFlags:r,nativeEvent:o,targetContainers:[i]},e!==null&&(e=nl(e),e!==null&&Cp(e)),n):(n.eventSystemFlags|=r,e=n.targetContainers,i!==null&&e.indexOf(i)===-1&&e.push(i),n)}function hA(n,e,t,r,i){switch(e){case"focusin":return oi=Us(oi,n,e,t,r,i),!0;case"dragenter":return si=Us(si,n,e,t,r,i),!0;case"mouseover":return ai=Us(ai,n,e,t,r,i),!0;case"pointerover":var o=i.pointerId;return ka.set(o,Us(ka.get(o)||null,n,e,t,r,i)),!0;case"gotpointercapture":return o=i.pointerId,Ia.set(o,Us(Ia.get(o)||null,n,e,t,r,i)),!0}return!1}function _S(n){var e=Di(n.target);if(e!==null){var t=uo(e);if(t!==null){if(e=t.tag,e===13){if(e=wS(t),e!==null){n.blockedOn=e,MS(n.priority,function(){xS(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Jl(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=Hh(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var r=new t.constructor(t.type,t);Mh=r,t.target.dispatchEvent(r),Mh=null}else return e=nl(t),e!==null&&Cp(e),n.blockedOn=t,!1;e.shift()}return!0}function Hg(n,e,t){Jl(n)&&t.delete(e)}function fA(){Uh=!1,oi!==null&&Jl(oi)&&(oi=null),si!==null&&Jl(si)&&(si=null),ai!==null&&Jl(ai)&&(ai=null),ka.forEach(Hg),Ia.forEach(Hg)}function Hs(n,e){n.blockedOn===e&&(n.blockedOn=null,Uh||(Uh=!0,gn.unstable_scheduleCallback(gn.unstable_NormalPriority,fA)))}function Aa(n){function e(i){return Hs(i,n)}if(0<Sl.length){Hs(Sl[0],n);for(var t=1;t<Sl.length;t++){var r=Sl[t];r.blockedOn===n&&(r.blockedOn=null)}}for(oi!==null&&Hs(oi,n),si!==null&&Hs(si,n),ai!==null&&Hs(ai,n),ka.forEach(e),Ia.forEach(e),t=0;t<Qr.length;t++)r=Qr[t],r.blockedOn===n&&(r.blockedOn=null);for(;0<Qr.length&&(t=Qr[0],t.blockedOn===null);)_S(t),t.blockedOn===null&&Qr.shift()}var Go=Pr.ReactCurrentBatchConfig,vc=!0;function pA(n,e,t,r){var i=pe,o=Go.transition;Go.transition=null;try{pe=1,Sp(n,e,t,r)}finally{pe=i,Go.transition=o}}function mA(n,e,t,r){var i=pe,o=Go.transition;Go.transition=null;try{pe=4,Sp(n,e,t,r)}finally{pe=i,Go.transition=o}}function Sp(n,e,t,r){if(vc){var i=Hh(n,e,t,r);if(i===null)Od(n,e,r,Cc,t),Ug(n,r);else if(hA(i,n,e,t,r))r.stopPropagation();else if(Ug(n,r),e&4&&-1<dA.indexOf(n)){for(;i!==null;){var o=nl(i);if(o!==null&&NS(o),o=Hh(n,e,t,r),o===null&&Od(n,e,r,Cc,t),o===i)break;i=o}i!==null&&r.stopPropagation()}else Od(n,e,r,null,t)}}var Cc=null;function Hh(n,e,t,r){if(Cc=null,n=gp(r),n=Di(n),n!==null)if(e=uo(n),e===null)n=null;else if(t=e.tag,t===13){if(n=wS(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Cc=n,null}function PS(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nA()){case yp:return 1;case IS:return 4;case gc:case rA:return 16;case AS:return 536870912;default:return 16}default:return 16}}var Xr=null,wp=null,Xl=null;function DS(){if(Xl)return Xl;var n,e=wp,t=e.length,r,i="value"in Xr?Xr.value:Xr.textContent,o=i.length;for(n=0;n<t&&e[n]===i[n];n++);var s=t-n;for(r=1;r<=s&&e[t-r]===i[o-r];r++);return Xl=i.slice(n,1<r?1-r:void 0)}function Zl(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function wl(){return!0}function Fg(){return!1}function vn(n){function e(t,r,i,o,s){this._reactName=t,this._targetInst=i,this.type=r,this.nativeEvent=o,this.target=s,this.currentTarget=null;for(var a in n)n.hasOwnProperty(a)&&(t=n[a],this[a]=t?t(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?wl:Fg,this.isPropagationStopped=Fg,this}return Ue(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=wl)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=wl)},persist:function(){},isPersistent:wl}),e}var Es={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Tp=vn(Es),tl=Ue({},Es,{view:0,detail:0}),gA=vn(tl),Td,Ed,Fs,wu=Ue({},tl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Ep,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Fs&&(Fs&&n.type==="mousemove"?(Td=n.screenX-Fs.screenX,Ed=n.screenY-Fs.screenY):Ed=Td=0,Fs=n),Td)},movementY:function(n){return"movementY"in n?n.movementY:Ed}}),Bg=vn(wu),yA=Ue({},wu,{dataTransfer:0}),vA=vn(yA),CA=Ue({},tl,{relatedTarget:0}),kd=vn(CA),SA=Ue({},Es,{animationName:0,elapsedTime:0,pseudoElement:0}),wA=vn(SA),TA=Ue({},Es,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),EA=vn(TA),kA=Ue({},Es,{data:0}),zg=vn(kA),IA={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},AA={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},bA={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function RA(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=bA[n])?!!e[n]:!1}function Ep(){return RA}var NA=Ue({},tl,{key:function(n){if(n.key){var e=IA[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=Zl(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?AA[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Ep,charCode:function(n){return n.type==="keypress"?Zl(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?Zl(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),xA=vn(NA),OA=Ue({},wu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),jg=vn(OA),MA=Ue({},tl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Ep}),_A=vn(MA),PA=Ue({},Es,{propertyName:0,elapsedTime:0,pseudoElement:0}),DA=vn(PA),LA=Ue({},wu,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),UA=vn(LA),HA=[9,13,27,32],kp=br&&"CompositionEvent"in window,ea=null;br&&"documentMode"in document&&(ea=document.documentMode);var FA=br&&"TextEvent"in window&&!ea,LS=br&&(!kp||ea&&8<ea&&11>=ea),Kg=" ",$g=!1;function US(n,e){switch(n){case"keyup":return HA.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function HS(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var No=!1;function BA(n,e){switch(n){case"compositionend":return HS(e);case"keypress":return e.which!==32?null:($g=!0,Kg);case"textInput":return n=e.data,n===Kg&&$g?null:n;default:return null}}function zA(n,e){if(No)return n==="compositionend"||!kp&&US(n,e)?(n=DS(),Xl=wp=Xr=null,No=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return LS&&e.locale!=="ko"?null:e.data;default:return null}}var jA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Vg(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!jA[n.type]:e==="textarea"}function FS(n,e,t,r){gS(r),e=Sc(e,"onChange"),0<e.length&&(t=new Tp("onChange","change",null,t,r),n.push({event:t,listeners:e}))}var ta=null,ba=null;function KA(n){YS(n,0)}function Tu(n){var e=Mo(n);if(cS(e))return n}function $A(n,e){if(n==="change")return e}var BS=!1;if(br){var Id;if(br){var Ad="oninput"in document;if(!Ad){var Wg=document.createElement("div");Wg.setAttribute("oninput","return;"),Ad=typeof Wg.oninput=="function"}Id=Ad}else Id=!1;BS=Id&&(!document.documentMode||9<document.documentMode)}function Gg(){ta&&(ta.detachEvent("onpropertychange",zS),ba=ta=null)}function zS(n){if(n.propertyName==="value"&&Tu(ba)){var e=[];FS(e,ba,n,gp(n)),SS(KA,e)}}function VA(n,e,t){n==="focusin"?(Gg(),ta=e,ba=t,ta.attachEvent("onpropertychange",zS)):n==="focusout"&&Gg()}function WA(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return Tu(ba)}function GA(n,e){if(n==="click")return Tu(e)}function qA(n,e){if(n==="input"||n==="change")return Tu(e)}function QA(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var jn=typeof Object.is=="function"?Object.is:QA;function Ra(n,e){if(jn(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(r=0;r<t.length;r++){var i=t[r];if(!Sh.call(e,i)||!jn(n[i],e[i]))return!1}return!0}function qg(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Qg(n,e){var t=qg(n);n=0;for(var r;t;){if(t.nodeType===3){if(r=n+t.textContent.length,n<=e&&r>=e)return{node:t,offset:e-n};n=r}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=qg(t)}}function jS(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?jS(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function KS(){for(var n=window,e=fc();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=fc(n.document)}return e}function Ip(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function YA(n){var e=KS(),t=n.focusedElem,r=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&jS(t.ownerDocument.documentElement,t)){if(r!==null&&Ip(t)){if(e=r.start,n=r.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var i=t.textContent.length,o=Math.min(r.start,i);r=r.end===void 0?o:Math.min(r.end,i),!n.extend&&o>r&&(i=r,r=o,o=i),i=Qg(t,o);var s=Qg(t,r);i&&s&&(n.rangeCount!==1||n.anchorNode!==i.node||n.anchorOffset!==i.offset||n.focusNode!==s.node||n.focusOffset!==s.offset)&&(e=e.createRange(),e.setStart(i.node,i.offset),n.removeAllRanges(),o>r?(n.addRange(e),n.extend(s.node,s.offset)):(e.setEnd(s.node,s.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var JA=br&&"documentMode"in document&&11>=document.documentMode,xo=null,Fh=null,na=null,Bh=!1;function Yg(n,e,t){var r=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;Bh||xo==null||xo!==fc(r)||(r=xo,"selectionStart"in r&&Ip(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),na&&Ra(na,r)||(na=r,r=Sc(Fh,"onSelect"),0<r.length&&(e=new Tp("onSelect","select",null,e,t),n.push({event:e,listeners:r}),e.target=xo)))}function Tl(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var Oo={animationend:Tl("Animation","AnimationEnd"),animationiteration:Tl("Animation","AnimationIteration"),animationstart:Tl("Animation","AnimationStart"),transitionend:Tl("Transition","TransitionEnd")},bd={},$S={};br&&($S=document.createElement("div").style,"AnimationEvent"in window||(delete Oo.animationend.animation,delete Oo.animationiteration.animation,delete Oo.animationstart.animation),"TransitionEvent"in window||delete Oo.transitionend.transition);function Eu(n){if(bd[n])return bd[n];if(!Oo[n])return n;var e=Oo[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in $S)return bd[n]=e[t];return n}var VS=Eu("animationend"),WS=Eu("animationiteration"),GS=Eu("animationstart"),qS=Eu("transitionend"),QS=new Map,Jg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ii(n,e){QS.set(n,e),co(e,[n])}for(var Rd=0;Rd<Jg.length;Rd++){var Nd=Jg[Rd],XA=Nd.toLowerCase(),ZA=Nd[0].toUpperCase()+Nd.slice(1);Ii(XA,"on"+ZA)}Ii(VS,"onAnimationEnd");Ii(WS,"onAnimationIteration");Ii(GS,"onAnimationStart");Ii("dblclick","onDoubleClick");Ii("focusin","onFocus");Ii("focusout","onBlur");Ii(qS,"onTransitionEnd");ns("onMouseEnter",["mouseout","mouseover"]);ns("onMouseLeave",["mouseout","mouseover"]);ns("onPointerEnter",["pointerout","pointerover"]);ns("onPointerLeave",["pointerout","pointerover"]);co("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));co("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));co("onBeforeInput",["compositionend","keypress","textInput","paste"]);co("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));co("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));co("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Gs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),eb=new Set("cancel close invalid load scroll toggle".split(" ").concat(Gs));function Xg(n,e,t){var r=n.type||"unknown-event";n.currentTarget=t,XI(r,e,void 0,n),n.currentTarget=null}function YS(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var r=n[t],i=r.event;r=r.listeners;e:{var o=void 0;if(e)for(var s=r.length-1;0<=s;s--){var a=r[s],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&i.isPropagationStopped())break e;Xg(i,a,c),o=l}else for(s=0;s<r.length;s++){if(a=r[s],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&i.isPropagationStopped())break e;Xg(i,a,c),o=l}}}if(mc)throw n=Dh,mc=!1,Dh=null,n}function Ae(n,e){var t=e[Vh];t===void 0&&(t=e[Vh]=new Set);var r=n+"__bubble";t.has(r)||(JS(e,n,2,!1),t.add(r))}function xd(n,e,t){var r=0;e&&(r|=4),JS(t,n,r,e)}var El="_reactListening"+Math.random().toString(36).slice(2);function Na(n){if(!n[El]){n[El]=!0,iS.forEach(function(t){t!=="selectionchange"&&(eb.has(t)||xd(t,!1,n),xd(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[El]||(e[El]=!0,xd("selectionchange",!1,e))}}function JS(n,e,t,r){switch(PS(e)){case 1:var i=pA;break;case 4:i=mA;break;default:i=Sp}t=i.bind(null,e,t,n),i=void 0,!Ph||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(i=!0),r?i!==void 0?n.addEventListener(e,t,{capture:!0,passive:i}):n.addEventListener(e,t,!0):i!==void 0?n.addEventListener(e,t,{passive:i}):n.addEventListener(e,t,!1)}function Od(n,e,t,r,i){var o=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var s=r.tag;if(s===3||s===4){var a=r.stateNode.containerInfo;if(a===i||a.nodeType===8&&a.parentNode===i)break;if(s===4)for(s=r.return;s!==null;){var l=s.tag;if((l===3||l===4)&&(l=s.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;s=s.return}for(;a!==null;){if(s=Di(a),s===null)return;if(l=s.tag,l===5||l===6){r=o=s;continue e}a=a.parentNode}}r=r.return}SS(function(){var c=o,u=gp(t),d=[];e:{var h=QS.get(n);if(h!==void 0){var f=Tp,p=n;switch(n){case"keypress":if(Zl(t)===0)break e;case"keydown":case"keyup":f=xA;break;case"focusin":p="focus",f=kd;break;case"focusout":p="blur",f=kd;break;case"beforeblur":case"afterblur":f=kd;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=Bg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=vA;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=_A;break;case VS:case WS:case GS:f=wA;break;case qS:f=DA;break;case"scroll":f=gA;break;case"wheel":f=UA;break;case"copy":case"cut":case"paste":f=EA;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=jg}var m=(e&4)!==0,v=!m&&n==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,C;y!==null;){C=y;var w=C.stateNode;if(C.tag===5&&w!==null&&(C=w,g!==null&&(w=Ea(y,g),w!=null&&m.push(xa(y,w,C)))),v)break;y=y.return}0<m.length&&(h=new f(h,p,null,t,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=n==="mouseover"||n==="pointerover",f=n==="mouseout"||n==="pointerout",h&&t!==Mh&&(p=t.relatedTarget||t.fromElement)&&(Di(p)||p[Rr]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=t.relatedTarget||t.toElement,f=c,p=p?Di(p):null,p!==null&&(v=uo(p),p!==v||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=Bg,w="onMouseLeave",g="onMouseEnter",y="mouse",(n==="pointerout"||n==="pointerover")&&(m=jg,w="onPointerLeave",g="onPointerEnter",y="pointer"),v=f==null?h:Mo(f),C=p==null?h:Mo(p),h=new m(w,y+"leave",f,t,u),h.target=v,h.relatedTarget=C,w=null,Di(u)===c&&(m=new m(g,y+"enter",p,t,u),m.target=C,m.relatedTarget=v,w=m),v=w,f&&p)t:{for(m=f,g=p,y=0,C=m;C;C=vo(C))y++;for(C=0,w=g;w;w=vo(w))C++;for(;0<y-C;)m=vo(m),y--;for(;0<C-y;)g=vo(g),C--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=vo(m),g=vo(g)}m=null}else m=null;f!==null&&Zg(d,h,f,m,!1),p!==null&&v!==null&&Zg(d,v,p,m,!0)}}e:{if(h=c?Mo(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var E=$A;else if(Vg(h))if(BS)E=qA;else{E=WA;var I=VA}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=GA);if(E&&(E=E(n,c))){FS(d,E,t,u);break e}I&&I(n,h,c),n==="focusout"&&(I=h._wrapperState)&&I.controlled&&h.type==="number"&&bh(h,"number",h.value)}switch(I=c?Mo(c):window,n){case"focusin":(Vg(I)||I.contentEditable==="true")&&(xo=I,Fh=c,na=null);break;case"focusout":na=Fh=xo=null;break;case"mousedown":Bh=!0;break;case"contextmenu":case"mouseup":case"dragend":Bh=!1,Yg(d,t,u);break;case"selectionchange":if(JA)break;case"keydown":case"keyup":Yg(d,t,u)}var b;if(kp)e:{switch(n){case"compositionstart":var R="onCompositionStart";break e;case"compositionend":R="onCompositionEnd";break e;case"compositionupdate":R="onCompositionUpdate";break e}R=void 0}else No?US(n,t)&&(R="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(R="onCompositionStart");R&&(LS&&t.locale!=="ko"&&(No||R!=="onCompositionStart"?R==="onCompositionEnd"&&No&&(b=DS()):(Xr=u,wp="value"in Xr?Xr.value:Xr.textContent,No=!0)),I=Sc(c,R),0<I.length&&(R=new zg(R,n,null,t,u),d.push({event:R,listeners:I}),b?R.data=b:(b=HS(t),b!==null&&(R.data=b)))),(b=FA?BA(n,t):zA(n,t))&&(c=Sc(c,"onBeforeInput"),0<c.length&&(u=new zg("onBeforeInput","beforeinput",null,t,u),d.push({event:u,listeners:c}),u.data=b))}YS(d,e)})}function xa(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Sc(n,e){for(var t=e+"Capture",r=[];n!==null;){var i=n,o=i.stateNode;i.tag===5&&o!==null&&(i=o,o=Ea(n,t),o!=null&&r.unshift(xa(n,o,i)),o=Ea(n,e),o!=null&&r.push(xa(n,o,i))),n=n.return}return r}function vo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function Zg(n,e,t,r,i){for(var o=e._reactName,s=[];t!==null&&t!==r;){var a=t,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,i?(l=Ea(t,o),l!=null&&s.unshift(xa(t,l,a))):i||(l=Ea(t,o),l!=null&&s.push(xa(t,l,a)))),t=t.return}s.length!==0&&n.push({event:e,listeners:s})}var tb=/\r\n?/g,nb=/\u0000|\uFFFD/g;function ey(n){return(typeof n=="string"?n:""+n).replace(tb,`
`).replace(nb,"")}function kl(n,e,t){if(e=ey(e),ey(n)!==e&&t)throw Error(M(425))}function wc(){}var zh=null,jh=null;function Kh(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var $h=typeof setTimeout=="function"?setTimeout:void 0,rb=typeof clearTimeout=="function"?clearTimeout:void 0,ty=typeof Promise=="function"?Promise:void 0,ib=typeof queueMicrotask=="function"?queueMicrotask:typeof ty<"u"?function(n){return ty.resolve(null).then(n).catch(ob)}:$h;function ob(n){setTimeout(function(){throw n})}function Md(n,e){var t=e,r=0;do{var i=t.nextSibling;if(n.removeChild(t),i&&i.nodeType===8)if(t=i.data,t==="/$"){if(r===0){n.removeChild(i),Aa(e);return}r--}else t!=="$"&&t!=="$?"&&t!=="$!"||r++;t=i}while(t);Aa(e)}function li(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function ny(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var ks=Math.random().toString(36).slice(2),tr="__reactFiber$"+ks,Oa="__reactProps$"+ks,Rr="__reactContainer$"+ks,Vh="__reactEvents$"+ks,sb="__reactListeners$"+ks,ab="__reactHandles$"+ks;function Di(n){var e=n[tr];if(e)return e;for(var t=n.parentNode;t;){if(e=t[Rr]||t[tr]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=ny(n);n!==null;){if(t=n[tr])return t;n=ny(n)}return e}n=t,t=n.parentNode}return null}function nl(n){return n=n[tr]||n[Rr],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function Mo(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(M(33))}function ku(n){return n[Oa]||null}var Wh=[],_o=-1;function Ai(n){return{current:n}}function Re(n){0>_o||(n.current=Wh[_o],Wh[_o]=null,_o--)}function Te(n,e){_o++,Wh[_o]=n.current,n.current=e}var wi={},Rt=Ai(wi),qt=Ai(!1),Qi=wi;function rs(n,e){var t=n.type.contextTypes;if(!t)return wi;var r=n.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var i={},o;for(o in t)i[o]=e[o];return r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=i),i}function Qt(n){return n=n.childContextTypes,n!=null}function Tc(){Re(qt),Re(Rt)}function ry(n,e,t){if(Rt.current!==wi)throw Error(M(168));Te(Rt,e),Te(qt,t)}function XS(n,e,t){var r=n.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return t;r=r.getChildContext();for(var i in r)if(!(i in e))throw Error(M(108,VI(n)||"Unknown",i));return Ue({},t,r)}function Ec(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||wi,Qi=Rt.current,Te(Rt,n),Te(qt,qt.current),!0}function iy(n,e,t){var r=n.stateNode;if(!r)throw Error(M(169));t?(n=XS(n,e,Qi),r.__reactInternalMemoizedMergedChildContext=n,Re(qt),Re(Rt),Te(Rt,n)):Re(qt),Te(qt,t)}var vr=null,Iu=!1,_d=!1;function ZS(n){vr===null?vr=[n]:vr.push(n)}function lb(n){Iu=!0,ZS(n)}function bi(){if(!_d&&vr!==null){_d=!0;var n=0,e=pe;try{var t=vr;for(pe=1;n<t.length;n++){var r=t[n];do r=r(!0);while(r!==null)}vr=null,Iu=!1}catch(i){throw vr!==null&&(vr=vr.slice(n+1)),kS(yp,bi),i}finally{pe=e,_d=!1}}return null}var Po=[],Do=0,kc=null,Ic=0,Tn=[],En=0,Yi=null,Cr=1,Sr="";function Oi(n,e){Po[Do++]=Ic,Po[Do++]=kc,kc=n,Ic=e}function ew(n,e,t){Tn[En++]=Cr,Tn[En++]=Sr,Tn[En++]=Yi,Yi=n;var r=Cr;n=Sr;var i=32-Hn(r)-1;r&=~(1<<i),t+=1;var o=32-Hn(e)+i;if(30<o){var s=i-i%5;o=(r&(1<<s)-1).toString(32),r>>=s,i-=s,Cr=1<<32-Hn(e)+i|t<<i|r,Sr=o+n}else Cr=1<<o|t<<i|r,Sr=n}function Ap(n){n.return!==null&&(Oi(n,1),ew(n,1,0))}function bp(n){for(;n===kc;)kc=Po[--Do],Po[Do]=null,Ic=Po[--Do],Po[Do]=null;for(;n===Yi;)Yi=Tn[--En],Tn[En]=null,Sr=Tn[--En],Tn[En]=null,Cr=Tn[--En],Tn[En]=null}var mn=null,hn=null,Oe=!1,Ln=null;function tw(n,e){var t=In(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function oy(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,mn=n,hn=li(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,mn=n,hn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=Yi!==null?{id:Cr,overflow:Sr}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=In(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,mn=n,hn=null,!0):!1;default:return!1}}function Gh(n){return(n.mode&1)!==0&&(n.flags&128)===0}function qh(n){if(Oe){var e=hn;if(e){var t=e;if(!oy(n,e)){if(Gh(n))throw Error(M(418));e=li(t.nextSibling);var r=mn;e&&oy(n,e)?tw(r,t):(n.flags=n.flags&-4097|2,Oe=!1,mn=n)}}else{if(Gh(n))throw Error(M(418));n.flags=n.flags&-4097|2,Oe=!1,mn=n}}}function sy(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;mn=n}function Il(n){if(n!==mn)return!1;if(!Oe)return sy(n),Oe=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!Kh(n.type,n.memoizedProps)),e&&(e=hn)){if(Gh(n))throw nw(),Error(M(418));for(;e;)tw(n,e),e=li(e.nextSibling)}if(sy(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(M(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){hn=li(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}hn=null}}else hn=mn?li(n.stateNode.nextSibling):null;return!0}function nw(){for(var n=hn;n;)n=li(n.nextSibling)}function is(){hn=mn=null,Oe=!1}function Rp(n){Ln===null?Ln=[n]:Ln.push(n)}var cb=Pr.ReactCurrentBatchConfig;function Bs(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(M(309));var r=t.stateNode}if(!r)throw Error(M(147,n));var i=r,o=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(s){var a=i.refs;s===null?delete a[o]:a[o]=s},e._stringRef=o,e)}if(typeof n!="string")throw Error(M(284));if(!t._owner)throw Error(M(290,n))}return n}function Al(n,e){throw n=Object.prototype.toString.call(e),Error(M(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function ay(n){var e=n._init;return e(n._payload)}function rw(n){function e(g,y){if(n){var C=g.deletions;C===null?(g.deletions=[y],g.flags|=16):C.push(y)}}function t(g,y){if(!n)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function r(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function i(g,y){return g=hi(g,y),g.index=0,g.sibling=null,g}function o(g,y,C){return g.index=C,n?(C=g.alternate,C!==null?(C=C.index,C<y?(g.flags|=2,y):C):(g.flags|=2,y)):(g.flags|=1048576,y)}function s(g){return n&&g.alternate===null&&(g.flags|=2),g}function a(g,y,C,w){return y===null||y.tag!==6?(y=Bd(C,g.mode,w),y.return=g,y):(y=i(y,C),y.return=g,y)}function l(g,y,C,w){var E=C.type;return E===Ro?u(g,y,C.props.children,w,C.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===$r&&ay(E)===y.type)?(w=i(y,C.props),w.ref=Bs(g,y,C),w.return=g,w):(w=sc(C.type,C.key,C.props,null,g.mode,w),w.ref=Bs(g,y,C),w.return=g,w)}function c(g,y,C,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==C.containerInfo||y.stateNode.implementation!==C.implementation?(y=zd(C,g.mode,w),y.return=g,y):(y=i(y,C.children||[]),y.return=g,y)}function u(g,y,C,w,E){return y===null||y.tag!==7?(y=Ki(C,g.mode,w,E),y.return=g,y):(y=i(y,C),y.return=g,y)}function d(g,y,C){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Bd(""+y,g.mode,C),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case ml:return C=sc(y.type,y.key,y.props,null,g.mode,C),C.ref=Bs(g,null,y),C.return=g,C;case bo:return y=zd(y,g.mode,C),y.return=g,y;case $r:var w=y._init;return d(g,w(y._payload),C)}if(Vs(y)||Ds(y))return y=Ki(y,g.mode,C,null),y.return=g,y;Al(g,y)}return null}function h(g,y,C,w){var E=y!==null?y.key:null;if(typeof C=="string"&&C!==""||typeof C=="number")return E!==null?null:a(g,y,""+C,w);if(typeof C=="object"&&C!==null){switch(C.$$typeof){case ml:return C.key===E?l(g,y,C,w):null;case bo:return C.key===E?c(g,y,C,w):null;case $r:return E=C._init,h(g,y,E(C._payload),w)}if(Vs(C)||Ds(C))return E!==null?null:u(g,y,C,w,null);Al(g,C)}return null}function f(g,y,C,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(C)||null,a(y,g,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case ml:return g=g.get(w.key===null?C:w.key)||null,l(y,g,w,E);case bo:return g=g.get(w.key===null?C:w.key)||null,c(y,g,w,E);case $r:var I=w._init;return f(g,y,C,I(w._payload),E)}if(Vs(w)||Ds(w))return g=g.get(C)||null,u(y,g,w,E,null);Al(y,w)}return null}function p(g,y,C,w){for(var E=null,I=null,b=y,R=y=0,N=null;b!==null&&R<C.length;R++){b.index>R?(N=b,b=null):N=b.sibling;var _=h(g,b,C[R],w);if(_===null){b===null&&(b=N);break}n&&b&&_.alternate===null&&e(g,b),y=o(_,y,R),I===null?E=_:I.sibling=_,I=_,b=N}if(R===C.length)return t(g,b),Oe&&Oi(g,R),E;if(b===null){for(;R<C.length;R++)b=d(g,C[R],w),b!==null&&(y=o(b,y,R),I===null?E=b:I.sibling=b,I=b);return Oe&&Oi(g,R),E}for(b=r(g,b);R<C.length;R++)N=f(b,g,R,C[R],w),N!==null&&(n&&N.alternate!==null&&b.delete(N.key===null?R:N.key),y=o(N,y,R),I===null?E=N:I.sibling=N,I=N);return n&&b.forEach(function(V){return e(g,V)}),Oe&&Oi(g,R),E}function m(g,y,C,w){var E=Ds(C);if(typeof E!="function")throw Error(M(150));if(C=E.call(C),C==null)throw Error(M(151));for(var I=E=null,b=y,R=y=0,N=null,_=C.next();b!==null&&!_.done;R++,_=C.next()){b.index>R?(N=b,b=null):N=b.sibling;var V=h(g,b,_.value,w);if(V===null){b===null&&(b=N);break}n&&b&&V.alternate===null&&e(g,b),y=o(V,y,R),I===null?E=V:I.sibling=V,I=V,b=N}if(_.done)return t(g,b),Oe&&Oi(g,R),E;if(b===null){for(;!_.done;R++,_=C.next())_=d(g,_.value,w),_!==null&&(y=o(_,y,R),I===null?E=_:I.sibling=_,I=_);return Oe&&Oi(g,R),E}for(b=r(g,b);!_.done;R++,_=C.next())_=f(b,g,R,_.value,w),_!==null&&(n&&_.alternate!==null&&b.delete(_.key===null?R:_.key),y=o(_,y,R),I===null?E=_:I.sibling=_,I=_);return n&&b.forEach(function(ue){return e(g,ue)}),Oe&&Oi(g,R),E}function v(g,y,C,w){if(typeof C=="object"&&C!==null&&C.type===Ro&&C.key===null&&(C=C.props.children),typeof C=="object"&&C!==null){switch(C.$$typeof){case ml:e:{for(var E=C.key,I=y;I!==null;){if(I.key===E){if(E=C.type,E===Ro){if(I.tag===7){t(g,I.sibling),y=i(I,C.props.children),y.return=g,g=y;break e}}else if(I.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===$r&&ay(E)===I.type){t(g,I.sibling),y=i(I,C.props),y.ref=Bs(g,I,C),y.return=g,g=y;break e}t(g,I);break}else e(g,I);I=I.sibling}C.type===Ro?(y=Ki(C.props.children,g.mode,w,C.key),y.return=g,g=y):(w=sc(C.type,C.key,C.props,null,g.mode,w),w.ref=Bs(g,y,C),w.return=g,g=w)}return s(g);case bo:e:{for(I=C.key;y!==null;){if(y.key===I)if(y.tag===4&&y.stateNode.containerInfo===C.containerInfo&&y.stateNode.implementation===C.implementation){t(g,y.sibling),y=i(y,C.children||[]),y.return=g,g=y;break e}else{t(g,y);break}else e(g,y);y=y.sibling}y=zd(C,g.mode,w),y.return=g,g=y}return s(g);case $r:return I=C._init,v(g,y,I(C._payload),w)}if(Vs(C))return p(g,y,C,w);if(Ds(C))return m(g,y,C,w);Al(g,C)}return typeof C=="string"&&C!==""||typeof C=="number"?(C=""+C,y!==null&&y.tag===6?(t(g,y.sibling),y=i(y,C),y.return=g,g=y):(t(g,y),y=Bd(C,g.mode,w),y.return=g,g=y),s(g)):t(g,y)}return v}var ss=rw(!0),iw=rw(!1),Ac=Ai(null),bc=null,Lo=null,Np=null;function xp(){Np=Lo=bc=null}function Op(n){var e=Ac.current;Re(Ac),n._currentValue=e}function Qh(n,e,t){for(;n!==null;){var r=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),n===t)break;n=n.return}}function qo(n,e){bc=n,Np=Lo=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Gt=!0),n.firstContext=null)}function xn(n){var e=n._currentValue;if(Np!==n)if(n={context:n,memoizedValue:e,next:null},Lo===null){if(bc===null)throw Error(M(308));Lo=n,bc.dependencies={lanes:0,firstContext:n}}else Lo=Lo.next=n;return e}var Li=null;function Mp(n){Li===null?Li=[n]:Li.push(n)}function ow(n,e,t,r){var i=e.interleaved;return i===null?(t.next=t,Mp(e)):(t.next=i.next,i.next=t),e.interleaved=t,Nr(n,r)}function Nr(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var Vr=!1;function _p(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function sw(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function kr(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function ci(n,e,t){var r=n.updateQueue;if(r===null)return null;if(r=r.shared,ce&2){var i=r.pending;return i===null?e.next=e:(e.next=i.next,i.next=e),r.pending=e,Nr(n,t)}return i=r.interleaved,i===null?(e.next=e,Mp(r)):(e.next=i.next,i.next=e),r.interleaved=e,Nr(n,t)}function ec(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,vp(n,t)}}function ly(n,e){var t=n.updateQueue,r=n.alternate;if(r!==null&&(r=r.updateQueue,t===r)){var i=null,o=null;if(t=t.firstBaseUpdate,t!==null){do{var s={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};o===null?i=o=s:o=o.next=s,t=t.next}while(t!==null);o===null?i=o=e:o=o.next=e}else i=o=e;t={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:o,shared:r.shared,effects:r.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function Rc(n,e,t,r){var i=n.updateQueue;Vr=!1;var o=i.firstBaseUpdate,s=i.lastBaseUpdate,a=i.shared.pending;if(a!==null){i.shared.pending=null;var l=a,c=l.next;l.next=null,s===null?o=c:s.next=c,s=l;var u=n.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==s&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=i.baseState;s=0,u=c=l=null,a=o;do{var h=a.lane,f=a.eventTime;if((r&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=n,m=a;switch(h=e,f=t,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Ue({},d,h);break e;case 2:Vr=!0}}a.callback!==null&&a.lane!==0&&(n.flags|=64,h=i.effects,h===null?i.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,s|=h;if(a=a.next,a===null){if(a=i.shared.pending,a===null)break;h=a,a=h.next,h.next=null,i.lastBaseUpdate=h,i.shared.pending=null}}while(!0);if(u===null&&(l=d),i.baseState=l,i.firstBaseUpdate=c,i.lastBaseUpdate=u,e=i.shared.interleaved,e!==null){i=e;do s|=i.lane,i=i.next;while(i!==e)}else o===null&&(i.shared.lanes=0);Xi|=s,n.lanes=s,n.memoizedState=d}}function cy(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var r=n[e],i=r.callback;if(i!==null){if(r.callback=null,r=t,typeof i!="function")throw Error(M(191,i));i.call(r)}}}var rl={},ar=Ai(rl),Ma=Ai(rl),_a=Ai(rl);function Ui(n){if(n===rl)throw Error(M(174));return n}function Pp(n,e){switch(Te(_a,e),Te(Ma,n),Te(ar,rl),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Nh(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=Nh(e,n)}Re(ar),Te(ar,e)}function as(){Re(ar),Re(Ma),Re(_a)}function aw(n){Ui(_a.current);var e=Ui(ar.current),t=Nh(e,n.type);e!==t&&(Te(Ma,n),Te(ar,t))}function Dp(n){Ma.current===n&&(Re(ar),Re(Ma))}var De=Ai(0);function Nc(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Pd=[];function Lp(){for(var n=0;n<Pd.length;n++)Pd[n]._workInProgressVersionPrimary=null;Pd.length=0}var tc=Pr.ReactCurrentDispatcher,Dd=Pr.ReactCurrentBatchConfig,Ji=0,Le=null,Ye=null,nt=null,xc=!1,ra=!1,Pa=0,ub=0;function wt(){throw Error(M(321))}function Up(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!jn(n[t],e[t]))return!1;return!0}function Hp(n,e,t,r,i,o){if(Ji=o,Le=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,tc.current=n===null||n.memoizedState===null?pb:mb,n=t(r,i),ra){o=0;do{if(ra=!1,Pa=0,25<=o)throw Error(M(301));o+=1,nt=Ye=null,e.updateQueue=null,tc.current=gb,n=t(r,i)}while(ra)}if(tc.current=Oc,e=Ye!==null&&Ye.next!==null,Ji=0,nt=Ye=Le=null,xc=!1,e)throw Error(M(300));return n}function Fp(){var n=Pa!==0;return Pa=0,n}function Xn(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return nt===null?Le.memoizedState=nt=n:nt=nt.next=n,nt}function On(){if(Ye===null){var n=Le.alternate;n=n!==null?n.memoizedState:null}else n=Ye.next;var e=nt===null?Le.memoizedState:nt.next;if(e!==null)nt=e,Ye=n;else{if(n===null)throw Error(M(310));Ye=n,n={memoizedState:Ye.memoizedState,baseState:Ye.baseState,baseQueue:Ye.baseQueue,queue:Ye.queue,next:null},nt===null?Le.memoizedState=nt=n:nt=nt.next=n}return nt}function Da(n,e){return typeof e=="function"?e(n):e}function Ld(n){var e=On(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var r=Ye,i=r.baseQueue,o=t.pending;if(o!==null){if(i!==null){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,t.pending=null}if(i!==null){o=i.next,r=r.baseState;var a=s=null,l=null,c=o;do{var u=c.lane;if((Ji&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:n(r,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,s=r):l=l.next=d,Le.lanes|=u,Xi|=u}c=c.next}while(c!==null&&c!==o);l===null?s=r:l.next=a,jn(r,e.memoizedState)||(Gt=!0),e.memoizedState=r,e.baseState=s,e.baseQueue=l,t.lastRenderedState=r}if(n=t.interleaved,n!==null){i=n;do o=i.lane,Le.lanes|=o,Xi|=o,i=i.next;while(i!==n)}else i===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Ud(n){var e=On(),t=e.queue;if(t===null)throw Error(M(311));t.lastRenderedReducer=n;var r=t.dispatch,i=t.pending,o=e.memoizedState;if(i!==null){t.pending=null;var s=i=i.next;do o=n(o,s.action),s=s.next;while(s!==i);jn(o,e.memoizedState)||(Gt=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),t.lastRenderedState=o}return[o,r]}function lw(){}function cw(n,e){var t=Le,r=On(),i=e(),o=!jn(r.memoizedState,i);if(o&&(r.memoizedState=i,Gt=!0),r=r.queue,Bp(hw.bind(null,t,r,n),[n]),r.getSnapshot!==e||o||nt!==null&&nt.memoizedState.tag&1){if(t.flags|=2048,La(9,dw.bind(null,t,r,i,e),void 0,null),st===null)throw Error(M(349));Ji&30||uw(t,e,i)}return i}function uw(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function dw(n,e,t,r){e.value=t,e.getSnapshot=r,fw(e)&&pw(n)}function hw(n,e,t){return t(function(){fw(e)&&pw(n)})}function fw(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!jn(n,t)}catch{return!0}}function pw(n){var e=Nr(n,1);e!==null&&Fn(e,n,1,-1)}function uy(n){var e=Xn();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Da,lastRenderedState:n},e.queue=n,n=n.dispatch=fb.bind(null,Le,n),[e.memoizedState,n]}function La(n,e,t,r){return n={tag:n,create:e,destroy:t,deps:r,next:null},e=Le.updateQueue,e===null?(e={lastEffect:null,stores:null},Le.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(r=t.next,t.next=n,n.next=r,e.lastEffect=n)),n}function mw(){return On().memoizedState}function nc(n,e,t,r){var i=Xn();Le.flags|=n,i.memoizedState=La(1|e,t,void 0,r===void 0?null:r)}function Au(n,e,t,r){var i=On();r=r===void 0?null:r;var o=void 0;if(Ye!==null){var s=Ye.memoizedState;if(o=s.destroy,r!==null&&Up(r,s.deps)){i.memoizedState=La(e,t,o,r);return}}Le.flags|=n,i.memoizedState=La(1|e,t,o,r)}function dy(n,e){return nc(8390656,8,n,e)}function Bp(n,e){return Au(2048,8,n,e)}function gw(n,e){return Au(4,2,n,e)}function yw(n,e){return Au(4,4,n,e)}function vw(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function Cw(n,e,t){return t=t!=null?t.concat([n]):null,Au(4,4,vw.bind(null,e,n),t)}function zp(){}function Sw(n,e){var t=On();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Up(e,r[1])?r[0]:(t.memoizedState=[n,e],n)}function ww(n,e){var t=On();e=e===void 0?null:e;var r=t.memoizedState;return r!==null&&e!==null&&Up(e,r[1])?r[0]:(n=n(),t.memoizedState=[n,e],n)}function Tw(n,e,t){return Ji&21?(jn(t,e)||(t=bS(),Le.lanes|=t,Xi|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Gt=!0),n.memoizedState=t)}function db(n,e){var t=pe;pe=t!==0&&4>t?t:4,n(!0);var r=Dd.transition;Dd.transition={};try{n(!1),e()}finally{pe=t,Dd.transition=r}}function Ew(){return On().memoizedState}function hb(n,e,t){var r=di(n);if(t={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null},kw(n))Iw(e,t);else if(t=ow(n,e,t,r),t!==null){var i=_t();Fn(t,n,r,i),Aw(t,e,r)}}function fb(n,e,t){var r=di(n),i={lane:r,action:t,hasEagerState:!1,eagerState:null,next:null};if(kw(n))Iw(e,i);else{var o=n.alternate;if(n.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var s=e.lastRenderedState,a=o(s,t);if(i.hasEagerState=!0,i.eagerState=a,jn(a,s)){var l=e.interleaved;l===null?(i.next=i,Mp(e)):(i.next=l.next,l.next=i),e.interleaved=i;return}}catch{}finally{}t=ow(n,e,i,r),t!==null&&(i=_t(),Fn(t,n,r,i),Aw(t,e,r))}}function kw(n){var e=n.alternate;return n===Le||e!==null&&e===Le}function Iw(n,e){ra=xc=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function Aw(n,e,t){if(t&4194240){var r=e.lanes;r&=n.pendingLanes,t|=r,e.lanes=t,vp(n,t)}}var Oc={readContext:xn,useCallback:wt,useContext:wt,useEffect:wt,useImperativeHandle:wt,useInsertionEffect:wt,useLayoutEffect:wt,useMemo:wt,useReducer:wt,useRef:wt,useState:wt,useDebugValue:wt,useDeferredValue:wt,useTransition:wt,useMutableSource:wt,useSyncExternalStore:wt,useId:wt,unstable_isNewReconciler:!1},pb={readContext:xn,useCallback:function(n,e){return Xn().memoizedState=[n,e===void 0?null:e],n},useContext:xn,useEffect:dy,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,nc(4194308,4,vw.bind(null,e,n),t)},useLayoutEffect:function(n,e){return nc(4194308,4,n,e)},useInsertionEffect:function(n,e){return nc(4,2,n,e)},useMemo:function(n,e){var t=Xn();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var r=Xn();return e=t!==void 0?t(e):e,r.memoizedState=r.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},r.queue=n,n=n.dispatch=hb.bind(null,Le,n),[r.memoizedState,n]},useRef:function(n){var e=Xn();return n={current:n},e.memoizedState=n},useState:uy,useDebugValue:zp,useDeferredValue:function(n){return Xn().memoizedState=n},useTransition:function(){var n=uy(!1),e=n[0];return n=db.bind(null,n[1]),Xn().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var r=Le,i=Xn();if(Oe){if(t===void 0)throw Error(M(407));t=t()}else{if(t=e(),st===null)throw Error(M(349));Ji&30||uw(r,e,t)}i.memoizedState=t;var o={value:t,getSnapshot:e};return i.queue=o,dy(hw.bind(null,r,o,n),[n]),r.flags|=2048,La(9,dw.bind(null,r,o,t,e),void 0,null),t},useId:function(){var n=Xn(),e=st.identifierPrefix;if(Oe){var t=Sr,r=Cr;t=(r&~(1<<32-Hn(r)-1)).toString(32)+t,e=":"+e+"R"+t,t=Pa++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=ub++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},mb={readContext:xn,useCallback:Sw,useContext:xn,useEffect:Bp,useImperativeHandle:Cw,useInsertionEffect:gw,useLayoutEffect:yw,useMemo:ww,useReducer:Ld,useRef:mw,useState:function(){return Ld(Da)},useDebugValue:zp,useDeferredValue:function(n){var e=On();return Tw(e,Ye.memoizedState,n)},useTransition:function(){var n=Ld(Da)[0],e=On().memoizedState;return[n,e]},useMutableSource:lw,useSyncExternalStore:cw,useId:Ew,unstable_isNewReconciler:!1},gb={readContext:xn,useCallback:Sw,useContext:xn,useEffect:Bp,useImperativeHandle:Cw,useInsertionEffect:gw,useLayoutEffect:yw,useMemo:ww,useReducer:Ud,useRef:mw,useState:function(){return Ud(Da)},useDebugValue:zp,useDeferredValue:function(n){var e=On();return Ye===null?e.memoizedState=n:Tw(e,Ye.memoizedState,n)},useTransition:function(){var n=Ud(Da)[0],e=On().memoizedState;return[n,e]},useMutableSource:lw,useSyncExternalStore:cw,useId:Ew,unstable_isNewReconciler:!1};function _n(n,e){if(n&&n.defaultProps){e=Ue({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Yh(n,e,t,r){e=n.memoizedState,t=t(r,e),t=t==null?e:Ue({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var bu={isMounted:function(n){return(n=n._reactInternals)?uo(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var r=_t(),i=di(n),o=kr(r,i);o.payload=e,t!=null&&(o.callback=t),e=ci(n,o,i),e!==null&&(Fn(e,n,i,r),ec(e,n,i))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var r=_t(),i=di(n),o=kr(r,i);o.tag=1,o.payload=e,t!=null&&(o.callback=t),e=ci(n,o,i),e!==null&&(Fn(e,n,i,r),ec(e,n,i))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=_t(),r=di(n),i=kr(t,r);i.tag=2,e!=null&&(i.callback=e),e=ci(n,i,r),e!==null&&(Fn(e,n,r,t),ec(e,n,r))}};function hy(n,e,t,r,i,o,s){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(r,o,s):e.prototype&&e.prototype.isPureReactComponent?!Ra(t,r)||!Ra(i,o):!0}function bw(n,e,t){var r=!1,i=wi,o=e.contextType;return typeof o=="object"&&o!==null?o=xn(o):(i=Qt(e)?Qi:Rt.current,r=e.contextTypes,o=(r=r!=null)?rs(n,i):wi),e=new e(t,o),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=bu,n.stateNode=e,e._reactInternals=n,r&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=i,n.__reactInternalMemoizedMaskedChildContext=o),e}function fy(n,e,t,r){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,r),e.state!==n&&bu.enqueueReplaceState(e,e.state,null)}function Jh(n,e,t,r){var i=n.stateNode;i.props=t,i.state=n.memoizedState,i.refs={},_p(n);var o=e.contextType;typeof o=="object"&&o!==null?i.context=xn(o):(o=Qt(e)?Qi:Rt.current,i.context=rs(n,o)),i.state=n.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(Yh(n,e,o,t),i.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(e=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),e!==i.state&&bu.enqueueReplaceState(i,i.state,null),Rc(n,t,i,r),i.state=n.memoizedState),typeof i.componentDidMount=="function"&&(n.flags|=4194308)}function ls(n,e){try{var t="",r=e;do t+=$I(r),r=r.return;while(r);var i=t}catch(o){i=`
Error generating stack: `+o.message+`
`+o.stack}return{value:n,source:e,stack:i,digest:null}}function Hd(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Xh(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var yb=typeof WeakMap=="function"?WeakMap:Map;function Rw(n,e,t){t=kr(-1,t),t.tag=3,t.payload={element:null};var r=e.value;return t.callback=function(){_c||(_c=!0,cf=r),Xh(n,e)},t}function Nw(n,e,t){t=kr(-1,t),t.tag=3;var r=n.type.getDerivedStateFromError;if(typeof r=="function"){var i=e.value;t.payload=function(){return r(i)},t.callback=function(){Xh(n,e)}}var o=n.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(t.callback=function(){Xh(n,e),typeof r!="function"&&(ui===null?ui=new Set([this]):ui.add(this));var s=e.stack;this.componentDidCatch(e.value,{componentStack:s!==null?s:""})}),t}function py(n,e,t){var r=n.pingCache;if(r===null){r=n.pingCache=new yb;var i=new Set;r.set(e,i)}else i=r.get(e),i===void 0&&(i=new Set,r.set(e,i));i.has(t)||(i.add(t),n=Ob.bind(null,n,e,t),e.then(n,n))}function my(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function gy(n,e,t,r,i){return n.mode&1?(n.flags|=65536,n.lanes=i,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=kr(-1,1),e.tag=2,ci(t,e,1))),t.lanes|=1),n)}var vb=Pr.ReactCurrentOwner,Gt=!1;function Ot(n,e,t,r){e.child=n===null?iw(e,null,t,r):ss(e,n.child,t,r)}function yy(n,e,t,r,i){t=t.render;var o=e.ref;return qo(e,i),r=Hp(n,e,t,r,o,i),t=Fp(),n!==null&&!Gt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,xr(n,e,i)):(Oe&&t&&Ap(e),e.flags|=1,Ot(n,e,r,i),e.child)}function vy(n,e,t,r,i){if(n===null){var o=t.type;return typeof o=="function"&&!Qp(o)&&o.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=o,xw(n,e,o,r,i)):(n=sc(t.type,null,r,e,e.mode,i),n.ref=e.ref,n.return=e,e.child=n)}if(o=n.child,!(n.lanes&i)){var s=o.memoizedProps;if(t=t.compare,t=t!==null?t:Ra,t(s,r)&&n.ref===e.ref)return xr(n,e,i)}return e.flags|=1,n=hi(o,r),n.ref=e.ref,n.return=e,e.child=n}function xw(n,e,t,r,i){if(n!==null){var o=n.memoizedProps;if(Ra(o,r)&&n.ref===e.ref)if(Gt=!1,e.pendingProps=r=o,(n.lanes&i)!==0)n.flags&131072&&(Gt=!0);else return e.lanes=n.lanes,xr(n,e,i)}return Zh(n,e,t,r,i)}function Ow(n,e,t){var r=e.pendingProps,i=r.children,o=n!==null?n.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Te(Ho,sn),sn|=t;else{if(!(t&1073741824))return n=o!==null?o.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Te(Ho,sn),sn|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=o!==null?o.baseLanes:t,Te(Ho,sn),sn|=r}else o!==null?(r=o.baseLanes|t,e.memoizedState=null):r=t,Te(Ho,sn),sn|=r;return Ot(n,e,i,t),e.child}function Mw(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Zh(n,e,t,r,i){var o=Qt(t)?Qi:Rt.current;return o=rs(e,o),qo(e,i),t=Hp(n,e,t,r,o,i),r=Fp(),n!==null&&!Gt?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~i,xr(n,e,i)):(Oe&&r&&Ap(e),e.flags|=1,Ot(n,e,t,i),e.child)}function Cy(n,e,t,r,i){if(Qt(t)){var o=!0;Ec(e)}else o=!1;if(qo(e,i),e.stateNode===null)rc(n,e),bw(e,t,r),Jh(e,t,r,i),r=!0;else if(n===null){var s=e.stateNode,a=e.memoizedProps;s.props=a;var l=s.context,c=t.contextType;typeof c=="object"&&c!==null?c=xn(c):(c=Qt(t)?Qi:Rt.current,c=rs(e,c));var u=t.getDerivedStateFromProps,d=typeof u=="function"||typeof s.getSnapshotBeforeUpdate=="function";d||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==r||l!==c)&&fy(e,s,r,c),Vr=!1;var h=e.memoizedState;s.state=h,Rc(e,r,s,i),l=e.memoizedState,a!==r||h!==l||qt.current||Vr?(typeof u=="function"&&(Yh(e,t,u,r),l=e.memoizedState),(a=Vr||hy(e,t,a,r,h,l,c))?(d||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount()),typeof s.componentDidMount=="function"&&(e.flags|=4194308)):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),s.props=r,s.state=l,s.context=c,r=a):(typeof s.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{s=e.stateNode,sw(n,e),a=e.memoizedProps,c=e.type===e.elementType?a:_n(e.type,a),s.props=c,d=e.pendingProps,h=s.context,l=t.contextType,typeof l=="object"&&l!==null?l=xn(l):(l=Qt(t)?Qi:Rt.current,l=rs(e,l));var f=t.getDerivedStateFromProps;(u=typeof f=="function"||typeof s.getSnapshotBeforeUpdate=="function")||typeof s.UNSAFE_componentWillReceiveProps!="function"&&typeof s.componentWillReceiveProps!="function"||(a!==d||h!==l)&&fy(e,s,r,l),Vr=!1,h=e.memoizedState,s.state=h,Rc(e,r,s,i);var p=e.memoizedState;a!==d||h!==p||qt.current||Vr?(typeof f=="function"&&(Yh(e,t,f,r),p=e.memoizedState),(c=Vr||hy(e,t,c,r,h,p,l)||!1)?(u||typeof s.UNSAFE_componentWillUpdate!="function"&&typeof s.componentWillUpdate!="function"||(typeof s.componentWillUpdate=="function"&&s.componentWillUpdate(r,p,l),typeof s.UNSAFE_componentWillUpdate=="function"&&s.UNSAFE_componentWillUpdate(r,p,l)),typeof s.componentDidUpdate=="function"&&(e.flags|=4),typeof s.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=p),s.props=r,s.state=p,s.context=l,r=c):(typeof s.componentDidUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=4),typeof s.getSnapshotBeforeUpdate!="function"||a===n.memoizedProps&&h===n.memoizedState||(e.flags|=1024),r=!1)}return ef(n,e,t,r,o,i)}function ef(n,e,t,r,i,o){Mw(n,e);var s=(e.flags&128)!==0;if(!r&&!s)return i&&iy(e,t,!1),xr(n,e,o);r=e.stateNode,vb.current=e;var a=s&&typeof t.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,n!==null&&s?(e.child=ss(e,n.child,null,o),e.child=ss(e,null,a,o)):Ot(n,e,a,o),e.memoizedState=r.state,i&&iy(e,t,!0),e.child}function _w(n){var e=n.stateNode;e.pendingContext?ry(n,e.pendingContext,e.pendingContext!==e.context):e.context&&ry(n,e.context,!1),Pp(n,e.containerInfo)}function Sy(n,e,t,r,i){return is(),Rp(i),e.flags|=256,Ot(n,e,t,r),e.child}var tf={dehydrated:null,treeContext:null,retryLane:0};function nf(n){return{baseLanes:n,cachePool:null,transitions:null}}function Pw(n,e,t){var r=e.pendingProps,i=De.current,o=!1,s=(e.flags&128)!==0,a;if((a=s)||(a=n!==null&&n.memoizedState===null?!1:(i&2)!==0),a?(o=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(i|=1),Te(De,i&1),n===null)return qh(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,n=r.fallback,o?(r=e.mode,o=e.child,s={mode:"hidden",children:s},!(r&1)&&o!==null?(o.childLanes=0,o.pendingProps=s):o=xu(s,r,0,null),n=Ki(n,r,t,null),o.return=e,n.return=e,o.sibling=n,e.child=o,e.child.memoizedState=nf(t),e.memoizedState=tf,n):jp(e,s));if(i=n.memoizedState,i!==null&&(a=i.dehydrated,a!==null))return Cb(n,e,s,r,a,i,t);if(o){o=r.fallback,s=e.mode,i=n.child,a=i.sibling;var l={mode:"hidden",children:r.children};return!(s&1)&&e.child!==i?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=hi(i,l),r.subtreeFlags=i.subtreeFlags&14680064),a!==null?o=hi(a,o):(o=Ki(o,s,t,null),o.flags|=2),o.return=e,r.return=e,r.sibling=o,e.child=r,r=o,o=e.child,s=n.child.memoizedState,s=s===null?nf(t):{baseLanes:s.baseLanes|t,cachePool:null,transitions:s.transitions},o.memoizedState=s,o.childLanes=n.childLanes&~t,e.memoizedState=tf,r}return o=n.child,n=o.sibling,r=hi(o,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=t),r.return=e,r.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=r,e.memoizedState=null,r}function jp(n,e){return e=xu({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function bl(n,e,t,r){return r!==null&&Rp(r),ss(e,n.child,null,t),n=jp(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function Cb(n,e,t,r,i,o,s){if(t)return e.flags&256?(e.flags&=-257,r=Hd(Error(M(422))),bl(n,e,s,r)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(o=r.fallback,i=e.mode,r=xu({mode:"visible",children:r.children},i,0,null),o=Ki(o,i,s,null),o.flags|=2,r.return=e,o.return=e,r.sibling=o,e.child=r,e.mode&1&&ss(e,n.child,null,s),e.child.memoizedState=nf(s),e.memoizedState=tf,o);if(!(e.mode&1))return bl(n,e,s,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var a=r.dgst;return r=a,o=Error(M(419)),r=Hd(o,r,void 0),bl(n,e,s,r)}if(a=(s&n.childLanes)!==0,Gt||a){if(r=st,r!==null){switch(s&-s){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|s)?0:i,i!==0&&i!==o.retryLane&&(o.retryLane=i,Nr(n,i),Fn(r,n,i,-1))}return qp(),r=Hd(Error(M(421))),bl(n,e,s,r)}return i.data==="$?"?(e.flags|=128,e.child=n.child,e=Mb.bind(null,n),i._reactRetry=e,null):(n=o.treeContext,hn=li(i.nextSibling),mn=e,Oe=!0,Ln=null,n!==null&&(Tn[En++]=Cr,Tn[En++]=Sr,Tn[En++]=Yi,Cr=n.id,Sr=n.overflow,Yi=e),e=jp(e,r.children),e.flags|=4096,e)}function wy(n,e,t){n.lanes|=e;var r=n.alternate;r!==null&&(r.lanes|=e),Qh(n.return,e,t)}function Fd(n,e,t,r,i){var o=n.memoizedState;o===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:t,tailMode:i}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=r,o.tail=t,o.tailMode=i)}function Dw(n,e,t){var r=e.pendingProps,i=r.revealOrder,o=r.tail;if(Ot(n,e,r.children,t),r=De.current,r&2)r=r&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&wy(n,t,e);else if(n.tag===19)wy(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}r&=1}if(Te(De,r),!(e.mode&1))e.memoizedState=null;else switch(i){case"forwards":for(t=e.child,i=null;t!==null;)n=t.alternate,n!==null&&Nc(n)===null&&(i=t),t=t.sibling;t=i,t===null?(i=e.child,e.child=null):(i=t.sibling,t.sibling=null),Fd(e,!1,i,t,o);break;case"backwards":for(t=null,i=e.child,e.child=null;i!==null;){if(n=i.alternate,n!==null&&Nc(n)===null){e.child=i;break}n=i.sibling,i.sibling=t,t=i,i=n}Fd(e,!0,t,null,o);break;case"together":Fd(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function rc(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function xr(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),Xi|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(M(153));if(e.child!==null){for(n=e.child,t=hi(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=hi(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function Sb(n,e,t){switch(e.tag){case 3:_w(e),is();break;case 5:aw(e);break;case 1:Qt(e.type)&&Ec(e);break;case 4:Pp(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,i=e.memoizedProps.value;Te(Ac,r._currentValue),r._currentValue=i;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Te(De,De.current&1),e.flags|=128,null):t&e.child.childLanes?Pw(n,e,t):(Te(De,De.current&1),n=xr(n,e,t),n!==null?n.sibling:null);Te(De,De.current&1);break;case 19:if(r=(t&e.childLanes)!==0,n.flags&128){if(r)return Dw(n,e,t);e.flags|=128}if(i=e.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Te(De,De.current),r)break;return null;case 22:case 23:return e.lanes=0,Ow(n,e,t)}return xr(n,e,t)}var Lw,rf,Uw,Hw;Lw=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};rf=function(){};Uw=function(n,e,t,r){var i=n.memoizedProps;if(i!==r){n=e.stateNode,Ui(ar.current);var o=null;switch(t){case"input":i=Ih(n,i),r=Ih(n,r),o=[];break;case"select":i=Ue({},i,{value:void 0}),r=Ue({},r,{value:void 0}),o=[];break;case"textarea":i=Rh(n,i),r=Rh(n,r),o=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(n.onclick=wc)}xh(t,r);var s;t=null;for(c in i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&i[c]!=null)if(c==="style"){var a=i[c];for(s in a)a.hasOwnProperty(s)&&(t||(t={}),t[s]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(wa.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var l=r[c];if(a=i!=null?i[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(s in a)!a.hasOwnProperty(s)||l&&l.hasOwnProperty(s)||(t||(t={}),t[s]="");for(s in l)l.hasOwnProperty(s)&&a[s]!==l[s]&&(t||(t={}),t[s]=l[s])}else t||(o||(o=[]),o.push(c,t)),t=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(wa.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ae("scroll",n),o||a===l||(o=[])):(o=o||[]).push(c,l))}t&&(o=o||[]).push("style",t);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};Hw=function(n,e,t,r){t!==r&&(e.flags|=4)};function zs(n,e){if(!Oe)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:r.sibling=null}}function Tt(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,r=0;if(e)for(var i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=n,i=i.sibling;else for(i=n.child;i!==null;)t|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=n,i=i.sibling;return n.subtreeFlags|=r,n.childLanes=t,e}function wb(n,e,t){var r=e.pendingProps;switch(bp(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Tt(e),null;case 1:return Qt(e.type)&&Tc(),Tt(e),null;case 3:return r=e.stateNode,as(),Re(qt),Re(Rt),Lp(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(n===null||n.child===null)&&(Il(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Ln!==null&&(hf(Ln),Ln=null))),rf(n,e),Tt(e),null;case 5:Dp(e);var i=Ui(_a.current);if(t=e.type,n!==null&&e.stateNode!=null)Uw(n,e,t,r,i),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(M(166));return Tt(e),null}if(n=Ui(ar.current),Il(e)){r=e.stateNode,t=e.type;var o=e.memoizedProps;switch(r[tr]=e,r[Oa]=o,n=(e.mode&1)!==0,t){case"dialog":Ae("cancel",r),Ae("close",r);break;case"iframe":case"object":case"embed":Ae("load",r);break;case"video":case"audio":for(i=0;i<Gs.length;i++)Ae(Gs[i],r);break;case"source":Ae("error",r);break;case"img":case"image":case"link":Ae("error",r),Ae("load",r);break;case"details":Ae("toggle",r);break;case"input":xg(r,o),Ae("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Ae("invalid",r);break;case"textarea":Mg(r,o),Ae("invalid",r)}xh(t,o),i=null;for(var s in o)if(o.hasOwnProperty(s)){var a=o[s];s==="children"?typeof a=="string"?r.textContent!==a&&(o.suppressHydrationWarning!==!0&&kl(r.textContent,a,n),i=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&kl(r.textContent,a,n),i=["children",""+a]):wa.hasOwnProperty(s)&&a!=null&&s==="onScroll"&&Ae("scroll",r)}switch(t){case"input":gl(r),Og(r,o,!0);break;case"textarea":gl(r),_g(r);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(r.onclick=wc)}r=i,e.updateQueue=r,r!==null&&(e.flags|=4)}else{s=i.nodeType===9?i:i.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=hS(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=s.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof r.is=="string"?n=s.createElement(t,{is:r.is}):(n=s.createElement(t),t==="select"&&(s=n,r.multiple?s.multiple=!0:r.size&&(s.size=r.size))):n=s.createElementNS(n,t),n[tr]=e,n[Oa]=r,Lw(n,e,!1,!1),e.stateNode=n;e:{switch(s=Oh(t,r),t){case"dialog":Ae("cancel",n),Ae("close",n),i=r;break;case"iframe":case"object":case"embed":Ae("load",n),i=r;break;case"video":case"audio":for(i=0;i<Gs.length;i++)Ae(Gs[i],n);i=r;break;case"source":Ae("error",n),i=r;break;case"img":case"image":case"link":Ae("error",n),Ae("load",n),i=r;break;case"details":Ae("toggle",n),i=r;break;case"input":xg(n,r),i=Ih(n,r),Ae("invalid",n);break;case"option":i=r;break;case"select":n._wrapperState={wasMultiple:!!r.multiple},i=Ue({},r,{value:void 0}),Ae("invalid",n);break;case"textarea":Mg(n,r),i=Rh(n,r),Ae("invalid",n);break;default:i=r}xh(t,i),a=i;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?mS(n,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&fS(n,l)):o==="children"?typeof l=="string"?(t!=="textarea"||l!=="")&&Ta(n,l):typeof l=="number"&&Ta(n,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(wa.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Ae("scroll",n):l!=null&&hp(n,o,l,s))}switch(t){case"input":gl(n),Og(n,r,!1);break;case"textarea":gl(n),_g(n);break;case"option":r.value!=null&&n.setAttribute("value",""+Si(r.value));break;case"select":n.multiple=!!r.multiple,o=r.value,o!=null?$o(n,!!r.multiple,o,!1):r.defaultValue!=null&&$o(n,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(n.onclick=wc)}switch(t){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Tt(e),null;case 6:if(n&&e.stateNode!=null)Hw(n,e,n.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(M(166));if(t=Ui(_a.current),Ui(ar.current),Il(e)){if(r=e.stateNode,t=e.memoizedProps,r[tr]=e,(o=r.nodeValue!==t)&&(n=mn,n!==null))switch(n.tag){case 3:kl(r.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&kl(r.nodeValue,t,(n.mode&1)!==0)}o&&(e.flags|=4)}else r=(t.nodeType===9?t:t.ownerDocument).createTextNode(r),r[tr]=e,e.stateNode=r}return Tt(e),null;case 13:if(Re(De),r=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(Oe&&hn!==null&&e.mode&1&&!(e.flags&128))nw(),is(),e.flags|=98560,o=!1;else if(o=Il(e),r!==null&&r.dehydrated!==null){if(n===null){if(!o)throw Error(M(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(M(317));o[tr]=e}else is(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Tt(e),o=!1}else Ln!==null&&(hf(Ln),Ln=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(r=r!==null,r!==(n!==null&&n.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(n===null||De.current&1?Xe===0&&(Xe=3):qp())),e.updateQueue!==null&&(e.flags|=4),Tt(e),null);case 4:return as(),rf(n,e),n===null&&Na(e.stateNode.containerInfo),Tt(e),null;case 10:return Op(e.type._context),Tt(e),null;case 17:return Qt(e.type)&&Tc(),Tt(e),null;case 19:if(Re(De),o=e.memoizedState,o===null)return Tt(e),null;if(r=(e.flags&128)!==0,s=o.rendering,s===null)if(r)zs(o,!1);else{if(Xe!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(s=Nc(n),s!==null){for(e.flags|=128,zs(o,!1),r=s.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=t,t=e.child;t!==null;)o=t,n=r,o.flags&=14680066,s=o.alternate,s===null?(o.childLanes=0,o.lanes=n,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=s.childLanes,o.lanes=s.lanes,o.child=s.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=s.memoizedProps,o.memoizedState=s.memoizedState,o.updateQueue=s.updateQueue,o.type=s.type,n=s.dependencies,o.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Te(De,De.current&1|2),e.child}n=n.sibling}o.tail!==null&&ze()>cs&&(e.flags|=128,r=!0,zs(o,!1),e.lanes=4194304)}else{if(!r)if(n=Nc(s),n!==null){if(e.flags|=128,r=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),zs(o,!0),o.tail===null&&o.tailMode==="hidden"&&!s.alternate&&!Oe)return Tt(e),null}else 2*ze()-o.renderingStartTime>cs&&t!==1073741824&&(e.flags|=128,r=!0,zs(o,!1),e.lanes=4194304);o.isBackwards?(s.sibling=e.child,e.child=s):(t=o.last,t!==null?t.sibling=s:e.child=s,o.last=s)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=ze(),e.sibling=null,t=De.current,Te(De,r?t&1|2:t&1),e):(Tt(e),null);case 22:case 23:return Gp(),r=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?sn&1073741824&&(Tt(e),e.subtreeFlags&6&&(e.flags|=8192)):Tt(e),null;case 24:return null;case 25:return null}throw Error(M(156,e.tag))}function Tb(n,e){switch(bp(e),e.tag){case 1:return Qt(e.type)&&Tc(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return as(),Re(qt),Re(Rt),Lp(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return Dp(e),null;case 13:if(Re(De),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(M(340));is()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return Re(De),null;case 4:return as(),null;case 10:return Op(e.type._context),null;case 22:case 23:return Gp(),null;case 24:return null;default:return null}}var Rl=!1,It=!1,Eb=typeof WeakSet=="function"?WeakSet:Set,H=null;function Uo(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(r){Fe(n,e,r)}else t.current=null}function of(n,e,t){try{t()}catch(r){Fe(n,e,r)}}var Ty=!1;function kb(n,e){if(zh=vc,n=KS(),Ip(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var r=t.getSelection&&t.getSelection();if(r&&r.rangeCount!==0){t=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{t.nodeType,o.nodeType}catch{t=null;break e}var s=0,a=-1,l=-1,c=0,u=0,d=n,h=null;t:for(;;){for(var f;d!==t||i!==0&&d.nodeType!==3||(a=s+i),d!==o||r!==0&&d.nodeType!==3||(l=s+r),d.nodeType===3&&(s+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===n)break t;if(h===t&&++c===i&&(a=s),h===o&&++u===r&&(l=s),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}t=a===-1||l===-1?null:{start:a,end:l}}else t=null}t=t||{start:0,end:0}}else t=null;for(jh={focusedElem:n,selectionRange:t},vc=!1,H=e;H!==null;)if(e=H,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,H=n;else for(;H!==null;){e=H;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,v=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:_n(e.type,m),v);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var C=e.stateNode.containerInfo;C.nodeType===1?C.textContent="":C.nodeType===9&&C.documentElement&&C.removeChild(C.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(M(163))}}catch(w){Fe(e,e.return,w)}if(n=e.sibling,n!==null){n.return=e.return,H=n;break}H=e.return}return p=Ty,Ty=!1,p}function ia(n,e,t){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&n)===n){var o=i.destroy;i.destroy=void 0,o!==void 0&&of(e,t,o)}i=i.next}while(i!==r)}}function Ru(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var r=t.create;t.destroy=r()}t=t.next}while(t!==e)}}function sf(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function Fw(n){var e=n.alternate;e!==null&&(n.alternate=null,Fw(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[tr],delete e[Oa],delete e[Vh],delete e[sb],delete e[ab])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function Bw(n){return n.tag===5||n.tag===3||n.tag===4}function Ey(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||Bw(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function af(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=wc));else if(r!==4&&(n=n.child,n!==null))for(af(n,e,t),n=n.sibling;n!==null;)af(n,e,t),n=n.sibling}function lf(n,e,t){var r=n.tag;if(r===5||r===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(r!==4&&(n=n.child,n!==null))for(lf(n,e,t),n=n.sibling;n!==null;)lf(n,e,t),n=n.sibling}var ht=null,Pn=!1;function Br(n,e,t){for(t=t.child;t!==null;)zw(n,e,t),t=t.sibling}function zw(n,e,t){if(sr&&typeof sr.onCommitFiberUnmount=="function")try{sr.onCommitFiberUnmount(Su,t)}catch{}switch(t.tag){case 5:It||Uo(t,e);case 6:var r=ht,i=Pn;ht=null,Br(n,e,t),ht=r,Pn=i,ht!==null&&(Pn?(n=ht,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):ht.removeChild(t.stateNode));break;case 18:ht!==null&&(Pn?(n=ht,t=t.stateNode,n.nodeType===8?Md(n.parentNode,t):n.nodeType===1&&Md(n,t),Aa(n)):Md(ht,t.stateNode));break;case 4:r=ht,i=Pn,ht=t.stateNode.containerInfo,Pn=!0,Br(n,e,t),ht=r,Pn=i;break;case 0:case 11:case 14:case 15:if(!It&&(r=t.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var o=i,s=o.destroy;o=o.tag,s!==void 0&&(o&2||o&4)&&of(t,e,s),i=i.next}while(i!==r)}Br(n,e,t);break;case 1:if(!It&&(Uo(t,e),r=t.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=t.memoizedProps,r.state=t.memoizedState,r.componentWillUnmount()}catch(a){Fe(t,e,a)}Br(n,e,t);break;case 21:Br(n,e,t);break;case 22:t.mode&1?(It=(r=It)||t.memoizedState!==null,Br(n,e,t),It=r):Br(n,e,t);break;default:Br(n,e,t)}}function ky(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new Eb),e.forEach(function(r){var i=_b.bind(null,n,r);t.has(r)||(t.add(r),r.then(i,i))})}}function Mn(n,e){var t=e.deletions;if(t!==null)for(var r=0;r<t.length;r++){var i=t[r];try{var o=n,s=e,a=s;e:for(;a!==null;){switch(a.tag){case 5:ht=a.stateNode,Pn=!1;break e;case 3:ht=a.stateNode.containerInfo,Pn=!0;break e;case 4:ht=a.stateNode.containerInfo,Pn=!0;break e}a=a.return}if(ht===null)throw Error(M(160));zw(o,s,i),ht=null,Pn=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(c){Fe(i,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)jw(e,n),e=e.sibling}function jw(n,e){var t=n.alternate,r=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Mn(e,n),Yn(n),r&4){try{ia(3,n,n.return),Ru(3,n)}catch(m){Fe(n,n.return,m)}try{ia(5,n,n.return)}catch(m){Fe(n,n.return,m)}}break;case 1:Mn(e,n),Yn(n),r&512&&t!==null&&Uo(t,t.return);break;case 5:if(Mn(e,n),Yn(n),r&512&&t!==null&&Uo(t,t.return),n.flags&32){var i=n.stateNode;try{Ta(i,"")}catch(m){Fe(n,n.return,m)}}if(r&4&&(i=n.stateNode,i!=null)){var o=n.memoizedProps,s=t!==null?t.memoizedProps:o,a=n.type,l=n.updateQueue;if(n.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&uS(i,o),Oh(a,s);var c=Oh(a,o);for(s=0;s<l.length;s+=2){var u=l[s],d=l[s+1];u==="style"?mS(i,d):u==="dangerouslySetInnerHTML"?fS(i,d):u==="children"?Ta(i,d):hp(i,u,d,c)}switch(a){case"input":Ah(i,o);break;case"textarea":dS(i,o);break;case"select":var h=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?$o(i,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?$o(i,!!o.multiple,o.defaultValue,!0):$o(i,!!o.multiple,o.multiple?[]:"",!1))}i[Oa]=o}catch(m){Fe(n,n.return,m)}}break;case 6:if(Mn(e,n),Yn(n),r&4){if(n.stateNode===null)throw Error(M(162));i=n.stateNode,o=n.memoizedProps;try{i.nodeValue=o}catch(m){Fe(n,n.return,m)}}break;case 3:if(Mn(e,n),Yn(n),r&4&&t!==null&&t.memoizedState.isDehydrated)try{Aa(e.containerInfo)}catch(m){Fe(n,n.return,m)}break;case 4:Mn(e,n),Yn(n);break;case 13:Mn(e,n),Yn(n),i=n.child,i.flags&8192&&(o=i.memoizedState!==null,i.stateNode.isHidden=o,!o||i.alternate!==null&&i.alternate.memoizedState!==null||(Vp=ze())),r&4&&ky(n);break;case 22:if(u=t!==null&&t.memoizedState!==null,n.mode&1?(It=(c=It)||u,Mn(e,n),It=c):Mn(e,n),Yn(n),r&8192){if(c=n.memoizedState!==null,(n.stateNode.isHidden=c)&&!u&&n.mode&1)for(H=n,u=n.child;u!==null;){for(d=H=u;H!==null;){switch(h=H,f=h.child,h.tag){case 0:case 11:case 14:case 15:ia(4,h,h.return);break;case 1:Uo(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){r=h,t=h.return;try{e=r,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Fe(r,t,m)}}break;case 5:Uo(h,h.return);break;case 22:if(h.memoizedState!==null){Ay(d);continue}}f!==null?(f.return=h,H=f):Ay(d)}u=u.sibling}e:for(u=null,d=n;;){if(d.tag===5){if(u===null){u=d;try{i=d.stateNode,c?(o=i.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,s=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=pS("display",s))}catch(m){Fe(n,n.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Fe(n,n.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===n)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===n)break e;for(;d.sibling===null;){if(d.return===null||d.return===n)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Mn(e,n),Yn(n),r&4&&ky(n);break;case 21:break;default:Mn(e,n),Yn(n)}}function Yn(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(Bw(t)){var r=t;break e}t=t.return}throw Error(M(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Ta(i,""),r.flags&=-33);var o=Ey(n);lf(n,o,i);break;case 3:case 4:var s=r.stateNode.containerInfo,a=Ey(n);af(n,a,s);break;default:throw Error(M(161))}}catch(l){Fe(n,n.return,l)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function Ib(n,e,t){H=n,Kw(n)}function Kw(n,e,t){for(var r=(n.mode&1)!==0;H!==null;){var i=H,o=i.child;if(i.tag===22&&r){var s=i.memoizedState!==null||Rl;if(!s){var a=i.alternate,l=a!==null&&a.memoizedState!==null||It;a=Rl;var c=It;if(Rl=s,(It=l)&&!c)for(H=i;H!==null;)s=H,l=s.child,s.tag===22&&s.memoizedState!==null?by(i):l!==null?(l.return=s,H=l):by(i);for(;o!==null;)H=o,Kw(o),o=o.sibling;H=i,Rl=a,It=c}Iy(n)}else i.subtreeFlags&8772&&o!==null?(o.return=i,H=o):Iy(n)}}function Iy(n){for(;H!==null;){var e=H;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:It||Ru(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!It)if(t===null)r.componentDidMount();else{var i=e.elementType===e.type?t.memoizedProps:_n(e.type,t.memoizedProps);r.componentDidUpdate(i,t.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&cy(e,o,r);break;case 3:var s=e.updateQueue;if(s!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}cy(e,s,t)}break;case 5:var a=e.stateNode;if(t===null&&e.flags&4){t=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&t.focus();break;case"img":l.src&&(t.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&Aa(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(M(163))}It||e.flags&512&&sf(e)}catch(h){Fe(e,e.return,h)}}if(e===n){H=null;break}if(t=e.sibling,t!==null){t.return=e.return,H=t;break}H=e.return}}function Ay(n){for(;H!==null;){var e=H;if(e===n){H=null;break}var t=e.sibling;if(t!==null){t.return=e.return,H=t;break}H=e.return}}function by(n){for(;H!==null;){var e=H;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{Ru(4,e)}catch(l){Fe(e,t,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var i=e.return;try{r.componentDidMount()}catch(l){Fe(e,i,l)}}var o=e.return;try{sf(e)}catch(l){Fe(e,o,l)}break;case 5:var s=e.return;try{sf(e)}catch(l){Fe(e,s,l)}}}catch(l){Fe(e,e.return,l)}if(e===n){H=null;break}var a=e.sibling;if(a!==null){a.return=e.return,H=a;break}H=e.return}}var Ab=Math.ceil,Mc=Pr.ReactCurrentDispatcher,Kp=Pr.ReactCurrentOwner,bn=Pr.ReactCurrentBatchConfig,ce=0,st=null,We=null,gt=0,sn=0,Ho=Ai(0),Xe=0,Ua=null,Xi=0,Nu=0,$p=0,oa=null,Vt=null,Vp=0,cs=1/0,mr=null,_c=!1,cf=null,ui=null,Nl=!1,Zr=null,Pc=0,sa=0,uf=null,ic=-1,oc=0;function _t(){return ce&6?ze():ic!==-1?ic:ic=ze()}function di(n){return n.mode&1?ce&2&&gt!==0?gt&-gt:cb.transition!==null?(oc===0&&(oc=bS()),oc):(n=pe,n!==0||(n=window.event,n=n===void 0?16:PS(n.type)),n):1}function Fn(n,e,t,r){if(50<sa)throw sa=0,uf=null,Error(M(185));el(n,t,r),(!(ce&2)||n!==st)&&(n===st&&(!(ce&2)&&(Nu|=t),Xe===4&&Yr(n,gt)),Yt(n,r),t===1&&ce===0&&!(e.mode&1)&&(cs=ze()+500,Iu&&bi()))}function Yt(n,e){var t=n.callbackNode;cA(n,e);var r=yc(n,n===st?gt:0);if(r===0)t!==null&&Lg(t),n.callbackNode=null,n.callbackPriority=0;else if(e=r&-r,n.callbackPriority!==e){if(t!=null&&Lg(t),e===1)n.tag===0?lb(Ry.bind(null,n)):ZS(Ry.bind(null,n)),ib(function(){!(ce&6)&&bi()}),t=null;else{switch(RS(r)){case 1:t=yp;break;case 4:t=IS;break;case 16:t=gc;break;case 536870912:t=AS;break;default:t=gc}t=Jw(t,$w.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function $w(n,e){if(ic=-1,oc=0,ce&6)throw Error(M(327));var t=n.callbackNode;if(Qo()&&n.callbackNode!==t)return null;var r=yc(n,n===st?gt:0);if(r===0)return null;if(r&30||r&n.expiredLanes||e)e=Dc(n,r);else{e=r;var i=ce;ce|=2;var o=Ww();(st!==n||gt!==e)&&(mr=null,cs=ze()+500,ji(n,e));do try{Nb();break}catch(a){Vw(n,a)}while(!0);xp(),Mc.current=o,ce=i,We!==null?e=0:(st=null,gt=0,e=Xe)}if(e!==0){if(e===2&&(i=Lh(n),i!==0&&(r=i,e=df(n,i))),e===1)throw t=Ua,ji(n,0),Yr(n,r),Yt(n,ze()),t;if(e===6)Yr(n,r);else{if(i=n.current.alternate,!(r&30)&&!bb(i)&&(e=Dc(n,r),e===2&&(o=Lh(n),o!==0&&(r=o,e=df(n,o))),e===1))throw t=Ua,ji(n,0),Yr(n,r),Yt(n,ze()),t;switch(n.finishedWork=i,n.finishedLanes=r,e){case 0:case 1:throw Error(M(345));case 2:Mi(n,Vt,mr);break;case 3:if(Yr(n,r),(r&130023424)===r&&(e=Vp+500-ze(),10<e)){if(yc(n,0)!==0)break;if(i=n.suspendedLanes,(i&r)!==r){_t(),n.pingedLanes|=n.suspendedLanes&i;break}n.timeoutHandle=$h(Mi.bind(null,n,Vt,mr),e);break}Mi(n,Vt,mr);break;case 4:if(Yr(n,r),(r&4194240)===r)break;for(e=n.eventTimes,i=-1;0<r;){var s=31-Hn(r);o=1<<s,s=e[s],s>i&&(i=s),r&=~o}if(r=i,r=ze()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Ab(r/1960))-r,10<r){n.timeoutHandle=$h(Mi.bind(null,n,Vt,mr),r);break}Mi(n,Vt,mr);break;case 5:Mi(n,Vt,mr);break;default:throw Error(M(329))}}}return Yt(n,ze()),n.callbackNode===t?$w.bind(null,n):null}function df(n,e){var t=oa;return n.current.memoizedState.isDehydrated&&(ji(n,e).flags|=256),n=Dc(n,e),n!==2&&(e=Vt,Vt=t,e!==null&&hf(e)),n}function hf(n){Vt===null?Vt=n:Vt.push.apply(Vt,n)}function bb(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var r=0;r<t.length;r++){var i=t[r],o=i.getSnapshot;i=i.value;try{if(!jn(o(),i))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Yr(n,e){for(e&=~$p,e&=~Nu,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Hn(e),r=1<<t;n[t]=-1,e&=~r}}function Ry(n){if(ce&6)throw Error(M(327));Qo();var e=yc(n,0);if(!(e&1))return Yt(n,ze()),null;var t=Dc(n,e);if(n.tag!==0&&t===2){var r=Lh(n);r!==0&&(e=r,t=df(n,r))}if(t===1)throw t=Ua,ji(n,0),Yr(n,e),Yt(n,ze()),t;if(t===6)throw Error(M(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Mi(n,Vt,mr),Yt(n,ze()),null}function Wp(n,e){var t=ce;ce|=1;try{return n(e)}finally{ce=t,ce===0&&(cs=ze()+500,Iu&&bi())}}function Zi(n){Zr!==null&&Zr.tag===0&&!(ce&6)&&Qo();var e=ce;ce|=1;var t=bn.transition,r=pe;try{if(bn.transition=null,pe=1,n)return n()}finally{pe=r,bn.transition=t,ce=e,!(ce&6)&&bi()}}function Gp(){sn=Ho.current,Re(Ho)}function ji(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,rb(t)),We!==null)for(t=We.return;t!==null;){var r=t;switch(bp(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&Tc();break;case 3:as(),Re(qt),Re(Rt),Lp();break;case 5:Dp(r);break;case 4:as();break;case 13:Re(De);break;case 19:Re(De);break;case 10:Op(r.type._context);break;case 22:case 23:Gp()}t=t.return}if(st=n,We=n=hi(n.current,null),gt=sn=e,Xe=0,Ua=null,$p=Nu=Xi=0,Vt=oa=null,Li!==null){for(e=0;e<Li.length;e++)if(t=Li[e],r=t.interleaved,r!==null){t.interleaved=null;var i=r.next,o=t.pending;if(o!==null){var s=o.next;o.next=i,r.next=s}t.pending=r}Li=null}return n}function Vw(n,e){do{var t=We;try{if(xp(),tc.current=Oc,xc){for(var r=Le.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}xc=!1}if(Ji=0,nt=Ye=Le=null,ra=!1,Pa=0,Kp.current=null,t===null||t.return===null){Xe=1,Ua=e,We=null;break}e:{var o=n,s=t.return,a=t,l=e;if(e=gt,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=my(s);if(f!==null){f.flags&=-257,gy(f,s,a,o,e),f.mode&1&&py(o,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){py(o,c,e),qp();break e}l=Error(M(426))}}else if(Oe&&a.mode&1){var v=my(s);if(v!==null){!(v.flags&65536)&&(v.flags|=256),gy(v,s,a,o,e),Rp(ls(l,a));break e}}o=l=ls(l,a),Xe!==4&&(Xe=2),oa===null?oa=[o]:oa.push(o),o=s;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=Rw(o,l,e);ly(o,g);break e;case 1:a=l;var y=o.type,C=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||C!==null&&typeof C.componentDidCatch=="function"&&(ui===null||!ui.has(C)))){o.flags|=65536,e&=-e,o.lanes|=e;var w=Nw(o,a,e);ly(o,w);break e}}o=o.return}while(o!==null)}qw(t)}catch(E){e=E,We===t&&t!==null&&(We=t=t.return);continue}break}while(!0)}function Ww(){var n=Mc.current;return Mc.current=Oc,n===null?Oc:n}function qp(){(Xe===0||Xe===3||Xe===2)&&(Xe=4),st===null||!(Xi&268435455)&&!(Nu&268435455)||Yr(st,gt)}function Dc(n,e){var t=ce;ce|=2;var r=Ww();(st!==n||gt!==e)&&(mr=null,ji(n,e));do try{Rb();break}catch(i){Vw(n,i)}while(!0);if(xp(),ce=t,Mc.current=r,We!==null)throw Error(M(261));return st=null,gt=0,Xe}function Rb(){for(;We!==null;)Gw(We)}function Nb(){for(;We!==null&&!eA();)Gw(We)}function Gw(n){var e=Yw(n.alternate,n,sn);n.memoizedProps=n.pendingProps,e===null?qw(n):We=e,Kp.current=null}function qw(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=Tb(t,e),t!==null){t.flags&=32767,We=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Xe=6,We=null;return}}else if(t=wb(t,e,sn),t!==null){We=t;return}if(e=e.sibling,e!==null){We=e;return}We=e=n}while(e!==null);Xe===0&&(Xe=5)}function Mi(n,e,t){var r=pe,i=bn.transition;try{bn.transition=null,pe=1,xb(n,e,t,r)}finally{bn.transition=i,pe=r}return null}function xb(n,e,t,r){do Qo();while(Zr!==null);if(ce&6)throw Error(M(327));t=n.finishedWork;var i=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(M(177));n.callbackNode=null,n.callbackPriority=0;var o=t.lanes|t.childLanes;if(uA(n,o),n===st&&(We=st=null,gt=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||Nl||(Nl=!0,Jw(gc,function(){return Qo(),null})),o=(t.flags&15990)!==0,t.subtreeFlags&15990||o){o=bn.transition,bn.transition=null;var s=pe;pe=1;var a=ce;ce|=4,Kp.current=null,kb(n,t),jw(t,n),YA(jh),vc=!!zh,jh=zh=null,n.current=t,Ib(t),tA(),ce=a,pe=s,bn.transition=o}else n.current=t;if(Nl&&(Nl=!1,Zr=n,Pc=i),o=n.pendingLanes,o===0&&(ui=null),iA(t.stateNode),Yt(n,ze()),e!==null)for(r=n.onRecoverableError,t=0;t<e.length;t++)i=e[t],r(i.value,{componentStack:i.stack,digest:i.digest});if(_c)throw _c=!1,n=cf,cf=null,n;return Pc&1&&n.tag!==0&&Qo(),o=n.pendingLanes,o&1?n===uf?sa++:(sa=0,uf=n):sa=0,bi(),null}function Qo(){if(Zr!==null){var n=RS(Pc),e=bn.transition,t=pe;try{if(bn.transition=null,pe=16>n?16:n,Zr===null)var r=!1;else{if(n=Zr,Zr=null,Pc=0,ce&6)throw Error(M(331));var i=ce;for(ce|=4,H=n.current;H!==null;){var o=H,s=o.child;if(H.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(H=c;H!==null;){var u=H;switch(u.tag){case 0:case 11:case 15:ia(8,u,o)}var d=u.child;if(d!==null)d.return=u,H=d;else for(;H!==null;){u=H;var h=u.sibling,f=u.return;if(Fw(u),u===c){H=null;break}if(h!==null){h.return=f,H=h;break}H=f}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var v=m.sibling;m.sibling=null,m=v}while(m!==null)}}H=o}}if(o.subtreeFlags&2064&&s!==null)s.return=o,H=s;else e:for(;H!==null;){if(o=H,o.flags&2048)switch(o.tag){case 0:case 11:case 15:ia(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,H=g;break e}H=o.return}}var y=n.current;for(H=y;H!==null;){s=H;var C=s.child;if(s.subtreeFlags&2064&&C!==null)C.return=s,H=C;else e:for(s=y;H!==null;){if(a=H,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Ru(9,a)}}catch(E){Fe(a,a.return,E)}if(a===s){H=null;break e}var w=a.sibling;if(w!==null){w.return=a.return,H=w;break e}H=a.return}}if(ce=i,bi(),sr&&typeof sr.onPostCommitFiberRoot=="function")try{sr.onPostCommitFiberRoot(Su,n)}catch{}r=!0}return r}finally{pe=t,bn.transition=e}}return!1}function Ny(n,e,t){e=ls(t,e),e=Rw(n,e,1),n=ci(n,e,1),e=_t(),n!==null&&(el(n,1,e),Yt(n,e))}function Fe(n,e,t){if(n.tag===3)Ny(n,n,t);else for(;e!==null;){if(e.tag===3){Ny(e,n,t);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(ui===null||!ui.has(r))){n=ls(t,n),n=Nw(e,n,1),e=ci(e,n,1),n=_t(),e!==null&&(el(e,1,n),Yt(e,n));break}}e=e.return}}function Ob(n,e,t){var r=n.pingCache;r!==null&&r.delete(e),e=_t(),n.pingedLanes|=n.suspendedLanes&t,st===n&&(gt&t)===t&&(Xe===4||Xe===3&&(gt&130023424)===gt&&500>ze()-Vp?ji(n,0):$p|=t),Yt(n,e)}function Qw(n,e){e===0&&(n.mode&1?(e=Cl,Cl<<=1,!(Cl&130023424)&&(Cl=4194304)):e=1);var t=_t();n=Nr(n,e),n!==null&&(el(n,e,t),Yt(n,t))}function Mb(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),Qw(n,t)}function _b(n,e){var t=0;switch(n.tag){case 13:var r=n.stateNode,i=n.memoizedState;i!==null&&(t=i.retryLane);break;case 19:r=n.stateNode;break;default:throw Error(M(314))}r!==null&&r.delete(e),Qw(n,t)}var Yw;Yw=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||qt.current)Gt=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Gt=!1,Sb(n,e,t);Gt=!!(n.flags&131072)}else Gt=!1,Oe&&e.flags&1048576&&ew(e,Ic,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;rc(n,e),n=e.pendingProps;var i=rs(e,Rt.current);qo(e,t),i=Hp(null,e,r,n,i,t);var o=Fp();return e.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Qt(r)?(o=!0,Ec(e)):o=!1,e.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,_p(e),i.updater=bu,e.stateNode=i,i._reactInternals=e,Jh(e,r,n,t),e=ef(null,e,r,!0,o,t)):(e.tag=0,Oe&&o&&Ap(e),Ot(null,e,i,t),e=e.child),e;case 16:r=e.elementType;e:{switch(rc(n,e),n=e.pendingProps,i=r._init,r=i(r._payload),e.type=r,i=e.tag=Db(r),n=_n(r,n),i){case 0:e=Zh(null,e,r,n,t);break e;case 1:e=Cy(null,e,r,n,t);break e;case 11:e=yy(null,e,r,n,t);break e;case 14:e=vy(null,e,r,_n(r.type,n),t);break e}throw Error(M(306,r,""))}return e;case 0:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),Zh(n,e,r,i,t);case 1:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),Cy(n,e,r,i,t);case 3:e:{if(_w(e),n===null)throw Error(M(387));r=e.pendingProps,o=e.memoizedState,i=o.element,sw(n,e),Rc(e,r,null,t);var s=e.memoizedState;if(r=s.element,o.isDehydrated)if(o={element:r,isDehydrated:!1,cache:s.cache,pendingSuspenseBoundaries:s.pendingSuspenseBoundaries,transitions:s.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){i=ls(Error(M(423)),e),e=Sy(n,e,r,t,i);break e}else if(r!==i){i=ls(Error(M(424)),e),e=Sy(n,e,r,t,i);break e}else for(hn=li(e.stateNode.containerInfo.firstChild),mn=e,Oe=!0,Ln=null,t=iw(e,null,r,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(is(),r===i){e=xr(n,e,t);break e}Ot(n,e,r,t)}e=e.child}return e;case 5:return aw(e),n===null&&qh(e),r=e.type,i=e.pendingProps,o=n!==null?n.memoizedProps:null,s=i.children,Kh(r,i)?s=null:o!==null&&Kh(r,o)&&(e.flags|=32),Mw(n,e),Ot(n,e,s,t),e.child;case 6:return n===null&&qh(e),null;case 13:return Pw(n,e,t);case 4:return Pp(e,e.stateNode.containerInfo),r=e.pendingProps,n===null?e.child=ss(e,null,r,t):Ot(n,e,r,t),e.child;case 11:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),yy(n,e,r,i,t);case 7:return Ot(n,e,e.pendingProps,t),e.child;case 8:return Ot(n,e,e.pendingProps.children,t),e.child;case 12:return Ot(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(r=e.type._context,i=e.pendingProps,o=e.memoizedProps,s=i.value,Te(Ac,r._currentValue),r._currentValue=s,o!==null)if(jn(o.value,s)){if(o.children===i.children&&!qt.current){e=xr(n,e,t);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){s=o.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(o.tag===1){l=kr(-1,t&-t),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),Qh(o.return,t,e),a.lanes|=t;break}l=l.next}}else if(o.tag===10)s=o.type===e.type?null:o.child;else if(o.tag===18){if(s=o.return,s===null)throw Error(M(341));s.lanes|=t,a=s.alternate,a!==null&&(a.lanes|=t),Qh(s,t,e),s=o.sibling}else s=o.child;if(s!==null)s.return=o;else for(s=o;s!==null;){if(s===e){s=null;break}if(o=s.sibling,o!==null){o.return=s.return,s=o;break}s=s.return}o=s}Ot(n,e,i.children,t),e=e.child}return e;case 9:return i=e.type,r=e.pendingProps.children,qo(e,t),i=xn(i),r=r(i),e.flags|=1,Ot(n,e,r,t),e.child;case 14:return r=e.type,i=_n(r,e.pendingProps),i=_n(r.type,i),vy(n,e,r,i,t);case 15:return xw(n,e,e.type,e.pendingProps,t);case 17:return r=e.type,i=e.pendingProps,i=e.elementType===r?i:_n(r,i),rc(n,e),e.tag=1,Qt(r)?(n=!0,Ec(e)):n=!1,qo(e,t),bw(e,r,i),Jh(e,r,i,t),ef(null,e,r,!0,n,t);case 19:return Dw(n,e,t);case 22:return Ow(n,e,t)}throw Error(M(156,e.tag))};function Jw(n,e){return kS(n,e)}function Pb(n,e,t,r){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function In(n,e,t,r){return new Pb(n,e,t,r)}function Qp(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Db(n){if(typeof n=="function")return Qp(n)?1:0;if(n!=null){if(n=n.$$typeof,n===pp)return 11;if(n===mp)return 14}return 2}function hi(n,e){var t=n.alternate;return t===null?(t=In(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function sc(n,e,t,r,i,o){var s=2;if(r=n,typeof n=="function")Qp(n)&&(s=1);else if(typeof n=="string")s=5;else e:switch(n){case Ro:return Ki(t.children,i,o,e);case fp:s=8,i|=8;break;case wh:return n=In(12,t,e,i|2),n.elementType=wh,n.lanes=o,n;case Th:return n=In(13,t,e,i),n.elementType=Th,n.lanes=o,n;case Eh:return n=In(19,t,e,i),n.elementType=Eh,n.lanes=o,n;case aS:return xu(t,i,o,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case oS:s=10;break e;case sS:s=9;break e;case pp:s=11;break e;case mp:s=14;break e;case $r:s=16,r=null;break e}throw Error(M(130,n==null?n:typeof n,""))}return e=In(s,t,e,i),e.elementType=n,e.type=r,e.lanes=o,e}function Ki(n,e,t,r){return n=In(7,n,r,e),n.lanes=t,n}function xu(n,e,t,r){return n=In(22,n,r,e),n.elementType=aS,n.lanes=t,n.stateNode={isHidden:!1},n}function Bd(n,e,t){return n=In(6,n,null,e),n.lanes=t,n}function zd(n,e,t){return e=In(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function Lb(n,e,t,r,i){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wd(0),this.expirationTimes=wd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wd(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Yp(n,e,t,r,i,o,s,a,l){return n=new Lb(n,e,t,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=In(3,null,null,e),n.current=o,o.stateNode=n,o.memoizedState={element:r,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},_p(o),n}function Ub(n,e,t){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:bo,key:r==null?null:""+r,children:n,containerInfo:e,implementation:t}}function Xw(n){if(!n)return wi;n=n._reactInternals;e:{if(uo(n)!==n||n.tag!==1)throw Error(M(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Qt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(M(171))}if(n.tag===1){var t=n.type;if(Qt(t))return XS(n,t,e)}return e}function Zw(n,e,t,r,i,o,s,a,l){return n=Yp(t,r,!0,n,i,o,s,a,l),n.context=Xw(null),t=n.current,r=_t(),i=di(t),o=kr(r,i),o.callback=e??null,ci(t,o,i),n.current.lanes=i,el(n,i,r),Yt(n,r),n}function Ou(n,e,t,r){var i=e.current,o=_t(),s=di(i);return t=Xw(t),e.context===null?e.context=t:e.pendingContext=t,e=kr(o,s),e.payload={element:n},r=r===void 0?null:r,r!==null&&(e.callback=r),n=ci(i,e,s),n!==null&&(Fn(n,i,s,o),ec(n,i,s)),s}function Lc(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function xy(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function Jp(n,e){xy(n,e),(n=n.alternate)&&xy(n,e)}function Hb(){return null}var eT=typeof reportError=="function"?reportError:function(n){console.error(n)};function Xp(n){this._internalRoot=n}Mu.prototype.render=Xp.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(M(409));Ou(n,e,null,null)};Mu.prototype.unmount=Xp.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;Zi(function(){Ou(null,n,null,null)}),e[Rr]=null}};function Mu(n){this._internalRoot=n}Mu.prototype.unstable_scheduleHydration=function(n){if(n){var e=OS();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Qr.length&&e!==0&&e<Qr[t].priority;t++);Qr.splice(t,0,n),t===0&&_S(n)}};function Zp(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function _u(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function Oy(){}function Fb(n,e,t,r,i){if(i){if(typeof r=="function"){var o=r;r=function(){var c=Lc(s);o.call(c)}}var s=Zw(e,r,n,0,null,!1,!1,"",Oy);return n._reactRootContainer=s,n[Rr]=s.current,Na(n.nodeType===8?n.parentNode:n),Zi(),s}for(;i=n.lastChild;)n.removeChild(i);if(typeof r=="function"){var a=r;r=function(){var c=Lc(l);a.call(c)}}var l=Yp(n,0,!1,null,null,!1,!1,"",Oy);return n._reactRootContainer=l,n[Rr]=l.current,Na(n.nodeType===8?n.parentNode:n),Zi(function(){Ou(e,l,t,r)}),l}function Pu(n,e,t,r,i){var o=t._reactRootContainer;if(o){var s=o;if(typeof i=="function"){var a=i;i=function(){var l=Lc(s);a.call(l)}}Ou(e,s,n,i)}else s=Fb(t,e,n,i,r);return Lc(s)}NS=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=Ws(e.pendingLanes);t!==0&&(vp(e,t|1),Yt(e,ze()),!(ce&6)&&(cs=ze()+500,bi()))}break;case 13:Zi(function(){var r=Nr(n,1);if(r!==null){var i=_t();Fn(r,n,1,i)}}),Jp(n,1)}};Cp=function(n){if(n.tag===13){var e=Nr(n,134217728);if(e!==null){var t=_t();Fn(e,n,134217728,t)}Jp(n,134217728)}};xS=function(n){if(n.tag===13){var e=di(n),t=Nr(n,e);if(t!==null){var r=_t();Fn(t,n,e,r)}Jp(n,e)}};OS=function(){return pe};MS=function(n,e){var t=pe;try{return pe=n,e()}finally{pe=t}};_h=function(n,e,t){switch(e){case"input":if(Ah(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var r=t[e];if(r!==n&&r.form===n.form){var i=ku(r);if(!i)throw Error(M(90));cS(r),Ah(r,i)}}}break;case"textarea":dS(n,t);break;case"select":e=t.value,e!=null&&$o(n,!!t.multiple,e,!1)}};vS=Wp;CS=Zi;var Bb={usingClientEntryPoint:!1,Events:[nl,Mo,ku,gS,yS,Wp]},js={findFiberByHostInstance:Di,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},zb={bundleType:js.bundleType,version:js.version,rendererPackageName:js.rendererPackageName,rendererConfig:js.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Pr.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=TS(n),n===null?null:n.stateNode},findFiberByHostInstance:js.findFiberByHostInstance||Hb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var xl=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!xl.isDisabled&&xl.supportsFiber)try{Su=xl.inject(zb),sr=xl}catch{}}yn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Bb;yn.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Zp(e))throw Error(M(200));return Ub(n,e,null,t)};yn.createRoot=function(n,e){if(!Zp(n))throw Error(M(299));var t=!1,r="",i=eT;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(i=e.onRecoverableError)),e=Yp(n,1,!1,null,null,t,!1,r,i),n[Rr]=e.current,Na(n.nodeType===8?n.parentNode:n),new Xp(e)};yn.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(M(188)):(n=Object.keys(n).join(","),Error(M(268,n)));return n=TS(e),n=n===null?null:n.stateNode,n};yn.flushSync=function(n){return Zi(n)};yn.hydrate=function(n,e,t){if(!_u(e))throw Error(M(200));return Pu(null,n,e,!0,t)};yn.hydrateRoot=function(n,e,t){if(!Zp(n))throw Error(M(405));var r=t!=null&&t.hydratedSources||null,i=!1,o="",s=eT;if(t!=null&&(t.unstable_strictMode===!0&&(i=!0),t.identifierPrefix!==void 0&&(o=t.identifierPrefix),t.onRecoverableError!==void 0&&(s=t.onRecoverableError)),e=Zw(e,null,n,1,t??null,i,!1,o,s),n[Rr]=e.current,Na(n),r)for(n=0;n<r.length;n++)t=r[n],i=t._getVersion,i=i(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,i]:e.mutableSourceEagerHydrationData.push(t,i);return new Mu(e)};yn.render=function(n,e,t){if(!_u(e))throw Error(M(200));return Pu(null,n,e,!1,t)};yn.unmountComponentAtNode=function(n){if(!_u(n))throw Error(M(40));return n._reactRootContainer?(Zi(function(){Pu(null,null,n,!1,function(){n._reactRootContainer=null,n[Rr]=null})}),!0):!1};yn.unstable_batchedUpdates=Wp;yn.unstable_renderSubtreeIntoContainer=function(n,e,t,r){if(!_u(t))throw Error(M(200));if(n==null||n._reactInternals===void 0)throw Error(M(38));return Pu(n,e,t,!1,r)};yn.version="18.3.1-next-f1338f8080-20240426";function tT(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(tT)}catch(n){console.error(n)}}tT(),tS.exports=yn;var ei=tS.exports;const jb=KC(ei);var nT,My=ei;nT=My.createRoot,My.hydrateRoot;/*! @azure/msal-common v14.16.0 2024-11-05 */const A={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Ol={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},Is=[A.OPENID_SCOPE,A.PROFILE_SCOPE,A.OFFLINE_ACCESS_SCOPE],_y=[...Is,A.EMAIL_SCOPE],Mt={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},et={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},fi={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Ml={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},it={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Py={PLAIN:"plain",S256:"S256"},il={QUERY:"query",FRAGMENT:"fragment"},Kb={...il,FORM_POST:"form_post"},rT={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},_l={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},At={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},Q={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},em="appmetadata",$b="client_info",aa="1",Uc={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},rn={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},dt={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ge={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},la={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Dy={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Ly={username:"username",password:"password"},Pl={httpSuccess:200,httpBadRequest:400},Co={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},jd={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},jr={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Vb={Jwt:"JWT",Jwk:"JWK",Pop:"pop"},Wb=300;/*! @azure/msal-common v14.16.0 2024-11-05 */const tm="unexpected_error",Gb="post_request_failed";/*! @azure/msal-common v14.16.0 2024-11-05 */const Uy={[tm]:"Unexpected error in authentication.",[Gb]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Me extends Error{constructor(e,t,r){const i=t?`${e}: ${t}`:e;super(i),Object.setPrototypeOf(this,Me.prototype),this.errorCode=e||A.EMPTY_STRING,this.errorMessage=t||A.EMPTY_STRING,this.subError=r||A.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function iT(n,e){return new Me(n,e?`${Uy[n]} ${e}`:Uy[n])}/*! @azure/msal-common v14.16.0 2024-11-05 */const nm="client_info_decoding_error",oT="client_info_empty_error",rm="token_parsing_error",sT="null_or_empty_token",gr="endpoints_resolution_error",aT="network_error",lT="openid_config_error",cT="hash_not_deserialized",us="invalid_state",uT="state_mismatch",Hc="state_not_found",dT="nonce_mismatch",im="auth_time_not_found",hT="max_age_transpired",qb="multiple_matching_tokens",Qb="multiple_matching_accounts",fT="multiple_matching_appMetadata",pT="request_cannot_be_made",mT="cannot_remove_empty_scope",gT="cannot_append_scopeset",ff="empty_input_scopeset",Yb="device_code_polling_cancelled",Jb="device_code_expired",Xb="device_code_unknown_error",om="no_account_in_silent_request",yT="invalid_cache_record",sm="invalid_cache_environment",pf="no_account_found",mf="no_crypto_object",gf="unexpected_credential_type",Zb="invalid_assertion",eR="invalid_client_credential",wr="token_refresh_required",tR="user_timeout_reached",vT="token_claims_cnf_required_for_signedjwt",CT="authorization_code_missing_from_server_response",ST="binding_key_not_removed",wT="end_session_endpoint_not_supported",am="key_id_missing",nR="no_network_connectivity",rR="user_canceled",iR="missing_tenant_id_error",te="method_not_implemented",oR="nested_app_auth_bridge_disabled";/*! @azure/msal-common v14.16.0 2024-11-05 */const Hy={[nm]:"The client info could not be parsed/decoded correctly",[oT]:"The client info was empty",[rm]:"Token cannot be parsed",[sT]:"The token is null or empty",[gr]:"Endpoints cannot be resolved",[aT]:"Network request failed",[lT]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[cT]:"The hash parameters could not be deserialized",[us]:"State was not the expected format",[uT]:"State mismatch error",[Hc]:"State not found",[dT]:"Nonce mismatch error",[im]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[hT]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[qb]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Qb]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[fT]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[pT]:"Token request cannot be made without authorization code or refresh token.",[mT]:"Cannot remove null or empty scope from ScopeSet",[gT]:"Cannot append ScopeSet",[ff]:"Empty input ScopeSet cannot be processed",[Yb]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Jb]:"Device code is expired.",[Xb]:"Device code stopped polling for unknown reasons.",[om]:"Please pass an account object, silent flow is not supported without account information",[yT]:"Cache record object was null or undefined.",[sm]:"Invalid environment when attempting to create cache entry",[pf]:"No account found in cache for given key.",[mf]:"No crypto object detected.",[gf]:"Unexpected credential type.",[Zb]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[eR]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[wr]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[tR]:"User defined timeout for device code polling reached",[vT]:"Cannot generate a POP jwt if the token_claims are not populated",[CT]:"Server response does not contain an authorization code to proceed",[ST]:"Could not remove the credential's binding key from storage.",[wT]:"The provided authority does not support logout",[am]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[nR]:"No network connectivity. Check your internet connection.",[rR]:"User cancelled the flow.",[iR]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[te]:"This method has not been implemented",[oR]:"The nested app auth bridge is disabled"};class Du extends Me{constructor(e,t){super(e,t?`${Hy[e]}: ${t}`:Hy[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,Du.prototype)}}function O(n,e){return new Du(n,e)}/*! @azure/msal-common v14.16.0 2024-11-05 */const Fc={createNewGuid:()=>{throw O(te)},base64Decode:()=>{throw O(te)},base64Encode:()=>{throw O(te)},base64UrlEncode:()=>{throw O(te)},encodeKid:()=>{throw O(te)},async getPublicKeyThumbprint(){throw O(te)},async removeTokenBindingKey(){throw O(te)},async clearKeystore(){throw O(te)},async signJwt(){throw O(te)},async hashString(){throw O(te)}};/*! @azure/msal-common v14.16.0 2024-11-05 */var xe;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(xe||(xe={}));class Or{constructor(e,t,r){this.level=xe.Info;const i=()=>{},o=e||Or.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||i,this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level=typeof o.logLevel=="number"?o.logLevel:xe.Info,this.correlationId=o.correlationId||A.EMPTY_STRING,this.packageName=t||A.EMPTY_STRING,this.packageVersion=r||A.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:xe.Info}}clone(e,t,r){return new Or({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:r||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const o=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${xe[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,o,t.containsPii||!1)}executeCallback(e,t,r){this.localCallback&&this.localCallback(e,t,r)}error(e,t){this.logMessage(e,{logLevel:xe.Error,containsPii:!1,correlationId:t||A.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:xe.Error,containsPii:!0,correlationId:t||A.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:xe.Warning,containsPii:!1,correlationId:t||A.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:xe.Warning,containsPii:!0,correlationId:t||A.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:xe.Info,containsPii:!1,correlationId:t||A.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:xe.Info,containsPii:!0,correlationId:t||A.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:xe.Verbose,containsPii:!1,correlationId:t||A.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:xe.Verbose,containsPii:!0,correlationId:t||A.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:xe.Trace,containsPii:!1,correlationId:t||A.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:xe.Trace,containsPii:!0,correlationId:t||A.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v14.16.0 2024-11-05 */const TT="@azure/msal-common",lm="14.16.0";/*! @azure/msal-common v14.16.0 2024-11-05 */const cm={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};/*! @azure/msal-common v14.16.0 2024-11-05 */function ho(n,e){const t=sR(n);try{const r=e(t);return JSON.parse(r)}catch{throw O(rm)}}function sR(n){if(!n)throw O(sT);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw O(rm);return t[2]}function ET(n,e){if(e===0||Date.now()-3e5>n+e)throw O(hT)}/*! @azure/msal-common v14.16.0 2024-11-05 */function cr(){return Math.round(new Date().getTime()/1e3)}function yf(n,e){const t=Number(n)||0;return cr()+e>t}function aR(n){return Number(n)>cr()}/*! @azure/msal-common v14.16.0 2024-11-05 */function Fo(n){return[lR(n),cR(n),uR(n),dR(n),hR(n)].join(At.CACHE_KEY_SEPARATOR).toLowerCase()}function Lu(n,e,t,r,i){return{credentialType:Q.ID_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t,realm:i}}function Uu(n,e,t,r,i,o,s,a,l,c,u,d,h,f,p){var v,g;const m={homeAccountId:n,credentialType:Q.ACCESS_TOKEN,secret:t,cachedAt:cr().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:r,realm:i,target:o,tokenType:u||ge.BEARER};if(d&&(m.userAssertionHash=d),c&&(m.refreshOn=c.toString()),f&&(m.requestedClaims=f,m.requestedClaimsHash=p),((v=m.tokenType)==null?void 0:v.toLowerCase())!==ge.BEARER.toLowerCase())switch(m.credentialType=Q.ACCESS_TOKEN_WITH_AUTH_SCHEME,m.tokenType){case ge.POP:const y=ho(t,l);if(!((g=y==null?void 0:y.cnf)!=null&&g.kid))throw O(vT);m.keyId=y.cnf.kid;break;case ge.SSH:m.keyId=h}return m}function kT(n,e,t,r,i,o,s){const a={credentialType:Q.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:r,secret:t};return o&&(a.userAssertionHash=o),i&&(a.familyId=i),s&&(a.expiresOn=s.toString()),a}function um(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function Fy(n){return n?um(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===Q.ACCESS_TOKEN||n.credentialType===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function By(n){return n?um(n)&&n.hasOwnProperty("realm")&&n.credentialType===Q.ID_TOKEN:!1}function zy(n){return n?um(n)&&n.credentialType===Q.REFRESH_TOKEN:!1}function lR(n){return[n.homeAccountId,n.environment].join(At.CACHE_KEY_SEPARATOR).toLowerCase()}function cR(n){const e=n.credentialType===Q.REFRESH_TOKEN&&n.familyId||n.clientId;return[n.credentialType,e,n.realm||""].join(At.CACHE_KEY_SEPARATOR).toLowerCase()}function uR(n){return(n.target||"").toLowerCase()}function dR(n){return(n.requestedClaimsHash||"").toLowerCase()}function hR(n){return n.tokenType&&n.tokenType.toLowerCase()!==ge.BEARER.toLowerCase()?n.tokenType.toLowerCase():""}function fR(n,e){const t=n.indexOf(dt.CACHE_KEY)===0;let r=!0;return e&&(r=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&r}function pR(n,e){let t=!1;n&&(t=n.indexOf(la.THROTTLING_PREFIX)===0);let r=!0;return e&&(r=e.hasOwnProperty("throttleTime")),t&&r}function mR({environment:n,clientId:e}){return[em,n,e].join(At.CACHE_KEY_SEPARATOR).toLowerCase()}function gR(n,e){return e?n.indexOf(em)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function yR(n,e){return e?n.indexOf(Uc.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function jy(){return cr()+Uc.REFRESH_TIME_SECONDS}function Dl(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function Kd(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function Ky(n){return n.expiresAt<=cr()}/*! @azure/msal-common v14.16.0 2024-11-05 */const IT="redirect_uri_empty",vR="claims_request_parsing_error",AT="authority_uri_insecure",qs="url_parse_error",bT="empty_url_error",RT="empty_input_scopes_error",NT="invalid_prompt_value",dm="invalid_claims",xT="token_request_empty",OT="logout_request_empty",MT="invalid_code_challenge_method",hm="pkce_params_missing",fm="invalid_cloud_discovery_metadata",_T="invalid_authority_metadata",PT="untrusted_authority",Hu="missing_ssh_jwk",DT="missing_ssh_kid",CR="missing_nonce_authentication_header",SR="invalid_authentication_header",LT="cannot_set_OIDCOptions",UT="cannot_allow_native_broker",HT="authority_mismatch";/*! @azure/msal-common v14.16.0 2024-11-05 */const wR={[IT]:"A redirect URI is required for all calls, and none has been set.",[vR]:"Could not parse the given claims request object.",[AT]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[qs]:"URL could not be parsed into appropriate segments.",[bT]:"URL was empty or null.",[RT]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[NT]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[dm]:"Given claims parameter must be a stringified JSON object.",[xT]:"Token request was empty and not found in cache.",[OT]:"The logout request was null or undefined.",[MT]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[hm]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[fm]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[_T]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[PT]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Hu]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[DT]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[CR]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[SR]:"Invalid authentication header provided",[LT]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[UT]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[HT]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."};class pm extends Me{constructor(e){super(e,wR[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,pm.prototype)}}function Ce(n){return new pm(n)}/*! @azure/msal-common v14.16.0 2024-11-05 */class Bn{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},r=e.split("&"),i=o=>decodeURIComponent(o.replace(/\+/g," "));return r.forEach(o=>{if(o.trim()){const[s,a]=o.split(/=(.+)/g,2);s&&a&&(t[i(s)]=i(a))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class je{constructor(e){const t=e?Bn.trimArrayEntries([...e]):[],r=t?Bn.removeEmptyStringsFromArray(t):[];this.validateInputScopes(r),this.scopes=new Set,r.forEach(i=>this.scopes.add(i))}static fromString(e){const r=(e||A.EMPTY_STRING).split(" ");return new je(r)}static createSearchScopes(e){const t=new je(e);return t.containsOnlyOIDCScopes()?t.removeScope(A.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw Ce(RT)}containsScope(e){const t=this.printScopesLowerCase().split(" "),r=new je(t);return e?r.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return _y.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw O(gT)}}removeScope(e){if(!e)throw O(mT);this.scopes.delete(e.trim())}removeOIDCScopes(){_y.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw O(ff);const t=new Set;return e.scopes.forEach(r=>t.add(r.toLowerCase())),this.scopes.forEach(r=>t.add(r.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw O(ff);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),r=e.getScopeCount(),i=this.getScopeCount();return t.size<i+r}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):A.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v14.16.0 2024-11-05 */function Bc(n,e){if(!n)throw O(oT);try{const t=e(n);return JSON.parse(t)}catch{throw O(nm)}}function Bo(n){if(!n)throw O(nm);const e=n.split(At.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?A.EMPTY_STRING:e[1]}}/*! @azure/msal-common v14.16.0 2024-11-05 */function zc(n,e){return!!n&&!!e&&n===e.split(".")[1]}function mm(n,e,t,r){if(r){const{oid:i,sub:o,tid:s,name:a,tfp:l,acr:c}=r,u=s||l||c||"";return{tenantId:u,localAccountId:i||o||"",name:a,isHomeTenant:zc(u,n)}}else return{tenantId:t,localAccountId:e,isHomeTenant:zc(t,n)}}function gm(n,e,t,r){let i=n;if(e){const{isHomeTenant:o,...s}=e;i={...n,...s}}if(t){const{isHomeTenant:o,...s}=mm(n.homeAccountId,n.localAccountId,n.tenantId,t);return i={...i,...s,idTokenClaims:t,idToken:r},i}return i}/*! @azure/msal-common v14.16.0 2024-11-05 */const Dn={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v14.16.0 2024-11-05 */function FT(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v14.16.0 2024-11-05 */const Ir={AAD:"AAD",OIDC:"OIDC"};/*! @azure/msal-common v14.16.0 2024-11-05 */class Ze{generateAccountId(){return[this.homeAccountId,this.environment].join(At.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return Ze.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){const t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(At.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,r){var c,u,d,h,f,p;const i=new Ze;t.authorityType===Dn.Adfs?i.authorityType=_l.ADFS_ACCOUNT_TYPE:t.protocolMode===Ir.AAD?i.authorityType=_l.MSSTS_ACCOUNT_TYPE:i.authorityType=_l.GENERIC_ACCOUNT_TYPE;let o;e.clientInfo&&r&&(o=Bc(e.clientInfo,r)),i.clientInfo=e.clientInfo,i.homeAccountId=e.homeAccountId,i.nativeAccountId=e.nativeAccountId;const s=e.environment||t&&t.getPreferredCache();if(!s)throw O(sm);i.environment=s,i.realm=(o==null?void 0:o.utid)||FT(e.idTokenClaims)||"",i.localAccountId=(o==null?void 0:o.uid)||((c=e.idTokenClaims)==null?void 0:c.oid)||((u=e.idTokenClaims)==null?void 0:u.sub)||"";const a=((d=e.idTokenClaims)==null?void 0:d.preferred_username)||((h=e.idTokenClaims)==null?void 0:h.upn),l=(f=e.idTokenClaims)!=null&&f.emails?e.idTokenClaims.emails[0]:null;if(i.username=a||l||"",i.name=((p=e.idTokenClaims)==null?void 0:p.name)||"",i.cloudGraphHostName=e.cloudGraphHostName,i.msGraphHost=e.msGraphHost,e.tenantProfiles)i.tenantProfiles=e.tenantProfiles;else{const m=mm(e.homeAccountId,i.localAccountId,i.realm,e.idTokenClaims);i.tenantProfiles=[m]}return i}static createFromAccountInfo(e,t,r){var o;const i=new Ze;return i.authorityType=e.authorityType||_l.GENERIC_ACCOUNT_TYPE,i.homeAccountId=e.homeAccountId,i.localAccountId=e.localAccountId,i.nativeAccountId=e.nativeAccountId,i.realm=e.tenantId,i.environment=e.environment,i.username=e.username,i.name=e.name,i.cloudGraphHostName=t,i.msGraphHost=r,i.tenantProfiles=Array.from(((o=e.tenantProfiles)==null?void 0:o.values())||[]),i}static generateHomeAccountId(e,t,r,i,o){if(!(t===Dn.Adfs||t===Dn.Dsts)){if(e)try{const s=Bc(e,i.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch{}r.warning("No client info in response")}return(o==null?void 0:o.sub)||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,r){if(!e||!t)return!1;let i=!0;if(r){const o=e.idTokenClaims||{},s=t.idTokenClaims||{};i=o.iat===s.iat&&o.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i}}/*! @azure/msal-common v14.16.0 2024-11-05 */function BT(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function jc(n){if(!n||n.indexOf("=")<0)return null;try{const e=BT(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw O(cT)}return null}/*! @azure/msal-common v14.16.0 2024-11-05 */class ae{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Ce(bT);e.includes("#")||(this._urlString=ae.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Bn.endsWith(t,"?")?t=t.slice(0,-1):Bn.endsWith(t,"?/")&&(t=t.slice(0,-2)),Bn.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Ce(qs)}if(!e.HostNameAndPort||!e.PathSegments)throw Ce(qs);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Ce(AT)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return ae.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),r=t.PathSegments;return e&&r.length!==0&&(r[0]===fi.COMMON||r[0]===fi.ORGANIZATIONS)&&(r[0]=e),ae.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Ce(qs);const r={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let i=r.AbsolutePath.split("/");return i=i.filter(o=>o&&o.length>0),r.PathSegments=i,r.QueryString&&r.QueryString.endsWith("/")&&(r.QueryString=r.QueryString.substring(0,r.QueryString.length-1)),r}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),r=e.match(t);if(!r)throw Ce(qs);return r[2]}static getAbsoluteUrl(e,t){if(e[0]===A.FORWARD_SLASH){const i=new ae(t).getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new ae(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!jc(e)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const zT={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},$y=zT.endpointMetadata,ym=zT.instanceDiscoveryMetadata,jT=new Set;ym.metadata.forEach(n=>{n.aliases.forEach(e=>{jT.add(e)})});function TR(n,e){var i;let t;const r=n.canonicalAuthority;if(r){const o=new ae(r).getUrlComponents().HostNameAndPort;t=Vy(o,(i=n.cloudDiscoveryMetadata)==null?void 0:i.metadata,rn.CONFIG,e)||Vy(o,ym.metadata,rn.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function Vy(n,e,t,r){if(r==null||r.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const i=Kc(e,n);if(i)return r==null||r.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),i.aliases;r==null||r.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function ER(n){return Kc(ym.metadata,n)}function Kc(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(r.aliases.includes(e))return r}return null}/*! @azure/msal-common v14.16.0 2024-11-05 */const KT="cache_quota_exceeded",vm="cache_error_unknown";/*! @azure/msal-common v14.16.0 2024-11-05 */const $d={[KT]:"Exceeded cache storage capacity.",[vm]:"Unexpected error occurred when using cache storage."};class Yo extends Error{constructor(e,t){const r=t||($d[e]?$d[e]:$d[vm]);super(`${e}: ${r}`),Object.setPrototypeOf(this,Yo.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=r}}/*! @azure/msal-common v14.16.0 2024-11-05 */class ds{constructor(e,t,r,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=r.clone(TT,lm),this.staticAuthorityOptions=i}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){const t=this.getAllAccounts(e);return t.length>1?t.sort(i=>i.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){const t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(r=>this.getTenantProfilesFromAccountEntity(r,t==null?void 0:t.tenantId,t))}getTenantedAccountInfoByFilter(e,t,r,i){let o=null,s;if(i&&!this.tenantProfileMatchesFilter(r,i))return null;const a=this.getIdToken(e,t,r.tenantId);return a&&(s=ho(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,i))?null:(o=gm(e,r,s,a==null?void 0:a.secret),o)}getTenantProfilesFromAccountEntity(e,t,r){const i=e.getAccountInfo();let o=i.tenantProfiles||new Map;const s=this.getTokenKeys();if(t){const l=o.get(t);if(l)o=new Map([[t,l]]);else return[]}const a=[];return o.forEach(l=>{const c=this.getTenantedAccountInfoByFilter(i,s,l,r);c&&a.push(c)}),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,r){var i,o,s,a;if(!e)throw O(yT);try{e.account&&this.setAccount(e.account),e.idToken&&(t==null?void 0:t.idToken)!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&(t==null?void 0:t.accessToken)!==!1&&await this.saveAccessToken(e.accessToken),e.refreshToken&&(t==null?void 0:t.refreshToken)!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(l){throw(i=this.commonLogger)==null||i.error("CacheManager.saveCacheRecord: failed"),l instanceof Error?((o=this.commonLogger)==null||o.errorPii(`CacheManager.saveCacheRecord: ${l.message}`,r),l.name==="QuotaExceededError"||l.name==="NS_ERROR_DOM_QUOTA_REACHED"||l.message.includes("exceeded the quota")?((s=this.commonLogger)==null||s.error("CacheManager.saveCacheRecord: exceeded storage quota",r),new Yo(KT)):new Yo(l.name,l.message)):((a=this.commonLogger)==null||a.errorPii(`CacheManager.saveCacheRecord: ${l}`,r),new Yo(vm))}}async saveAccessToken(e){const t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},r=this.getTokenKeys(),i=je.fromString(e.target),o=[];r.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,t,!1))return;const a=this.getAccessTokenCredential(s);a&&this.credentialMatchesFilter(a,t)&&je.fromString(a.target).intersectingScopeSets(i)&&o.push(this.removeAccessToken(s))}),await Promise.all(o),this.setAccessTokenCredential(e)}getAccountsFilteredBy(e){const t=this.getAccountKeys(),r=[];return t.forEach(i=>{var l;if(!this.isAccountKey(i,e.homeAccountId))return;const o=this.getAccount(i,this.commonLogger);if(!o||e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId)||e.username&&!this.matchUsername(o.username,e.username)||e.environment&&!this.matchEnvironment(o,e.environment)||e.realm&&!this.matchRealm(o,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;const s={localAccountId:e==null?void 0:e.localAccountId,name:e==null?void 0:e.name},a=(l=o.tenantProfiles)==null?void 0:l.filter(c=>this.tenantProfileMatchesFilter(c,s));a&&a.length===0||r.push(o)}),r}isAccountKey(e,t,r){return!(e.split(At.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||r&&!e.toLowerCase().includes(r.toLowerCase()))}isCredentialKey(e){if(e.split(At.CACHE_KEY_SEPARATOR).length<6)return!1;const t=e.toLowerCase();if(t.indexOf(Q.ID_TOKEN.toLowerCase())===-1&&t.indexOf(Q.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(Q.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(Q.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(Q.REFRESH_TOKEN.toLowerCase())>-1){const r=`${Q.REFRESH_TOKEN}${At.CACHE_KEY_SEPARATOR}${this.clientId}${At.CACHE_KEY_SEPARATOR}`,i=`${Q.REFRESH_TOKEN}${At.CACHE_KEY_SEPARATOR}${aa}${At.CACHE_KEY_SEPARATOR}`;if(t.indexOf(r.toLowerCase())===-1&&t.indexOf(i.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===ge.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),r={};return t.forEach(i=>{if(!this.isAppMetadata(i))return;const o=this.getAppMetadata(i);o&&(e.environment&&!this.matchEnvironment(o,e.environment)||e.clientId&&!this.matchClientId(o,e.clientId)||(r[i]=o))}),r}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let r=null;return t.forEach(i=>{if(!this.isAuthorityMetadata(i)||i.indexOf(this.clientId)===-1)return;const o=this.getAuthorityMetadata(i);o&&o.aliases.indexOf(e)!==-1&&(r=o)}),r}async removeAllAccounts(){const e=this.getAccountKeys(),t=[];e.forEach(r=>{t.push(this.removeAccount(r))}),await Promise.all(t)}async removeAccount(e){const t=this.getAccount(e,this.commonLogger);t&&(await this.removeAccountContext(t),this.removeItem(e))}async removeAccountContext(e){const t=this.getTokenKeys(),r=e.generateAccountId(),i=[];t.idToken.forEach(o=>{o.indexOf(r)===0&&this.removeIdToken(o)}),t.accessToken.forEach(o=>{o.indexOf(r)===0&&i.push(this.removeAccessToken(o))}),t.refreshToken.forEach(o=>{o.indexOf(r)===0&&this.removeRefreshToken(o)}),await Promise.all(i)}updateOutdatedCachedAccount(e,t,r){var i;if(t&&t.isSingleTenant()){(i=this.commonLogger)==null||i.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");const o=this.getAccountKeys().filter(u=>u.startsWith(t.homeAccountId)),s=[];o.forEach(u=>{const d=this.getCachedAccountEntity(u);d&&s.push(d)});const a=s.find(u=>zc(u.realm,u.homeAccountId))||s[0];a.tenantProfiles=s.map(u=>({tenantId:u.realm,localAccountId:u.localAccountId,name:u.name,isHomeTenant:zc(u.realm,u.homeAccountId)}));const l=ds.toObject(new Ze,{...a}),c=l.generateAccountKey();return o.forEach(u=>{u!==c&&this.removeOutdatedAccount(e)}),this.setAccount(l),r==null||r.verbose("Updated an outdated account entity in the cache"),l}return t}async removeAccessToken(e){const t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===Q.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===ge.POP){const i=t.keyId;if(i)try{await this.cryptoImpl.removeTokenBindingKey(i)}catch{throw O(ST)}}return this.removeItem(e)}}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){const t=Ze.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,r,i,o){this.commonLogger.trace("CacheManager - getIdToken called");const s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Q.ID_TOKEN,clientId:this.clientId,realm:r},a=this.getIdTokensByFilter(s,t),l=a.size;if(l<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(l>1){let c=a;if(!r){const u=new Map;a.forEach((h,f)=>{h.realm===e.tenantId&&u.set(f,h)});const d=u.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(d===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;c=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),c.forEach((u,d)=>{this.removeIdToken(d)}),i&&o&&i.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){const r=t&&t.idToken||this.getTokenKeys().idToken,i=new Map;return r.forEach(o=>{if(!this.idTokenKeyMatchesFilter(o,{clientId:this.clientId,...e}))return;const s=this.getIdTokenCredential(o);s&&this.credentialMatchesFilter(s,e)&&i.set(o,s)}),i}idTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,r,i,o,s){this.commonLogger.trace("CacheManager - getAccessToken called");const a=je.createSearchScopes(t.scopes),l=t.authenticationScheme||ge.BEARER,c=l&&l.toLowerCase()!==ge.BEARER.toLowerCase()?Q.ACCESS_TOKEN_WITH_AUTH_SCHEME:Q.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:c,clientId:this.clientId,realm:i||e.tenantId,target:a,tokenType:l,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},d=r&&r.accessToken||this.getTokenKeys().accessToken,h=[];d.forEach(p=>{if(this.accessTokenKeyMatchesFilter(p,u,!0)){const m=this.getAccessTokenCredential(p);m&&this.credentialMatchesFilter(m,u)&&h.push(m)}});const f=h.length;return f<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):f>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),h.forEach(p=>{this.removeAccessToken(Fo(p))}),o&&s&&o.addFields({multiMatchedAT:h.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),h[0])}accessTokenKeyMatchesFilter(e,t,r){const i=e.toLowerCase();if(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&i.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&i.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const o=t.target.asArray();for(let s=0;s<o.length;s++){if(r&&!i.includes(o[s].toLowerCase()))return!1;if(!r&&i.includes(o[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){const t=this.getTokenKeys(),r=[];return t.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;const o=this.getAccessTokenCredential(i);o&&this.credentialMatchesFilter(o,e)&&r.push(o)}),r}getRefreshToken(e,t,r,i,o){this.commonLogger.trace("CacheManager - getRefreshToken called");const s=t?aa:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:Q.REFRESH_TOKEN,clientId:this.clientId,familyId:s},l=r&&r.refreshToken||this.getTokenKeys().refreshToken,c=[];l.forEach(d=>{if(this.refreshTokenKeyMatchesFilter(d,a)){const h=this.getRefreshTokenCredential(d);h&&this.credentialMatchesFilter(h,a)&&c.push(h)}});const u=c.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&i&&o&&i.addFields({multiMatchedRT:u},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),c[0])}refreshTokenKeyMatchesFilter(e,t){const r=e.toLowerCase();return!(t.familyId&&r.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&r.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&r.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},r=this.getAppMetadataFilteredBy(t),i=Object.keys(r).map(s=>r[s]),o=i.length;if(o<1)return null;if(o>1)throw O(fT);return i[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===aa)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const r=e.oid||e.sub;return t===r}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){var r;return t.toLowerCase()===((r=e.name)==null?void 0:r.toLowerCase())}matchUsername(e,t){return!!(e&&typeof e=="string"&&(t==null?void 0:t.toLowerCase())===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const i=TR(this.staticAuthorityOptions,this.commonLogger);if(i.includes(t)&&i.includes(e.environment))return!0}const r=this.getAuthorityMetadataByAlias(t);return!!(r&&r.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){var r;return((r=e.realm)==null?void 0:r.toLowerCase())===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==Q.ACCESS_TOKEN&&e.credentialType!==Q.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:je.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(em)!==-1}isAuthorityMetadata(e){return e.indexOf(Uc.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Uc.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const r in t)e[r]=t[r];return e}}class kR extends ds{setAccount(){throw O(te)}getAccount(){throw O(te)}getCachedAccountEntity(){throw O(te)}setIdTokenCredential(){throw O(te)}getIdTokenCredential(){throw O(te)}setAccessTokenCredential(){throw O(te)}getAccessTokenCredential(){throw O(te)}setRefreshTokenCredential(){throw O(te)}getRefreshTokenCredential(){throw O(te)}setAppMetadata(){throw O(te)}getAppMetadata(){throw O(te)}setServerTelemetry(){throw O(te)}getServerTelemetry(){throw O(te)}setAuthorityMetadata(){throw O(te)}getAuthorityMetadata(){throw O(te)}getAuthorityMetadataKeys(){throw O(te)}setThrottlingCache(){throw O(te)}getThrottlingCache(){throw O(te)}removeItem(){throw O(te)}getKeys(){throw O(te)}getAccountKeys(){throw O(te)}getTokenKeys(){throw O(te)}updateCredentialCacheKey(){throw O(te)}removeOutdatedAccount(){throw O(te)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const $T={tokenRenewalOffsetSeconds:Wb,preventCorsPreflight:!1},IR={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:xe.Info,correlationId:A.EMPTY_STRING},AR={claimsBasedCachingEnabled:!1},bR={async sendGetRequestAsync(){throw O(te)},async sendPostRequestAsync(){throw O(te)}},RR={sku:A.SKU,version:lm,cpu:A.EMPTY_STRING,os:A.EMPTY_STRING},NR={clientSecret:A.EMPTY_STRING,clientAssertion:void 0},xR={azureCloudInstance:cm.None,tenant:`${A.DEFAULT_COMMON_TENANT}`},OR={application:{appName:"",appVersion:""}};function MR({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:r,storageInterface:i,networkInterface:o,cryptoInterface:s,clientCredentials:a,libraryInfo:l,telemetry:c,serverTelemetryManager:u,persistencePlugin:d,serializableCache:h}){const f={...IR,...t};return{authOptions:_R(n),systemOptions:{...$T,...e},loggerOptions:f,cacheOptions:{...AR,...r},storageInterface:i||new kR(n.clientId,Fc,new Or(f)),networkInterface:o||bR,cryptoInterface:s||Fc,clientCredentials:a||NR,libraryInfo:{...RR,...l},telemetry:{...OR,...c},serverTelemetryManager:u||null,persistencePlugin:d||null,serializableCache:h||null}}function _R(n){return{clientCapabilities:[],azureCloudOptions:xR,skipAuthorityMetadataCache:!1,instanceAware:!1,...n}}function vf(n){return n.authOptions.authority.options.protocolMode===Ir.OIDC}/*! @azure/msal-common v14.16.0 2024-11-05 */const fn={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v14.16.0 2024-11-05 */const eo="client_id",VT="redirect_uri",Wy="response_type",PR="response_mode",DR="grant_type",LR="claims",UR="scope",HR="refresh_token",FR="state",BR="nonce",zR="prompt",jR="code",KR="code_challenge",$R="code_challenge_method",VR="code_verifier",WR="client-request-id",GR="x-client-SKU",qR="x-client-VER",QR="x-client-OS",YR="x-client-CPU",JR="x-client-current-telemetry",XR="x-client-last-telemetry",ZR="x-ms-lib-capability",e1="x-app-name",t1="x-app-ver",n1="post_logout_redirect_uri",r1="id_token_hint",i1="device_code",o1="client_secret",s1="client_assertion",a1="client_assertion_type",Gy="token_type",qy="req_cnf",l1="assertion",c1="requested_token_use",Qy="return_spa_code",u1="nativebroker",d1="logout_hint",h1="sid",f1="login_hint",p1="domain_hint",m1="x-client-xtra-sku",Cm="brk_client_id",Cf="brk_redirect_uri";/*! @azure/msal-common v14.16.0 2024-11-05 */class To{static validateRedirectUri(e){if(!e)throw Ce(IT)}static validatePrompt(e){const t=[];for(const r in it)t.push(it[r]);if(t.indexOf(e)<0)throw Ce(NT)}static validateClaims(e){try{JSON.parse(e)}catch{throw Ce(dm)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw Ce(hm);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Py.PLAIN,Py.S256].indexOf(e)<0)throw Ce(MT)}}/*! @azure/msal-common v14.16.0 2024-11-05 */function g1(n,e,t){if(!e)return;const r=n.get(eo);r&&n.has(Cm)&&(t==null||t.addFields({embeddedClientId:r,embeddedRedirectUri:n.get(VT)},e))}class ca{constructor(e,t){this.parameters=new Map,this.performanceClient=t,this.correlationId=e}addResponseTypeCode(){this.parameters.set(Wy,encodeURIComponent(A.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Wy,encodeURIComponent(`${A.TOKEN_RESPONSE_TYPE} ${A.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(PR,encodeURIComponent(e||Kb.QUERY))}addNativeBroker(){this.parameters.set(u1,encodeURIComponent("1"))}addScopes(e,t=!0,r=Is){t&&!r.includes("openid")&&!e.includes("openid")&&r.push("openid");const i=t?[...e||[],...r]:e||[],o=new je(i);this.parameters.set(UR,encodeURIComponent(o.printScopes()))}addClientId(e){this.parameters.set(eo,encodeURIComponent(e))}addRedirectUri(e){To.validateRedirectUri(e),this.parameters.set(VT,encodeURIComponent(e))}addPostLogoutRedirectUri(e){To.validateRedirectUri(e),this.parameters.set(n1,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(r1,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(p1,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(f1,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(Mt.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(Mt.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(h1,encodeURIComponent(e))}addClaims(e,t){const r=this.addClientCapabilitiesToClaims(e,t);To.validateClaims(r),this.parameters.set(LR,encodeURIComponent(r))}addCorrelationId(e){this.parameters.set(WR,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(GR,e.sku),this.parameters.set(qR,e.version),e.os&&this.parameters.set(QR,e.os),e.cpu&&this.parameters.set(YR,e.cpu)}addApplicationTelemetry(e){e!=null&&e.appName&&this.parameters.set(e1,e.appName),e!=null&&e.appVersion&&this.parameters.set(t1,e.appVersion)}addPrompt(e){To.validatePrompt(e),this.parameters.set(`${zR}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(FR,encodeURIComponent(e))}addNonce(e){this.parameters.set(BR,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(To.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(KR,encodeURIComponent(e)),this.parameters.set($R,encodeURIComponent(t));else throw Ce(hm)}addAuthorizationCode(e){this.parameters.set(jR,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(i1,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(HR,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(VR,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(o1,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(s1,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(a1,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(l1,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(c1,encodeURIComponent(e))}addGrantType(e){this.parameters.set(DR,encodeURIComponent(e))}addClientInfo(){this.parameters.set($b,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,r])=>{!this.parameters.has(t)&&r&&this.parameters.set(t,r)})}addClientCapabilitiesToClaims(e,t){let r;if(!e)r={};else try{r=JSON.parse(e)}catch{throw Ce(dm)}return t&&t.length>0&&(r.hasOwnProperty(Ml.ACCESS_TOKEN)||(r[Ml.ACCESS_TOKEN]={}),r[Ml.ACCESS_TOKEN][Ml.XMS_CC]={values:t}),JSON.stringify(r)}addUsername(e){this.parameters.set(Ly.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Ly.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(Gy,ge.POP),this.parameters.set(qy,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(Gy,ge.SSH),this.parameters.set(qy,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(JR,e.generateCurrentRequestHeaderValue()),this.parameters.set(XR,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(ZR,la.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(d1,encodeURIComponent(e))}addBrokerParameters(e){const t={};t[Cm]=e.brokerClientId,t[Cf]=e.brokerRedirectUri,this.addExtraQueryParameters(t)}createQueryString(){const e=new Array;return this.parameters.forEach((t,r)=>{e.push(`${r}=${t}`)}),g1(this.parameters,this.correlationId,this.performanceClient),e.join("&")}}/*! @azure/msal-common v14.16.0 2024-11-05 */function y1(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v14.16.0 2024-11-05 */function v1(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v14.16.0 2024-11-05 */function C1(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v14.16.0 2024-11-05 */const T={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},S1={NotStarted:0,InProgress:1,Completed:2};/*! @azure/msal-common v14.16.0 2024-11-05 */const fo=(n,e,t,r,i)=>(...o)=>{t.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,i);if(i){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},i)}try{const a=n(...o);return s==null||s.end({success:!0}),t.trace(`Returning result from ${e}`),a}catch(a){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a}},P=(n,e,t,r,i)=>(...o)=>{t.trace(`Executing function ${e}`);const s=r==null?void 0:r.startMeasurement(e,i);if(i){const a=e+"CallCount";r==null||r.incrementFields({[a]:1},i)}return r==null||r.setPreQueueTime(e,i),n(...o).then(a=>(t.trace(`Returning result from ${e}`),s==null||s.end({success:!0}),a)).catch(a=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw s==null||s.end({success:!1},a),a})};/*! @azure/msal-common v14.16.0 2024-11-05 */class Fu{constructor(e,t,r,i){this.networkInterface=e,this.logger=t,this.performanceClient=r,this.correlationId=i}async detectRegion(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(T.RegionDiscoveryDetectRegion,this.correlationId);let r=e;if(r)t.region_source=Co.ENVIRONMENT_VARIABLE;else{const o=Fu.IMDS_OPTIONS;try{const s=await P(this.getRegionFromIMDS.bind(this),T.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(A.IMDS_VERSION,o);if(s.status===Pl.httpSuccess&&(r=s.body,t.region_source=Co.IMDS),s.status===Pl.httpBadRequest){const a=await P(this.getCurrentVersion.bind(this),T.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(o);if(!a)return t.region_source=Co.FAILED_AUTO_DETECTION,null;const l=await P(this.getRegionFromIMDS.bind(this),T.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,o);l.status===Pl.httpSuccess&&(r=l.body,t.region_source=Co.IMDS)}}catch{return t.region_source=Co.FAILED_AUTO_DETECTION,null}}return r||(t.region_source=Co.FAILED_AUTO_DETECTION),r||null}async getRegionFromIMDS(e,t){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(T.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${A.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,A.IMDS_TIMEOUT)}async getCurrentVersion(e){var t;(t=this.performanceClient)==null||t.addQueueMeasurement(T.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const r=await this.networkInterface.sendGetRequestAsync(`${A.IMDS_ENDPOINT}?format=json`,e);return r.status===Pl.httpBadRequest&&r.body&&r.body["newest-versions"]&&r.body["newest-versions"].length>0?r.body["newest-versions"][0]:null}catch{return null}}}Fu.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v14.16.0 2024-11-05 */class kt{constructor(e,t,r,i,o,s,a,l){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=r,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=s,this.managedIdentity=l||!1,this.regionDiscovery=new Fu(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(A.CIAM_AUTH_URL))return Dn.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case A.ADFS:return Dn.Adfs;case A.DSTS:return Dn.Dsts}return Dn.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new ae(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw O(gr)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw O(gr)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw O(gr)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw O(wT);return this.replacePath(this.metadata.end_session_endpoint)}else throw O(gr)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw O(gr)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw O(gr)}canReplaceTenant(e){return e.PathSegments.length===1&&!kt.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Dn.Default&&this.protocolMode===Ir.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const i=new ae(this.metadata.canonical_authority).getUrlComponents(),o=i.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,l)=>{let c=o[l];if(l===0&&this.canReplaceTenant(i)){const u=new ae(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];c!==u&&(this.logger.verbose(`Replacing tenant domain name ${c} with id ${u}`),c=u)}a!==c&&(t=t.replace(`/${c}/`,`/${a}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Dn.Adfs||this.protocolMode!==Ir.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){var i,o;(i=this.performanceClient)==null||i.addQueueMeasurement(T.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await P(this.updateCloudDiscoveryMetadata.bind(this),T.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const r=await P(this.updateEndpointMetadata.bind(this),T.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:r}),(o=this.performanceClient)==null||o.addFields({cloudDiscoverySource:t,authorityEndpointSource:r},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:jy(),jwks_uri:""}),e}updateCachedMetadata(e,t,r){t!==rn.CACHE&&(r==null?void 0:r.source)!==rn.CACHE&&(e.expiresAt=jy(),e.canonical_authority=this.canonicalAuthority);const i=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(i,e),this.metadata=e}async updateEndpointMetadata(e){var i,o,s;(i=this.performanceClient)==null||i.addQueueMeasurement(T.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===rn.HARDCODED_VALUES&&(o=this.authorityOptions.azureRegionConfiguration)!=null&&o.azureRegion&&t.metadata){const a=await P(this.updateMetadataWithRegionalInformation.bind(this),T.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);Dl(e,a,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let r=await P(this.getEndpointMetadataFromNetwork.bind(this),T.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return(s=this.authorityOptions.azureRegionConfiguration)!=null&&s.azureRegion&&(r=await P(this.updateMetadataWithRegionalInformation.bind(this),T.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(r)),Dl(e,r,!0),rn.NETWORK;throw O(lT,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Dl(e,t,!1),{source:rn.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const i=this.getEndpointMetadataFromHardcodedValues();if(i)return Dl(e,i,!1),{source:rn.HARDCODED_VALUES,metadata:i};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const r=Ky(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!r?(this.logger.verbose("Found endpoint metadata in the cache."),{source:rn.CACHE}):(r&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new ae(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Ce(_T)}return null}async getEndpointMetadataFromNetwork(){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(T.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const i=await this.networkInterface.sendGetRequestAsync(t,e);return y1(i.body)?i.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(i){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${i}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in $y?$y[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){var r,i,o;(r=this.performanceClient)==null||r.addQueueMeasurement(T.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=(i=this.authorityOptions.azureRegionConfiguration)==null?void 0:i.azureRegion;if(t){if(t!==A.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=jd.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,kt.replaceWithRegionalInformation(e,t);const s=await P(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),T.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)((o=this.authorityOptions.azureRegionConfiguration)==null?void 0:o.environmentRegion,this.regionDiscoveryMetadata);if(s)return this.regionDiscoveryMetadata.region_outcome=jd.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=s,kt.replaceWithRegionalInformation(e,s);this.regionDiscoveryMetadata.region_outcome=jd.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(T.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const r=await P(this.getCloudDiscoveryMetadataFromNetwork.bind(this),T.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(r)return Kd(e,r,!0),rn.NETWORK;throw Ce(PT)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||A.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||A.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||A.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Kd(e,t,!1),rn.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const i=ER(this.hostnameAndPort);if(i)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Kd(e,i,!1),rn.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const r=Ky(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!r?(this.logger.verbose("Found cloud discovery metadata in the cache."),rn.CACHE):(r&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Dn.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),kt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Kc(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Ce(fm)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),kt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(T.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${A.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let r=null;try{const o=await this.networkInterface.sendGetRequestAsync(e,t);let s,a;if(v1(o.body))s=o.body,a=s.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${s.tenant_discovery_endpoint}`);else if(C1(o.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${o.status}`),s=o.body,s.error===A.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${s.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${s.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),r=Kc(a,this.hostnameAndPort)}catch(o){if(o instanceof Me)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${o.errorCode}
Error Description: ${o.errorMessage}`);else{const s=o;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${s.name}
Error Description: ${s.message}`)}return null}return r||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),r=kt.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),r}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&ae.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let r;if(t&&t.azureCloudInstance!==cm.None){const i=t.tenant?t.tenant:A.DEFAULT_COMMON_TENANT;r=`${t.azureCloudInstance}/${i}/`}return r||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return A.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw O(gr)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return jT.has(e)}static isPublicCloudAuthority(e){return A.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,r){const i=new ae(e);i.validateAsUri();const o=i.getUrlComponents();let s=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(s=`${t}.${A.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const a=ae.constructAuthorityUriFromObject({...i.getUrlComponents(),HostNameAndPort:s}).urlString;return r?`${a}?${r}`:a}static replaceWithRegionalInformation(e,t){const r={...e};return r.authorization_endpoint=kt.buildRegionalAuthorityString(r.authorization_endpoint,t),r.token_endpoint=kt.buildRegionalAuthorityString(r.token_endpoint,t),r.end_session_endpoint&&(r.end_session_endpoint=kt.buildRegionalAuthorityString(r.end_session_endpoint,t)),r}static transformCIAMAuthority(e){let t=e;const i=new ae(e).getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(A.CIAM_AUTH_URL)){const o=i.HostNameAndPort.split(".")[0];t=`${t}${o}${A.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}kt.reservedTenantDomains=new Set(["{tenant}","{tenantid}",fi.COMMON,fi.CONSUMERS,fi.ORGANIZATIONS]);function w1(n){var i;const r=(i=new ae(n).getUrlComponents().PathSegments.slice(-1)[0])==null?void 0:i.toLowerCase();switch(r){case fi.COMMON:case fi.ORGANIZATIONS:case fi.CONSUMERS:return;default:return r}}function WT(n){return n.endsWith(A.FORWARD_SLASH)?n:`${n}${A.FORWARD_SLASH}`}function T1(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw Ce(fm)}return{canonicalAuthority:n.authority?WT(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v14.16.0 2024-11-05 */async function GT(n,e,t,r,i,o,s){s==null||s.addQueueMeasurement(T.AuthorityFactoryCreateDiscoveredInstance,o);const a=kt.transformCIAMAuthority(WT(n)),l=new kt(a,e,t,r,i,o,s);try{return await P(l.resolveEndpointsAsync.bind(l),T.AuthorityResolveEndpointsAsync,i,s,o)(),l}catch{throw O(gr)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class Ti extends Me{constructor(e,t,r,i,o){super(e,t,r),this.name="ServerError",this.errorNo=i,this.status=o,Object.setPrototypeOf(this,Ti.prototype)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class nr{static generateThrottlingStorageKey(e){return`${la.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){var o;const r=nr.generateThrottlingStorageKey(t),i=e.getThrottlingCache(r);if(i){if(i.throttleTime<Date.now()){e.removeItem(r);return}throw new Ti(((o=i.errorCodes)==null?void 0:o.join(" "))||A.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,r){if(nr.checkResponseStatus(r)||nr.checkResponseForRetryAfter(r)){const i={throttleTime:nr.calculateThrottleTime(parseInt(r.headers[Mt.RETRY_AFTER])),error:r.body.error,errorCodes:r.body.error_codes,errorMessage:r.body.error_description,subError:r.body.suberror};e.setThrottlingCache(nr.generateThrottlingStorageKey(t),i)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Mt.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,r=Date.now()/1e3;return Math.floor(Math.min(r+(t||la.DEFAULT_THROTTLE_TIME_SECONDS),r+la.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,r,i){const o={clientId:t,authority:r.authority,scopes:r.scopes,homeAccountIdentifier:i,claims:r.claims,authenticationScheme:r.authenticationScheme,resourceRequestMethod:r.resourceRequestMethod,resourceRequestUri:r.resourceRequestUri,shrClaims:r.shrClaims,sshKid:r.sshKid},s=this.generateThrottlingStorageKey(o);e.removeItem(s)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class Bu extends Me{constructor(e,t,r){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Bu.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=r}}function Yy(n,e,t){return new Bu(n,e,t)}/*! @azure/msal-common v14.16.0 2024-11-05 */class Sm{constructor(e,t){this.config=MR(e),this.logger=new Or(this.config.loggerOptions,TT,lm),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[Mt.CONTENT_TYPE]=A.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case fn.HOME_ACCOUNT_ID:try{const r=Bo(e.credential);t[Mt.CCS_HEADER]=`Oid:${r.uid}@${r.utid}`}catch(r){this.logger.verbose("Could not parse home account ID for CCS Header: "+r)}break;case fn.UPN:t[Mt.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,r,i,o,s){var l;s&&((l=this.performanceClient)==null||l.addQueueMeasurement(s,o));const a=await this.sendPostRequest(i,e,{body:t,headers:r},o);return this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a}async sendPostRequest(e,t,r,i){var s,a,l;nr.preProcess(this.cacheManager,e);let o;try{o=await P(this.networkClient.sendPostRequestAsync.bind(this.networkClient),T.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,i)(t,r);const c=o.headers||{};(a=this.performanceClient)==null||a.addFields({refreshTokenSize:((s=o.body.refresh_token)==null?void 0:s.length)||0,httpVerToken:c[Mt.X_MS_HTTP_VERSION]||"",requestId:c[Mt.X_MS_REQUEST_ID]||""},i)}catch(c){if(c instanceof Bu){const u=c.responseHeaders;throw u&&((l=this.performanceClient)==null||l.addFields({httpVerToken:u[Mt.X_MS_HTTP_VERSION]||"",requestId:u[Mt.X_MS_REQUEST_ID]||"",contentTypeHeader:u[Mt.CONTENT_TYPE]||void 0,contentLengthHeader:u[Mt.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},i)),c.error}throw c instanceof Me?c:O(aT)}return nr.postProcess(this.cacheManager,e,o),o}async updateAuthority(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(T.UpdateTokenEndpointAuthority,t);const r=`https://${e}/${this.authority.tenant}/`,i=await GT(r,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=i}createTokenQueryParameters(e){const t=new ca(e.correlationId,this.performanceClient);return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.addCorrelationId(e.correlationId),t.createQueryString()}}/*! @azure/msal-common v14.16.0 2024-11-05 */const $c="no_tokens_found",qT="native_account_unavailable",wm="refresh_token_expired",E1="interaction_required",k1="consent_required",I1="login_required",zu="bad_token";/*! @azure/msal-common v14.16.0 2024-11-05 */const Jy=[E1,k1,I1,zu],A1=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],b1={[$c]:"No refresh token found in the cache. Please sign-in.",[qT]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[wm]:"Refresh token has expired.",[zu]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."};class Kn extends Me{constructor(e,t,r,i,o,s,a,l){super(e,t,r),Object.setPrototypeOf(this,Kn.prototype),this.timestamp=i||A.EMPTY_STRING,this.traceId=o||A.EMPTY_STRING,this.correlationId=s||A.EMPTY_STRING,this.claims=a||A.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=l}}function Xy(n,e,t){const r=!!n&&Jy.indexOf(n)>-1,i=!!t&&A1.indexOf(t)>-1,o=!!e&&Jy.some(s=>e.indexOf(s)>-1);return r||o||i}function Sf(n){return new Kn(n,b1[n])}/*! @azure/msal-common v14.16.0 2024-11-05 */class zn{static setRequestState(e,t,r){const i=zn.generateLibraryState(e,r);return t?`${i}${A.RESOURCE_DELIM}${t}`:i}static generateLibraryState(e,t){if(!e)throw O(mf);const r={id:e.createNewGuid()};t&&(r.meta=t);const i=JSON.stringify(r);return e.base64Encode(i)}static parseRequestState(e,t){if(!e)throw O(mf);if(!t)throw O(us);try{const r=t.split(A.RESOURCE_DELIM),i=r[0],o=r.length>1?r.slice(1).join(A.RESOURCE_DELIM):A.EMPTY_STRING,s=e.base64Decode(i),a=JSON.parse(s);return{userRequestState:o||A.EMPTY_STRING,libraryState:a}}catch{throw O(us)}}}/*! @azure/msal-common v14.16.0 2024-11-05 */const R1={SW:"sw",UHW:"uhw"};class hs{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(T.PopTokenGenerateCnf,e.correlationId);const r=await P(this.generateKid.bind(this),T.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),i=this.cryptoUtils.base64UrlEncode(JSON.stringify(r));return{kid:r.kid,reqCnfString:i}}async generateKid(e){var r;return(r=this.performanceClient)==null||r.addQueueMeasurement(T.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:R1.SW}}async signPopToken(e,t,r){return this.signPayload(e,t,r)}async signPayload(e,t,r,i){const{resourceRequestMethod:o,resourceRequestUri:s,shrClaims:a,shrNonce:l,shrOptions:c}=r,u=s?new ae(s):void 0,d=u==null?void 0:u.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:cr(),m:o==null?void 0:o.toUpperCase(),u:d==null?void 0:d.HostNameAndPort,nonce:l||this.cryptoUtils.createNewGuid(),p:d==null?void 0:d.AbsolutePath,q:d!=null&&d.QueryString?[[],d.QueryString]:void 0,client_claims:a||void 0,...i},t,c,r.correlationId)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class N1{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v14.16.0 2024-11-05 */function x1(n){var r,i;const e="code=",t=(r=n.error_uri)==null?void 0:r.lastIndexOf(e);return t&&t>=0?(i=n.error_uri)==null?void 0:i.substring(t+e.length):void 0}class to{constructor(e,t,r,i,o,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=r,this.logger=i,this.serializableCache=o,this.persistencePlugin=s,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?O(Hc,"Cached State"):O(Hc,"Server State");let r,i;try{r=decodeURIComponent(e.state)}catch{throw O(us,e.state)}try{i=decodeURIComponent(t)}catch{throw O(us,e.state)}if(r!==i)throw O(uT);if(e.error||e.error_description||e.suberror){const o=x1(e);throw Xy(e.error,e.error_description,e.suberror)?new Kn(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",o):new Ti(e.error||"",e.error_description,e.suberror,o)}}validateTokenResponse(e,t){var r;if(e.error||e.error_description||e.suberror){const i=`Error(s): ${e.error_codes||A.NOT_AVAILABLE} - Timestamp: ${e.timestamp||A.NOT_AVAILABLE} - Description: ${e.error_description||A.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||A.NOT_AVAILABLE} - Trace ID: ${e.trace_id||A.NOT_AVAILABLE}`,o=(r=e.error_codes)!=null&&r.length?e.error_codes[0]:void 0,s=new Ti(e.error,i,e.suberror,o,e.status);if(t&&e.status&&e.status>=Ol.SERVER_ERROR_RANGE_START&&e.status<=Ol.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${s}`);return}else if(t&&e.status&&e.status>=Ol.CLIENT_ERROR_RANGE_START&&e.status<=Ol.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${s}`);return}throw Xy(e.error,e.error_description,e.suberror)?new Kn(e.error,e.error_description,e.suberror,e.timestamp||A.EMPTY_STRING,e.trace_id||A.EMPTY_STRING,e.correlation_id||A.EMPTY_STRING,e.claims||A.EMPTY_STRING,o):s}}async handleServerTokenResponse(e,t,r,i,o,s,a,l,c){var p;(p=this.performanceClient)==null||p.addQueueMeasurement(T.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=ho(e.id_token||A.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&u.nonce!==o.nonce)throw O(dT);if(i.maxAge||i.maxAge===0){const m=u.auth_time;if(!m)throw O(im);ET(m,i.maxAge)}}this.homeAccountIdentifier=Ze.generateHomeAccountId(e.client_info||A.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u);let d;o&&o.state&&(d=zn.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||i.sshKid||void 0;const h=this.generateCacheRecord(e,t,r,i,u,s,o);let f;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),f=new N1(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(f)),a&&!l&&h.account){const m=h.account.generateAccountKey();if(!this.cacheStorage.getAccount(m,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await to.generateAuthenticationResult(this.cryptoObj,t,h,!1,i,u,d,void 0,c)}await this.cacheStorage.saveCacheRecord(h,i.storeInCache,i.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&f&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(f))}return to.generateAuthenticationResult(this.cryptoObj,t,h,!1,i,u,d,e,c)}generateCacheRecord(e,t,r,i,o,s,a){const l=t.getPreferredCache();if(!l)throw O(sm);const c=FT(o);let u,d;e.id_token&&o&&(u=Lu(this.homeAccountIdentifier,l,e.id_token,this.clientId,c||""),d=Tm(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,l,c,a,void 0,this.logger));let h=null;if(e.access_token){const m=e.scope?je.fromString(e.scope):new je(i.scopes||[]),v=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,g=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,y=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,C=r+v,w=C+g,E=y&&y>0?r+y:void 0;h=Uu(this.homeAccountIdentifier,l,e.access_token,this.clientId,c||t.tenant||"",m.printScopes(),C,w,this.cryptoObj.base64Decode,E,e.token_type,s,e.key_id,i.claims,i.requestedClaimsHash)}let f=null;if(e.refresh_token){let m;if(e.refresh_token_expires_in){const v=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;m=r+v}f=kT(this.homeAccountIdentifier,l,e.refresh_token,this.clientId,e.foci,s,m)}let p=null;return e.foci&&(p={clientId:this.clientId,environment:l,familyId:e.foci}),{account:d,idToken:u,accessToken:h,refreshToken:f,appMetadata:p}}static async generateAuthenticationResult(e,t,r,i,o,s,a,l,c){var C,w,E,I,b;let u=A.EMPTY_STRING,d=[],h=null,f,p,m=A.EMPTY_STRING;if(r.accessToken){if(r.accessToken.tokenType===ge.POP&&!o.popKid){const R=new hs(e),{secret:N,keyId:_}=r.accessToken;if(!_)throw O(am);u=await R.signPopToken(N,_,o)}else u=r.accessToken.secret;d=je.fromString(r.accessToken.target).asArray(),h=new Date(Number(r.accessToken.expiresOn)*1e3),f=new Date(Number(r.accessToken.extendedExpiresOn)*1e3),r.accessToken.refreshOn&&(p=new Date(Number(r.accessToken.refreshOn)*1e3))}r.appMetadata&&(m=r.appMetadata.familyId===aa?aa:"");const v=(s==null?void 0:s.oid)||(s==null?void 0:s.sub)||"",g=(s==null?void 0:s.tid)||"";l!=null&&l.spa_accountid&&r.account&&(r.account.nativeAccountId=l==null?void 0:l.spa_accountid);const y=r.account?gm(r.account.getAccountInfo(),void 0,s,(C=r.idToken)==null?void 0:C.secret):null;return{authority:t.canonicalAuthority,uniqueId:v,tenantId:g,scopes:d,account:y,idToken:((w=r==null?void 0:r.idToken)==null?void 0:w.secret)||"",idTokenClaims:s||{},accessToken:u,fromCache:i,expiresOn:h,extExpiresOn:f,refreshOn:p,correlationId:o.correlationId,requestId:c||A.EMPTY_STRING,familyId:m,tokenType:((E=r.accessToken)==null?void 0:E.tokenType)||A.EMPTY_STRING,state:a?a.userRequestState:A.EMPTY_STRING,cloudGraphHostName:((I=r.account)==null?void 0:I.cloudGraphHostName)||A.EMPTY_STRING,msGraphHost:((b=r.account)==null?void 0:b.msGraphHost)||A.EMPTY_STRING,code:l==null?void 0:l.spa_code,fromNativeBroker:!1}}}function Tm(n,e,t,r,i,o,s,a,l,c,u){u==null||u.verbose("setCachedAccount called");const h=n.getAccountKeys().find(g=>g.startsWith(t));let f=null;h&&(f=n.getAccount(h,u));const p=f||Ze.createAccount({homeAccountId:t,idTokenClaims:i,clientInfo:o,environment:s,cloudGraphHostName:l==null?void 0:l.cloud_graph_host_name,msGraphHost:l==null?void 0:l.msgraph_host,nativeAccountId:c},e,r),m=p.tenantProfiles||[],v=a||p.realm;if(v&&!m.find(g=>g.tenantId===v)){const g=mm(t,p.localAccountId,v,i);m.push(g)}return p.tenantProfiles=m,p}/*! @azure/msal-common v14.16.0 2024-11-05 */async function QT(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v14.16.0 2024-11-05 */class YT extends Sm{constructor(e,t){var r;super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=(r=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:r.defaultScopes}async getAuthCodeUrl(e){var r;(r=this.performanceClient)==null||r.addQueueMeasurement(T.GetAuthCodeUrl,e.correlationId);const t=await P(this.createAuthCodeUrlQueryString.bind(this),T.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return ae.appendQueryString(this.authority.authorizationEndpoint,t)}async acquireToken(e,t){var a,l;if((a=this.performanceClient)==null||a.addQueueMeasurement(T.AuthClientAcquireToken,e.correlationId),!e.code)throw O(pT);const r=cr(),i=await P(this.executeTokenRequest.bind(this),T.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=(l=i.headers)==null?void 0:l[Mt.X_MS_REQUEST_ID],s=new to(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(i.body),P(s.handleServerTokenResponse.bind(s),T.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,r,e,t,void 0,void 0,void 0,o)}handleFragmentResponse(e,t){if(new to(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw O(CT);return e}getLogoutUri(e){if(!e)throw Ce(OT);const t=this.createLogoutUrlQueryString(e);return ae.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){var c,u;(c=this.performanceClient)==null||c.addQueueMeasurement(T.AuthClientExecuteTokenRequest,t.correlationId);const r=this.createTokenQueryParameters(t),i=ae.appendQueryString(e.tokenEndpoint,r),o=await P(this.createTokenRequestBody.bind(this),T.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let s;if(t.clientInfo)try{const d=Bc(t.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${d.uid}${At.CLIENT_INFO_SEPARATOR}${d.utid}`,type:fn.HOME_ACCOUNT_ID}}catch(d){this.logger.verbose("Could not parse client info for CCS Header: "+d)}const a=this.createTokenRequestHeaders(s||t.ccsCredential),l={clientId:((u=t.tokenBodyParameters)==null?void 0:u.clientId)||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return P(this.executePostToTokenEndpoint.bind(this),T.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(i,o,a,l,t.correlationId,T.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var i,o;(i=this.performanceClient)==null||i.addQueueMeasurement(T.AuthClientCreateTokenRequestBody,e.correlationId);const t=new ca(e.correlationId,this.performanceClient);if(t.addClientId(e.embeddedClientId||((o=e.tokenBodyParameters)==null?void 0:o[eo])||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):To.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!vf(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const s=this.config.clientCredentials.clientAssertion;t.addClientAssertion(await QT(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(s.assertionType)}if(t.addGrantType(rT.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===ge.POP){const s=new hs(this.cryptoUtils,this.performanceClient);let a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(await P(s.generateCnf.bind(s),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}else if(e.authenticationScheme===ge.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw Ce(Hu);(!Bn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let r;if(e.clientInfo)try{const s=Bc(e.clientInfo,this.cryptoUtils.base64Decode);r={credential:`${s.uid}${At.CLIENT_INFO_SEPARATOR}${s.utid}`,type:fn.HOME_ACCOUNT_ID}}catch(s){this.logger.verbose("Could not parse client info for CCS Header: "+s)}else r=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&r)switch(r.type){case fn.HOME_ACCOUNT_ID:try{const s=Bo(r.credential);t.addCcsOid(s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case fn.UPN:t.addCcsUpn(r.credential);break}return e.embeddedClientId&&t.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Qy])&&t.addExtraQueryParameters({[Qy]:"1"}),t.createQueryString()}async createAuthCodeUrlQueryString(e){var o,s;const t=e.correlationId||this.config.cryptoInterface.createNewGuid();(o=this.performanceClient)==null||o.addQueueMeasurement(T.AuthClientCreateQueryString,t);const r=new ca(t,this.performanceClient);r.addClientId(e.embeddedClientId||((s=e.extraQueryParameters)==null?void 0:s[eo])||this.config.authOptions.clientId);const i=[...e.scopes||[],...e.extraScopesToConsent||[]];if(r.addScopes(i,!0,this.oidcDefaultScopes),r.addRedirectUri(e.redirectUri),r.addCorrelationId(t),r.addResponseMode(e.responseMode),r.addResponseTypeCode(),r.addLibraryInfo(this.config.libraryInfo),vf(this.config)||r.addApplicationTelemetry(this.config.telemetry.application),r.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&r.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&r.addPrompt(e.prompt),e.domainHint&&r.addDomainHint(e.domainHint),e.prompt!==it.SELECT_ACCOUNT)if(e.sid&&e.prompt===it.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),r.addSid(e.sid);else if(e.account){const a=this.extractAccountSid(e.account);let l=this.extractLoginHint(e.account);if(l&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),l=null),l){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),r.addLoginHint(l);try{const c=Bo(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(a&&e.prompt===it.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),r.addSid(a);try{const c=Bo(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),r.addLoginHint(e.account.username);try{const c=Bo(e.account.homeAccountId);r.addCcsOid(c)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),r.addLoginHint(e.loginHint),r.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&r.addNonce(e.nonce),e.state&&r.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),this.addExtraQueryParams(e,r),e.nativeBroker&&(r.addNativeBroker(),e.authenticationScheme===ge.POP)){const a=new hs(this.cryptoUtils);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await P(a.generateCnf.bind(a),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}return r.createQueryString()}createLogoutUrlQueryString(e){const t=new ca(e.correlationId,this.performanceClient);return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),this.addExtraQueryParams(e,t),t.createQueryString()}addExtraQueryParams(e,t){!(e.extraQueryParameters&&e.extraQueryParameters.hasOwnProperty("instance_aware"))&&this.config.authOptions.instanceAware&&(e.extraQueryParameters=e.extraQueryParameters||{},e.extraQueryParameters.instance_aware="true"),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters)}extractAccountSid(e){var t;return((t=e.idTokenClaims)==null?void 0:t.sid)||null}extractLoginHint(e){var t;return((t=e.idTokenClaims)==null?void 0:t.login_hint)||null}}/*! @azure/msal-common v14.16.0 2024-11-05 */const O1=300;class wf extends Sm{constructor(e,t){super(e,t)}async acquireToken(e){var s,a;(s=this.performanceClient)==null||s.addQueueMeasurement(T.RefreshTokenClientAcquireToken,e.correlationId);const t=cr(),r=await P(this.executeTokenRequest.bind(this),T.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=(a=r.headers)==null?void 0:a[Mt.X_MS_REQUEST_ID],o=new to(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(r.body),P(o.handleServerTokenResponse.bind(o),T.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(r.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,i)}async acquireTokenByRefreshToken(e){var r;if(!e)throw Ce(xT);if((r=this.performanceClient)==null||r.addQueueMeasurement(T.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw O(om);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await P(this.acquireTokenWithCachedRefreshToken.bind(this),T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(i){const o=i instanceof Kn&&i.errorCode===$c,s=i instanceof Ti&&i.errorCode===Dy.INVALID_GRANT_ERROR&&i.subError===Dy.CLIENT_MISMATCH_ERROR;if(o||s)return P(this.acquireTokenWithCachedRefreshToken.bind(this),T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw i}return P(this.acquireTokenWithCachedRefreshToken.bind(this),T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){var o;(o=this.performanceClient)==null||o.addQueueMeasurement(T.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const r=fo(this.cacheManager.getRefreshToken.bind(this.cacheManager),T.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!r)throw Sf($c);if(r.expiresOn&&yf(r.expiresOn,e.refreshTokenExpirationOffsetSeconds||O1))throw Sf(wm);const i={...e,refreshToken:r.secret,authenticationScheme:e.authenticationScheme||ge.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:fn.HOME_ACCOUNT_ID}};try{return await P(this.acquireToken.bind(this),T.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(i)}catch(s){if(s instanceof Kn&&s.subError===zu){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const a=Fo(r);this.cacheManager.removeRefreshToken(a)}throw s}}async executeTokenRequest(e,t){var l,c;(l=this.performanceClient)==null||l.addQueueMeasurement(T.RefreshTokenClientExecuteTokenRequest,e.correlationId);const r=this.createTokenQueryParameters(e),i=ae.appendQueryString(t.tokenEndpoint,r),o=await P(this.createTokenRequestBody.bind(this),T.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:((c=e.tokenBodyParameters)==null?void 0:c.clientId)||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return P(this.executePostToTokenEndpoint.bind(this),T.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(i,o,s,a,e.correlationId,T.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){var i,o,s;(i=this.performanceClient)==null||i.addQueueMeasurement(T.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=e.correlationId,r=new ca(t,this.performanceClient);if(r.addClientId(e.embeddedClientId||((o=e.tokenBodyParameters)==null?void 0:o[eo])||this.config.authOptions.clientId),e.redirectUri&&r.addRedirectUri(e.redirectUri),r.addScopes(e.scopes,!0,(s=this.config.authOptions.authority.options.OIDCOptions)==null?void 0:s.defaultScopes),r.addGrantType(rT.REFRESH_TOKEN_GRANT),r.addClientInfo(),r.addLibraryInfo(this.config.libraryInfo),r.addApplicationTelemetry(this.config.telemetry.application),r.addThrottling(),this.serverTelemetryManager&&!vf(this.config)&&r.addServerTelemetry(this.serverTelemetryManager),r.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&r.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;r.addClientAssertion(await QT(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),r.addClientAssertionType(a.assertionType)}if(e.authenticationScheme===ge.POP){const a=new hs(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await P(a.generateCnf.bind(a),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,r.addPopToken(l)}else if(e.authenticationScheme===ge.SSH)if(e.sshJwk)r.addSshJwk(e.sshJwk);else throw Ce(Hu);if((!Bn.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&r.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case fn.HOME_ACCOUNT_ID:try{const a=Bo(e.ccsCredential.credential);r.addCcsOid(a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case fn.UPN:r.addCcsUpn(e.ccsCredential.credential);break}return e.embeddedClientId&&r.addBrokerParameters({brokerClientId:this.config.authOptions.clientId,brokerRedirectUri:this.config.authOptions.redirectUri}),e.tokenBodyParameters&&r.addExtraQueryParameters(e.tokenBodyParameters),r.createQueryString()}}/*! @azure/msal-common v14.16.0 2024-11-05 */class M1 extends Sm{constructor(e,t){super(e,t)}async acquireToken(e){var t;try{const[r,i]=await this.acquireCachedToken({...e,scopes:(t=e.scopes)!=null&&t.length?e.scopes:[...Is]});return i===jr.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new wf(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),r}catch(r){if(r instanceof Du&&r.errorCode===wr)return new wf(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw r}}async acquireCachedToken(e){var l;(l=this.performanceClient)==null||l.addQueueMeasurement(T.SilentFlowClientAcquireCachedToken,e.correlationId);let t=jr.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Bn.isEmptyObj(e.claims))throw this.setCacheOutcome(jr.FORCE_REFRESH_OR_CLAIMS,e.correlationId),O(wr);if(!e.account)throw O(om);const r=e.account.tenantId||w1(e.authority),i=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,i,r,this.performanceClient,e.correlationId);if(o){if(aR(o.cachedAt)||yf(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(jr.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),O(wr);o.refreshOn&&yf(o.refreshOn,0)&&(t=jr.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(jr.NO_CACHED_ACCESS_TOKEN,e.correlationId),O(wr);const s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,i,r,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await P(this.generateResultFromCacheRecord.bind(this),T.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]}setCacheOutcome(e,t){var r,i;(r=this.serverTelemetryManager)==null||r.setCacheOutcome(e),(i=this.performanceClient)==null||i.addFields({cacheOutcome:e},t),e!==jr.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){var i;(i=this.performanceClient)==null||i.addQueueMeasurement(T.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let r;if(e.idToken&&(r=ho(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const o=r==null?void 0:r.auth_time;if(!o)throw O(im);ET(o,t.maxAge)}return to.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,r)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const _1={sendGetRequestAsync:()=>Promise.reject(O(te)),sendPostRequestAsync:()=>Promise.reject(O(te))};/*! @azure/msal-common v14.16.0 2024-11-05 */const Zy=",",JT="|";function P1(n){const{skus:e,libraryName:t,libraryVersion:r,extensionName:i,extensionVersion:o}=n,s=new Map([[0,[t,r]],[2,[i,o]]]);let a=[];if(e!=null&&e.length){if(a=e.split(Zy),a.length<4)return e}else a=Array.from({length:4},()=>JT);return s.forEach((l,c)=>{var u,d;l.length===2&&((u=l[0])!=null&&u.length)&&((d=l[1])!=null&&d.length)&&D1({skuArr:a,index:c,skuName:l[0],skuVersion:l[1]})}),a.join(Zy)}function D1(n){const{skuArr:e,index:t,skuName:r,skuVersion:i}=n;t>=e.length||(e[t]=[r,i].join(JT))}class Ha{constructor(e,t){this.cacheOutcome=jr.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||A.EMPTY_STRING,this.wrapperVer=e.wrapperVer||A.EMPTY_STRING,this.telemetryCacheKey=dt.CACHE_KEY+At.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${dt.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],r=this.getNativeBrokerErrorCode();r!=null&&r.length&&t.push(`broker_error=${r}`);const i=t.join(dt.VALUE_SEPARATOR),o=this.getRegionDiscoveryFields(),s=[e,o].join(dt.VALUE_SEPARATOR);return[dt.SCHEMA_VERSION,s,i].join(dt.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Ha.maxErrorsToSend(e),r=e.failedRequests.slice(0,2*t).join(dt.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(dt.VALUE_SEPARATOR),o=e.errors.length,s=t<o?dt.OVERFLOW_TRUE:dt.OVERFLOW_FALSE,a=[o,s].join(dt.VALUE_SEPARATOR);return[dt.SCHEMA_VERSION,e.cacheHits,r,i,a].join(dt.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=dt.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Me?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(dt.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=Ha.maxErrorsToSend(e),r=e.errors.length;if(t===r)this.cacheManager.removeItem(this.telemetryCacheKey);else{const i={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)}}static maxErrorsToSend(e){let t,r=0,i=0;const o=e.errors.length;for(t=0;t<o;t++){const s=e.failedRequests[2*t]||A.EMPTY_STRING,a=e.failedRequests[2*t+1]||A.EMPTY_STRING,l=e.errors[t]||A.EMPTY_STRING;if(i+=s.toString().length+a.toString().length+l.length+3,i<dt.MAX_LAST_HEADER_BYTES)r+=1;else break}return r}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||A.EMPTY_STRING),e.push(this.regionSource||A.EMPTY_STRING),e.push(this.regionOutcome||A.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return P1(e)}}/*! @azure/msal-common v14.16.0 2024-11-05 */const XT="missing_kid_error",ZT="missing_alg_error";/*! @azure/msal-common v14.16.0 2024-11-05 */const L1={[XT]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[ZT]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Em extends Me{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Em.prototype)}}function ev(n){return new Em(n,L1[n])}/*! @azure/msal-common v14.16.0 2024-11-05 */class km{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw ev(XT);if(!e.alg)throw ev(ZT);const t=new km({typ:e.typ||Vb.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-common v14.16.0 2024-11-05 */class tv{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class U1{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:S1.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new tv}}startPerformanceMeasurement(){return new tv}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const Im="pkce_not_created",Tf="crypto_nonexistent",ju="empty_navigate_uri",eE="hash_empty_error",Am="no_state_in_hash",tE="hash_does_not_contain_known_properties",nE="unable_to_parse_state",rE="state_interaction_type_mismatch",iE="interaction_in_progress",oE="popup_window_error",sE="empty_window_error",no="user_cancelled",H1="monitor_popup_timeout",aE="monitor_window_timeout",lE="redirect_in_iframe",cE="block_iframe_reload",uE="block_nested_popups",F1="iframe_closed_prematurely",Ku="silent_logout_unsupported",dE="no_account_error",B1="silent_prompt_value_error",hE="no_token_request_cache_error",fE="unable_to_parse_token_request_cache_error",bm="no_cached_authority_error",z1="auth_request_not_set_error",j1="invalid_cache_type",$u="non_browser_environment",Eo="database_not_open",Vc="no_network_connectivity",pE="post_request_failed",mE="get_request_failed",Ef="failed_to_parse_response",gE="unable_to_load_token",Rm="crypto_key_not_found",yE="auth_code_required",vE="auth_code_or_nativeAccountId_required",CE="spa_code_and_nativeAccountId_present",Nm="database_unavailable",SE="unable_to_acquire_token_from_native_platform",wE="native_handshake_timeout",TE="native_extension_not_installed",ol="native_connection_not_established",EE="uninitialized_public_client_application",kE="native_prompt_not_supported",IE="invalid_base64_string",AE="invalid_pop_token_request",bE="failed_to_build_headers",RE="failed_to_parse_headers";/*! @azure/msal-browser v3.28.1 2025-01-14 */const fr="For more visit: aka.ms/msaljs/browser-errors",K1={[Im]:"The PKCE code challenge and verifier could not be generated.",[Tf]:"The crypto object or function is not available.",[ju]:"Navigation URI is empty. Please check stack trace for more info.",[eE]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${fr}`,[Am]:"Hash does not contain state. Please verify that the request originated from msal.",[tE]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${fr}`,[nE]:"Unable to parse state. Please verify that the request originated from msal.",[rE]:"Hash contains state but the interaction type does not match the caller.",[iE]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${fr}`,[oE]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[sE]:"window.open returned null or undefined window object.",[no]:"User cancelled the flow.",[H1]:`Token acquisition in popup failed due to timeout.  ${fr}`,[aE]:`Token acquisition in iframe failed due to timeout.  ${fr}`,[lE]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[cE]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${fr}`,[uE]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[F1]:"The iframe being monitored was closed prematurely.",[Ku]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[dE]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[B1]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[hE]:"No token request found in cache.",[fE]:"The cached token request could not be parsed.",[bm]:"No cached authority found.",[z1]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[j1]:"Invalid cache type",[$u]:"Login and token requests are not supported in non-browser environments.",[Eo]:"Database is not open!",[Vc]:"No network connectivity. Check your internet connection.",[pE]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[mE]:"Network request failed. Please check the network trace to determine root cause.",[Ef]:"Failed to parse network response. Check network trace.",[gE]:"Error loading token to cache.",[Rm]:"Cryptographic Key or Keypair not found in browser storage.",[yE]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[vE]:"An authorization code or nativeAccountId must be provided to this flow.",[CE]:"Request cannot contain both spa code and native account id.",[Nm]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[SE]:`Unable to acquire token from native platform.  ${fr}`,[wE]:"Timed out while attempting to establish connection to browser extension",[TE]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[ol]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${fr}`,[EE]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${fr}`,[kE]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[IE]:"Invalid base64 encoded string.",[AE]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[bE]:"Failed to build request headers object.",[RE]:"Failed to parse response headers"};class sl extends Me{constructor(e,t){super(e,K1[e],t),Object.setPrototypeOf(this,sl.prototype),this.name="BrowserAuthError"}}function F(n,e){return new sl(n,e)}/*! @azure/msal-browser v3.28.1 2025-01-14 */const cn={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},zo={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},Hi={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},Wt={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},nv={GET:"GET",POST:"POST"},fe={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context"},zr={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},Ll={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},be={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var $;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})($||($={}));const tt={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},rv={scopes:Is},NE="jwk",$1={React:"@azure/msal-react",Angular:"@azure/msal-angular"},kf="msal.db",V1=1,W1=`${kf}.keys`,on={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},G1=[on.Default,on.Skip,on.RefreshTokenAndNetwork],q1="msal.browser.log.level",Q1="msal.browser.log.pii";/*! @azure/msal-browser v3.28.1 2025-01-14 */function Ul(n){return encodeURIComponent(xm(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Vu(n){return xE(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function xm(n){return xE(new TextEncoder().encode(n))}function xE(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v3.28.1 2025-01-14 */const Y1="RSASSA-PKCS1-v1_5",OE="SHA-256",J1=2048,X1=new Uint8Array([1,0,1]),iv="0123456789abcdef",ov=new Uint32Array(1),Z1="crypto_subtle_undefined",Om={name:Y1,hash:OE,modulusLength:J1,publicExponent:X1};function eN(n){if(!window)throw F($u);if(!window.crypto)throw F(Tf);if(!n&&!window.crypto.subtle)throw F(Tf,Z1)}async function ME(n,e,t){e==null||e.addQueueMeasurement(T.Sha256Digest,t);const i=new TextEncoder().encode(n);return window.crypto.subtle.digest(OE,i)}function tN(n){return window.crypto.getRandomValues(n)}function Vd(){return window.crypto.getRandomValues(ov),ov[0]}function Mr(){const n=Date.now(),e=Vd()*1024+(Vd()&1023),t=new Uint8Array(16),r=Math.trunc(e/2**30),i=e&2**30-1,o=Vd();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|r>>>8,t[7]=r,t[8]=128|i>>>24,t[9]=i>>>16,t[10]=i>>>8,t[11]=i,t[12]=o>>>24,t[13]=o>>>16,t[14]=o>>>8,t[15]=o;let s="";for(let a=0;a<t.length;a++)s+=iv.charAt(t[a]>>>4),s+=iv.charAt(t[a]&15),(a===3||a===5||a===7||a===9)&&(s+="-");return s}async function nN(n,e){return window.crypto.subtle.generateKey(Om,n,e)}async function Wd(n){return window.crypto.subtle.exportKey(NE,n)}async function rN(n,e,t){return window.crypto.subtle.importKey(NE,n,Om,e,t)}async function iN(n,e){return window.crypto.subtle.sign(Om,n,e)}async function _E(n){const e=await ME(n),t=new Uint8Array(e);return Vu(t)}/*! @azure/msal-browser v3.28.1 2025-01-14 */const Fa="storage_not_supported",Ke="stubbed_public_client_application_called",Wc="in_mem_redirect_unavailable";/*! @azure/msal-browser v3.28.1 2025-01-14 */const ac={[Fa]:"Given storage configuration option was not supported.",[Ke]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Wc]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};ac[Fa],ac[Ke],ac[Wc];class Mm extends Me{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Mm.prototype)}}function $e(n){return new Mm(n,ac[n])}/*! @azure/msal-browser v3.28.1 2025-01-14 */function oN(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function sN(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function _m(){return window.parent!==window}function aN(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${cn.POPUP_NAME_PREFIX}.`)===0}function Tr(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function lN(){const e=new ae(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function cN(){if(ae.hashContainsKnownProperties(window.location.hash)&&_m())throw F(cE)}function uN(n){if(_m()&&!n)throw F(lE)}function dN(){if(aN())throw F(uE)}function PE(){if(typeof window>"u")throw F($u)}function DE(n){if(!n)throw F(EE)}function Pm(n){PE(),cN(),dN(),DE(n)}function sv(n,e){if(Pm(n),uN(e.system.allowRedirectInIframe),e.cache.cacheLocation===Wt.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw $e(Wc)}function LE(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function hN(){return Mr()}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Gc{navigateInternal(e,t){return Gc.defaultNavigateWindow(e,t)}navigateExternal(e,t){return Gc.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(r=>{setTimeout(()=>{r(!0)},t.timeout)})}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class fN{async sendGetRequestAsync(e,t){let r,i={},o=0;const s=av(t);try{r=await fetch(e,{method:nv.GET,headers:s})}catch{throw F(window.navigator.onLine?mE:Vc)}i=lv(r.headers);try{return o=r.status,{headers:i,body:await r.json(),status:o}}catch{throw Yy(F(Ef),o,i)}}async sendPostRequestAsync(e,t){const r=t&&t.body||"",i=av(t);let o,s=0,a={};try{o=await fetch(e,{method:nv.POST,headers:i,body:r})}catch{throw F(window.navigator.onLine?pE:Vc)}a=lv(o.headers);try{return s=o.status,{headers:a,body:await o.json(),status:s}}catch{throw Yy(F(Ef),s,a)}}}function av(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([r,i])=>{e.append(r,i)}),e}catch{throw F(bE)}}function lv(n){try{const e={};return n.forEach((t,r)=>{e[r]=t}),e}catch{throw F(RE)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const pN=6e4,If=1e4,mN=3e4,gN=2e3;function yN({auth:n,cache:e,system:t,telemetry:r},i){const o={clientId:A.EMPTY_STRING,authority:`${A.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:A.EMPTY_STRING,authorityMetadata:A.EMPTY_STRING,redirectUri:typeof window<"u"?Tr():"",postLogoutRedirectUri:A.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:Ir.AAD,OIDCOptions:{serverResponseType:il.FRAGMENT,defaultScopes:[A.OPENID_SCOPE,A.PROFILE_SCOPE,A.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:cm.None,tenant:A.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1},s={cacheLocation:Wt.SessionStorage,temporaryCacheLocation:Wt.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===Wt.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:xe.Info,piiLoggingEnabled:!1},c={...{...$T,loggerOptions:a,networkClient:i?new fN:_1,navigationClient:new Gc,loadFrameTimeout:0,windowHashTimeout:(t==null?void 0:t.loadFrameTimeout)||pN,iframeHashTimeout:(t==null?void 0:t.loadFrameTimeout)||If,navigateFrameWait:0,redirectNavigationTimeout:mN,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:(t==null?void 0:t.nativeBrokerHandshakeTimeout)||gN,pollIntervalMilliseconds:cn.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:(t==null?void 0:t.loggerOptions)||a},u={application:{appName:A.EMPTY_STRING,appVersion:A.EMPTY_STRING},client:new U1};if((n==null?void 0:n.protocolMode)!==Ir.OIDC&&(n!=null&&n.OIDCOptions)&&new Or(c.loggerOptions).warning(JSON.stringify(Ce(LT))),n!=null&&n.protocolMode&&n.protocolMode!==Ir.AAD&&(c!=null&&c.allowNativeBroker))throw Ce(UT);return{auth:{...o,...n,OIDCOptions:{...o.OIDCOptions,...n==null?void 0:n.OIDCOptions}},cache:{...s,...e},system:c,telemetry:{...u,...r}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const vN="@azure/msal-browser",Wu="3.28.1";/*! @azure/msal-browser v3.28.1 2025-01-14 */class Dm{static loggerCallback(e,t){switch(e){case xe.Error:console.error(t);return;case xe.Info:console.info(t);return;case xe.Verbose:console.debug(t);return;case xe.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){var l;this.browserEnvironment=typeof window<"u",this.config=yN(e,this.browserEnvironment);let t;try{t=window[Wt.SessionStorage]}catch{}const r=t==null?void 0:t.getItem(q1),i=(l=t==null?void 0:t.getItem(Q1))==null?void 0:l.toLowerCase(),o=i==="true"?!0:i==="false"?!1:void 0,s={...this.config.system.loggerOptions},a=r&&Object.keys(xe).includes(r)?xe[r]:void 0;a&&(s.loggerCallback=Dm.loggerCallback,s.logLevel=a),o!==void 0&&(s.piiLoggingEnabled=o),this.logger=new Or(s,vN,Wu),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ro extends Dm{getModuleName(){return ro.MODULE_NAME}getId(){return ro.ID}async initialize(){return this.available=typeof window<"u",this.available}}ro.MODULE_NAME="";ro.ID="StandardOperatingContext";/*! @azure/msal-browser v3.28.1 2025-01-14 */function lr(n){return new TextDecoder().decode(CN(n))}function CN(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw F(IE)}const t=atob(e);return Uint8Array.from(t,r=>r.codePointAt(0)||0)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class SN{constructor(){this.dbName=kf,this.version=V1,this.tableName=W1,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const r=window.indexedDB.open(this.dbName,this.version);r.addEventListener("upgradeneeded",i=>{i.target.result.createObjectStore(this.tableName)}),r.addEventListener("success",i=>{const o=i;this.db=o.target.result,this.dbOpen=!0,e()}),r.addEventListener("error",()=>t(F(Nm)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(F(Eo));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);s.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((r,i)=>{if(!this.db)return i(F(Eo));const a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",()=>{this.closeConnection(),r()}),a.addEventListener("error",l=>{this.closeConnection(),i(l)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(F(Eo));const s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);s.addEventListener("success",()=>{this.closeConnection(),t()}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(F(Eo));const o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();o.addEventListener("success",s=>{const a=s;this.closeConnection(),e(a.target.result)}),o.addEventListener("error",s=>{this.closeConnection(),t(s)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,r)=>{if(!this.db)return r(F(Eo));const s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);s.addEventListener("success",a=>{const l=a;this.closeConnection(),t(l.target.result===1)}),s.addEventListener("error",a=>{this.closeConnection(),r(a)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const r=window.indexedDB.deleteDatabase(kf),i=setTimeout(()=>t(!1),200);r.addEventListener("success",()=>(clearTimeout(i),e(!0))),r.addEventListener("blocked",()=>(clearTimeout(i),e(!0))),r.addEventListener("error",()=>(clearTimeout(i),t(!1)))})}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Af{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,r)=>{e.push(r)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class wN{constructor(e){this.inMemoryCache=new Af,this.indexedDBCache=new SN,this.logger=e}handleDatabaseAccessError(e){if(e instanceof sl&&e.errorCode===Nm)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(r){this.handleDatabaseAccessError(r)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(r){this.handleDatabaseAccessError(r)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(r){this.handleDatabaseAccessError(r)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class fs{constructor(e,t,r){this.logger=e,eN(r??!1),this.cache=new wN(this.logger),this.performanceClient=t}createNewGuid(){return Mr()}base64Encode(e){return xm(e)}base64Decode(e){return lr(e)}base64UrlEncode(e){return Ul(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){var u;const t=(u=this.performanceClient)==null?void 0:u.startMeasurement(T.CryptoOptsGetPublicKeyThumbprint,e.correlationId),r=await nN(fs.EXTRACTABLE,fs.POP_KEY_USAGES),i=await Wd(r.publicKey),o={e:i.e,kty:i.kty,n:i.n},s=cv(o),a=await this.hashString(s),l=await Wd(r.privateKey),c=await rN(l,!1,["sign"]);return await this.cache.setItem(a,{privateKey:c,publicKey:r.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),a}async removeTokenBindingKey(e){return await this.cache.removeItem(e),!await this.cache.containsKey(e)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,r,i){var C;const o=(C=this.performanceClient)==null?void 0:C.startMeasurement(T.CryptoOptsSignJwt,i),s=await this.cache.getItem(t);if(!s)throw F(Rm);const a=await Wd(s.publicKey),l=cv(a),c=Ul(JSON.stringify({kid:t})),u=km.getShrHeaderString({...r==null?void 0:r.header,alg:a.alg,kid:c}),d=Ul(u);e.cnf={jwk:JSON.parse(l)};const h=Ul(JSON.stringify(e)),f=`${d}.${h}`,m=new TextEncoder().encode(f),v=await iN(s.privateKey,m),g=Vu(new Uint8Array(v)),y=`${f}.${g}`;return o&&o.end({success:!0}),y}async hashString(e){return _E(e)}}fs.POP_KEY_USAGES=["sign","verify"];fs.EXTRACTABLE=!0;function cv(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v3.28.1 2025-01-14 */class TN{constructor(){if(!window.localStorage)throw $e(Fa)}getItem(e){return window.localStorage.getItem(e)}setItem(e,t){window.localStorage.setItem(e,t)}removeItem(e){window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class EN{constructor(){if(!window.sessionStorage)throw $e(Fa)}getItem(e){return window.sessionStorage.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */function UE(n,e){if(!e)return null;try{return zn.parseRequestState(n,e).libraryState.meta}catch{throw O(us)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const kN=24*60*60*1e3;class IN{getItem(e){const t=`${encodeURIComponent(e)}`,r=document.cookie.split(";");for(let i=0;i<r.length;i++){const o=r[i],[s,...a]=decodeURIComponent(o).trim().split("="),l=a.join("=");if(s===t)return l}return""}setItem(e,t,r,i=!0){let o=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(r){const s=AN(r);o+=`expires=${s};`}i&&(o+="Secure;"),document.cookie=o}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(r=>{const i=decodeURIComponent(r).trim().split("=");t.push(i[0])}),t}containsKey(e){return this.getKeys().includes(e)}}function AN(n){const e=new Date;return new Date(e.getTime()+n*kN).toUTCString()}/*! @azure/msal-browser v3.28.1 2025-01-14 */class bf extends ds{constructor(e,t,r,i,o,s){super(e,r,i,o),this.cacheConfig=t,this.logger=i,this.internalStorage=new Af,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupBrowserStorage(this.cacheConfig.temporaryCacheLocation),this.cookieStorage=new IN,t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=s}setupBrowserStorage(e){try{switch(e){case Wt.LocalStorage:return new TN;case Wt.SessionStorage:return new EN;case Wt.MemoryStorage:default:break}}catch(t){this.logger.error(t)}return this.cacheConfig.cacheLocation=Wt.MemoryStorage,new Af}migrateCacheEntries(){const e=`${A.CACHE_PREFIX}.${et.ID_TOKEN}`,t=`${A.CACHE_PREFIX}.${et.CLIENT_INFO}`,r=`${A.CACHE_PREFIX}.${et.ERROR}`,i=`${A.CACHE_PREFIX}.${et.ERROR_DESC}`,o=this.browserStorage.getItem(e),s=this.browserStorage.getItem(t),a=this.browserStorage.getItem(r),l=this.browserStorage.getItem(i),c=[o,s,a,l];[et.ID_TOKEN,et.CLIENT_INFO,et.ERROR,et.ERROR_DESC].forEach((d,h)=>{const f=c[h];f&&this.setTemporaryCache(d,f,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");const e=this.getItem(zr.ACCOUNT_KEYS),t=this.getItem(`${zr.TOKEN_KEYS}.${this.clientId}`);if(e&&t){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(i=>{if(this.isCredentialKey(i)){const o=this.getItem(i);if(o){const s=this.validateAndParseJson(o);if(s&&s.hasOwnProperty("credentialType"))switch(s.credentialType){case Q.ID_TOKEN:if(By(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${i} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(i,a);this.addTokenKey(l,Q.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${i}`);break;case Q.ACCESS_TOKEN:case Q.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Fy(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${i} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(i,a);this.addTokenKey(l,Q.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${i}`);break;case Q.REFRESH_TOKEN:if(zy(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${i} found, saving key to token key map`);const a=s,l=this.updateCredentialCacheKey(i,a);this.addTokenKey(l,Q.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${i}`);break}}}if(this.isAccountKey(i)){const o=this.getItem(i);if(o){const s=this.validateAndParseJson(o);s&&Ze.isAccountEntity(s)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${i} found, saving key to account key map`),this.addAccountKeyToMap(i))}}})}validateAndParseJson(e){try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const r=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,r,t)}getCachedAccountEntity(e){const t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;const r=this.validateAndParseJson(t);return!r||!Ze.isAccountEntity(r)?(this.removeAccountKeyFromMap(e),null):ds.toObject(new Ze,r)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");const t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");const e=this.getItem(zr.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const t=this.getAccountKeys();t.indexOf(e)===-1?(t.push(e),this.setItem(zr.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const t=this.getAccountKeys(),r=t.indexOf(e);r>-1?(t.splice(r,1),this.setItem(zr.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}async removeAccount(e){super.removeAccount(e),this.removeAccountKeyFromMap(e)}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,Q.ID_TOKEN)}async removeAccessToken(e){super.removeAccessToken(e),this.removeTokenKey(e,Q.ACCESS_TOKEN)}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,Q.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");const e=this.getItem(`${zr.TOKEN_KEYS}.${this.clientId}`);if(e){const t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");const r=this.getTokenKeys();switch(t){case Q.ID_TOKEN:r.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),r.idToken.push(e));break;case Q.ACCESS_TOKEN:r.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),r.accessToken.push(e));break;case Q.REFRESH_TOKEN:r.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),r.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),O(gf)}this.setItem(`${zr.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");const r=this.getTokenKeys();switch(t){case Q.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);const i=r.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),r.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case Q.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);const o=r.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),r.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case Q.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);const s=r.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),r.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),O(gf)}this.setItem(`${zr.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(r))}getIdTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ID_TOKEN),null;const r=this.validateAndParseJson(t);return!r||!By(r)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),r)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const t=Fo(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Q.ID_TOKEN)}getAccessTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ACCESS_TOKEN),null;const r=this.validateAndParseJson(t);return!r||!Fy(r)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),r)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const t=Fo(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Q.ACCESS_TOKEN)}getRefreshTokenCredential(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.REFRESH_TOKEN),null;const r=this.validateAndParseJson(t);return!r||!zy(r)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,Q.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),r)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const t=Fo(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,Q.REFRESH_TOKEN)}getAppMetadata(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!gR(e,r)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),r)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");const t=mR(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!fR(e,r)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),r)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const r=this.validateAndParseJson(t);return r&&yR(e,r)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),r):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(Ll.WRAPPER_SKU,e),this.internalStorage.setItem(Ll.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(Ll.WRAPPER_SKU)||A.EMPTY_STRING,t=this.internalStorage.getItem(Ll.WRAPPER_VER)||A.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){const e=this.generateCacheKey(et.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");const i=this.generateCacheKey(et.ACTIVE_ACCOUNT),o=this.getItem(i);if(!o)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;const s=this.getAccountInfoFilteredBy({localAccountId:o});return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}const r=this.validateAndParseJson(t);return r?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:r.homeAccountId,localAccountId:r.localAccountId,tenantId:r.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){const t=this.generateCacheKey(et.ACTIVE_ACCOUNT_FILTERS),r=this.generateCacheKey(et.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");const i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(i)),this.browserStorage.setItem(r,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(r)}getThrottlingCache(e){const t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const r=this.validateAndParseJson(t);return!r||!pR(e,r)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),r)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){const r=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const o=this.cookieStorage.getItem(r);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),o}const i=this.temporaryCacheStorage.getItem(r);if(!i){if(this.cacheConfig.cacheLocation===Wt.LocalStorage){const o=this.browserStorage.getItem(r);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),o}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i}setTemporaryCache(e,t,r){const i=r?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(i,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(i,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}async clear(){await this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(A.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(A.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()}async clearTokensAndKeysWithClaims(e,t){e.addQueueMeasurement(T.ClearTokensAndKeysWithClaims,t);const r=this.getTokenKeys(),i=[];r.accessToken.forEach(o=>{const s=this.getAccessTokenCredential(o);s!=null&&s.requestedClaimsHash&&o.includes(s.requestedClaimsHash.toLowerCase())&&i.push(this.removeAccessToken(o))}),await Promise.all(i),i.length>0&&this.logger.warning(`${i.length} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):Bn.startsWith(e,A.CACHE_PREFIX)||Bn.startsWith(e,et.ADAL_ID_TOKEN)?e:`${A.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){const{libraryState:{id:t}}=zn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${fe.AUTHORITY}.${t}`)}generateNonceKey(e){const{libraryState:{id:t}}=zn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${fe.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){const{libraryState:{id:t}}=zn.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${fe.REQUEST_STATE}.${t}`)}getCachedAuthority(e){const t=this.generateStateKey(e),r=this.getTemporaryCache(t);if(!r)return null;const i=this.generateAuthorityKey(r);return this.getTemporaryCache(i)}updateCacheEntries(e,t,r,i,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");const s=this.generateStateKey(e);this.setTemporaryCache(s,e,!1);const a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);const l=this.generateAuthorityKey(e);if(this.setTemporaryCache(l,r,!1),o){const c={credential:o.homeAccountId,type:fn.HOME_ACCOUNT_ID};this.setTemporaryCache(fe.CCS_CREDENTIAL,JSON.stringify(c),!0)}else if(i){const c={credential:i,type:fn.UPN};this.setTemporaryCache(fe.CCS_CREDENTIAL,JSON.stringify(c),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(fe.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(fe.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(fe.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(fe.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(fe.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(fe.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){const t=this.generateStateKey(e),r=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r||A.EMPTY_STRING)}}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(fe.REQUEST_STATE)===-1)return;const r=this.temporaryCacheStorage.getItem(t);if(!r)return;const i=UE(this.cryptoImpl,r);i&&i.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${r}`),this.resetRequestCache(r))}),this.setInteractionInProgress(!1)}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");const t=xm(JSON.stringify(e));this.setTemporaryCache(fe.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");const t=this.getTemporaryCache(fe.REQUEST_PARAMS,!0);if(!t)throw F(hE);let r;try{r=JSON.parse(lr(t))}catch(i){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${i}`),F(fE)}if(this.removeTemporaryItem(this.generateCacheKey(fe.REQUEST_PARAMS)),!r.authority){const i=this.generateAuthorityKey(e),o=this.getTemporaryCache(i);if(!o)throw F(bm);r.authority=o}return r}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(fe.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${A.CACHE_PREFIX}.${fe.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){const t=`${A.CACHE_PREFIX}.${fe.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw F(iE);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){const e=this.getTemporaryCache(et.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(et.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));const t=this.getTemporaryCache(et.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(et.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));const r=t||e;if(r){const i=ho(r,lr);if(i.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.preferred_username;if(i.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){const r=Fo(t);if(e!==r){const i=this.getItem(e);if(i)return this.browserStorage.removeItem(e),this.setItem(r,i),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),r;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}async hydrateCache(e,t){var a,l,c;const r=Lu((a=e.account)==null?void 0:a.homeAccountId,(l=e.account)==null?void 0:l.environment,e.idToken,this.clientId,e.tenantId);let i;t.claims&&(i=await this.cryptoImpl.hashString(t.claims));const o=Uu((c=e.account)==null?void 0:c.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,lr,void 0,e.tokenType,void 0,t.sshKid,t.claims,i),s={idToken:r,accessToken:o};return this.saveCacheRecord(s)}async saveCacheRecord(e,t,r){try{await super.saveCacheRecord(e,t,r)}catch(i){if(i instanceof Yo&&this.performanceClient&&r)try{const o=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:o.refreshToken.length,cacheIdCount:o.idToken.length,cacheAtCount:o.accessToken.length},r)}catch{}throw i}}}const bN=(n,e)=>{const t={cacheLocation:Wt.MemoryStorage,temporaryCacheLocation:Wt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new bf(n,t,Fc,e)};/*! @azure/msal-browser v3.28.1 2025-01-14 */function RN(n,e,t,r){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(r):[]}function NN(n,e,t){if(e.trace("getAccount called"),Object.keys(n).length===0)return e.warning("getAccount: No accountFilter provided"),null;const r=t.getAccountInfoFilteredBy(n);return r?(e.verbose("getAccount: Account matching provided filter found, returning"),r):(e.verbose("getAccount: No matching account found, returning null"),null)}function xN(n,e,t){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const r=t.getAccountInfoFilteredBy({username:n});return r?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),r):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function ON(n,e,t){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const r=t.getAccountInfoFilteredBy({homeAccountId:n});return r?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),r):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function MN(n,e,t){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const r=t.getAccountInfoFilteredBy({localAccountId:n});return r?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),r):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function _N(n,e){e.setActiveAccount(n)}function PN(n){return n.getActiveAccount()}/*! @azure/msal-browser v3.28.1 2025-01-14 */const z={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};/*! @azure/msal-browser v3.28.1 2025-01-14 */class DN{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Or({})}addEventCallback(e,t,r){if(typeof window<"u"){const i=r||hN();return this.eventCallbacks.has(i)?(this.logger.error(`Event callback with id: ${i} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(i,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${i}`),i)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,r,i){if(typeof window<"u"){const o={eventType:e,interactionType:t||null,payload:r||null,error:i||null,timestamp:Date.now()};this.eventCallbacks.forEach(([s,a],l)=>{(a.length===0||a.includes(e))&&(this.logger.verbose(`Emitting event to callback ${l}: ${e}`),s.apply(null,[o]))})}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class HE{constructor(e,t,r,i,o,s,a,l,c){this.config=e,this.browserStorage=t,this.browserCrypto=r,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=s,this.nativeMessageHandler=l,this.correlationId=c||Mr(),this.logger=i.clone(cn.MSAL_SKU,Wu,this.correlationId),this.performanceClient=a}async clearCacheOnLogout(e){if(e){Ze.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{await this.browserStorage.removeAccount(Ze.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),await this.browserStorage.clear(),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return ae.getAbsoluteUrl(t,Tr())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const r={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Ha(r,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,r=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(T.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const i={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e.requestAuthority||this.config.auth.authority,s=r!=null&&r.length?r==="true":this.config.auth.instanceAware,a=t&&s?this.config.auth.authority.replace(ae.getDomainFromUrl(o),t.environment):o,l=kt.generateAuthority(a,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),c=await P(GT,T.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(l,this.config.system.networkClient,this.browserStorage,i,this.logger,this.correlationId,this.performanceClient);if(t&&!c.isAlias(t.environment))throw Ce(HT);return c}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const LN=32;async function UN(n,e,t){n.addQueueMeasurement(T.GeneratePkceCodes,t);const r=fo(HN,T.GenerateCodeVerifier,e,n,t)(n,e,t),i=await P(FN,T.GenerateCodeChallengeFromVerifier,e,n,t)(r,n,e,t);return{verifier:r,challenge:i}}function HN(n,e,t){try{const r=new Uint8Array(LN);return fo(tN,T.GetRandomValues,e,n,t)(r),Vu(r)}catch{throw F(Im)}}async function FN(n,e,t,r){e.addQueueMeasurement(T.GenerateCodeChallengeFromVerifier,r);try{const i=await P(ME,T.Sha256Digest,t,e,r)(n,e,r);return Vu(new Uint8Array(i))}catch{throw F(Im)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */async function Lm(n,e,t,r){t.addQueueMeasurement(T.InitializeBaseRequest,n.correlationId);const i=n.authority||e.auth.authority,o=[...n&&n.scopes||[]],s={...n,correlationId:n.correlationId,authority:i,scopes:o};if(!s.authenticationScheme)s.authenticationScheme=ge.BEARER,r.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(s.authenticationScheme===ge.SSH){if(!n.sshJwk)throw Ce(Hu);if(!n.sshKid)throw Ce(DT)}r.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!Bn.isEmptyObj(n.claims)&&(s.requestedClaimsHash=await _E(n.claims)),s}async function BN(n,e,t,r,i){r.addQueueMeasurement(T.InitializeSilentRequest,n.correlationId);const o=await P(Lm,T.InitializeBaseRequest,i,r,n.correlationId)(n,t,r,i);return{...n,...o,account:e,forceRefresh:n.forceRefresh||!1}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class As extends HE{async initializeAuthorizationCodeRequest(e){this.performanceClient.addQueueMeasurement(T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);const t=await P(UN,T.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),r={...e,redirectUri:e.redirectUri,code:A.EMPTY_STRING,codeVerifier:t.verifier};return e.codeChallenge=t.challenge,e.codeChallengeMethod=A.S256_CODE_CHALLENGE_METHOD,r}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e==null?void 0:e.correlationId);const t={correlationId:this.correlationId||Mr(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const r=this.getLogoutHintFromIdTokenClaims(e.account);r&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=r)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=ae.getAbsoluteUrl(e.postLogoutRedirectUri,Tr())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=ae.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Tr())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=ae.getAbsoluteUrl(Tr(),Tr())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(T.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await P(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new YT(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:r,requestAzureCloudOptions:i,requestExtraQueryParameters:o,account:s}=e;this.performanceClient.addQueueMeasurement(T.StandardInteractionClientGetClientConfiguration,this.correlationId);const a=await P(this.getDiscoveredAuthority.bind(this),T.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:r,requestAzureCloudOptions:i,requestExtraQueryParameters:o,account:s}),l=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:a,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:l.loggerCallback,piiLoggingEnabled:l.piiLoggingEnabled,logLevel:l.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:cn.MSAL_SKU,version:Wu,cpu:A.EMPTY_STRING,os:A.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(T.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const r=this.getRedirectUri(e.redirectUri),i={interactionType:t},o=zn.setRequestState(this.browserCrypto,e&&e.state||A.EMPTY_STRING,i),a={...await P(Lm,T.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:r,state:o,nonce:e.nonce||Mr(),responseMode:this.config.auth.OIDCOptions.serverResponseType};if(e.loginHint||e.sid)return a;const l=e.account||this.browserStorage.getActiveAccount();if(l&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${l.homeAccountId}`,this.correlationId),a.account=l),!a.loginHint&&!l){const c=this.browserStorage.getLegacyLoginHint();c&&(a.loginHint=c)}return a}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const zN="ContentError",FE="user_switch";/*! @azure/msal-browser v3.28.1 2025-01-14 */const jN="USER_INTERACTION_REQUIRED",KN="USER_CANCEL",$N="NO_NETWORK",VN="PERSISTENT_ERROR",WN="DISABLED",GN="ACCOUNT_UNAVAILABLE";/*! @azure/msal-browser v3.28.1 2025-01-14 */const qN=-2147186943,QN={[FE]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class rr extends Me{constructor(e,t,r){super(e,t),Object.setPrototypeOf(this,rr.prototype),this.name="NativeAuthError",this.ext=r}}function ko(n){if(n.ext&&n.ext.status&&(n.ext.status===VN||n.ext.status===WN)||n.ext&&n.ext.error&&n.ext.error===qN)return!0;switch(n.errorCode){case zN:return!0;default:return!1}}function Rf(n,e,t){if(t&&t.status)switch(t.status){case GN:return Sf(qT);case jN:return new Kn(n,e);case KN:return F(no);case $N:return F(Vc)}return new rr(n,QN[n]||e,t)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class BE extends As{async acquireToken(e){this.performanceClient.addQueueMeasurement(T.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(be.acquireTokenSilent_silentFlow),r=await P(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),i=new M1(r,this.performanceClient);this.logger.verbose("Silent auth client created");try{const s=(await P(i.acquireCachedToken.bind(i),T.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),s}catch(o){throw o instanceof sl&&o.errorCode===Rm&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t==null?void 0:t.account)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Jo extends HE{constructor(e,t,r,i,o,s,a,l,c,u,d,h){var p;super(e,t,r,i,o,s,l,c,h),this.apiId=a,this.accountId=u,this.nativeMessageHandler=c,this.nativeStorageManager=d,this.silentCacheClient=new BE(e,this.nativeStorageManager,r,i,o,s,l,c,h),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);const f=this.nativeMessageHandler.getExtensionId()===zo.PREFERRED_EXTENSION_ID?"chrome":(p=this.nativeMessageHandler.getExtensionId())!=null&&p.length?"unknown":void 0;this.skus=Ha.makeExtraSkuString({libraryName:cn.MSAL_SKU,libraryVersion:Wu,extensionName:f,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[m1]:this.skus}}async acquireToken(e){this.performanceClient.addQueueMeasurement(T.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const t=this.performanceClient.startMeasurement(T.NativeInteractionClientAcquireToken,e.correlationId),r=cr();try{const i=await this.initializeNativeRequest(e);try{const c=await this.acquireTokensFromCache(this.accountId,i);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),c}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const{...o}=i,s={method:Hi.GetToken,request:o},a=await this.nativeMessageHandler.sendMessage(s),l=this.validateNativeResponse(a);return await this.handleNativeResponse(l,i,r).then(c=>(t.end({success:!0,isNativeBroker:!0,requestId:c.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),c)).catch(c=>{throw t.end({success:!1,errorCode:c.errorCode,subErrorCode:c.subError,isNativeBroker:!0}),c})}catch(i){throw i instanceof rr&&this.serverTelemetryManager.setNativeBrokerErrorCode(i.errorCode),i}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:je.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),O(pf);const r=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!r)throw O(pf);try{const i=this.createSilentCacheRequest(t,r),o=await this.silentCacheClient.acquireToken(i),s={...r,idTokenClaims:o==null?void 0:o.idTokenClaims,idToken:o==null?void 0:o.idToken};return{...o,account:s}}catch(i){throw i}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...r}=e;delete r.onRedirectNavigate;const i=await this.initializeNativeRequest(r),o={method:Hi.GetToken,request:i};try{const l=await this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(l)}catch(l){if(l instanceof rr&&(this.serverTelemetryManager.setNativeBrokerErrorCode(l.errorCode),ko(l)))throw l}this.browserStorage.setTemporaryCache(fe.NATIVE_REQUEST,JSON.stringify(i),!0);const s={apiId:be.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(a,s)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const r=this.browserStorage.getCachedNativeRequest();if(!r)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&(e==null||e.addFields({errorCode:"no_cached_request"},t)),null;const{prompt:i,...o}=r;i&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(fe.NATIVE_REQUEST));const s={method:Hi.GetToken,request:o},a=cr();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const l=await this.nativeMessageHandler.sendMessage(s);this.validateNativeResponse(l);const c=this.handleNativeResponse(l,o,a);this.browserStorage.setInteractionInProgress(!1);const u=await c;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),u}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,r){var u;this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const i=ho(e.id_token,lr),o=this.createHomeAccountIdentifier(e,i),s=(u=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId}))==null?void 0:u.homeAccountId;if(o!==s&&e.account.id!==t.accountId)throw Rf(FE);const a=await this.getDiscoveredAuthority({requestAuthority:t.authority}),l=Tm(this.browserStorage,a,o,lr,i,e.client_info,void 0,i.tid,void 0,e.account.id,this.logger),c=await this.generateAuthenticationResult(e,t,i,l,a.canonicalAuthority,r);return this.cacheAccount(l),this.cacheNativeTokens(e,t,o,i,e.access_token,c.tenantId,r),c}createHomeAccountIdentifier(e,t){return Ze.generateHomeAccountId(e.client_info||A.EMPTY_STRING,Dn.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?je.fromString(e.scope):je.fromString(t.scope)}async generatePopAccessToken(e,t){if(t.tokenType===ge.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const r=new hs(this.browserCrypto),i={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw O(am);return r.signPopToken(e.access_token,t.keyId,i)}else return e.access_token}async generateAuthenticationResult(e,t,r,i,o,s){const a=this.addTelemetryFromNativeResponse(e),l=e.scope?je.fromString(e.scope):je.fromString(t.scope),c=e.account.properties||{},u=c.UID||r.oid||r.sub||A.EMPTY_STRING,d=c.TenantId||r.tid||A.EMPTY_STRING,h=gm(i.getAccountInfo(),void 0,r,e.id_token);h.nativeAccountId!==e.account.id&&(h.nativeAccountId=e.account.id);const f=await this.generatePopAccessToken(e,t),p=t.tokenType===ge.POP?ge.POP:ge.BEARER;return{authority:o,uniqueId:u,tenantId:d,scopes:l.asArray(),account:h,idToken:e.id_token,idTokenClaims:r,accessToken:f,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(s+e.expires_in)*1e3),tokenType:p,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,r,i,o,s,a){const l=Lu(r,t.authority,e.id_token||"",t.clientId,i.tid||""),c=t.tokenType===ge.POP?A.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,u=a+c,d=this.generateScopes(e,t),h=Uu(r,t.authority,o,t.clientId,i.tid||s,d.printScopes(),u,0,lr,void 0,t.tokenType,void 0,t.keyId),f={idToken:l,accessToken:h};this.nativeStorageManager.saveCacheRecord(f,t.storeInCache)}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw iT(tm,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const r=new ae(t);r.validateAsUri();const{scopes:i,...o}=e,s=new je(i||[]);s.appendScopes(Is);const a=()=>{switch(this.apiId){case be.ssoSilent:case be.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),it.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case it.NONE:case it.CONSENT:case it.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),F(kE)}},l={...o,accountId:this.accountId,clientId:this.config.auth.clientId,authority:r.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(l.signPopToken&&e.popKid)throw F(AE);if(this.handleExtraBrokerParams(l),l.extraParameters=l.extraParameters||{},l.extraParameters.telemetry=zo.MATS_TELEMETRY,e.authenticationScheme===ge.POP){const c={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},u=new hs(this.browserCrypto);let d;if(l.keyId)d=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:l.keyId})),l.signPopToken=!1;else{const h=await P(u.generateCnf.bind(u),T.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(c,this.logger);d=h.reqCnfString,l.keyId=h.kid,l.signPopToken=!0}l.reqCnf=d}return this.addRequestSKUs(l),l}handleExtraBrokerParams(e){var o;const t=e.extraParameters&&e.extraParameters.hasOwnProperty(Cm)&&e.extraParameters.hasOwnProperty(Cf)&&e.extraParameters.hasOwnProperty(eo);if(!e.embeddedClientId&&!t)return;let r="";const i=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,r=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[Cf],r=e.extraParameters[eo]),e.extraParameters={child_client_id:r,child_redirect_uri:i},(o=this.performanceClient)==null||o.addFields({embeddedClientId:r,embeddedRedirectUri:i},e.correlationId)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ir{constructor(e,t,r,i){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=r,this.handshakeEvent=r.startMeasurement(T.NativeMessageHandlerHandshake)}async sendMessage(e){this.logger.trace("NativeMessageHandler - sendMessage called.");const t={channel:zo.CHANNEL_ID,extensionId:this.extensionId,responseId:Mr(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((r,i)=>{this.resolvers.set(t.responseId,{resolve:r,reject:i})})}static async createProvider(e,t,r){e.trace("NativeMessageHandler - createProvider called.");try{const i=new ir(e,t,r,zo.PREFERRED_EXTENSION_ID);return await i.sendHandshakeRequest(),i}catch{const o=new ir(e,t,r);return await o.sendHandshakeRequest(),o}}async sendHandshakeRequest(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:zo.CHANNEL_ID,extensionId:this.extensionId,responseId:Mr(),body:{method:Hi.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,r)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:r}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),r(F(wE)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==zo.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===Hi.HandshakeRequest){const r=this.handshakeResolvers.get(t.responseId);if(!r){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),r.reject(F(TE))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");const t=e.data,r=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{const o=t.body.method;if(o===Hi.Response){if(!r)return;const s=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(s)}`),s.status!=="Success")r.reject(Rf(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?r.reject(Rf(s.result.code,s.result.description,s.result.ext)):r.resolve(s.result);else throw iT(tm,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(o===Hi.HandshakeResponse){if(!i){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(o){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${o}`),this.logger.errorPii(`Unable to parse ${e}`),r?r.reject(o):i&&i.reject(o)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,r,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!r)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case ge.BEARER:case ge.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class Um{constructor(e,t,r,i,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=i,this.performanceClient=o}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(T.HandleCodeResponse,t.correlationId);let r;try{r=this.authModule.handleFragmentResponse(e,t.state)}catch(i){throw i instanceof Ti&&i.subError===no?F(no):i}return P(this.handleCodeResponseFromServer.bind(this),T.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(r,t)}async handleCodeResponseFromServer(e,t,r=!0){if(this.performanceClient.addQueueMeasurement(T.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await P(this.authModule.updateAuthority.bind(this.authModule),T.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),r&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const o=this.createCcsCredentials(t);o&&(this.authCodeRequest.ccsCredential=o)}return await P(this.authModule.acquireToken.bind(this.authModule),T.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:fn.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:fn.UPN}:null}}/*! @azure/msal-browser v3.28.1 2025-01-14 */function zE(n,e,t){const r=jc(n);if(!r)throw BT(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),F(tE)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),F(eE));return r}function YN(n,e,t){if(!n.state)throw F(Am);const r=UE(e,n.state);if(!r)throw F(nE);if(r.interactionType!==t)throw F(rE)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class JN extends As{constructor(e,t,r,i,o,s,a,l,c,u){super(e,t,r,i,o,s,a,c,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=l}acquireToken(e){try{const r={popupName:this.generatePopupName(e.scopes||Is,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window};return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,r)):(this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),r.popup=this.openSizedPopup("about:blank",r),this.acquireTokenPopupAsync(e,r))}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),r={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:(e==null?void 0:e.popupWindowAttributes)||{},popupWindowParent:(e==null?void 0:e.popupWindowParent)??window},i=e&&e.authority,o=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,r,i,o)):(this.logger.verbose("asyncPopup set to false, opening popup"),r.popup=this.openSizedPopup("about:blank",r),this.logoutPopupAsync(t,r,i,o))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t){var o;this.logger.verbose("acquireTokenPopupAsync called");const r=this.initializeServerTelemetryManager(be.acquireTokenPopup),i=await P(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,$.Popup);LE(i.authority);try{const s=await P(this.initializeAuthorizationCodeRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(i),a=await P(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:i.authority,requestAzureCloudOptions:i.azureCloudOptions,requestExtraQueryParameters:i.extraQueryParameters,account:i.account}),l=ir.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme);let c;l&&(c=this.performanceClient.startMeasurement(T.FetchAccountIdWithNativeBroker,e.correlationId));const u=await a.getAuthCodeUrl({...i,nativeBroker:l}),d=new Um(a,this.browserStorage,s,this.logger,this.performanceClient),h=this.initiateAuthRequest(u,t);this.eventHandler.emitEvent(z.POPUP_OPENED,$.Popup,{popupWindow:h},null);const f=await this.monitorPopupForHash(h,t.popupWindowParent),p=fo(zE,T.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(f,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(nr.removeThrottle(this.browserStorage,this.config.auth.clientId,s),p.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),c&&c.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw F(ol);const v=new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,p.accountId,this.nativeStorage,i.correlationId),{userRequestState:g}=zn.parseRequestState(this.browserCrypto,i.state);return await v.acquireToken({...i,state:g,prompt:void 0})}return await d.handleCodeResponse(p,i)}catch(s){throw(o=t.popup)==null||o.close(),s instanceof Me&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),s}}async logoutPopupAsync(e,t,r,i){var s,a,l,c;this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(z.LOGOUT_START,$.Popup,e);const o=this.initializeServerTelemetryManager(be.logoutPopup);try{await this.clearCacheOnLogout(e.account);const u=await P(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:o,requestAuthority:r,account:e.account||void 0});try{u.authority.endSessionEndpoint}catch{if((s=e.account)!=null&&s.homeAccountId&&e.postLogoutRedirectUri&&u.authority.protocolMode===Ir.OIDC){if(this.browserStorage.removeAccount((a=e.account)==null?void 0:a.homeAccountId),this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Popup,e),i){const f={apiId:be.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=ae.getAbsoluteUrl(i,Tr());await this.navigationClient.navigateInternal(p,f)}(l=t.popup)==null||l.close();return}}const d=u.getLogoutUri(e);this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Popup,e);const h=this.openPopup(d,t);if(this.eventHandler.emitEvent(z.POPUP_OPENED,$.Popup,{popupWindow:h},null),await this.monitorPopupForHash(h,t.popupWindowParent).catch(()=>{}),i){const f={apiId:be.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=ae.getAbsoluteUrl(i,Tr());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${p}`),await this.navigationClient.navigateInternal(p,f)}else this.logger.verbose("No main window navigation requested")}catch(u){throw(c=t.popup)==null||c.close(),u instanceof Me&&(u.setCorrelationId(this.correlationId),o.cacheFailedRequest(u)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(z.LOGOUT_FAILURE,$.Popup,null,u),this.eventHandler.emitEvent(z.LOGOUT_END,$.Popup),u}this.eventHandler.emitEvent(z.LOGOUT_END,$.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),F(ju)}monitorPopupForHash(e,t){return new Promise((r,i)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const o=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(o),i(F(no));return}let s="";try{s=e.location.href}catch{}if(!s||s==="about:blank")return;clearInterval(o);let a="";const l=this.config.auth.OIDCOptions.serverResponseType;e&&(l===il.QUERY?a=e.location.search:a=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),r(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let r;if(t.popup?(r=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),r.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),r=this.openSizedPopup(e,t)),!r)throw F(sE);return r.focus&&r.focus(),this.currentWindow=r,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),r}catch(r){throw this.logger.error("error opening popup "+r.message),this.browserStorage.setInteractionInProgress(!1),F(oE)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:r,popupWindowParent:i}){var f,p,m,v;const o=i.screenLeft?i.screenLeft:i.screenX,s=i.screenTop?i.screenTop:i.screenY,a=i.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,l=i.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let c=(f=r.popupSize)==null?void 0:f.width,u=(p=r.popupSize)==null?void 0:p.height,d=(m=r.popupPosition)==null?void 0:m.top,h=(v=r.popupPosition)==null?void 0:v.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=cn.POPUP_WIDTH),(!u||u<0||u>l)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),u=cn.POPUP_HEIGHT),(!d||d<0||d>l)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),d=Math.max(0,l/2-cn.POPUP_HEIGHT/2+s)),(!h||h<0||h>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),h=Math.max(0,a/2-cn.POPUP_WIDTH/2+o)),i.open(e,t,`width=${c}, height=${u}, top=${d}, left=${h}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType($.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${cn.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${cn.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v3.28.1 2025-01-14 */let uv=class{constructor(e,t,r,i,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=r,this.logger=i,this.performanceClient=o}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(fe.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(fe.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const r={apiId:be.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await t.navigationClient.navigateExternal(e,r);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await t.navigationClient.navigateExternal(e,r);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),F(ju)}async handleCodeResponse(e,t){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);const r=this.browserStorage.generateStateKey(t),i=this.browserStorage.getTemporaryCache(r);if(!i)throw O(Hc,"Cached State");let o;try{o=this.authModule.handleFragmentResponse(e,i)}catch(c){throw c instanceof Ti&&c.subError===no?F(no):c}const s=this.browserStorage.generateNonceKey(i),a=this.browserStorage.getTemporaryCache(s);if(this.authCodeRequest.code=o.code,o.cloud_instance_host_name&&await P(this.authModule.updateAuthority.bind(this.authModule),T.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(o.cloud_instance_host_name,this.authCodeRequest.correlationId),o.nonce=a||void 0,o.state=i,o.client_info)this.authCodeRequest.clientInfo=o.client_info;else{const c=this.checkCcsCredentials();c&&(this.authCodeRequest.ccsCredential=c)}const l=await this.authModule.acquireToken(this.authCodeRequest,o);return this.browserStorage.cleanRequestByState(t),l}checkCcsCredentials(){const e=this.browserStorage.getTemporaryCache(fe.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}};/*! @azure/msal-browser v3.28.1 2025-01-14 */function XN(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation"),e=n.length?n[0]:void 0;return e==null?void 0:e.type}class ZN extends As{constructor(e,t,r,i,o,s,a,l,c,u){super(e,t,r,i,o,s,a,c,u),this.nativeStorage=l}async acquireToken(e){const t=await P(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,$.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);const r=this.initializeServerTelemetryManager(be.acquireTokenRedirect),i=o=>{o.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(z.RESTORE_FROM_BFCACHE,$.Redirect))};try{const o=await P(this.initializeAuthorizationCodeRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),s=await P(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),a=new uv(s,this.browserStorage,o,this.logger,this.performanceClient),l=await s.getAuthCodeUrl({...t,nativeBroker:ir.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)}),c=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${c}`),window.addEventListener("pageshow",i),await a.initiateAuthRequest(l,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:c,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(o){throw o instanceof Me&&(o.setCorrelationId(this.correlationId),r.cacheFailedRequest(o)),window.removeEventListener("pageshow",i),this.browserStorage.cleanRequestByState(t.state),o}}async handleRedirectPromise(e="",t){const r=this.initializeServerTelemetryManager(be.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const[i,o]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType($.Redirect),XN()!=="back_forward"?t.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const s=this.browserStorage.getTemporaryCache(fe.ORIGIN_URI,!0)||A.EMPTY_STRING,a=ae.removeHashFromUrl(s),l=ae.removeHashFromUrl(window.location.href);if(a===l&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&sN(s),await this.handleResponse(i,r);if(this.config.auth.navigateToLoginRequestUrl){if(!_m()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(fe.URL_HASH,o,!0);const c={apiId:be.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let u=!0;if(!s||s==="null"){const d=lN();this.browserStorage.setTemporaryCache(fe.ORIGIN_URI,d,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),u=await this.navigationClient.navigateInternal(d,c)}else this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),u=await this.navigationClient.navigateInternal(s,c);if(!u)return await this.handleResponse(i,r)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(i,r);return null}catch(i){throw i instanceof Me&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),this.browserStorage.cleanRequestByInteractionType($.Redirect),i}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===il.QUERY?t=window.location.search:t=window.location.hash);let r=jc(t);if(r){try{YN(r,this.browserCrypto,$.Redirect)}catch(o){return o instanceof Me&&this.logger.error(`Interaction type validation failed due to ${o.errorCode}: ${o.errorMessage}`),[null,""]}return oN(window),this.logger.verbose("Hash contains known properties, returning response hash"),[r,t]}const i=this.browserStorage.getTemporaryCache(fe.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(fe.URL_HASH)),i&&(r=jc(i),r)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[r,i]):[null,""]}async handleResponse(e,t){const r=e.state;if(!r)throw F(Am);const i=this.browserStorage.getCachedRequest(r);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw F(ol);const l=new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,i.correlationId),{userRequestState:c}=zn.parseRequestState(this.browserCrypto,r);return l.acquireToken({...i,state:c,prompt:void 0}).finally(()=>{this.browserStorage.cleanRequestByState(r)})}const o=this.browserStorage.getCachedAuthority(r);if(!o)throw F(bm);const s=await P(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:o});return nr.removeThrottle(this.browserStorage,this.config.auth.clientId,i),new uv(s,this.browserStorage,i,this.logger,this.performanceClient).handleCodeResponse(e,r)}async logout(e){var i,o;this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),r=this.initializeServerTelemetryManager(be.logout);try{this.eventHandler.emitEvent(z.LOGOUT_START,$.Redirect,e),await this.clearCacheOnLogout(t.account);const s={apiId:be.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=await P(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:r,requestAuthority:e&&e.authority,requestExtraQueryParameters:e==null?void 0:e.extraQueryParameters,account:e&&e.account||void 0});if(a.authority.protocolMode===Ir.OIDC)try{a.authority.endSessionEndpoint}catch{if((i=t.account)!=null&&i.homeAccountId){this.browserStorage.removeAccount((o=t.account)==null?void 0:o.homeAccountId),this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Redirect,t);return}}const l=a.getLogoutUri(t);if(this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,$.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(l)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,s);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),await this.navigationClient.navigateExternal(l,s);return}}catch(s){throw s instanceof Me&&(s.setCorrelationId(this.correlationId),r.cacheFailedRequest(s)),this.eventHandler.emitEvent(z.LOGOUT_FAILURE,$.Redirect,null,s),this.eventHandler.emitEvent(z.LOGOUT_END,$.Redirect),s}this.eventHandler.emitEvent(z.LOGOUT_END,$.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return ae.getAbsoluteUrl(t,Tr())}}/*! @azure/msal-browser v3.28.1 2025-01-14 */async function ex(n,e,t,r,i){if(e.addQueueMeasurement(T.SilentHandlerInitiateAuthRequest,r),!n)throw t.info("Navigate url is empty"),F(ju);return i?P(nx,T.SilentHandlerLoadFrame,t,e,r)(n,i,e,r):fo(rx,T.SilentHandlerLoadFrameSync,t,e,r)(n)}async function tx(n,e,t,r,i,o,s){return r.addQueueMeasurement(T.SilentHandlerMonitorIframeForHash,o),new Promise((a,l)=>{e<If&&i.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${If}ms). This may result in timeouts.`);const c=window.setTimeout(()=>{window.clearInterval(u),l(F(aE))},e),u=window.setInterval(()=>{let d="";const h=n.contentWindow;try{d=h?h.location.href:""}catch{}if(!d||d==="about:blank")return;let f="";h&&(s===il.QUERY?f=h.location.search:f=h.location.hash),window.clearTimeout(c),window.clearInterval(u),a(f)},t)}).finally(()=>{fo(ix,T.RemoveHiddenIframe,i,r,o)(n)})}function nx(n,e,t,r){return t.addQueueMeasurement(T.SilentHandlerLoadFrame,r),new Promise((i,o)=>{const s=jE();window.setTimeout(()=>{if(!s){o("Unable to load iframe");return}s.src=n,i(s)},e)})}function rx(n){const e=jE();return e.src=n,e}function jE(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function ix(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ox extends As{constructor(e,t,r,i,o,s,a,l,c,u,d){super(e,t,r,i,o,s,l,u,d),this.apiId=a,this.nativeStorage=c}async acquireToken(e){this.performanceClient.addQueueMeasurement(T.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==it.NONE&&t.prompt!==it.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${it.NONE}`),t.prompt=it.NONE):t.prompt=it.NONE;const r=await P(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,$.Silent);LE(r.authority);const i=this.initializeServerTelemetryManager(this.apiId);let o;try{return o=await P(this.createAuthCodeClient.bind(this),T.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:i,requestAuthority:r.authority,requestAzureCloudOptions:r.azureCloudOptions,requestExtraQueryParameters:r.extraQueryParameters,account:r.account}),await P(this.silentTokenHelper.bind(this),T.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(o,r)}catch(s){if(s instanceof Me&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),!o||!(s instanceof Me)||s.errorCode!==cn.INVALID_GRANT_ERROR)throw s;this.performanceClient.addFields({retryError:s.errorCode},this.correlationId);const a=await P(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,$.Silent);return await P(this.silentTokenHelper.bind(this),T.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(o,a)}}logout(){return Promise.reject(F(Ku))}async silentTokenHelper(e,t){const r=t.correlationId;this.performanceClient.addQueueMeasurement(T.SilentIframeClientTokenHelper,r);const i=await P(this.initializeAuthorizationCodeRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,r)(t),o=await P(e.getAuthCodeUrl.bind(e),T.GetAuthCodeUrl,this.logger,this.performanceClient,r)({...t,nativeBroker:ir.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)}),s=new Um(e,this.browserStorage,i,this.logger,this.performanceClient),a=await P(ex,T.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,r)(o,this.performanceClient,this.logger,r,this.config.system.navigateFrameWait),l=this.config.auth.OIDCOptions.serverResponseType,c=await P(tx,T.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,r)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,r,l),u=fo(zE,T.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(c,l,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw F(ol);const d=new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,r),{userRequestState:h}=zn.parseRequestState(this.browserCrypto,t.state);return P(d.acquireToken.bind(d),T.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,r)({...t,state:h,prompt:t.prompt||it.NONE})}return P(s.handleCodeResponse.bind(s),T.HandleCodeResponse,this.logger,this.performanceClient,r)(u,t)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class sx extends As{async acquireToken(e){this.performanceClient.addQueueMeasurement(T.SilentRefreshClientAcquireToken,e.correlationId);const t=await P(Lm,T.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),r={...e,...t};e.redirectUri&&(r.redirectUri=this.getRedirectUri(e.redirectUri));const i=this.initializeServerTelemetryManager(be.acquireTokenSilent_silentFlow),o=await this.createRefreshTokenClient({serverTelemetryManager:i,authorityUrl:r.authority,azureCloudOptions:r.azureCloudOptions,account:r.account});return P(o.acquireTokenByRefreshToken.bind(o),T.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(r).catch(s=>{throw s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s),s})}logout(){return Promise.reject(F(Ku))}async createRefreshTokenClient(e){const t=await P(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new wf(t,this.performanceClient)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class ax{constructor(e,t,r,i){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=r,this.cryptoObj=i}loadExternalTokens(e,t,r){if(!this.isBrowserEnvironment)throw F($u);const i=t.id_token?ho(t.id_token,lr):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new kt(kt.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||Mr()):void 0,a=this.loadAccount(e,r.clientInfo||t.client_info||"",i,s),l=this.loadIdToken(t,a.homeAccountId,a.environment,a.realm),c=this.loadAccessToken(e,t,a.homeAccountId,a.environment,a.realm,r),u=this.loadRefreshToken(t,a.homeAccountId,a.environment);return this.generateAuthenticationResult(e,{account:a,idToken:l,accessToken:c,refreshToken:u},i,s)}loadAccount(e,t,r,i){if(this.logger.verbose("TokenCache - loading account"),e.account){const l=Ze.createFromAccountInfo(e.account);return this.storage.setAccount(l),l}else if(!i||!t&&!r)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),F(gE);const o=Ze.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,r),s=r==null?void 0:r.tid,a=Tm(this.storage,i,o,lr,r,t,i.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(a),a}loadIdToken(e,t,r,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const o=Lu(t,r,e.id_token,this.config.auth.clientId,i);return this.storage.setIdTokenCredential(o),o}loadAccessToken(e,t,r,i,o,s){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const a=t.scope?je.fromString(t.scope):new je(e.scopes),l=s.expiresOn||t.expires_in+new Date().getTime()/1e3,c=s.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=Uu(r,i,t.access_token,this.config.auth.clientId,o,a.printScopes(),l,c,lr);return this.storage.setAccessTokenCredential(u),u}loadRefreshToken(e,t,r){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const i=kT(t,r,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(i),i}generateAuthenticationResult(e,t,r,i){var u,d,h;let o="",s=[],a=null,l;t!=null&&t.accessToken&&(o=t.accessToken.secret,s=je.fromString(t.accessToken.target).asArray(),a=new Date(Number(t.accessToken.expiresOn)*1e3),l=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));const c=t.account;return{authority:i?i.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:s,account:c.getAccountInfo(),idToken:((u=t.idToken)==null?void 0:u.secret)||"",idTokenClaims:r||{},accessToken:o,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:l,familyId:((d=t.refreshToken)==null?void 0:d.familyId)||"",tokenType:((h=t==null?void 0:t.accessToken)==null?void 0:h.tokenType)||"",state:e.state||"",cloudGraphHostName:c.cloudGraphHostName||"",msGraphHost:c.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class lx extends YT{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v3.28.1 2025-01-14 */class cx extends As{constructor(e,t,r,i,o,s,a,l,c,u){super(e,t,r,i,o,s,l,c,u),this.apiId=a}async acquireToken(e){if(!e.code)throw F(yE);const t=await P(this.initializeAuthorizationRequest.bind(this),T.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,$.Silent),r=this.initializeServerTelemetryManager(this.apiId);try{const i={...t,code:e.code},o=await P(this.getClientConfiguration.bind(this),T.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:r,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),s=new lx(o);this.logger.verbose("Auth code client created");const a=new Um(s,this.browserStorage,i,this.logger,this.performanceClient);return await P(a.handleCodeResponseFromServer.bind(a),T.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(i){throw i instanceof Me&&(i.setCorrelationId(this.correlationId),r.cacheFailedRequest(i)),i}}logout(){return Promise.reject(F(Ku))}}/*! @azure/msal-browser v3.28.1 2025-01-14 */function Jn(n){const e=n==null?void 0:n.idTokenClaims;if(e!=null&&e.tfp||e!=null&&e.acr)return"B2C";if(e!=null&&e.tid){if((e==null?void 0:e.tid)==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function Hl(n,e){try{Pm(n)}catch(t){throw e.end({success:!1},t),t}}class Gu{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new fs(this.logger,this.performanceClient):Fc,this.eventHandler=new DN(this.logger),this.browserStorage=this.isBrowserEnvironment?new bf(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,T1(this.config.auth),this.performanceClient):bN(this.config.auth.clientId,this.logger);const t={cacheLocation:Wt.MemoryStorage,temporaryCacheLocation:Wt.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new bf(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new ax(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this),this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}static async createController(e,t){const r=new Gu(e);return await r.initialize(t),r}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent(z.INITIALIZE_END);return}const t=(e==null?void 0:e.correlationId)||this.getRequestCorrelationId(),r=this.config.system.allowNativeBroker,i=this.performanceClient.startMeasurement(T.InitializeClientApplication,t);if(this.eventHandler.emitEvent(z.INITIALIZE_START),r)try{this.nativeExtensionProvider=await ir.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(o){this.logger.verbose(o)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),await P(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),T.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(z.INITIALIZE_END),i.end({allowNativeBroker:r,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),DE(this.initialized),this.isBrowserEnvironment){const t=e||"";let r=this.redirectResponse.get(t);return typeof r>"u"?(r=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,r),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),r}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){const t=this.getAllAccounts(),r=this.browserStorage.getCachedNativeRequest(),i=r&&ir.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,o=i?r==null?void 0:r.correlationId:this.browserStorage.getTemporaryCache(fe.CORRELATION_ID,!0)||"",s=this.performanceClient.startMeasurement(T.AcquireTokenRedirect,o);this.eventHandler.emitEvent(z.HANDLE_REDIRECT_START,$.Redirect);let a;if(i&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");const l=new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,r.accountId,this.nativeInternalStorage,r.correlationId);a=P(l.handleRedirectPromise.bind(l),T.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(this.performanceClient,s.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");const l=this.createRedirectClient(o);a=P(l.handleRedirectPromise.bind(l),T.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(e,s)}return a.then(l=>(l?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(z.LOGIN_SUCCESS,$.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,$.Redirect,l),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),s.end({success:!0,accountType:Jn(l.account)})):s.event.errorCode?s.end({success:!1}):s.discard(),this.eventHandler.emitEvent(z.HANDLE_REDIRECT_END,$.Redirect),l)).catch(l=>{const c=l;throw t.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Redirect,null,c):this.eventHandler.emitEvent(z.LOGIN_FAILURE,$.Redirect,null,c),this.eventHandler.emitEvent(z.HANDLE_REDIRECT_END,$.Redirect),s.end({success:!1},c),l})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const r=this.performanceClient.startMeasurement(T.AcquireTokenPreRedirect,t);r.add({accountType:Jn(e.account),scenarioId:e.scenarioId});const i=e.onRedirectNavigate;if(i)e.onRedirectNavigate=s=>{const a=typeof i=="function"?i(s):void 0;return a!==!1?r.end({success:!0}):r.discard(),a};else{const s=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=a=>{const l=typeof s=="function"?s(a):void 0;return l!==!1?r.end({success:!0}):r.discard(),l}}const o=this.getAllAccounts().length>0;try{sv(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),o?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,$.Redirect,e):this.eventHandler.emitEvent(z.LOGIN_START,$.Redirect,e);let s;return this.nativeExtensionProvider&&this.canUseNative(e)?s=new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,r).catch(l=>{if(l instanceof rr&&ko(l))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(l instanceof Kn)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),l}):s=this.createRedirectClient(t).acquireToken(e),await s}catch(s){throw r.end({success:!1},s),o?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Redirect,null,s):this.eventHandler.emitEvent(z.LOGIN_FAILURE,$.Redirect,null,s),s}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(T.AcquireTokenPopup,t);r.add({scenarioId:e.scenarioId,accountType:Jn(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Hl(this.initialized,r),this.browserStorage.setInteractionInProgress(!0)}catch(s){return Promise.reject(s)}const i=this.getAllAccounts();i.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,$.Popup,e):this.eventHandler.emitEvent(z.LOGIN_START,$.Popup,e);let o;return this.canUseNative(e)?o=this.acquireTokenNative({...e,correlationId:t},be.acquireTokenPopup).then(s=>(this.browserStorage.setInteractionInProgress(!1),r.end({success:!0,isNativeBroker:!0,accountType:Jn(s.account)}),s)).catch(s=>{if(s instanceof rr&&ko(s))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(s instanceof Kn)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),s}):o=this.createPopupClient(t).acquireToken(e),o.then(s=>(i.length<this.getAllAccounts().length?this.eventHandler.emitEvent(z.LOGIN_SUCCESS,$.Popup,s):this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,$.Popup,s),r.end({success:!0,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Jn(s.account)}),s)).catch(s=>(i.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Popup,null,s):this.eventHandler.emitEvent(z.LOGIN_FAILURE,$.Popup,null,s),r.end({success:!1},s),Promise.reject(s)))}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){var o,s;const t=this.getRequestCorrelationId(e),r={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(T.SsoSilent,t),(o=this.ssoSilentMeasurement)==null||o.add({scenarioId:e.scenarioId,accountType:Jn(e.account)}),Hl(this.initialized,this.ssoSilentMeasurement),(s=this.ssoSilentMeasurement)==null||s.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(z.SSO_SILENT_START,$.Silent,r);let i;return this.canUseNative(r)?i=this.acquireTokenNative(r,be.ssoSilent).catch(a=>{if(a instanceof rr&&ko(a))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(r.correlationId).acquireToken(r);throw a}):i=this.createSilentIframeClient(r.correlationId).acquireToken(r),i.then(a=>{var l;return this.eventHandler.emitEvent(z.SSO_SILENT_SUCCESS,$.Silent,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!0,isNativeBroker:a.fromNativeBroker,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:Jn(a.account)}),a}).catch(a=>{var l;throw this.eventHandler.emitEvent(z.SSO_SILENT_FAILURE,$.Silent,null,a),(l=this.ssoSilentMeasurement)==null||l.end({success:!1},a),a}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const r=this.performanceClient.startMeasurement(T.AcquireTokenByCode,t);Hl(this.initialized,r),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_START,$.Silent,e),r.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw F(CE);if(e.code){const i=e.code;let o=this.hybridAuthCodeResponses.get(i);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),r.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(s=>(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_SUCCESS,$.Silent,s),this.hybridAuthCodeResponses.delete(i),r.end({success:!0,isNativeBroker:s.fromNativeBroker,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Jn(s.account)}),s)).catch(s=>{throw this.hybridAuthCodeResponses.delete(i),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_FAILURE,$.Silent,null,s),r.end({success:!1},s),s}),this.hybridAuthCodeResponses.set(i,o)),await o}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){const i=await this.acquireTokenNative({...e,correlationId:t},be.acquireTokenByCode,e.nativeAccountId).catch(o=>{throw o instanceof rr&&ko(o)&&(this.nativeExtensionProvider=void 0),o});return r.end({accountType:Jn(i.account),success:!0}),i}else throw F(SE);else throw F(vE)}catch(i){throw this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_FAILURE,$.Silent,null,i),r.end({success:!1},i),i}}async acquireTokenByCodeAsync(e){var i;return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(T.AcquireTokenByCodeAsync,e.correlationId),(i=this.acquireTokenByCodeAsyncMeasurement)==null||i.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(o=>{var s;return(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!0,fromCache:o.fromCache,isNativeBroker:o.fromNativeBroker}),o}).catch(o=>{var s;throw(s=this.acquireTokenByCodeAsyncMeasurement)==null||s.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(T.AcquireTokenFromCache,e.correlationId),t){case on.Default:case on.AccessToken:case on.AccessTokenAndRefreshToken:const r=this.createSilentCacheClient(e.correlationId);return P(r.acquireToken.bind(r),T.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw O(wr)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(T.AcquireTokenByRefreshToken,e.correlationId),t){case on.Default:case on.AccessTokenAndRefreshToken:case on.RefreshToken:case on.RefreshTokenAndNetwork:const r=this.createSilentRefreshClient(e.correlationId);return P(r.acquireToken.bind(r),T.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw O(wr)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(T.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return P(t.acquireToken.bind(t),T.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return sv(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Pm(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){return RN(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return NN(e,this.logger,this.browserStorage)}getAccountByUsername(e){return xN(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return ON(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return MN(e,this.logger,this.browserStorage)}setActiveAccount(e){_N(e,this.browserStorage)}getActiveAccount(){return PN(this.browserStorage)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const r=Ze.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(r),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,r){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw F(ol);return new Jo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,r||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!ir.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case it.NONE:case it.CONSENT:case it.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new JN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new ZN(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new ox(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new BE(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new sx(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new cx(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,be.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return PE(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}handleAccountCacheChange(e){var t;try{(t=e.key)!=null&&t.includes(et.ACTIVE_ACCOUNT_FILTERS)&&this.eventHandler.emitEvent(z.ACTIVE_ACCOUNT_CHANGED);const r=e.newValue||e.oldValue;if(!r)return;const i=JSON.parse(r);if(typeof i!="object"||!Ze.isAccountEntity(i))return;const s=ds.toObject(new Ze,i).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.eventHandler.emitEvent(z.ACCOUNT_ADDED,void 0,s)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.eventHandler.emitEvent(z.ACCOUNT_REMOVED,void 0,s))}catch{return}}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e!=null&&e.correlationId?e.correlationId:this.isBrowserEnvironment?Mr():A.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||rv})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||rv})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),r=this.performanceClient.startMeasurement(T.AcquireTokenSilent,t);r.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Hl(this.initialized,r),this.logger.verbose("acquireTokenSilent called",t);const i=e.account||this.getActiveAccount();if(!i)throw F(dE);r.add({accountType:Jn(i)});const o={clientId:this.config.auth.clientId,authority:e.authority||A.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:i.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},s=JSON.stringify(o),a=this.activeSilentTokenRequests.get(s);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);const l=P(this.acquireTokenSilentAsync.bind(this),T.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)({...e,correlationId:t},i).then(c=>(this.activeSilentTokenRequests.delete(s),r.end({success:!0,fromCache:c.fromCache,isNativeBroker:c.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length}),c)).catch(c=>{throw this.activeSilentTokenRequests.delete(s),r.end({success:!1},c),c});return this.activeSilentTokenRequests.set(s,l),{...await l,state:e.state}}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),r.discard(),{...await a,state:e.state}}async acquireTokenSilentAsync(e,t){const r=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(T.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,$.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",r);const i=await P(BN,T.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||on.Default;return this.acquireTokenSilentNoIframe(i,o).catch(async a=>{if(ux(a,o))if(this.activeIframeRequest)if(o!==on.Skip){const[c,u]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${u}`,i.correlationId);const d=this.performanceClient.startMeasurement(T.AwaitConcurrentIframe,i.correlationId);d.add({awaitIframeCorrelationId:u});const h=await c;if(d.end({success:h}),h)return this.logger.verbose(`Parallel iframe request with correlationId: ${u} succeeded. Retrying cache and/or RT redemption`,i.correlationId),this.acquireTokenSilentNoIframe(i,o);throw this.logger.info(`Iframe request with correlationId: ${u} failed. Interaction is required.`),a}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",i.correlationId),P(this.acquireTokenBySilentIframe.bind(this),T.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i);else{let c;return this.activeIframeRequest=[new Promise(u=>{c=u}),i.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",i.correlationId),P(this.acquireTokenBySilentIframe.bind(this),T.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i).then(u=>(c(!0),u)).catch(u=>{throw c(!1),u}).finally(()=>{this.activeIframeRequest=void 0})}else throw a}).then(a=>(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,$.Silent,a),e.correlationId&&this.performanceClient.addFields({fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker},e.correlationId),a)).catch(a=>{throw this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,$.Silent,null,a),a}).finally(()=>{document.removeEventListener("visibilitychange",r)})}async acquireTokenSilentNoIframe(e,t){return ir.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,be.acquireTokenSilent_silentFlow).catch(async r=>{throw r instanceof rr&&ko(r)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,O(wr)):r})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),P(this.acquireTokenFromCache.bind(this),T.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(r=>{if(t===on.AccessToken)throw r;return this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_NETWORK_START,$.Silent,e),P(this.acquireTokenByRefreshToken.bind(this),T.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}}function ux(n,e){const t=!(n instanceof Kn&&n.subError!==zu),r=n.errorCode===cn.INVALID_GRANT_ERROR||n.errorCode===wr,i=t&&r||n.errorCode===$c||n.errorCode===wm,o=G1.includes(e);return i&&o}/*! @azure/msal-browser v3.28.1 2025-01-14 */async function dx(n,e){const t=new ro(n);return await t.initialize(),Gu.createController(t,e)}/*! @azure/msal-browser v3.28.1 2025-01-14 */class qu{static async createPublicClientApplication(e){const t=await dx(e);return new qu(e,t)}constructor(e,t){this.controller=t||new Gu(new ro(e))}async initialize(e){return this.controller.initialize(e)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}/*! @azure/msal-browser v3.28.1 2025-01-14 */const hx={initialize:()=>Promise.reject($e(Ke)),acquireTokenPopup:()=>Promise.reject($e(Ke)),acquireTokenRedirect:()=>Promise.reject($e(Ke)),acquireTokenSilent:()=>Promise.reject($e(Ke)),acquireTokenByCode:()=>Promise.reject($e(Ke)),getAllAccounts:()=>[],getAccount:()=>null,getAccountByHomeId:()=>null,getAccountByUsername:()=>null,getAccountByLocalId:()=>null,handleRedirectPromise:()=>Promise.reject($e(Ke)),loginPopup:()=>Promise.reject($e(Ke)),loginRedirect:()=>Promise.reject($e(Ke)),logout:()=>Promise.reject($e(Ke)),logoutRedirect:()=>Promise.reject($e(Ke)),logoutPopup:()=>Promise.reject($e(Ke)),ssoSilent:()=>Promise.reject($e(Ke)),addEventCallback:()=>null,removeEventCallback:()=>{},addPerformanceCallback:()=>"",removePerformanceCallback:()=>!1,enableAccountStorageEvents:()=>{},disableAccountStorageEvents:()=>{},getTokenCache:()=>{throw $e(Ke)},getLogger:()=>{throw $e(Ke)},setLogger:()=>{},setActiveAccount:()=>{},getActiveAccount:()=>null,initializeWrapperLibrary:()=>{},setNavigationClient:()=>{},getConfiguration:()=>{throw $e(Ke)},hydrateCache:()=>Promise.reject($e(Ke)),clearCache:()=>Promise.reject($e(Ke))};/*! @azure/msal-browser v3.28.1 2025-01-14 */class fx{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case z.LOGIN_START:return tt.Login;case z.SSO_SILENT_START:return tt.SsoSilent;case z.ACQUIRE_TOKEN_START:if(e.interactionType===$.Redirect||e.interactionType===$.Popup)return tt.AcquireToken;break;case z.HANDLE_REDIRECT_START:return tt.HandleRedirect;case z.LOGOUT_START:return tt.Logout;case z.SSO_SILENT_SUCCESS:case z.SSO_SILENT_FAILURE:if(t&&t!==tt.SsoSilent)break;return tt.None;case z.LOGOUT_END:if(t&&t!==tt.Logout)break;return tt.None;case z.HANDLE_REDIRECT_END:if(t&&t!==tt.HandleRedirect)break;return tt.None;case z.LOGIN_SUCCESS:case z.LOGIN_FAILURE:case z.ACQUIRE_TOKEN_SUCCESS:case z.ACQUIRE_TOKEN_FAILURE:case z.RESTORE_FROM_BFCACHE:if(e.interactionType===$.Redirect||e.interactionType===$.Popup){if(t&&t!==tt.Login&&t!==tt.AcquireToken)break;return tt.None}break}return null}}/*! @azure/msal-react v2.2.0 2024-11-05 */const px={instance:hx,inProgress:tt.None,accounts:[],logger:new Or({})},Hm=S.createContext(px);Hm.Consumer;/*! @azure/msal-react v2.2.0 2024-11-05 */function dv(n,e){if(n.length!==e.length)return!1;const t=[...e];return n.every(r=>{const i=t.shift();return!r||!i?!1:r.homeAccountId===i.homeAccountId&&r.localAccountId===i.localAccountId&&r.username===i.username})}/*! @azure/msal-react v2.2.0 2024-11-05 */const mx="@azure/msal-react",hv="2.2.0";/*! @azure/msal-react v2.2.0 2024-11-05 */const qc={UNBLOCK_INPROGRESS:"UNBLOCK_INPROGRESS",EVENT:"EVENT"},gx=(n,e)=>{const{type:t,payload:r}=e;let i=n.inProgress;switch(t){case qc.UNBLOCK_INPROGRESS:n.inProgress===tt.Startup&&(i=tt.None,r.logger.info("MsalProvider - handleRedirectPromise resolved, setting inProgress to 'none'"));break;case qc.EVENT:const s=r.message,a=fx.getInteractionStatusFromEvent(s,n.inProgress);a&&(r.logger.info(`MsalProvider - ${s.eventType} results in setting inProgress from ${n.inProgress} to ${a}`),i=a);break;default:throw new Error(`Unknown action type: ${t}`)}const o=r.instance.getAllAccounts();return i!==n.inProgress&&!dv(o,n.accounts)?{...n,inProgress:i,accounts:o}:i!==n.inProgress?{...n,inProgress:i}:dv(o,n.accounts)?n:{...n,accounts:o}};function yx({instance:n,children:e}){S.useEffect(()=>{n.initializeWrapperLibrary($1.React,hv)},[n]);const t=S.useMemo(()=>n.getLogger().clone(mx,hv),[n]),[r,i]=S.useReducer(gx,void 0,()=>({inProgress:tt.Startup,accounts:n.getAllAccounts()}));S.useEffect(()=>{const s=n.addEventCallback(a=>{i({payload:{instance:n,logger:t,message:a},type:qc.EVENT})});return t.verbose(`MsalProvider - Registered event callback with id: ${s}`),n.initialize().then(()=>{n.handleRedirectPromise().catch(()=>{}).finally(()=>{i({payload:{instance:n,logger:t},type:qc.UNBLOCK_INPROGRESS})})}).catch(()=>{}),()=>{s&&(t.verbose(`MsalProvider - Removing event callback ${s}`),n.removeEventCallback(s))}},[n,t]);const o={instance:n,inProgress:r.inProgress,accounts:r.accounts,logger:t};return re.createElement(Hm.Provider,{value:o},e)}/*! @azure/msal-react v2.2.0 2024-11-05 */const Fm=()=>S.useContext(Hm),KE={auth:{clientId:"9d415839-9ee7-4830-8dc3-ccf5a34af2b9",authority:"https://login.microsoftonline.com/54df8ee5-42ab-4c14-b444-1b54f749b225",redirectUri:window.location.origin},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!1}},Qc={scopes:["User.Read","User.ReadBasic.All","People.Read"]};function ve(n,e,t,r){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{c(r.next(u))}catch(d){s(d)}}function l(u){try{c(r.throw(u))}catch(d){s(d)}}function c(u){u.done?o(u.value):i(u.value).then(a,l)}c((r=r.apply(n,e||[])).next())})}var an;(function(n){n.GET="GET",n.PATCH="PATCH",n.POST="POST",n.PUT="PUT",n.DELETE="DELETE"})(an||(an={}));const vx="v1.0",Cx="https://graph.microsoft.com/",Sx=new Set(["graph.microsoft.com","graph.microsoft.us","dod-graph.microsoft.us","graph.microsoft.de","microsoftgraph.chinacloudapi.cn","canary.graph.microsoft.com"]);class io extends Error{static setGraphClientError(e){let t;return e instanceof Error?t=e:(t=new io,t.customError=e),t}constructor(e){super(e),Object.setPrototypeOf(this,io.prototype)}}const wx=["$select","$expand","$orderby","$filter","$top","$skip","$skipToken","$count"],Tx=n=>{const e=o=>o.replace(/\/+$/,""),t=o=>o.replace(/^\/+/,""),r=(o,s)=>[e(o),t(s)].join("/");return Array.prototype.slice.call(n).reduce(r)},Gd=n=>{const e=n&&n.constructor&&n.constructor.name;if(e==="Buffer"||e==="Blob"||e==="File"||e==="FormData"||typeof n=="string")return n;if(e==="ArrayBuffer")n=Buffer.from(n);else if(e==="Int8Array"||e==="Int16Array"||e==="Int32Array"||e==="Uint8Array"||e==="Uint16Array"||e==="Uint32Array"||e==="Uint8ClampedArray"||e==="Float32Array"||e==="Float64Array"||e==="DataView")n=Buffer.from(n.buffer);else try{n=JSON.stringify(n)}catch{throw new Error("Unable to stringify the content")}return n},$E=n=>WE(n),VE=(n,e)=>(e.forEach(t=>Ex(t)),WE(n,e)),WE=(n,e=Sx)=>{if(n=n.toLowerCase(),n.indexOf("https://")!==-1){n=n.replace("https://","");const t=n.indexOf(":"),r=n.indexOf("/");let i="";if(r!==-1)return t!==-1&&t<r?(i=n.substring(0,t),e.has(i)):(i=n.substring(0,r),e.has(i))}return!1},Ex=n=>{if(n.indexOf("/")!==-1)throw new io("Please add only hosts or hostnames to the CustomHosts config. If the url is `http://example.com:3000/`, host is `example:3000`")};class oo{constructor(e=[]){this.middlewareOptions=new Map;for(const t of e){const r=t.constructor;this.middlewareOptions.set(r,t)}}getMiddlewareOptions(e){return this.middlewareOptions.get(e)}setMiddlewareOptions(e,t){this.middlewareOptions.set(e,t)}}const kx=()=>{let n="";for(let e=0;e<32;e++)(e===8||e===12||e===16||e===20)&&(n+="-"),n+=Math.floor(Math.random()*16).toString(16);return n},GE=(n,e,t)=>{let r=null;if(typeof Request<"u"&&n instanceof Request)r=n.headers.get(t);else if(typeof e<"u"&&e.headers!==void 0)if(typeof Headers<"u"&&e.headers instanceof Headers)r=e.headers.get(t);else if(e.headers instanceof Array){const i=e.headers;for(let o=0,s=i.length;o<s;o++)if(i[o][0]===t){r=i[o][1];break}}else e.headers[t]!==void 0&&(r=e.headers[t]);return r},qE=(n,e,t,r)=>{if(typeof Request<"u"&&n instanceof Request)n.headers.set(t,r);else if(typeof e<"u")if(e.headers===void 0)e.headers=new Headers({[t]:r});else if(typeof Headers<"u"&&e.headers instanceof Headers)e.headers.set(t,r);else if(e.headers instanceof Array){let i=0;const o=e.headers.length;for(;i<o;i++){const s=e.headers[i];if(s[0]===t){s[1]=r;break}}i===o&&e.headers.push([t,r])}else Object.assign(e.headers,{[t]:r})},QE=(n,e,t,r)=>{typeof Request<"u"&&n instanceof Request?n.headers.append(t,r):typeof e<"u"&&(e.headers===void 0?e.headers=new Headers({[t]:r}):typeof Headers<"u"&&e.headers instanceof Headers?e.headers.append(t,r):e.headers instanceof Array?e.headers.push([t,r]):e.headers===void 0?e.headers={[t]:r}:e.headers[t]===void 0?e.headers[t]=r:e.headers[t]+=`, ${r}`)},Ix=(n,e)=>ve(void 0,void 0,void 0,function*(){const t=e.headers.get("Content-Type")?yield e.blob():yield Promise.resolve(void 0),{method:r,headers:i,referrer:o,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:f}=e;return new Request(n,{method:r,headers:i,body:t,referrer:o,referrerPolicy:s,mode:a,credentials:l,cache:c,redirect:u,integrity:d,keepalive:h,signal:f})});class Ax{constructor(e,t){this.authenticationProvider=e,this.authenticationProviderOptions=t}}var ps;(function(n){n[n.NONE=0]="NONE",n[n.REDIRECT_HANDLER_ENABLED=1]="REDIRECT_HANDLER_ENABLED",n[n.RETRY_HANDLER_ENABLED=2]="RETRY_HANDLER_ENABLED",n[n.AUTHENTICATION_HANDLER_ENABLED=4]="AUTHENTICATION_HANDLER_ENABLED"})(ps||(ps={}));class pi{constructor(){this.featureUsage=ps.NONE}static updateFeatureUsageFlag(e,t){let r;e.middlewareControl instanceof oo?r=e.middlewareControl.getMiddlewareOptions(pi):e.middlewareControl=new oo,typeof r>"u"&&(r=new pi,e.middlewareControl.setMiddlewareOptions(pi,r)),r.setFeatureUsage(t)}setFeatureUsage(e){this.featureUsage=this.featureUsage|e}getFeatureUsage(){return this.featureUsage.toString(16)}}class Ba{constructor(e){this.authenticationProvider=e}execute(e){return ve(this,void 0,void 0,function*(){const t=typeof e.request=="string"?e.request:e.request.url;if($E(t)||e.customHosts&&VE(t,e.customHosts)){let r;e.middlewareControl instanceof oo&&(r=e.middlewareControl.getMiddlewareOptions(Ax));let i,o;r&&(i=r.authenticationProvider,o=r.authenticationProviderOptions),i||(i=this.authenticationProvider);const a=`Bearer ${yield i.getAccessToken(o)}`;QE(e.request,e.options,Ba.AUTHORIZATION_HEADER,a),pi.updateFeatureUsageFlag(e,ps.AUTHENTICATION_HANDLER_ENABLED)}else e.options.headers&&delete e.options.headers[Ba.AUTHORIZATION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}Ba.AUTHORIZATION_HEADER="Authorization";class bx{execute(e){return ve(this,void 0,void 0,function*(){e.response=yield fetch(e.request,e.options)})}}class Pe{constructor(e=Pe.DEFAULT_DELAY,t=Pe.DEFAULT_MAX_RETRIES,r=Pe.defaultShouldRetry){if(e>Pe.MAX_DELAY&&t>Pe.MAX_MAX_RETRIES){const i=new Error(`Delay and MaxRetries should not be more than ${Pe.MAX_DELAY} and ${Pe.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e>Pe.MAX_DELAY){const i=new Error(`Delay should not be more than ${Pe.MAX_DELAY}`);throw i.name="MaxLimitExceeded",i}else if(t>Pe.MAX_MAX_RETRIES){const i=new Error(`MaxRetries should not be more than ${Pe.MAX_MAX_RETRIES}`);throw i.name="MaxLimitExceeded",i}else if(e<0&&t<0){const i=new Error("Delay and MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}else if(e<0){const i=new Error("Delay should not be negative");throw i.name="MinExpectationNotMet",i}else if(t<0){const i=new Error("MaxRetries should not be negative");throw i.name="MinExpectationNotMet",i}this.delay=Math.min(e,Pe.MAX_DELAY),this.maxRetries=Math.min(t,Pe.MAX_MAX_RETRIES),this.shouldRetry=r}getMaxDelay(){return Pe.MAX_DELAY}}Pe.DEFAULT_DELAY=3;Pe.DEFAULT_MAX_RETRIES=3;Pe.MAX_DELAY=180;Pe.MAX_MAX_RETRIES=10;Pe.defaultShouldRetry=()=>!0;class mi{constructor(e=new Pe){this.options=e}isRetry(e){return mi.RETRY_STATUS_CODES.indexOf(e.status)!==-1}isBuffered(e,t){const r=typeof e=="string"?t.method:e.method;return!((r===an.PUT||r===an.PATCH||r===an.POST)&&GE(e,t,"Content-Type")==="application/octet-stream")}getDelay(e,t,r){const i=()=>Number(Math.random().toFixed(3)),o=e.headers!==void 0?e.headers.get(mi.RETRY_AFTER_HEADER):null;let s;return o!==null?Number.isNaN(Number(o))?s=Math.round((new Date(o).getTime()-Date.now())/1e3):s=Number(o):s=t>=2?this.getExponentialBackOffTime(t)+r+i():r+i(),Math.min(s,this.options.getMaxDelay()+i())}getExponentialBackOffTime(e){return Math.round(1/2*(Math.pow(2,e)-1))}sleep(e){return ve(this,void 0,void 0,function*(){const t=e*1e3;return new Promise(r=>setTimeout(r,t))})}getOptions(e){let t;return e.middlewareControl instanceof oo&&(t=e.middlewareControl.getMiddlewareOptions(this.options.constructor)),typeof t>"u"&&(t=Object.assign(new Pe,this.options)),t}executeWithRetry(e,t,r){return ve(this,void 0,void 0,function*(){if(yield this.nextMiddleware.execute(e),t<r.maxRetries&&this.isRetry(e.response)&&this.isBuffered(e.request,e.options)&&r.shouldRetry(r.delay,t,e.request,e.options,e.response)){++t,qE(e.request,e.options,mi.RETRY_ATTEMPT_HEADER,t.toString());const i=this.getDelay(e.response,t,r.delay);return yield this.sleep(i),yield this.executeWithRetry(e,t,r)}else return})}execute(e){return ve(this,void 0,void 0,function*(){const r=this.getOptions(e);return pi.updateFeatureUsageFlag(e,ps.RETRY_HANDLER_ENABLED),yield this.executeWithRetry(e,0,r)})}setNext(e){this.nextMiddleware=e}}mi.RETRY_STATUS_CODES=[429,503,504];mi.RETRY_ATTEMPT_HEADER="Retry-Attempt";mi.RETRY_AFTER_HEADER="Retry-After";class An{constructor(e=An.DEFAULT_MAX_REDIRECTS,t=An.defaultShouldRedirect){if(e>An.MAX_MAX_REDIRECTS){const r=new Error(`MaxRedirects should not be more than ${An.MAX_MAX_REDIRECTS}`);throw r.name="MaxLimitExceeded",r}if(e<0){const r=new Error("MaxRedirects should not be negative");throw r.name="MinExpectationNotMet",r}this.maxRedirects=e,this.shouldRedirect=t}}An.DEFAULT_MAX_REDIRECTS=5;An.MAX_MAX_REDIRECTS=20;An.defaultShouldRedirect=()=>!0;class un{constructor(e=new An){this.options=e}isRedirect(e){return un.REDIRECT_STATUS_CODES.indexOf(e.status)!==-1}hasLocationHeader(e){return e.headers.has(un.LOCATION_HEADER)}getLocationHeader(e){return e.headers.get(un.LOCATION_HEADER)}isRelativeURL(e){return e.indexOf("://")===-1}shouldDropAuthorizationHeader(e,t){const r=/^[A-Za-z].+?:\/\/.+?(?=\/|$)/,i=r.exec(e);let o,s;i!==null&&(o=i[0]);const a=r.exec(t);return a!==null&&(s=a[0]),typeof o<"u"&&typeof s<"u"&&o!==s}updateRequestUrl(e,t){return ve(this,void 0,void 0,function*(){t.request=typeof t.request=="string"?e:yield Ix(e,t.request)})}getOptions(e){let t;return e.middlewareControl instanceof oo&&(t=e.middlewareControl.getMiddlewareOptions(An)),typeof t>"u"&&(t=Object.assign(new An,this.options)),t}executeWithRedirect(e,t,r){return ve(this,void 0,void 0,function*(){yield this.nextMiddleware.execute(e);const i=e.response;if(t<r.maxRedirects&&this.isRedirect(i)&&this.hasLocationHeader(i)&&r.shouldRedirect(i)){if(++t,i.status===un.STATUS_CODE_SEE_OTHER)e.options.method=an.GET,delete e.options.body;else{const o=this.getLocationHeader(i);!this.isRelativeURL(o)&&this.shouldDropAuthorizationHeader(i.url,o)&&delete e.options.headers[un.AUTHORIZATION_HEADER],yield this.updateRequestUrl(o,e)}yield this.executeWithRedirect(e,t,r)}else return})}execute(e){return ve(this,void 0,void 0,function*(){const r=this.getOptions(e);return e.options.redirect=un.MANUAL_REDIRECT,pi.updateFeatureUsageFlag(e,ps.REDIRECT_HANDLER_ENABLED),yield this.executeWithRedirect(e,0,r)})}setNext(e){this.nextMiddleware=e}}un.REDIRECT_STATUS_CODES=[301,302,303,307,308];un.STATUS_CODE_SEE_OTHER=303;un.LOCATION_HEADER="Location";un.AUTHORIZATION_HEADER="Authorization";un.MANUAL_REDIRECT="manual";const Rx="3.0.7";class ln{execute(e){return ve(this,void 0,void 0,function*(){const t=typeof e.request=="string"?e.request:e.request.url;if($E(t)||e.customHosts&&VE(t,e.customHosts)){let r=GE(e.request,e.options,ln.CLIENT_REQUEST_ID_HEADER);r||(r=kx(),qE(e.request,e.options,ln.CLIENT_REQUEST_ID_HEADER,r));let i=`${ln.PRODUCT_NAME}/${Rx}`,o;if(e.middlewareControl instanceof oo&&(o=e.middlewareControl.getMiddlewareOptions(pi)),o){const s=o.getFeatureUsage();i+=` (${ln.FEATURE_USAGE_STRING}=${s})`}QE(e.request,e.options,ln.SDK_VERSION_HEADER,i)}else delete e.options.headers[ln.CLIENT_REQUEST_ID_HEADER],delete e.options.headers[ln.SDK_VERSION_HEADER];return yield this.nextMiddleware.execute(e)})}setNext(e){this.nextMiddleware=e}}ln.CLIENT_REQUEST_ID_HEADER="client-request-id";ln.SDK_VERSION_HEADER="SdkVersion";ln.PRODUCT_NAME="graph-js";ln.FEATURE_USAGE_STRING="featureUsage";var fv;(function(n){n[n.MANUAL=0]="MANUAL",n[n.RANDOM=1]="RANDOM"})(fv||(fv={}));var er;(function(n){n.ARRAYBUFFER="arraybuffer",n.BLOB="blob",n.DOCUMENT="document",n.JSON="json",n.RAW="raw",n.STREAM="stream",n.TEXT="text"})(er||(er={}));var Nf;(function(n){n.TEXT_HTML="text/html",n.TEXT_XML="text/xml",n.APPLICATION_XML="application/xml",n.APPLICATION_XHTML="application/xhtml+xml"})(Nf||(Nf={}));var Yc;(function(n){n.TEXT_PLAIN="text/plain",n.APPLICATION_JSON="application/json"})(Yc||(Yc={}));var Jc;(function(n){n.DOCUMENT="^(text\\/(html|xml))|(application\\/(xml|xhtml\\+xml))$",n.IMAGE="^image\\/.+"})(Jc||(Jc={}));class ua{static parseDocumentResponse(e,t){return typeof DOMParser<"u"?new Promise((r,i)=>{e.text().then(o=>{try{const a=new DOMParser().parseFromString(o,t);r(a)}catch(s){i(s)}})}):Promise.resolve(e.body)}static convertResponse(e,t){return ve(this,void 0,void 0,function*(){if(e.status===204)return Promise.resolve();let r;const i=e.headers.get("Content-type");switch(t){case er.ARRAYBUFFER:r=yield e.arrayBuffer();break;case er.BLOB:r=yield e.blob();break;case er.DOCUMENT:r=yield ua.parseDocumentResponse(e,Nf.TEXT_XML);break;case er.JSON:r=yield e.json();break;case er.STREAM:r=yield Promise.resolve(e.body);break;case er.TEXT:r=yield e.text();break;default:if(i!==null){const o=i.split(";")[0];new RegExp(Jc.DOCUMENT).test(o)?r=yield ua.parseDocumentResponse(e,o):new RegExp(Jc.IMAGE).test(o)?r=e.blob():o===Yc.TEXT_PLAIN?r=yield e.text():o===Yc.APPLICATION_JSON?r=yield e.json():r=Promise.resolve(e.body)}else r=Promise.resolve(e.body);break}return r})}static getResponse(e,t,r){return ve(this,void 0,void 0,function*(){if(t===er.RAW)return Promise.resolve(e);{const i=yield ua.convertResponse(e,t);if(e.ok)if(typeof r=="function")r(null,i);else return i;else throw i}})}}class Nx{constructor(e){this.provider=e}getAccessToken(){return ve(this,void 0,void 0,function*(){return new Promise((e,t)=>{this.provider((r,i)=>ve(this,void 0,void 0,function*(){if(i)e(i);else{if(!r){const s="Access token is undefined or empty.						Please provide a valid token.						For more help - https://github.com/microsoftgraph/msgraph-sdk-javascript/blob/dev/docs/CustomAuthenticationProvider.md";r=new io(s)}const o=yield io.setGraphClientError(r);t(o)}}))})})}}class da extends Error{constructor(e=-1,t,r){super(t||r&&r.message),Object.setPrototypeOf(this,da.prototype),this.statusCode=e,this.code=null,this.requestId=null,this.date=new Date,this.body=null,this.stack=r?r.stack:this.stack}}class Xc{static constructError(e,t,r){const i=new da(t,"",e);return e.name!==void 0&&(i.code=e.name),i.body=e.toString(),i.date=new Date,i.headers=r==null?void 0:r.headers,i}static constructErrorFromResponse(e,t,r){const i=e.error,o=new da(t,i.message);return o.code=i.code,i.innerError!==void 0&&(o.requestId=i.innerError["request-id"],o.date=new Date(i.innerError.date)),o.body=JSON.stringify(i),o.headers=r==null?void 0:r.headers,o}static getError(e=null,t=-1,r,i){return ve(this,void 0,void 0,function*(){let o;if(e&&e.error?o=Xc.constructErrorFromResponse(e,t,i):e instanceof Error?o=Xc.constructError(e,t,i):(o=new da(t),o.body=e),typeof r=="function")r(o,null);else return o})}}class xx{constructor(e,t,r){this.parsePath=i=>{if(i.indexOf("https://")!==-1){i=i.replace("https://","");const s=i.indexOf("/");s!==-1&&(this.urlComponents.host="https://"+i.substring(0,s),i=i.substring(s+1,i.length));const a=i.indexOf("/");a!==-1&&(this.urlComponents.version=i.substring(0,a),i=i.substring(a+1,i.length))}i.charAt(0)==="/"&&(i=i.substr(1));const o=i.indexOf("?");if(o===-1)this.urlComponents.path=i;else{this.urlComponents.path=i.substr(0,o);const s=i.substring(o+1,i.length).split("&");for(const a of s)this.parseQueryParameter(a)}},this.httpClient=e,this.config=t,this.urlComponents={host:this.config.baseUrl,version:this.config.defaultVersion,oDataQueryParams:{},otherURLQueryParams:{},otherURLQueryOptions:[]},this._headers={},this._options={},this._middlewareOptions=[],this.parsePath(r)}addCsvQueryParameter(e,t,r){this.urlComponents.oDataQueryParams[e]=this.urlComponents.oDataQueryParams[e]?this.urlComponents.oDataQueryParams[e]+",":"";let i=[];r.length>1&&typeof t=="string"?i=Array.prototype.slice.call(r):typeof t=="string"?i.push(t):i=i.concat(t),this.urlComponents.oDataQueryParams[e]+=i.join(",")}buildFullUrl(){const e=Tx([this.urlComponents.host,this.urlComponents.version,this.urlComponents.path])+this.createQueryString();return this.config.debugLogging&&console.log(e),e}createQueryString(){const e=this.urlComponents,t=[];if(Object.keys(e.oDataQueryParams).length!==0)for(const r in e.oDataQueryParams)Object.prototype.hasOwnProperty.call(e.oDataQueryParams,r)&&t.push(r+"="+e.oDataQueryParams[r]);if(Object.keys(e.otherURLQueryParams).length!==0)for(const r in e.otherURLQueryParams)Object.prototype.hasOwnProperty.call(e.otherURLQueryParams,r)&&t.push(r+"="+e.otherURLQueryParams[r]);if(e.otherURLQueryOptions.length!==0)for(const r of e.otherURLQueryOptions)t.push(r);return t.length>0?"?"+t.join("&"):""}parseQueryParameter(e){if(typeof e=="string")if(e.charAt(0)==="?"&&(e=e.substring(1)),e.indexOf("&")!==-1){const t=e.split("&");for(const r of t)this.parseQueryParamenterString(r)}else this.parseQueryParamenterString(e);else if(e.constructor===Object)for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&this.setURLComponentsQueryParamater(t,e[t]);return this}parseQueryParamenterString(e){if(this.isValidQueryKeyValuePair(e)){const t=e.indexOf("="),r=e.substring(0,t),i=e.substring(t+1);this.setURLComponentsQueryParamater(r,i)}else this.urlComponents.otherURLQueryOptions.push(e)}setURLComponentsQueryParamater(e,t){if(wx.indexOf(e)!==-1){const r=this.urlComponents.oDataQueryParams[e],i=r&&(e==="$expand"||e==="$select"||e==="$orderby");this.urlComponents.oDataQueryParams[e]=i?r+","+t:t}else this.urlComponents.otherURLQueryParams[e]=t}isValidQueryKeyValuePair(e){const t=e.indexOf("=");return!(t===-1||e.indexOf("(")!==-1&&e.indexOf("(")<t)}updateRequestOptions(e){const t=Object.assign({},e.headers);if(this.config.fetchOptions!==void 0){const r=Object.assign({},this.config.fetchOptions);Object.assign(e,r),typeof this.config.fetchOptions.headers!==void 0&&(e.headers=Object.assign({},this.config.fetchOptions.headers))}Object.assign(e,this._options),e.headers!==void 0&&Object.assign(t,e.headers),Object.assign(t,this._headers),e.headers=t}send(e,t,r){var i;return ve(this,void 0,void 0,function*(){let o;const s=new oo(this._middlewareOptions);this.updateRequestOptions(t);const a=(i=this.config)===null||i===void 0?void 0:i.customHosts;try{return o=(yield this.httpClient.sendRequest({request:e,options:t,middlewareControl:s,customHosts:a})).response,yield ua.getResponse(o,this._responseType,r)}catch(l){if(l instanceof io)throw l;let c;throw o&&(c=o.status),yield Xc.getError(l,c,r,o)}})}setHeaderContentType(){if(!this._headers){this.header("Content-Type","application/json");return}const e=Object.keys(this._headers);for(const t of e)if(t.toLowerCase()==="content-type")return;this.header("Content-Type","application/json")}header(e,t){return this._headers[e]=t,this}headers(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._headers[t]=e[t]);return this}option(e,t){return this._options[e]=t,this}options(e){for(const t in e)Object.prototype.hasOwnProperty.call(e,t)&&(this._options[t]=e[t]);return this}middlewareOptions(e){return this._middlewareOptions=e,this}version(e){return this.urlComponents.version=e,this}responseType(e){return this._responseType=e,this}select(e){return this.addCsvQueryParameter("$select",e,arguments),this}expand(e){return this.addCsvQueryParameter("$expand",e,arguments),this}orderby(e){return this.addCsvQueryParameter("$orderby",e,arguments),this}filter(e){return this.urlComponents.oDataQueryParams.$filter=e,this}search(e){return this.urlComponents.oDataQueryParams.$search=e,this}top(e){return this.urlComponents.oDataQueryParams.$top=e,this}skip(e){return this.urlComponents.oDataQueryParams.$skip=e,this}skipToken(e){return this.urlComponents.oDataQueryParams.$skipToken=e,this}count(e=!0){return this.urlComponents.oDataQueryParams.$count=e.toString(),this}query(e){return this.parseQueryParameter(e)}get(e){return ve(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:an.GET};return yield this.send(t,r,e)})}post(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl(),i={method:an.POST,body:Gd(e)};return(e&&e.constructor&&e.constructor.name)==="FormData"?i.headers={}:(this.setHeaderContentType(),i.headers=this._headers),yield this.send(r,i,t)})}create(e,t){return ve(this,void 0,void 0,function*(){return yield this.post(e,t)})}put(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const i={method:an.PUT,body:Gd(e)};return yield this.send(r,i,t)})}patch(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl();this.setHeaderContentType();const i={method:an.PATCH,body:Gd(e)};return yield this.send(r,i,t)})}update(e,t){return ve(this,void 0,void 0,function*(){return yield this.patch(e,t)})}delete(e){return ve(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:an.DELETE};return yield this.send(t,r,e)})}del(e){return ve(this,void 0,void 0,function*(){return yield this.delete(e)})}getStream(e){return ve(this,void 0,void 0,function*(){const t=this.buildFullUrl(),r={method:an.GET};return this.responseType(er.STREAM),yield this.send(t,r,e)})}putStream(e,t){return ve(this,void 0,void 0,function*(){const r=this.buildFullUrl(),i={method:an.PUT,headers:{"Content-Type":"application/octet-stream"},body:e};return yield this.send(r,i,t)})}}class YE{constructor(...e){if(!e||!e.length){const t=new Error;throw t.name="InvalidMiddlewareChain",t.message="Please provide a default middleware chain or custom middleware chain",t}this.setMiddleware(...e)}setMiddleware(...e){e.length>1?this.parseMiddleWareArray(e):this.middleware=e[0]}parseMiddleWareArray(e){e.forEach((t,r)=>{r<e.length-1&&t.setNext(e[r+1])}),this.middleware=e[0]}sendRequest(e){return ve(this,void 0,void 0,function*(){if(typeof e.request=="string"&&e.options===void 0){const t=new Error;throw t.name="InvalidRequestOptions",t.message="Unable to execute the middleware, Please provide valid options for a request",t}return yield this.middleware.execute(e),e})}}const Ox=()=>typeof process=="object"&&typeof require=="function";class Bm{static createWithAuthenticationProvider(e){const t=new Ba(e),r=new mi(new Pe),i=new ln,o=new bx;if(t.setNext(r),Ox()){const s=new un(new An);r.setNext(s),s.setNext(i)}else r.setNext(i);return i.setNext(o),Bm.createWithMiddleware(t)}static createWithMiddleware(...e){return new YE(...e)}}const Mx=()=>{if(typeof Promise>"u"&&typeof fetch>"u"){const n=new Error("Library cannot function without Promise and fetch. So, please provide polyfill for them.");throw n.name="PolyFillNotAvailable",n}else if(typeof Promise>"u"){const n=new Error("Library cannot function without Promise. So, please provide polyfill for it.");throw n.name="PolyFillNotAvailable",n}else if(typeof fetch>"u"){const n=new Error("Library cannot function without fetch. So, please provide polyfill for it.");throw n.name="PolyFillNotAvailable",n}return!0};class za{static init(e){const t={};for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=r==="authProvider"?new Nx(e[r]):e[r]);return za.initWithMiddleware(t)}static initWithMiddleware(e){return new za(e)}constructor(e){this.config={baseUrl:Cx,debugLogging:!1,defaultVersion:vx},Mx();for(const r in e)Object.prototype.hasOwnProperty.call(e,r)&&(this.config[r]=e[r]);let t;if(e.authProvider!==void 0&&e.middleware!==void 0){const r=new Error;throw r.name="AmbiguityInInitialization",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain not both",r}else if(e.authProvider!==void 0)t=Bm.createWithAuthenticationProvider(e.authProvider);else if(e.middleware!==void 0)t=new YE(...[].concat(e.middleware));else{const r=new Error;throw r.name="InvalidMiddlewareChain",r.message="Unable to Create Client, Please provide either authentication provider for default middleware chain or custom middleware chain",r}this.httpClient=t}api(e){return new xx(this.httpClient,this.config,e)}}const JE=S.createContext(void 0);function _x({children:n}){const{instance:e,accounts:t}=Fm(),[r,i]=S.useState(()=>{const a=localStorage.getItem("userPhotos");return a?JSON.parse(a):{}}),o=a=>r[a.toLowerCase()],s=async a=>{if(!(!t[0]||r[a.toLowerCase()]))try{const l=await e.acquireTokenSilent({...Qc,account:t[0]}),c=za.init({authProvider:u=>{u(null,l.accessToken)}});try{const u=await c.api(`/users/${a}/photo/$value`).get(),d=await new Promise(h=>{const f=new FileReader;f.onloadend=()=>h(f.result),f.readAsDataURL(u)});i(h=>{const f={...h,[a.toLowerCase()]:d};return localStorage.setItem("userPhotos",JSON.stringify(f)),f})}catch(u){console.error(`No photo found for user ${a}:`,u)}}catch(l){console.error(`Error fetching photo for ${a}:`,l)}};return k.jsx(JE.Provider,{value:{getUserPhoto:o,loadUserPhoto:s},children:n})}const Px=()=>{const n=S.useContext(JE);if(!n)throw new Error("useUserPhotos must be used within a UserPhotosProvider");return n};function Dx(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return S.useMemo(()=>r=>{e.forEach(i=>i(r))},e)}const Qu=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function bs(n){const e=Object.prototype.toString.call(n);return e==="[object Window]"||e==="[object global]"}function zm(n){return"nodeType"in n}function Bt(n){var e,t;return n?bs(n)?n:zm(n)&&(e=(t=n.ownerDocument)==null?void 0:t.defaultView)!=null?e:window:window}function jm(n){const{Document:e}=Bt(n);return n instanceof e}function al(n){return bs(n)?!1:n instanceof Bt(n).HTMLElement}function XE(n){return n instanceof Bt(n).SVGElement}function Rs(n){return n?bs(n)?n.document:zm(n)?jm(n)?n:al(n)||XE(n)?n.ownerDocument:document:document:document}const $n=Qu?S.useLayoutEffect:S.useEffect;function Yu(n){const e=S.useRef(n);return $n(()=>{e.current=n}),S.useCallback(function(){for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.current==null?void 0:e.current(...r)},[])}function Lx(){const n=S.useRef(null),e=S.useCallback((r,i)=>{n.current=setInterval(r,i)},[]),t=S.useCallback(()=>{n.current!==null&&(clearInterval(n.current),n.current=null)},[]);return[e,t]}function ja(n,e){e===void 0&&(e=[n]);const t=S.useRef(n);return $n(()=>{t.current!==n&&(t.current=n)},e),t}function ll(n,e){const t=S.useRef();return S.useMemo(()=>{const r=n(t.current);return t.current=r,r},[...e])}function Zc(n){const e=Yu(n),t=S.useRef(null),r=S.useCallback(i=>{i!==t.current&&(e==null||e(i,t.current)),t.current=i},[]);return[t,r]}function eu(n){const e=S.useRef();return S.useEffect(()=>{e.current=n},[n]),e.current}let qd={};function cl(n,e){return S.useMemo(()=>{if(e)return e;const t=qd[n]==null?0:qd[n]+1;return qd[n]=t,n+"-"+t},[n,e])}function ZE(n){return function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),i=1;i<t;i++)r[i-1]=arguments[i];return r.reduce((o,s)=>{const a=Object.entries(s);for(const[l,c]of a){const u=o[l];u!=null&&(o[l]=u+n*c)}return o},{...e})}}const Xo=ZE(1),tu=ZE(-1);function Ux(n){return"clientX"in n&&"clientY"in n}function Ju(n){if(!n)return!1;const{KeyboardEvent:e}=Bt(n.target);return e&&n instanceof e}function Hx(n){if(!n)return!1;const{TouchEvent:e}=Bt(n.target);return e&&n instanceof e}function nu(n){if(Hx(n)){if(n.touches&&n.touches.length){const{clientX:e,clientY:t}=n.touches[0];return{x:e,y:t}}else if(n.changedTouches&&n.changedTouches.length){const{clientX:e,clientY:t}=n.changedTouches[0];return{x:e,y:t}}}return Ux(n)?{x:n.clientX,y:n.clientY}:null}const _r=Object.freeze({Translate:{toString(n){if(!n)return;const{x:e,y:t}=n;return"translate3d("+(e?Math.round(e):0)+"px, "+(t?Math.round(t):0)+"px, 0)"}},Scale:{toString(n){if(!n)return;const{scaleX:e,scaleY:t}=n;return"scaleX("+e+") scaleY("+t+")"}},Transform:{toString(n){if(n)return[_r.Translate.toString(n),_r.Scale.toString(n)].join(" ")}},Transition:{toString(n){let{property:e,duration:t,easing:r}=n;return e+" "+t+"ms "+r}}}),pv="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function Fx(n){return n.matches(pv)?n:n.querySelector(pv)}const Bx={display:"none"};function zx(n){let{id:e,value:t}=n;return re.createElement("div",{id:e,style:Bx},t)}function jx(n){let{id:e,announcement:t,ariaLiveType:r="assertive"}=n;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return re.createElement("div",{id:e,style:i,role:"status","aria-live":r,"aria-atomic":!0},t)}function Kx(){const[n,e]=S.useState("");return{announce:S.useCallback(r=>{r!=null&&e(r)},[]),announcement:n}}const ek=S.createContext(null);function $x(n){const e=S.useContext(ek);S.useEffect(()=>{if(!e)throw new Error("useDndMonitor must be used within a children of <DndContext>");return e(n)},[n,e])}function Vx(){const[n]=S.useState(()=>new Set),e=S.useCallback(r=>(n.add(r),()=>n.delete(r)),[n]);return[S.useCallback(r=>{let{type:i,event:o}=r;n.forEach(s=>{var a;return(a=s[i])==null?void 0:a.call(s,o)})},[n]),e]}const Wx={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},Gx={onDragStart(n){let{active:e}=n;return"Picked up draggable item "+e.id+"."},onDragOver(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was moved over droppable area "+t.id+".":"Draggable item "+e.id+" is no longer over a droppable area."},onDragEnd(n){let{active:e,over:t}=n;return t?"Draggable item "+e.id+" was dropped over droppable area "+t.id:"Draggable item "+e.id+" was dropped."},onDragCancel(n){let{active:e}=n;return"Dragging was cancelled. Draggable item "+e.id+" was dropped."}};function qx(n){let{announcements:e=Gx,container:t,hiddenTextDescribedById:r,screenReaderInstructions:i=Wx}=n;const{announce:o,announcement:s}=Kx(),a=cl("DndLiveRegion"),[l,c]=S.useState(!1);if(S.useEffect(()=>{c(!0)},[]),$x(S.useMemo(()=>({onDragStart(d){let{active:h}=d;o(e.onDragStart({active:h}))},onDragMove(d){let{active:h,over:f}=d;e.onDragMove&&o(e.onDragMove({active:h,over:f}))},onDragOver(d){let{active:h,over:f}=d;o(e.onDragOver({active:h,over:f}))},onDragEnd(d){let{active:h,over:f}=d;o(e.onDragEnd({active:h,over:f}))},onDragCancel(d){let{active:h,over:f}=d;o(e.onDragCancel({active:h,over:f}))}}),[o,e])),!l)return null;const u=re.createElement(re.Fragment,null,re.createElement(zx,{id:r,value:i.draggable}),re.createElement(jx,{id:a,announcement:s}));return t?ei.createPortal(u,t):u}var Je;(function(n){n.DragStart="dragStart",n.DragMove="dragMove",n.DragEnd="dragEnd",n.DragCancel="dragCancel",n.DragOver="dragOver",n.RegisterDroppable="registerDroppable",n.SetDroppableDisabled="setDroppableDisabled",n.UnregisterDroppable="unregisterDroppable"})(Je||(Je={}));function ru(){}function Qx(n,e){return S.useMemo(()=>({sensor:n,options:e??{}}),[n,e])}function Yx(){for(var n=arguments.length,e=new Array(n),t=0;t<n;t++)e[t]=arguments[t];return S.useMemo(()=>[...e].filter(r=>r!=null),[...e])}const Vn=Object.freeze({x:0,y:0});function Jx(n,e){const t=nu(n);if(!t)return"0 0";const r={x:(t.x-e.left)/e.width*100,y:(t.y-e.top)/e.height*100};return r.x+"% "+r.y+"%"}function Xx(n,e){let{data:{value:t}}=n,{data:{value:r}}=e;return r-t}function Zx(n,e){if(!n||n.length===0)return null;const[t]=n;return t[e]}function eO(n,e){const t=Math.max(e.top,n.top),r=Math.max(e.left,n.left),i=Math.min(e.left+e.width,n.left+n.width),o=Math.min(e.top+e.height,n.top+n.height),s=i-r,a=o-t;if(r<i&&t<o){const l=e.width*e.height,c=n.width*n.height,u=s*a,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const tO=n=>{let{collisionRect:e,droppableRects:t,droppableContainers:r}=n;const i=[];for(const o of r){const{id:s}=o,a=t.get(s);if(a){const l=eO(a,e);l>0&&i.push({id:s,data:{droppableContainer:o,value:l}})}}return i.sort(Xx)};function nO(n,e,t){return{...n,scaleX:e&&t?e.width/t.width:1,scaleY:e&&t?e.height/t.height:1}}function tk(n,e){return n&&e?{x:n.left-e.left,y:n.top-e.top}:Vn}function rO(n){return function(t){for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return i.reduce((s,a)=>({...s,top:s.top+n*a.y,bottom:s.bottom+n*a.y,left:s.left+n*a.x,right:s.right+n*a.x}),{...t})}}const iO=rO(1);function nk(n){if(n.startsWith("matrix3d(")){const e=n.slice(9,-1).split(/, /);return{x:+e[12],y:+e[13],scaleX:+e[0],scaleY:+e[5]}}else if(n.startsWith("matrix(")){const e=n.slice(7,-1).split(/, /);return{x:+e[4],y:+e[5],scaleX:+e[0],scaleY:+e[3]}}return null}function oO(n,e,t){const r=nk(e);if(!r)return n;const{scaleX:i,scaleY:o,x:s,y:a}=r,l=n.left-s-(1-i)*parseFloat(t),c=n.top-a-(1-o)*parseFloat(t.slice(t.indexOf(" ")+1)),u=i?n.width/i:n.width,d=o?n.height/o:n.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const sO={ignoreTransform:!1};function Ns(n,e){e===void 0&&(e=sO);let t=n.getBoundingClientRect();if(e.ignoreTransform){const{transform:c,transformOrigin:u}=Bt(n).getComputedStyle(n);c&&(t=oO(t,c,u))}const{top:r,left:i,width:o,height:s,bottom:a,right:l}=t;return{top:r,left:i,width:o,height:s,bottom:a,right:l}}function mv(n){return Ns(n,{ignoreTransform:!0})}function aO(n){const e=n.innerWidth,t=n.innerHeight;return{top:0,left:0,right:e,bottom:t,width:e,height:t}}function lO(n,e){return e===void 0&&(e=Bt(n).getComputedStyle(n)),e.position==="fixed"}function cO(n,e){e===void 0&&(e=Bt(n).getComputedStyle(n));const t=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const o=e[i];return typeof o=="string"?t.test(o):!1})}function Km(n,e){const t=[];function r(i){if(e!=null&&t.length>=e||!i)return t;if(jm(i)&&i.scrollingElement!=null&&!t.includes(i.scrollingElement))return t.push(i.scrollingElement),t;if(!al(i)||XE(i)||t.includes(i))return t;const o=Bt(n).getComputedStyle(i);return i!==n&&cO(i,o)&&t.push(i),lO(i,o)?t:r(i.parentNode)}return n?r(n):t}function rk(n){const[e]=Km(n,1);return e??null}function Qd(n){return!Qu||!n?null:bs(n)?n:zm(n)?jm(n)||n===Rs(n).scrollingElement?window:al(n)?n:null:null}function ik(n){return bs(n)?n.scrollX:n.scrollLeft}function ok(n){return bs(n)?n.scrollY:n.scrollTop}function xf(n){return{x:ik(n),y:ok(n)}}var rt;(function(n){n[n.Forward=1]="Forward",n[n.Backward=-1]="Backward"})(rt||(rt={}));function sk(n){return!Qu||!n?!1:n===document.scrollingElement}function ak(n){const e={x:0,y:0},t=sk(n)?{height:window.innerHeight,width:window.innerWidth}:{height:n.clientHeight,width:n.clientWidth},r={x:n.scrollWidth-t.width,y:n.scrollHeight-t.height},i=n.scrollTop<=e.y,o=n.scrollLeft<=e.x,s=n.scrollTop>=r.y,a=n.scrollLeft>=r.x;return{isTop:i,isLeft:o,isBottom:s,isRight:a,maxScroll:r,minScroll:e}}const uO={x:.2,y:.2};function dO(n,e,t,r,i){let{top:o,left:s,right:a,bottom:l}=t;r===void 0&&(r=10),i===void 0&&(i=uO);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=ak(n),f={x:0,y:0},p={x:0,y:0},m={height:e.height*i.y,width:e.width*i.x};return!c&&o<=e.top+m.height?(f.y=rt.Backward,p.y=r*Math.abs((e.top+m.height-o)/m.height)):!u&&l>=e.bottom-m.height&&(f.y=rt.Forward,p.y=r*Math.abs((e.bottom-m.height-l)/m.height)),!h&&a>=e.right-m.width?(f.x=rt.Forward,p.x=r*Math.abs((e.right-m.width-a)/m.width)):!d&&s<=e.left+m.width&&(f.x=rt.Backward,p.x=r*Math.abs((e.left+m.width-s)/m.width)),{direction:f,speed:p}}function hO(n){if(n===document.scrollingElement){const{innerWidth:o,innerHeight:s}=window;return{top:0,left:0,right:o,bottom:s,width:o,height:s}}const{top:e,left:t,right:r,bottom:i}=n.getBoundingClientRect();return{top:e,left:t,right:r,bottom:i,width:n.clientWidth,height:n.clientHeight}}function lk(n){return n.reduce((e,t)=>Xo(e,xf(t)),Vn)}function fO(n){return n.reduce((e,t)=>e+ik(t),0)}function pO(n){return n.reduce((e,t)=>e+ok(t),0)}function ck(n,e){if(e===void 0&&(e=Ns),!n)return;const{top:t,left:r,bottom:i,right:o}=e(n);rk(n)&&(i<=0||o<=0||t>=window.innerHeight||r>=window.innerWidth)&&n.scrollIntoView({block:"center",inline:"center"})}const mO=[["x",["left","right"],fO],["y",["top","bottom"],pO]];class $m{constructor(e,t){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=Km(t),i=lk(r);this.rect={...e},this.width=e.width,this.height=e.height;for(const[o,s,a]of mO)for(const l of s)Object.defineProperty(this,l,{get:()=>{const c=a(r),u=i[o]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class ha{constructor(e){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(t=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...t)})},this.target=e}add(e,t,r){var i;(i=this.target)==null||i.addEventListener(e,t,r),this.listeners.push([e,t,r])}}function gO(n){const{EventTarget:e}=Bt(n);return n instanceof e?n:Rs(n)}function Yd(n,e){const t=Math.abs(n.x),r=Math.abs(n.y);return typeof e=="number"?Math.sqrt(t**2+r**2)>e:"x"in e&&"y"in e?t>e.x&&r>e.y:"x"in e?t>e.x:"y"in e?r>e.y:!1}var Sn;(function(n){n.Click="click",n.DragStart="dragstart",n.Keydown="keydown",n.ContextMenu="contextmenu",n.Resize="resize",n.SelectionChange="selectionchange",n.VisibilityChange="visibilitychange"})(Sn||(Sn={}));function gv(n){n.preventDefault()}function yO(n){n.stopPropagation()}var he;(function(n){n.Space="Space",n.Down="ArrowDown",n.Right="ArrowRight",n.Left="ArrowLeft",n.Up="ArrowUp",n.Esc="Escape",n.Enter="Enter",n.Tab="Tab"})(he||(he={}));const uk={start:[he.Space,he.Enter],cancel:[he.Esc],end:[he.Space,he.Enter,he.Tab]},vO=(n,e)=>{let{currentCoordinates:t}=e;switch(n.code){case he.Right:return{...t,x:t.x+25};case he.Left:return{...t,x:t.x-25};case he.Down:return{...t,y:t.y+25};case he.Up:return{...t,y:t.y-25}}};class dk{constructor(e){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=e;const{event:{target:t}}=e;this.props=e,this.listeners=new ha(Rs(t)),this.windowListeners=new ha(Bt(t)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(Sn.Resize,this.handleCancel),this.windowListeners.add(Sn.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(Sn.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:e,onStart:t}=this.props,r=e.node.current;r&&ck(r),t(Vn)}handleKeyDown(e){if(Ju(e)){const{active:t,context:r,options:i}=this.props,{keyboardCodes:o=uk,coordinateGetter:s=vO,scrollBehavior:a="smooth"}=i,{code:l}=e;if(o.end.includes(l)){this.handleEnd(e);return}if(o.cancel.includes(l)){this.handleCancel(e);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Vn;this.referenceCoordinates||(this.referenceCoordinates=u);const d=s(e,{active:t,context:r.current,currentCoordinates:u});if(d){const h=tu(d,u),f={x:0,y:0},{scrollableAncestors:p}=r.current;for(const m of p){const v=e.code,{isTop:g,isRight:y,isLeft:C,isBottom:w,maxScroll:E,minScroll:I}=ak(m),b=hO(m),R={x:Math.min(v===he.Right?b.right-b.width/2:b.right,Math.max(v===he.Right?b.left:b.left+b.width/2,d.x)),y:Math.min(v===he.Down?b.bottom-b.height/2:b.bottom,Math.max(v===he.Down?b.top:b.top+b.height/2,d.y))},N=v===he.Right&&!y||v===he.Left&&!C,_=v===he.Down&&!w||v===he.Up&&!g;if(N&&R.x!==d.x){const V=m.scrollLeft+h.x,ue=v===he.Right&&V<=E.x||v===he.Left&&V>=I.x;if(ue&&!h.y){m.scrollTo({left:V,behavior:a});return}ue?f.x=m.scrollLeft-V:f.x=v===he.Right?m.scrollLeft-E.x:m.scrollLeft-I.x,f.x&&m.scrollBy({left:-f.x,behavior:a});break}else if(_&&R.y!==d.y){const V=m.scrollTop+h.y,ue=v===he.Down&&V<=E.y||v===he.Up&&V>=I.y;if(ue&&!h.x){m.scrollTo({top:V,behavior:a});return}ue?f.y=m.scrollTop-V:f.y=v===he.Down?m.scrollTop-E.y:m.scrollTop-I.y,f.y&&m.scrollBy({top:-f.y,behavior:a});break}}this.handleMove(e,Xo(tu(d,this.referenceCoordinates),f))}}}handleMove(e,t){const{onMove:r}=this.props;e.preventDefault(),r(t)}handleEnd(e){const{onEnd:t}=this.props;e.preventDefault(),this.detach(),t()}handleCancel(e){const{onCancel:t}=this.props;e.preventDefault(),this.detach(),t()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}dk.activators=[{eventName:"onKeyDown",handler:(n,e,t)=>{let{keyboardCodes:r=uk,onActivation:i}=e,{active:o}=t;const{code:s}=n.nativeEvent;if(r.start.includes(s)){const a=o.activatorNode.current;return a&&n.target!==a?!1:(n.preventDefault(),i==null||i({event:n.nativeEvent}),!0)}return!1}}];function yv(n){return!!(n&&"distance"in n)}function vv(n){return!!(n&&"delay"in n)}class Vm{constructor(e,t,r){var i;r===void 0&&(r=gO(e.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=e,this.events=t;const{event:o}=e,{target:s}=o;this.props=e,this.events=t,this.document=Rs(s),this.documentListeners=new ha(this.document),this.listeners=new ha(r),this.windowListeners=new ha(Bt(s)),this.initialCoordinates=(i=nu(o))!=null?i:Vn,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:e,props:{options:{activationConstraint:t,bypassActivationConstraint:r}}}=this;if(this.listeners.add(e.move.name,this.handleMove,{passive:!1}),this.listeners.add(e.end.name,this.handleEnd),e.cancel&&this.listeners.add(e.cancel.name,this.handleCancel),this.windowListeners.add(Sn.Resize,this.handleCancel),this.windowListeners.add(Sn.DragStart,gv),this.windowListeners.add(Sn.VisibilityChange,this.handleCancel),this.windowListeners.add(Sn.ContextMenu,gv),this.documentListeners.add(Sn.Keydown,this.handleKeydown),t){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(vv(t)){this.timeoutId=setTimeout(this.handleStart,t.delay),this.handlePending(t);return}if(yv(t)){this.handlePending(t);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(e,t){const{active:r,onPending:i}=this.props;i(r,e,this.initialCoordinates,t)}handleStart(){const{initialCoordinates:e}=this,{onStart:t}=this.props;e&&(this.activated=!0,this.documentListeners.add(Sn.Click,yO,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(Sn.SelectionChange,this.removeTextSelection),t(e))}handleMove(e){var t;const{activated:r,initialCoordinates:i,props:o}=this,{onMove:s,options:{activationConstraint:a}}=o;if(!i)return;const l=(t=nu(e))!=null?t:Vn,c=tu(i,l);if(!r&&a){if(yv(a)){if(a.tolerance!=null&&Yd(c,a.tolerance))return this.handleCancel();if(Yd(c,a.distance))return this.handleStart()}if(vv(a)&&Yd(c,a.tolerance))return this.handleCancel();this.handlePending(a,c);return}e.cancelable&&e.preventDefault(),s(l)}handleEnd(){const{onAbort:e,onEnd:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleCancel(){const{onAbort:e,onCancel:t}=this.props;this.detach(),this.activated||e(this.props.active),t()}handleKeydown(e){e.code===he.Esc&&this.handleCancel()}removeTextSelection(){var e;(e=this.document.getSelection())==null||e.removeAllRanges()}}const CO={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class Wm extends Vm{constructor(e){const{event:t}=e,r=Rs(t.target);super(e,CO,r)}}Wm.activators=[{eventName:"onPointerDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return!t.isPrimary||t.button!==0?!1:(r==null||r({event:t}),!0)}}];const SO={move:{name:"mousemove"},end:{name:"mouseup"}};var Of;(function(n){n[n.RightClick=2]="RightClick"})(Of||(Of={}));class wO extends Vm{constructor(e){super(e,SO,Rs(e.event.target))}}wO.activators=[{eventName:"onMouseDown",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;return t.button===Of.RightClick?!1:(r==null||r({event:t}),!0)}}];const Jd={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class TO extends Vm{constructor(e){super(e,Jd)}static setup(){return window.addEventListener(Jd.move.name,e,{capture:!1,passive:!1}),function(){window.removeEventListener(Jd.move.name,e)};function e(){}}}TO.activators=[{eventName:"onTouchStart",handler:(n,e)=>{let{nativeEvent:t}=n,{onActivation:r}=e;const{touches:i}=t;return i.length>1?!1:(r==null||r({event:t}),!0)}}];var fa;(function(n){n[n.Pointer=0]="Pointer",n[n.DraggableRect=1]="DraggableRect"})(fa||(fa={}));var iu;(function(n){n[n.TreeOrder=0]="TreeOrder",n[n.ReversedTreeOrder=1]="ReversedTreeOrder"})(iu||(iu={}));function EO(n){let{acceleration:e,activator:t=fa.Pointer,canScroll:r,draggingRect:i,enabled:o,interval:s=5,order:a=iu.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=n;const f=IO({delta:d,disabled:!o}),[p,m]=Lx(),v=S.useRef({x:0,y:0}),g=S.useRef({x:0,y:0}),y=S.useMemo(()=>{switch(t){case fa.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case fa.DraggableRect:return i}},[t,i,l]),C=S.useRef(null),w=S.useCallback(()=>{const I=C.current;if(!I)return;const b=v.current.x*g.current.x,R=v.current.y*g.current.y;I.scrollBy(b,R)},[]),E=S.useMemo(()=>a===iu.TreeOrder?[...c].reverse():c,[a,c]);S.useEffect(()=>{if(!o||!c.length||!y){m();return}for(const I of E){if((r==null?void 0:r(I))===!1)continue;const b=c.indexOf(I),R=u[b];if(!R)continue;const{direction:N,speed:_}=dO(I,R,y,e,h);for(const V of["x","y"])f[V][N[V]]||(_[V]=0,N[V]=0);if(_.x>0||_.y>0){m(),C.current=I,p(w,s),v.current=_,g.current=N;return}}v.current={x:0,y:0},g.current={x:0,y:0},m()},[e,w,r,m,o,s,JSON.stringify(y),JSON.stringify(f),p,c,E,u,JSON.stringify(h)])}const kO={x:{[rt.Backward]:!1,[rt.Forward]:!1},y:{[rt.Backward]:!1,[rt.Forward]:!1}};function IO(n){let{delta:e,disabled:t}=n;const r=eu(e);return ll(i=>{if(t||!r||!i)return kO;const o={x:Math.sign(e.x-r.x),y:Math.sign(e.y-r.y)};return{x:{[rt.Backward]:i.x[rt.Backward]||o.x===-1,[rt.Forward]:i.x[rt.Forward]||o.x===1},y:{[rt.Backward]:i.y[rt.Backward]||o.y===-1,[rt.Forward]:i.y[rt.Forward]||o.y===1}}},[t,e,r])}function AO(n,e){const t=e!=null?n.get(e):void 0,r=t?t.node.current:null;return ll(i=>{var o;return e==null?null:(o=r??i)!=null?o:null},[r,e])}function bO(n,e){return S.useMemo(()=>n.reduce((t,r)=>{const{sensor:i}=r,o=i.activators.map(s=>({eventName:s.eventName,handler:e(s.handler,r)}));return[...t,...o]},[]),[n,e])}var Ka;(function(n){n[n.Always=0]="Always",n[n.BeforeDragging=1]="BeforeDragging",n[n.WhileDragging=2]="WhileDragging"})(Ka||(Ka={}));var Mf;(function(n){n.Optimized="optimized"})(Mf||(Mf={}));const Cv=new Map;function RO(n,e){let{dragging:t,dependencies:r,config:i}=e;const[o,s]=S.useState(null),{frequency:a,measure:l,strategy:c}=i,u=S.useRef(n),d=v(),h=ja(d),f=S.useCallback(function(g){g===void 0&&(g=[]),!h.current&&s(y=>y===null?g:y.concat(g.filter(C=>!y.includes(C))))},[h]),p=S.useRef(null),m=ll(g=>{if(d&&!t)return Cv;if(!g||g===Cv||u.current!==n||o!=null){const y=new Map;for(let C of n){if(!C)continue;if(o&&o.length>0&&!o.includes(C.id)&&C.rect.current){y.set(C.id,C.rect.current);continue}const w=C.node.current,E=w?new $m(l(w),w):null;C.rect.current=E,E&&y.set(C.id,E)}return y}return g},[n,o,t,d,l]);return S.useEffect(()=>{u.current=n},[n]),S.useEffect(()=>{d||f()},[t,d]),S.useEffect(()=>{o&&o.length>0&&s(null)},[JSON.stringify(o)]),S.useEffect(()=>{d||typeof a!="number"||p.current!==null||(p.current=setTimeout(()=>{f(),p.current=null},a))},[a,d,f,...r]),{droppableRects:m,measureDroppableContainers:f,measuringScheduled:o!=null};function v(){switch(c){case Ka.Always:return!1;case Ka.BeforeDragging:return t;default:return!t}}}function Gm(n,e){return ll(t=>n?t||(typeof e=="function"?e(n):n):null,[e,n])}function NO(n,e){return Gm(n,e)}function xO(n){let{callback:e,disabled:t}=n;const r=Yu(e),i=S.useMemo(()=>{if(t||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:o}=window;return new o(r)},[r,t]);return S.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function Xu(n){let{callback:e,disabled:t}=n;const r=Yu(e),i=S.useMemo(()=>{if(t||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:o}=window;return new o(r)},[t]);return S.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function OO(n){return new $m(Ns(n),n)}function Sv(n,e,t){e===void 0&&(e=OO);const[r,i]=S.useState(null);function o(){i(l=>{if(!n)return null;if(n.isConnected===!1){var c;return(c=l??t)!=null?c:null}const u=e(n);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const s=xO({callback(l){if(n)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(n)){o();break}}}}),a=Xu({callback:o});return $n(()=>{o(),n?(a==null||a.observe(n),s==null||s.observe(document.body,{childList:!0,subtree:!0})):(a==null||a.disconnect(),s==null||s.disconnect())},[n]),r}function MO(n){const e=Gm(n);return tk(n,e)}const wv=[];function _O(n){const e=S.useRef(n),t=ll(r=>n?r&&r!==wv&&n&&e.current&&n.parentNode===e.current.parentNode?r:Km(n):wv,[n]);return S.useEffect(()=>{e.current=n},[n]),t}function PO(n){const[e,t]=S.useState(null),r=S.useRef(n),i=S.useCallback(o=>{const s=Qd(o.target);s&&t(a=>a?(a.set(s,xf(s)),new Map(a)):null)},[]);return S.useEffect(()=>{const o=r.current;if(n!==o){s(o);const a=n.map(l=>{const c=Qd(l);return c?(c.addEventListener("scroll",i,{passive:!0}),[c,xf(c)]):null}).filter(l=>l!=null);t(a.length?new Map(a):null),r.current=n}return()=>{s(n),s(o)};function s(a){a.forEach(l=>{const c=Qd(l);c==null||c.removeEventListener("scroll",i)})}},[i,n]),S.useMemo(()=>n.length?e?Array.from(e.values()).reduce((o,s)=>Xo(o,s),Vn):lk(n):Vn,[n,e])}function Tv(n,e){e===void 0&&(e=[]);const t=S.useRef(null);return S.useEffect(()=>{t.current=null},e),S.useEffect(()=>{const r=n!==Vn;r&&!t.current&&(t.current=n),!r&&t.current&&(t.current=null)},[n]),t.current?tu(n,t.current):Vn}function DO(n){S.useEffect(()=>{if(!Qu)return;const e=n.map(t=>{let{sensor:r}=t;return r.setup==null?void 0:r.setup()});return()=>{for(const t of e)t==null||t()}},n.map(e=>{let{sensor:t}=e;return t}))}function LO(n,e){return S.useMemo(()=>n.reduce((t,r)=>{let{eventName:i,handler:o}=r;return t[i]=s=>{o(s,e)},t},{}),[n,e])}function hk(n){return S.useMemo(()=>n?aO(n):null,[n])}const Ev=[];function UO(n,e){e===void 0&&(e=Ns);const[t]=n,r=hk(t?Bt(t):null),[i,o]=S.useState(Ev);function s(){o(()=>n.length?n.map(l=>sk(l)?r:new $m(e(l),l)):Ev)}const a=Xu({callback:s});return $n(()=>{a==null||a.disconnect(),s(),n.forEach(l=>a==null?void 0:a.observe(l))},[n]),i}function fk(n){if(!n)return null;if(n.children.length>1)return n;const e=n.children[0];return al(e)?e:n}function HO(n){let{measure:e}=n;const[t,r]=S.useState(null),i=S.useCallback(c=>{for(const{target:u}of c)if(al(u)){r(d=>{const h=e(u);return d?{...d,width:h.width,height:h.height}:h});break}},[e]),o=Xu({callback:i}),s=S.useCallback(c=>{const u=fk(c);o==null||o.disconnect(),u&&(o==null||o.observe(u)),r(u?e(u):null)},[e,o]),[a,l]=Zc(s);return S.useMemo(()=>({nodeRef:a,rect:t,setRef:l}),[t,a,l])}const FO=[{sensor:Wm,options:{}},{sensor:dk,options:{}}],BO={current:{}},lc={draggable:{measure:mv},droppable:{measure:mv,strategy:Ka.WhileDragging,frequency:Mf.Optimized},dragOverlay:{measure:Ns}};class pa extends Map{get(e){var t;return e!=null&&(t=super.get(e))!=null?t:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(e=>{let{disabled:t}=e;return!t})}getNodeFor(e){var t,r;return(t=(r=this.get(e))==null?void 0:r.node.current)!=null?t:void 0}}const zO={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new pa,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ru},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:lc,measureDroppableContainers:ru,windowRect:null,measuringScheduled:!1},pk={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ru,draggableNodes:new Map,over:null,measureDroppableContainers:ru},ul=S.createContext(pk),mk=S.createContext(zO);function jO(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new pa}}}function KO(n,e){switch(e.type){case Je.DragStart:return{...n,draggable:{...n.draggable,initialCoordinates:e.initialCoordinates,active:e.active}};case Je.DragMove:return n.draggable.active==null?n:{...n,draggable:{...n.draggable,translate:{x:e.coordinates.x-n.draggable.initialCoordinates.x,y:e.coordinates.y-n.draggable.initialCoordinates.y}}};case Je.DragEnd:case Je.DragCancel:return{...n,draggable:{...n.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Je.RegisterDroppable:{const{element:t}=e,{id:r}=t,i=new pa(n.droppable.containers);return i.set(r,t),{...n,droppable:{...n.droppable,containers:i}}}case Je.SetDroppableDisabled:{const{id:t,key:r,disabled:i}=e,o=n.droppable.containers.get(t);if(!o||r!==o.key)return n;const s=new pa(n.droppable.containers);return s.set(t,{...o,disabled:i}),{...n,droppable:{...n.droppable,containers:s}}}case Je.UnregisterDroppable:{const{id:t,key:r}=e,i=n.droppable.containers.get(t);if(!i||r!==i.key)return n;const o=new pa(n.droppable.containers);return o.delete(t),{...n,droppable:{...n.droppable,containers:o}}}default:return n}}function $O(n){let{disabled:e}=n;const{active:t,activatorEvent:r,draggableNodes:i}=S.useContext(ul),o=eu(r),s=eu(t==null?void 0:t.id);return S.useEffect(()=>{if(!e&&!r&&o&&s!=null){if(!Ju(o)||document.activeElement===o.target)return;const a=i.get(s);if(!a)return;const{activatorNode:l,node:c}=a;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=Fx(u);if(d){d.focus();break}}})}},[r,e,i,s,o]),null}function gk(n,e){let{transform:t,...r}=e;return n!=null&&n.length?n.reduce((i,o)=>o({transform:i,...r}),t):t}function VO(n){return S.useMemo(()=>({draggable:{...lc.draggable,...n==null?void 0:n.draggable},droppable:{...lc.droppable,...n==null?void 0:n.droppable},dragOverlay:{...lc.dragOverlay,...n==null?void 0:n.dragOverlay}}),[n==null?void 0:n.draggable,n==null?void 0:n.droppable,n==null?void 0:n.dragOverlay])}function WO(n){let{activeNode:e,measure:t,initialRect:r,config:i=!0}=n;const o=S.useRef(!1),{x:s,y:a}=typeof i=="boolean"?{x:i,y:i}:i;$n(()=>{if(!s&&!a||!e){o.current=!1;return}if(o.current||!r)return;const c=e==null?void 0:e.node.current;if(!c||c.isConnected===!1)return;const u=t(c),d=tk(u,r);if(s||(d.x=0),a||(d.y=0),o.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=rk(c);h&&h.scrollBy({top:d.y,left:d.x})}},[e,s,a,r,t])}const Zu=S.createContext({...Vn,scaleX:1,scaleY:1});var Wr;(function(n){n[n.Uninitialized=0]="Uninitialized",n[n.Initializing=1]="Initializing",n[n.Initialized=2]="Initialized"})(Wr||(Wr={}));const GO=S.memo(function(e){var t,r,i,o;let{id:s,accessibility:a,autoScroll:l=!0,children:c,sensors:u=FO,collisionDetection:d=tO,measuring:h,modifiers:f,...p}=e;const m=S.useReducer(KO,void 0,jO),[v,g]=m,[y,C]=Vx(),[w,E]=S.useState(Wr.Uninitialized),I=w===Wr.Initialized,{draggable:{active:b,nodes:R,translate:N},droppable:{containers:_}}=v,V=b!=null?R.get(b):null,ue=S.useRef({initial:null,translated:null}),me=S.useMemo(()=>{var St;return b!=null?{id:b,data:(St=V==null?void 0:V.data)!=null?St:BO,rect:ue}:null},[b,V]),Ee=S.useRef(null),[Zt,Kt]=S.useState(null),[He,D]=S.useState(null),K=ja(p,Object.values(p)),q=cl("DndDescribedBy",s),de=S.useMemo(()=>_.getEnabled(),[_]),ie=VO(h),{droppableRects:qe,measureDroppableContainers:ye,measuringScheduled:ee}=RO(de,{dragging:I,dependencies:[N.x,N.y],config:ie.droppable}),W=AO(R,b),Y=S.useMemo(()=>He?nu(He):null,[He]),X=gI(),se=NO(W,ie.draggable.measure);WO({activeNode:b!=null?R.get(b):null,config:X.layoutShiftCompensation,initialRect:se,measure:ie.draggable.measure});const B=Sv(W,ie.draggable.measure,se),Qe=Sv(W?W.parentElement:null),Ne=S.useRef({activatorEvent:null,active:null,activeNode:W,collisionRect:null,collisions:null,droppableRects:qe,draggableNodes:R,draggingNode:null,draggingNodeRect:null,droppableContainers:_,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),_e=_.getNodeFor((t=Ne.current.over)==null?void 0:t.id),ke=HO({measure:ie.dragOverlay.measure}),vt=(r=ke.nodeRef.current)!=null?r:W,we=I?(i=ke.rect)!=null?i:B:null,Ct=!!(ke.nodeRef.current&&ke.rect),$t=MO(Ct?null:B),Ie=hk(vt?Bt(vt):null),L=_O(I?_e??W:null),le=UO(L),Dr=gk(f,{transform:{x:N.x-$t.x,y:N.y-$t.y,scaleX:1,scaleY:1},activatorEvent:He,active:me,activeNodeRect:B,containerNodeRect:Qe,draggingNodeRect:we,over:Ne.current.over,overlayNodeRect:ke.rect,scrollableAncestors:L,scrollableAncestorRects:le,windowRect:Ie}),vg=Y?Xo(Y,N):null,Cg=PO(L),cI=Tv(Cg),uI=Tv(Cg,[B]),mo=Xo(Dr,cI),go=we?iO(we,Dr):null,Os=me&&go?d({active:me,collisionRect:go,droppableRects:qe,droppableContainers:de,pointerCoordinates:vg}):null,Sg=Zx(Os,"id"),[Lr,wg]=S.useState(null),dI=Ct?Dr:Xo(Dr,uI),hI=nO(dI,(o=Lr==null?void 0:Lr.rect)!=null?o:null,B),pd=S.useRef(null),Tg=S.useCallback((St,en)=>{let{sensor:tn,options:Ur}=en;if(Ee.current==null)return;const Cn=R.get(Ee.current);if(!Cn)return;const nn=St.nativeEvent,qn=new tn({active:Ee.current,activeNode:Cn,event:nn,options:Ur,context:Ne,onAbort(ut){if(!R.get(ut))return;const{onDragAbort:Qn}=K.current,hr={id:ut};Qn==null||Qn(hr),y({type:"onDragAbort",event:hr})},onPending(ut,Hr,Qn,hr){if(!R.get(ut))return;const{onDragPending:_s}=K.current,Fr={id:ut,constraint:Hr,initialCoordinates:Qn,offset:hr};_s==null||_s(Fr),y({type:"onDragPending",event:Fr})},onStart(ut){const Hr=Ee.current;if(Hr==null)return;const Qn=R.get(Hr);if(!Qn)return;const{onDragStart:hr}=K.current,Ms={activatorEvent:nn,active:{id:Hr,data:Qn.data,rect:ue}};ei.unstable_batchedUpdates(()=>{hr==null||hr(Ms),E(Wr.Initializing),g({type:Je.DragStart,initialCoordinates:ut,active:Hr}),y({type:"onDragStart",event:Ms}),Kt(pd.current),D(nn)})},onMove(ut){g({type:Je.DragMove,coordinates:ut})},onEnd:yo(Je.DragEnd),onCancel:yo(Je.DragCancel)});pd.current=qn;function yo(ut){return async function(){const{active:Qn,collisions:hr,over:Ms,scrollAdjustedTranslate:_s}=Ne.current;let Fr=null;if(Qn&&_s){const{cancelDrop:Ps}=K.current;Fr={activatorEvent:nn,active:Qn,collisions:hr,delta:_s,over:Ms},ut===Je.DragEnd&&typeof Ps=="function"&&await Promise.resolve(Ps(Fr))&&(ut=Je.DragCancel)}Ee.current=null,ei.unstable_batchedUpdates(()=>{g({type:ut}),E(Wr.Uninitialized),wg(null),Kt(null),D(null),pd.current=null;const Ps=ut===Je.DragEnd?"onDragEnd":"onDragCancel";if(Fr){const md=K.current[Ps];md==null||md(Fr),y({type:Ps,event:Fr})}})}}},[R]),fI=S.useCallback((St,en)=>(tn,Ur)=>{const Cn=tn.nativeEvent,nn=R.get(Ur);if(Ee.current!==null||!nn||Cn.dndKit||Cn.defaultPrevented)return;const qn={active:nn};St(tn,en.options,qn)===!0&&(Cn.dndKit={capturedBy:en.sensor},Ee.current=Ur,Tg(tn,en))},[R,Tg]),Eg=bO(u,fI);DO(u),$n(()=>{B&&w===Wr.Initializing&&E(Wr.Initialized)},[B,w]),S.useEffect(()=>{const{onDragMove:St}=K.current,{active:en,activatorEvent:tn,collisions:Ur,over:Cn}=Ne.current;if(!en||!tn)return;const nn={active:en,activatorEvent:tn,collisions:Ur,delta:{x:mo.x,y:mo.y},over:Cn};ei.unstable_batchedUpdates(()=>{St==null||St(nn),y({type:"onDragMove",event:nn})})},[mo.x,mo.y]),S.useEffect(()=>{const{active:St,activatorEvent:en,collisions:tn,droppableContainers:Ur,scrollAdjustedTranslate:Cn}=Ne.current;if(!St||Ee.current==null||!en||!Cn)return;const{onDragOver:nn}=K.current,qn=Ur.get(Sg),yo=qn&&qn.rect.current?{id:qn.id,rect:qn.rect.current,data:qn.data,disabled:qn.disabled}:null,ut={active:St,activatorEvent:en,collisions:tn,delta:{x:Cn.x,y:Cn.y},over:yo};ei.unstable_batchedUpdates(()=>{wg(yo),nn==null||nn(ut),y({type:"onDragOver",event:ut})})},[Sg]),$n(()=>{Ne.current={activatorEvent:He,active:me,activeNode:W,collisionRect:go,collisions:Os,droppableRects:qe,draggableNodes:R,draggingNode:vt,draggingNodeRect:we,droppableContainers:_,over:Lr,scrollableAncestors:L,scrollAdjustedTranslate:mo},ue.current={initial:we,translated:go}},[me,W,Os,go,R,vt,we,qe,_,Lr,L,mo]),EO({...X,delta:N,draggingRect:go,pointerCoordinates:vg,scrollableAncestors:L,scrollableAncestorRects:le});const pI=S.useMemo(()=>({active:me,activeNode:W,activeNodeRect:B,activatorEvent:He,collisions:Os,containerNodeRect:Qe,dragOverlay:ke,draggableNodes:R,droppableContainers:_,droppableRects:qe,over:Lr,measureDroppableContainers:ye,scrollableAncestors:L,scrollableAncestorRects:le,measuringConfiguration:ie,measuringScheduled:ee,windowRect:Ie}),[me,W,B,He,Os,Qe,ke,R,_,qe,Lr,ye,L,le,ie,ee,Ie]),mI=S.useMemo(()=>({activatorEvent:He,activators:Eg,active:me,activeNodeRect:B,ariaDescribedById:{draggable:q},dispatch:g,draggableNodes:R,over:Lr,measureDroppableContainers:ye}),[He,Eg,me,B,g,q,R,Lr,ye]);return re.createElement(ek.Provider,{value:C},re.createElement(ul.Provider,{value:mI},re.createElement(mk.Provider,{value:pI},re.createElement(Zu.Provider,{value:hI},c)),re.createElement($O,{disabled:(a==null?void 0:a.restoreFocus)===!1})),re.createElement(qx,{...a,hiddenTextDescribedById:q}));function gI(){const St=(Zt==null?void 0:Zt.autoScrollEnabled)===!1,en=typeof l=="object"?l.enabled===!1:l===!1,tn=I&&!St&&!en;return typeof l=="object"?{...l,enabled:tn}:{enabled:tn}}}),qO=S.createContext(null),kv="button",QO="Draggable";function YO(n){let{id:e,data:t,disabled:r=!1,attributes:i}=n;const o=cl(QO),{activators:s,activatorEvent:a,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=S.useContext(ul),{role:f=kv,roleDescription:p="draggable",tabIndex:m=0}=i??{},v=(l==null?void 0:l.id)===e,g=S.useContext(v?Zu:qO),[y,C]=Zc(),[w,E]=Zc(),I=LO(s,e),b=ja(t);$n(()=>(d.set(e,{id:e,key:o,node:y,activatorNode:w,data:b}),()=>{const N=d.get(e);N&&N.key===o&&d.delete(e)}),[d,e]);const R=S.useMemo(()=>({role:f,tabIndex:m,"aria-disabled":r,"aria-pressed":v&&f===kv?!0:void 0,"aria-roledescription":p,"aria-describedby":u.draggable}),[r,f,m,v,p,u.draggable]);return{active:l,activatorEvent:a,activeNodeRect:c,attributes:R,isDragging:v,listeners:r?void 0:I,node:y,over:h,setNodeRef:C,setActivatorNodeRef:E,transform:g}}function yk(){return S.useContext(mk)}const JO="Droppable",XO={timeout:25};function ZO(n){let{data:e,disabled:t=!1,id:r,resizeObserverConfig:i}=n;const o=cl(JO),{active:s,dispatch:a,over:l,measureDroppableContainers:c}=S.useContext(ul),u=S.useRef({disabled:t}),d=S.useRef(!1),h=S.useRef(null),f=S.useRef(null),{disabled:p,updateMeasurementsFor:m,timeout:v}={...XO,...i},g=ja(m??r),y=S.useCallback(()=>{if(!d.current){d.current=!0;return}f.current!=null&&clearTimeout(f.current),f.current=setTimeout(()=>{c(Array.isArray(g.current)?g.current:[g.current]),f.current=null},v)},[v]),C=Xu({callback:y,disabled:p||!s}),w=S.useCallback((R,N)=>{C&&(N&&(C.unobserve(N),d.current=!1),R&&C.observe(R))},[C]),[E,I]=Zc(w),b=ja(e);return S.useEffect(()=>{!C||!E.current||(C.disconnect(),d.current=!1,C.observe(E.current))},[E,C]),S.useEffect(()=>(a({type:Je.RegisterDroppable,element:{id:r,key:o,disabled:t,node:E,rect:h,data:b}}),()=>a({type:Je.UnregisterDroppable,key:o,id:r})),[r]),S.useEffect(()=>{t!==u.current.disabled&&(a({type:Je.SetDroppableDisabled,id:r,key:o,disabled:t}),u.current.disabled=t)},[r,o,t,a]),{active:s,rect:h,isOver:(l==null?void 0:l.id)===r,node:E,over:l,setNodeRef:I}}function eM(n){let{animation:e,children:t}=n;const[r,i]=S.useState(null),[o,s]=S.useState(null),a=eu(t);return!t&&!r&&a&&i(a),$n(()=>{if(!o)return;const l=r==null?void 0:r.key,c=r==null?void 0:r.props.id;if(l==null||c==null){i(null);return}Promise.resolve(e(c,o)).then(()=>{i(null)})},[e,r,o]),re.createElement(re.Fragment,null,t,r?S.cloneElement(r,{ref:s}):null)}const tM={x:0,y:0,scaleX:1,scaleY:1};function nM(n){let{children:e}=n;return re.createElement(ul.Provider,{value:pk},re.createElement(Zu.Provider,{value:tM},e))}const rM={position:"fixed",touchAction:"none"},iM=n=>Ju(n)?"transform 250ms ease":void 0,oM=S.forwardRef((n,e)=>{let{as:t,activatorEvent:r,adjustScale:i,children:o,className:s,rect:a,style:l,transform:c,transition:u=iM}=n;if(!a)return null;const d=i?c:{...c,scaleX:1,scaleY:1},h={...rM,width:a.width,height:a.height,top:a.top,left:a.left,transform:_r.Transform.toString(d),transformOrigin:i&&r?Jx(r,a):void 0,transition:typeof u=="function"?u(r):u,...l};return re.createElement(t,{className:s,style:h,ref:e},o)}),sM=n=>e=>{let{active:t,dragOverlay:r}=e;const i={},{styles:o,className:s}=n;if(o!=null&&o.active)for(const[a,l]of Object.entries(o.active))l!==void 0&&(i[a]=t.node.style.getPropertyValue(a),t.node.style.setProperty(a,l));if(o!=null&&o.dragOverlay)for(const[a,l]of Object.entries(o.dragOverlay))l!==void 0&&r.node.style.setProperty(a,l);return s!=null&&s.active&&t.node.classList.add(s.active),s!=null&&s.dragOverlay&&r.node.classList.add(s.dragOverlay),function(){for(const[l,c]of Object.entries(i))t.node.style.setProperty(l,c);s!=null&&s.active&&t.node.classList.remove(s.active)}},aM=n=>{let{transform:{initial:e,final:t}}=n;return[{transform:_r.Transform.toString(e)},{transform:_r.Transform.toString(t)}]},lM={duration:250,easing:"ease",keyframes:aM,sideEffects:sM({styles:{active:{opacity:"0"}}})};function cM(n){let{config:e,draggableNodes:t,droppableContainers:r,measuringConfiguration:i}=n;return Yu((o,s)=>{if(e===null)return;const a=t.get(o);if(!a)return;const l=a.node.current;if(!l)return;const c=fk(s);if(!c)return;const{transform:u}=Bt(s).getComputedStyle(s),d=nk(u);if(!d)return;const h=typeof e=="function"?e:uM(e);return ck(l,i.draggable.measure),h({active:{id:o,data:a.data,node:l,rect:i.draggable.measure(l)},draggableNodes:t,dragOverlay:{node:s,rect:i.dragOverlay.measure(c)},droppableContainers:r,measuringConfiguration:i,transform:d})})}function uM(n){const{duration:e,easing:t,sideEffects:r,keyframes:i}={...lM,...n};return o=>{let{active:s,dragOverlay:a,transform:l,...c}=o;if(!e)return;const u={x:a.rect.left-s.rect.left,y:a.rect.top-s.rect.top},d={scaleX:l.scaleX!==1?s.rect.width*l.scaleX/a.rect.width:1,scaleY:l.scaleY!==1?s.rect.height*l.scaleY/a.rect.height:1},h={x:l.x-u.x,y:l.y-u.y,...d},f=i({...c,active:s,dragOverlay:a,transform:{initial:l,final:h}}),[p]=f,m=f[f.length-1];if(JSON.stringify(p)===JSON.stringify(m))return;const v=r==null?void 0:r({active:s,dragOverlay:a,...c}),g=a.node.animate(f,{duration:e,easing:t,fill:"forwards"});return new Promise(y=>{g.onfinish=()=>{v==null||v(),y()}})}}let Iv=0;function dM(n){return S.useMemo(()=>{if(n!=null)return Iv++,Iv},[n])}const hM=re.memo(n=>{let{adjustScale:e=!1,children:t,dropAnimation:r,style:i,transition:o,modifiers:s,wrapperElement:a="div",className:l,zIndex:c=999}=n;const{activatorEvent:u,active:d,activeNodeRect:h,containerNodeRect:f,draggableNodes:p,droppableContainers:m,dragOverlay:v,over:g,measuringConfiguration:y,scrollableAncestors:C,scrollableAncestorRects:w,windowRect:E}=yk(),I=S.useContext(Zu),b=dM(d==null?void 0:d.id),R=gk(s,{activatorEvent:u,active:d,activeNodeRect:h,containerNodeRect:f,draggingNodeRect:v.rect,over:g,overlayNodeRect:v.rect,scrollableAncestors:C,scrollableAncestorRects:w,transform:I,windowRect:E}),N=Gm(h),_=cM({config:r,draggableNodes:p,droppableContainers:m,measuringConfiguration:y}),V=N?v.setRef:void 0;return re.createElement(nM,null,re.createElement(eM,{animation:_},d&&b?re.createElement(oM,{key:b,id:d.id,ref:V,as:a,activatorEvent:u,adjustScale:e,className:l,transition:o,rect:N,style:{zIndex:c,...i},transform:R},t):null))});function ma(n,e,t){const r=n.slice();return r.splice(t<0?r.length+t:t,0,r.splice(e,1)[0]),r}function fM(n,e){return n.reduce((t,r,i)=>{const o=e.get(r);return o&&(t[i]=o),t},Array(n.length))}function Fl(n){return n!==null&&n>=0}function pM(n,e){if(n===e)return!0;if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function mM(n){return typeof n=="boolean"?{draggable:n,droppable:n}:n}const vk=n=>{let{rects:e,activeIndex:t,overIndex:r,index:i}=n;const o=ma(e,r,t),s=e[i],a=o[i];return!a||!s?null:{x:a.left-s.left,y:a.top-s.top,scaleX:a.width/s.width,scaleY:a.height/s.height}},Ck="Sortable",Sk=re.createContext({activeIndex:-1,containerId:Ck,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:vk,disabled:{draggable:!1,droppable:!1}});function gM(n){let{children:e,id:t,items:r,strategy:i=vk,disabled:o=!1}=n;const{active:s,dragOverlay:a,droppableRects:l,over:c,measureDroppableContainers:u}=yk(),d=cl(Ck,t),h=a.rect!==null,f=S.useMemo(()=>r.map(I=>typeof I=="object"&&"id"in I?I.id:I),[r]),p=s!=null,m=s?f.indexOf(s.id):-1,v=c?f.indexOf(c.id):-1,g=S.useRef(f),y=!pM(f,g.current),C=v!==-1&&m===-1||y,w=mM(o);$n(()=>{y&&p&&u(f)},[y,f,p,u]),S.useEffect(()=>{g.current=f},[f]);const E=S.useMemo(()=>({activeIndex:m,containerId:d,disabled:w,disableTransforms:C,items:f,overIndex:v,useDragOverlay:h,sortedRects:fM(f,l),strategy:i}),[m,d,w.draggable,w.droppable,C,f,v,l,h,i]);return re.createElement(Sk.Provider,{value:E},e)}const yM=n=>{let{id:e,items:t,activeIndex:r,overIndex:i}=n;return ma(t,r,i).indexOf(e)},vM=n=>{let{containerId:e,isSorting:t,wasDragging:r,index:i,items:o,newIndex:s,previousItems:a,previousContainerId:l,transition:c}=n;return!c||!r||a!==o&&i===s?!1:t?!0:s!==i&&e===l},CM={duration:200,easing:"ease"},wk="transform",SM=_r.Transition.toString({property:wk,duration:0,easing:"linear"}),wM={roleDescription:"sortable"};function TM(n){let{disabled:e,index:t,node:r,rect:i}=n;const[o,s]=S.useState(null),a=S.useRef(t);return $n(()=>{if(!e&&t!==a.current&&r.current){const l=i.current;if(l){const c=Ns(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&s(u)}}t!==a.current&&(a.current=t)},[e,t,r,i]),S.useEffect(()=>{o&&s(null)},[o]),o}function Tk(n){let{animateLayoutChanges:e=vM,attributes:t,disabled:r,data:i,getNewIndex:o=yM,id:s,strategy:a,resizeObserverConfig:l,transition:c=CM}=n;const{items:u,containerId:d,activeIndex:h,disabled:f,disableTransforms:p,sortedRects:m,overIndex:v,useDragOverlay:g,strategy:y}=S.useContext(Sk),C=EM(r,f),w=u.indexOf(s),E=S.useMemo(()=>({sortable:{containerId:d,index:w,items:u},...i}),[d,i,w,u]),I=S.useMemo(()=>u.slice(u.indexOf(s)),[u,s]),{rect:b,node:R,isOver:N,setNodeRef:_}=ZO({id:s,data:E,disabled:C.droppable,resizeObserverConfig:{updateMeasurementsFor:I,...l}}),{active:V,activatorEvent:ue,activeNodeRect:me,attributes:Ee,setNodeRef:Zt,listeners:Kt,isDragging:He,over:D,setActivatorNodeRef:K,transform:q}=YO({id:s,data:E,attributes:{...wM,...t},disabled:C.draggable}),de=Dx(_,Zt),ie=!!V,qe=ie&&!p&&Fl(h)&&Fl(v),ye=!g&&He,ee=ye&&qe?q:null,Y=qe?ee??(a??y)({rects:m,activeNodeRect:me,activeIndex:h,overIndex:v,index:w}):null,X=Fl(h)&&Fl(v)?o({id:s,items:u,activeIndex:h,overIndex:v}):w,se=V==null?void 0:V.id,B=S.useRef({activeId:se,items:u,newIndex:X,containerId:d}),Qe=u!==B.current.items,Ne=e({active:V,containerId:d,isDragging:He,isSorting:ie,id:s,index:w,items:u,newIndex:B.current.newIndex,previousItems:B.current.items,previousContainerId:B.current.containerId,transition:c,wasDragging:B.current.activeId!=null}),_e=TM({disabled:!Ne,index:w,node:R,rect:b});return S.useEffect(()=>{ie&&B.current.newIndex!==X&&(B.current.newIndex=X),d!==B.current.containerId&&(B.current.containerId=d),u!==B.current.items&&(B.current.items=u)},[ie,X,d,u]),S.useEffect(()=>{if(se===B.current.activeId)return;if(se&&!B.current.activeId){B.current.activeId=se;return}const vt=setTimeout(()=>{B.current.activeId=se},50);return()=>clearTimeout(vt)},[se]),{active:V,activeIndex:h,attributes:Ee,data:E,rect:b,index:w,newIndex:X,items:u,isOver:N,isSorting:ie,isDragging:He,listeners:Kt,node:R,overIndex:v,over:D,setNodeRef:de,setActivatorNodeRef:K,setDroppableNodeRef:_,setDraggableNodeRef:Zt,transform:_e??Y,transition:ke()};function ke(){if(_e||Qe&&B.current.newIndex===w)return SM;if(!(ye&&!Ju(ue)||!c)&&(ie||Ne))return _r.Transition.toString({...c,property:wk})}}function EM(n,e){var t,r;return typeof n=="boolean"?{draggable:n,droppable:!1}:{draggable:(t=n==null?void 0:n.draggable)!=null?t:e.draggable,droppable:(r=n==null?void 0:n.droppable)!=null?r:e.droppable}}he.Down,he.Right,he.Up,he.Left;/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var kM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),zt=(n,e)=>{const t=S.forwardRef(({color:r="currentColor",size:i=24,strokeWidth:o=2,absoluteStrokeWidth:s,className:a="",children:l,...c},u)=>S.createElement("svg",{ref:u,...kM,width:i,height:i,stroke:r,strokeWidth:s?Number(o)*24/Number(i):o,className:["lucide",`lucide-${IM(n)}`,a].join(" "),...c},[...e.map(([d,h])=>S.createElement(d,h)),...Array.isArray(l)?l:[l]]));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=zt("ArrowLeftRight",[["path",{d:"M8 3 4 7l4 4",key:"9rb6wj"}],["path",{d:"M4 7h16",key:"6tx8e3"}],["path",{d:"m16 21 4-4-4-4",key:"siv7j2"}],["path",{d:"M20 17H4",key:"h6l3hr"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=zt("Bold",[["path",{d:"M14 12a4 4 0 0 0 0-8H6v8",key:"v2sylx"}],["path",{d:"M15 20a4 4 0 0 0 0-8H6v8Z",key:"1ef5ya"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ek=zt("Bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kk=zt("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _f=zt("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=zt("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=zt("Italic",[["line",{x1:"19",x2:"10",y1:"4",y2:"4",key:"15jd3p"}],["line",{x1:"14",x2:"5",y1:"20",y2:"20",key:"bu0au3"}],["line",{x1:"15",x2:"9",y1:"4",y2:"20",key:"uljnxc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xM=zt("ListOrdered",[["line",{x1:"10",x2:"21",y1:"6",y2:"6",key:"76qw6h"}],["line",{x1:"10",x2:"21",y1:"12",y2:"12",key:"16nom4"}],["line",{x1:"10",x2:"21",y1:"18",y2:"18",key:"u3jurt"}],["path",{d:"M4 6h1v4",key:"cnovpq"}],["path",{d:"M4 10h2",key:"16xx2s"}],["path",{d:"M6 18H4c0-1 2-2 2-3s-1-1.5-2-1",key:"m9a95d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=zt("ListRestart",[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MM=zt("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _M=zt("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4Z",key:"ymcmye"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pf=zt("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Av=zt("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=zt("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Df=zt("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),DM="https://homeapi.quixy.com/api/Report/GetViewResult",qm="eyJhbGciOiJSUzI1NiIsImtpZCI6IkUzMDIwQkIwMTRGQzc0QjZBNEI3QjU5QTFBMTgzOENDIiwidHlwIjoiYXQrand0In0.eyJuYmYiOjE3NDg0MTQwODksImV4cCI6MTc1MTAwNjA4OSwiaXNzIjoiaHR0cHM6Ly9ob21laWRzLnF1aXh5LmNvbSIsImNsaWVudF9pZCI6ImFuZ3VsYXJfc3BhIiwic3ViIjoidmFtc2hpc2Fpa3Jpc2huYS5hcmVsbGlAcXVpeHkuY29tIiwiYXV0aF90aW1lIjoxNzQ4NDE0MDg5LCJpZHAiOiIiLCJVc2VyTmFtZSI6InZhbXNoaXNhaWtyaXNobmEuYXJlbGxpQHF1aXh5LmNvbSIsImh0dHA6Ly9zY2hlbWFzLnhtbHNvYXAub3JnL3dzLzIwMDUvMDUvaWRlbnRpdHkvY2xhaW1zL25hbWUiOiJ2YW1zaGkgc2FpIGtyaXNobmFhcmVsbGk2OTMyIiwiVXNlcklkIjoiMTcwNjIwMjQtMTgxNDEzMTQ2LTI0MTEyMWU0LTY2NDQtNDgxZi1hMGVhLWRkZjllMzgzMjU3NSIsIk5hbWUiOiJWYW1zaGkgU2FpIEtyaXNobmEgQXJlbGxpIiwiRW1haWxJZCI6InZhbXNoaXNhaWtyaXNobmEuYXJlbGxpQHF1aXh5LmNvbSIsIlVzZXJUeXBlIjoiVXNlciIsInJvbGUiOiJVc2VyIiwiT3JnYW5pemF0aW9uSWQiOiIyOTEwMjAxOS0wOTM0MzQ1NDgtYTRmZTQxYjAtMWZkMC00ODlhLWFjMDgtYTI5Yjk4ODgzMTQzIiwiQWNjZXB0ZWRUZXJtcyI6IlRydWUiLCJJcENvbmZpZ3VyYXRpb25FbmFibGVkIjoiRmFsc2UiLCJpc1NhYXNJbnN0YW5jZSI6IlRydWUiLCJhcGlVcmwiOiIiLCJhcGlLZXkiOiIiLCJTYW5kYm94VHlwZSI6IkFkdmFuY2VkIiwiU3RhZ2VBY2Nlc3MiOiJMaXZlIiwiQWxsb3dlZElwcyI6IiIsIkRhdGFiYXNlTmFtZSI6IjI5MTAyMDE5LTA5MzQzNDU0OC1hNGZlNDFiMC0xZmQwLTQ4OWEtYWMwOC1hMjliOTg4ODMxNDMiLCJMb2dJblNlc3Npb25JZCI6IjI4MDUyMDI1LTEyMDQ0OTIzMC1kYjdjNmZiNi1mYmQyLTQ4OTctYjYyNS1kMDIyOWM5ZWM1ZmYiLCJTZXNzaW9uIjoiMWFkMjNiZTktZDc5Yy00Y2RiLWI4ZmEtZmZmNDliNjA2Mzg1IiwiRGF0ZUZvcm1hdCI6ImRkL01NL3l5eXkiLCJTdWJzY3JpcHRpb25UeXBlIjoiVXNlciIsIlRpbWVGb3JtYXQiOiJoaDptbSBhIiwiRG9tYWluIjoiaHR0cHM6Ly92aXZpZG1pbmRzLnF1aXh5LmNvbSIsIkFjY2VwdGVkVGVybXNEYXRlIjoiNi8xOC8yMDI0IDg6Mzg6MjggQU0iLCJodHRwOi8vc2NoZW1hcy5taWNyb3NvZnQuY29tL3dzLzIwMDgvMDYvaWRlbnRpdHkvY2xhaW1zL3JvbGUiOiJVc2VyIiwiVGltZVpvbmUiOiJJbmRpYSBTdGFuZGFyZCBUaW1lIiwianRpIjoiMUZFM0MwRTlDRTdDMDUwNDA0MEZDODJBMUIxRjEwRTEiLCJzaWQiOiJCRThBQ0ZCQTFBMzQzOUU4OEJGM0NBQ0U2QzQ3OTU0QSIsImlhdCI6MTc0ODQxNDA4OSwic2NvcGUiOlsib3BlbmlkIiwicHJvZmlsZSIsInJvbGVzIiwib2ZmbGluZV9hY2Nlc3MiXSwiYW1yIjpbImV4dGVybmFsIl19.HKrVk4KFDyAiXoVP322RUKwEuZ8xfukqVVV9Ci57L3MIyEjy32G19mUVpvKQHswnXRpT9dD5sDsEPmb2VwlLYFbWqa5plLdoryB-SWZ00_HUduCawUxV4wJBtQcS4UHNhkFxjacNOalUpM02Jsmj0JrIgrB7Jo-DtTk4bnXd4lmPTJ-LrCYYzThazcS3hYZ9M4D289OA5vpBITpV2SUfz66cNMXG9RjNESmD4wsnQeGUj1dGEwhwWNhbwYXc8M80XQVggIOp2a-LbYIpceXsP29fyBInQfW6A1wV0H-05tWLneyqzdhY_8w9i0x-DPO98vcx2M-Jtsk8__MIS25gGg";let ti=null;const Lf=new qu(KE);async function LM(n="DAP - 24"){const e={orderByFields:"",filters:{searchString:"",columns:"Actions,Sub Tasks,Issue Id,Sprint Name,Issue Type,Summary,Status,Assignee,Project Id,Record Id,Reporter,Estimated Hours,Detection Phase,Status Indicator,Team Member Email Id",groupedColumns:"",rowHeight:null,columnsOrder:"Actions,Sub Tasks,Issue Id,Sprint Name,Issue Type,Summary,Status,Issue Category,Sprint Rank,Reporter,Assignee,Created Date Time,Due Date,Updated On,Dependent Id,Priority,Estimated Hours,Logged Hours,Remaining Hours,Release,Browser,Bug Type,Detection Phase,Fix Branch,Injection Phase,Severity,Required Builds,Checkin Given Branch,Configurations Made,DB scripts,DB scripts exist,Impacted Features Of The Bug,Test Case Id,Project Name,Module,Sub Module,Resource Type,Release DateTime,Created DateTime,Bug Age,Client Name,Reporter Story Points,Assignee Story Points,Task Type,Feature,Sub Feature,Group Name,Bug Scenario,Coding Target Date,Test Cases Target Date,Unit Testing Target Date,Devbox Testing Target Date,System Testing Target Date,Impact Features Sharepoint Link,Issue Reproduced Or Not,Steps To Reproduce,Reason For Not Reproducing,POD,IssueType,Bug Fixed Date,POD Test Owner,POD Dev Owner,BA Owner,DB Type",resizedColumns:[],pageSize:100,filters:[],sorting:[],CustomUserViewFilters:[{Order:0,ColumnName:"Sprint Name",ElementType:"TextBox",ConditionType:"Equal",Value:n,IsEditable:!0,IsVisible:!1,SecondValue:"",SelectedValues:[n]}]}};try{const t=await fetch(`${DM}?skip=0&take=100&viewId=05072022-184836479-5888ab5b-d645-4e86-a937-f2d02d2414c1`,{method:"POST",headers:{Authorization:`Bearer ${qm}`,"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);const r=await t.json();if(!r.Status)throw new Error("API returned unsuccessful status");const i=JSON.parse(r.results);if(i.length>0){const o=i[0]["Project Id"];o&&typeof o=="string"?(ti=o,console.log("Extracted Project ID from fetchTasks:",ti)):console.warn("No Project Id found in API response, keeping current Project ID:",ti)}else console.warn("No tasks found in API response, keeping current Project ID:",ti);return i.map((o,s)=>({id:s+1,columnId:o.Status,content:`Issue Id: ${o["Issue Id"]}
Summary: ${o.Summary}
Assignee: ${o.Assignee}
Issue Type: ${o["Issue Type"]}`,rowData:{"Issue Id":o["Issue Id"],Summary:o.Summary,Assignee:o.Assignee,"Issue Type":o["Issue Type"],Status:o.Status,"Record Id":o["Record Id"],"Project Id":o["Project Id"],Reporter:o.Reporter,"Estimated Hours":o["Estimated Hours"],"Detection Phase":o["Detection Phase"],"Status Indicator":o["Status Indicator"],"Sprint Name":o["Sprint Name"],"Team Member Email Id":o["Team Member Email Id"]}}))}catch(t){throw console.error("Error fetching tasks:",t),t}}function UM(){return ti}const HM=()=>{try{const n=Lf.getAllAccounts();if(n.length===0)return console.log("No MSAL accounts found - user not logged in"),!1;const e=n[0];return!e||!e.username?(console.log("No valid active account found"),!1):localStorage.getItem("userData")?(console.log("User is authenticated:",e.username),!0):(console.log("No user data in localStorage - user may not be fully authenticated"),!1)}catch(n){return console.error("Error checking authentication status:",n),!1}},FM=()=>{try{const n=localStorage.getItem("userData");if(n){const t=JSON.parse(n),i=Lf.getAllAccounts()[0];return{fullName:t.displayName||(i==null?void 0:i.name)||"",username:(i==null?void 0:i.username)||"",email:(i==null?void 0:i.username)||""}}const e=Lf.getAllAccounts();if(e.length>0){const t=e[0];return{fullName:t.name||"",username:t.username||"",email:t.username||""}}return{fullName:"",username:"",email:""}}catch(n){return console.error("Error getting user information:",n),{fullName:"",username:"",email:""}}};async function BM(n,e){console.log("Checking authentication status for updateTaskStatus...");const t=HM();if(console.log("Authentication check result:",t),!t)throw new Error("AUTHENTICATION_REQUIRED");const r="https://homeapi.quixy.com/api/App/SaveAppData?appName=Change%20Issue%20Status&users=&startDate=null&dueDate=null",i=n.rowData||{},o=new Date().toISOString(),s=i["Project Id"]||UM(),a=FM();if(!a.email||!a.fullName)throw alert("Unable to retrieve user information. Please try logging in again."),new Error("User information not available. Please re-authenticate.");const l={"var Project Id":s,"var Issue Record Id":i["Record Id"]||"","var Issue Id":i["Issue Id"]||"","Issue Id":null,Status:"","Project Id":s,"var Issue Type":i["Issue Type"]||"","Issue Type":i["Issue Type"]||"","var Current Assignee":i.Assignee||"","var Issue Current Status":i.Status||"","var Summary":i.Summary||"","Current Status":i.Status||"","Estimated Hours":i["Estimated Hours"]||"","Detection Phase":i["Detection Phase"]||"","New Status":e,"Change Remarks":"","Release Datetime":"","Review Closed Task By":"",Configurations:"",Scripts:"","Environment level":"","Specific details":"","Select Branch":"","Select Required Components":"","Any DB Scripts Exists":"","Issue Remarks":"","Mention the DB script":"","Any configuration changes made":"","Specify the configuration change":"","Configurations added":"","DB Scripts":"","Migration scripts":"","Configurations Files":"","DB Files":"","Migration files":"","Dev Remarks":"","Specify Impact Feature Related To Bug":"","Var Sub Task Id":"","status Indicator Project Id":s,"status Indicator Issue Type":i["Issue Type"]||"","status Indicator Status":i.Status||"","Status Indicator":i["Status Indicator"]||"In Progress","Updated Date Time":o,"Issue Id for watch":null,"Logged In User Name":a.fullName,"Watch List Details":[],"Assignee Story Points":null,"Status Changed User":i["Team Member Email Id"]||a.email,"Sprint Name":i["Sprint Name"]||"","Story points Issue Id":i["Issue Id"]||"","Get Assignee Story Points":"","Story Sub Task Id":null,"Sub task Story Points":"","Get ready for QA Issue id":null,"Get ready for QA Issue id Grid":"",_AppId:"01022021-064254831-3920198f-f15c-4ea9-b8f3-22913911c281",_AppName:"Change Issue Status",_CurrentStepNumber:1,_WorkSpaceId:"03012021-192624661-c4d2d235-e371-4983-973f-c82b074f9b21",_OrganizationId:"29102019-093434548-a4fe41b0-1fd0-489a-ac08-a29b98883143",_NextGroupName:"Done",_IsCompleted:!0,_ExternalApiIds:"",_InternalApiIds:"",_DataFunctionIds:"",_UserFunctionIds:"",_UserId:"17062024-181413146-241121e4-6644-481f-a0ea-ddf9e3832575",_Username:a.username,_FullName:a.fullName,_UpdatedUserId:"",_UpdatedUsername:"",_UpdatedEmailId:"",_UserEmailId:a.email,_NextStepUsers:"",_UpdatedLocation:"",_WorkFlowAction:"Start - Submit"};try{console.log("Making status update API request to:",r),console.log("Update payload:",JSON.stringify(l,null,2));const c=await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${qm}`,"Content-Type":"application/json"},body:JSON.stringify(l)});if(console.log("Update response status:",c.status),console.log("Update response ok:",c.ok),!c.ok){const d=await c.text();throw console.error("Update response error text:",d),new Error(`HTTP error! status: ${c.status}, message: ${d}`)}const u=await c.json();return console.log("Update API response:",u),{Status:u.Status||!0,results:u.results,message:u.message}}catch(c){throw console.error("Error updating task status:",c),c}}async function zM(n,e,t){const r="https://homeapi.quixy.com/api/DataTable/GetDataTableDataByReference";let i;ti?(i=ti,console.log("Using stored Project ID from last fetchTasks call:",ti)):(i="70",console.warn('No Project ID available, using fallback value "70". Make sure fetchTasks has been called at least once.')),console.log("Using Project ID for status check:",i);const o={DataTableFunctionId:"01022021-064148735-3f601026-cf68-4b03-abd5-ca71c5215f97",DataTableId:"03012021-220616917-65360d6b-ab63-4cf6-9977-2d6c91e005d8",ReferencedElements:"",DataTableDataReferenceDataDTOs:[{IsFocused:!1,ReferenceName:"Project Id",Value:i,SelectedValue:""},{IsFocused:!1,ReferenceName:"Issue Type",Value:n,SelectedValue:""},{IsFocused:!1,ReferenceName:"Current Status",Value:e,SelectedValue:""},{IsFocused:!0,ReferenceName:"Next Status",Value:"",SelectedValue:""}]};try{console.log("Making API request to:",r),console.log("Request payload:",JSON.stringify(o,null,2));const s=await fetch(r,{method:"POST",headers:{Authorization:`Bearer ${qm}`,"Content-Type":"application/json"},body:JSON.stringify(o)});if(console.log("Response status:",s.status),console.log("Response ok:",s.ok),!s.ok){const l=await s.text();throw console.error("Response error text:",l),new Error(`HTTP error! status: ${s.status}, message: ${l}`)}const a=await s.json();if(console.log("Full API response:",a),console.log("API response type:",Array.isArray(a)?"Array":"Object"),Array.isArray(a)){console.log("Response is an array, treating as direct data");const l={Status:!0,results:JSON.stringify(a),__count:a.length};return console.log("Formatted response:",l),l}if(console.log("API response Status field:",a.Status),console.log("API response results field:",a.results),!a.Status)throw console.error("API returned unsuccessful status. Full response:",a),new Error("API returned unsuccessful status");return a}catch(s){throw console.error("Error checking task status:",s),s}}function jM(n){switch(n==null?void 0:n.toLowerCase()){case"feature":return"bg-blue-500";case"improvement":return"bg-green-500";case"bug":return"bg-red-500";case"task":return"bg-violet-500";default:return"bg-gray-500"}}function KM(n){switch(n){case 1:return"text-yellow-500 fill-yellow-500";case 2:return"text-rose-500 fill-rose-500";default:return"text-gray-400"}}function $M(n){const e=n.split(`
`),t={};return e.forEach(r=>{const[i,o]=r.split(": ");if(i&&o)switch(i.trim()){case"Issue Id":t.issueId=o.trim();break;case"Summary":t.summary=o.trim();break;case"Issue Type":t.issueType=o.trim();break;case"Assignee":t.assignee=o.trim();break}}),t}function Ik({task:n,onStatusCheckResult:e,isHighlighted:t,isSuccess:r,isUpdating:i}){const[o,s]=S.useState(!1),[a,l]=S.useState(!1),{getUserPhoto:c,loadUserPhoto:u}=Px(),d=$M(n.content),[h,f]=S.useState(()=>JSON.parse(localStorage.getItem("taskBookmarks")||"{}")[d.issueId||""]||0),{setNodeRef:p,attributes:m,listeners:v,transform:g,transition:y,isDragging:C}=Tk({id:n.id,data:{type:"Task",task:n}});S.useEffect(()=>{d.assignee&&u(d.assignee)},[d.assignee,u]);const w={transition:y,transform:_r.Transform.toString(g)},E=async()=>{const N=`${d.issueId}: ${d.summary}`;try{await navigator.clipboard.writeText(N),s(!0),setTimeout(()=>s(!1),2e3)}catch(_){console.error("Failed to copy text: ",_)}},I=()=>{const N=(h+1)%3;f(N);const _=JSON.parse(localStorage.getItem("taskBookmarks")||"{}");d.issueId&&(N===0?delete _[d.issueId]:_[d.issueId]=N,localStorage.setItem("taskBookmarks",JSON.stringify(_)))},b=async()=>{if(!d.issueType||!n.columnId){console.error("Missing required data for status check:",{issueType:d.issueType,currentStatus:n.columnId});return}l(!0);try{const N=await zM(d.issueType,n.columnId);if(console.log("Status check response:",N),N.results)try{console.log("Raw API response.results:",N.results);const _=JSON.parse(N.results);console.log("Parsed API results:",_);const V=[];Array.isArray(_)&&_.forEach(ue=>{console.log("Processing item:",ue),ue.AppData&&typeof ue.AppData=="string"&&(V.push(ue.AppData),console.log("Added target status:",ue.AppData))}),console.log("Final extracted target statuses:",V),console.log("onStatusCheckResult callback exists:",!!e),console.log("Task ID:",n.id),e&&V.length>0?(console.log("Calling onStatusCheckResult with:",n.id,V),e(n.id,V)):console.log("Not calling callback - onStatusCheckResult:",!!e,"targetStatuses.length:",V.length)}catch(_){console.error("Failed to parse API response:",_)}else console.log("No response.results found")}catch(N){console.error("Failed to check task status:",N)}finally{l(!1)}};if(C)return k.jsx("div",{ref:p,style:w,className:"relative cursor-grab rounded-xl border-2 border-rose-500 bg-[#0c1015] opacity-30"});const R=d.assignee?c(d.assignee):void 0;return k.jsxs("div",{ref:p,style:w,...m,...v,className:`relative ${C?"cursor-grabbing":"cursor-grab"} rounded-xl bg-[#0c1015] overflow-hidden w-[300px] ${i?"ring-2 ring-inset ring-blue-500 opacity-75":t?"ring-2 ring-inset ring-blue-500":r?"ring-2 ring-inset ring-green-500":"hover:ring-2 hover:ring-inset hover:ring-rose-500"}`,children:[k.jsxs("div",{className:"p-3 border-b border-gray-700",children:[k.jsxs("div",{className:"flex justify-between items-center mb-2",children:[k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("span",{className:"text-gray-400 text-xs font-mono",children:d.issueId}),i&&k.jsx(Pf,{className:"h-3 w-3 text-blue-500 animate-spin"})]}),k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("span",{className:`text-xs px-2 py-1 rounded-full text-white ${jM(d.issueType)}`,children:d.issueType}),k.jsx("button",{onClick:I,className:"hover:scale-110 transition-transform duration-200",children:k.jsx(Ek,{size:16,className:`${KM(h)} transition-colors duration-200`})})]})]}),k.jsx("h3",{className:"text-white font-medium text-sm",children:d.summary})]}),k.jsxs("div",{className:"p-3 flex items-center justify-between",children:[k.jsxs("div",{className:"flex items-center",children:[R?k.jsx("img",{src:R,alt:d.assignee,className:"w-5 h-5 rounded-full mr-2 object-cover"}):k.jsx(_f,{size:20,className:"text-gray-400 mr-2"}),k.jsx("span",{className:"text-gray-400 text-xs",children:d.assignee})]}),k.jsxs("div",{className:"flex items-center gap-1",children:[k.jsx("button",{onClick:N=>{N.stopPropagation(),b()},disabled:a,className:"rounded p-1 hover:bg-[#181b21] transition-colors duration-200 disabled:opacity-50",title:"Check Next Status",children:a?k.jsx(Pf,{className:"h-4 w-4 text-gray-400 animate-spin"}):k.jsx(AM,{className:"h-4 w-4 text-gray-400 hover:text-white"})}),k.jsx("button",{onClick:E,className:"rounded p-1 hover:bg-[#181b21] transition-colors duration-200",title:"Copy Issue ID and Summary",children:o?k.jsx(kk,{className:"h-4 w-4 text-green-500"}):k.jsx(RM,{className:"h-4 w-4 text-gray-400 hover:text-white"})})]})]})]})}function VM({column:n,tasks:e,onStatusCheckResult:t,highlightedTaskId:r,successTaskId:i,updatingTaskId:o}){n.isHighlighted&&console.log(`Column ${n.id} is highlighted:`,n.isHighlighted);const{setNodeRef:s,attributes:a,listeners:l,transform:c,transition:u,isDragging:d}=Tk({id:n.id,data:{type:"Column",column:n}}),h={transition:u,transform:_r.Transform.toString(c)};return k.jsxs("div",{ref:s,style:h,className:`h-full rounded-lg flex flex-col ${n.isHighlighted?"border-2 border-blue-500 bg-blue-900/20":"bg-[#181b21]"}`,children:[k.jsx("div",{className:"p-4 border-b border-[#2D3139] bg-[#1C1F26] rounded-t-lg",children:k.jsx("div",{className:"flex items-center justify-between",children:k.jsxs("div",{className:"flex items-center gap-2",children:[k.jsx("h2",{className:"font-bold text-white text-sm",children:n.title}),k.jsx("span",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-[#0c1015] px-2 text-xs text-white border border-[#2D3139]",children:e.length})]})})}),k.jsx(gM,{items:e.map(f=>f.id),children:k.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-3 column-scroll",children:e.map(f=>k.jsx(Ik,{task:f,onStatusCheckResult:t,isHighlighted:r===f.id,isSuccess:i===f.id,isUpdating:o===f.id},f.id))})})]})}const Uf=["Reopened","Hold","New","Requirement Gathering","Design","Design Review","Design Completed","Ready for TC Preparation","Test Case Preparation","Test Case Review","Test Case Completed","Technical Document Review","In Progress","Coding","Unit Testing","White Box Testing","Coding Review","Devbox Testing","Ready for QA","System Testing","Closed","Release","Other Status"];function Bl(n){const e=Uf.indexOf(n);return e===-1?Uf.length-1:e}function WM(){const{instance:n,accounts:e}=Fm(),[t,r]=S.useState(()=>{const s=localStorage.getItem("userData");return s?JSON.parse(s):{}}),i=()=>{n.loginPopup(Qc).catch(s=>{console.error("Login failed:",s)})},o=()=>{localStorage.removeItem("userData"),r({}),n.logoutPopup().catch(s=>{console.error("Logout failed:",s)})};return S.useEffect(()=>{(async()=>{if(e[0])try{const a=await n.acquireTokenSilent({...Qc,account:e[0]}),c=await za.init({authProvider:u=>{u(null,a.accessToken)}}).api("/me").get();try{const u=await fetch("https://graph.microsoft.com/v1.0/me/photo/$value",{headers:{Authorization:`Bearer ${a.accessToken}`}});if(u.ok){const d=await u.blob(),h=await new Promise(p=>{const m=new FileReader;m.onloadend=()=>p(m.result),m.readAsDataURL(d)}),f={displayName:c.displayName,photo:h};r(f),localStorage.setItem("userData",JSON.stringify(f))}else throw new Error("Failed to fetch photo")}catch(u){console.error("Error fetching photo:",u);const d={displayName:c.displayName};r(d),localStorage.setItem("userData",JSON.stringify(d))}}catch(a){console.error("Error fetching user data:",a)}})()},[e,n]),e.length>0?k.jsxs("div",{className:"relative group",children:[t.photo?k.jsx("img",{src:t.photo,alt:t.displayName,className:"w-8 h-8 rounded-full cursor-pointer object-cover",onClick:o}):k.jsx(_f,{size:32,className:"text-white cursor-pointer",onClick:o}),k.jsxs("div",{className:"absolute right-0 mt-2 w-48 py-2 bg-[#181b21] rounded-lg shadow-xl opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:[k.jsx("div",{className:"px-4 py-2 text-sm text-white",children:t.displayName}),k.jsx("button",{onClick:o,className:"w-full text-left px-4 py-2 text-sm text-white hover:bg-[#2D3139]",children:"Sign out"})]})]}):k.jsxs("button",{onClick:i,className:"flex items-center gap-2 px-3 py-1.5 rounded-full text-sm font-medium bg-[#181b21] text-white hover:bg-[#1C1F26] transition-colors duration-200",children:[k.jsx(_f,{size:20}),"Sign in"]})}function ft(n){this.content=n}ft.prototype={constructor:ft,find:function(n){for(var e=0;e<this.content.length;e+=2)if(this.content[e]===n)return e;return-1},get:function(n){var e=this.find(n);return e==-1?void 0:this.content[e+1]},update:function(n,e,t){var r=t&&t!=n?this.remove(t):this,i=r.find(n),o=r.content.slice();return i==-1?o.push(t||n,e):(o[i+1]=e,t&&(o[i]=t)),new ft(o)},remove:function(n){var e=this.find(n);if(e==-1)return this;var t=this.content.slice();return t.splice(e,2),new ft(t)},addToStart:function(n,e){return new ft([n,e].concat(this.remove(n).content))},addToEnd:function(n,e){var t=this.remove(n).content.slice();return t.push(n,e),new ft(t)},addBefore:function(n,e,t){var r=this.remove(e),i=r.content.slice(),o=r.find(n);return i.splice(o==-1?i.length:o,0,e,t),new ft(i)},forEach:function(n){for(var e=0;e<this.content.length;e+=2)n(this.content[e],this.content[e+1])},prepend:function(n){return n=ft.from(n),n.size?new ft(n.content.concat(this.subtract(n).content)):this},append:function(n){return n=ft.from(n),n.size?new ft(this.subtract(n).content.concat(n.content)):this},subtract:function(n){var e=this;n=ft.from(n);for(var t=0;t<n.content.length;t+=2)e=e.remove(n.content[t]);return e},toObject:function(){var n={};return this.forEach(function(e,t){n[e]=t}),n},get size(){return this.content.length>>1}};ft.from=function(n){if(n instanceof ft)return n;var e=[];if(n)for(var t in n)e.push(t,n[t]);return new ft(e)};function Ak(n,e,t){for(let r=0;;r++){if(r==n.childCount||r==e.childCount)return n.childCount==e.childCount?null:t;let i=n.child(r),o=e.child(r);if(i==o){t+=i.nodeSize;continue}if(!i.sameMarkup(o))return t;if(i.isText&&i.text!=o.text){for(let s=0;i.text[s]==o.text[s];s++)t++;return t}if(i.content.size||o.content.size){let s=Ak(i.content,o.content,t+1);if(s!=null)return s}t+=i.nodeSize}}function bk(n,e,t,r){for(let i=n.childCount,o=e.childCount;;){if(i==0||o==0)return i==o?null:{a:t,b:r};let s=n.child(--i),a=e.child(--o),l=s.nodeSize;if(s==a){t-=l,r-=l;continue}if(!s.sameMarkup(a))return{a:t,b:r};if(s.isText&&s.text!=a.text){let c=0,u=Math.min(s.text.length,a.text.length);for(;c<u&&s.text[s.text.length-c-1]==a.text[a.text.length-c-1];)c++,t--,r--;return{a:t,b:r}}if(s.content.size||a.content.size){let c=bk(s.content,a.content,t-1,r-1);if(c)return c}t-=l,r-=l}}class x{constructor(e,t){if(this.content=e,this.size=t||0,t==null)for(let r=0;r<e.length;r++)this.size+=e[r].nodeSize}nodesBetween(e,t,r,i=0,o){for(let s=0,a=0;a<t;s++){let l=this.content[s],c=a+l.nodeSize;if(c>e&&r(l,i+a,o||null,s)!==!1&&l.content.size){let u=a+1;l.nodesBetween(Math.max(0,e-u),Math.min(l.content.size,t-u),r,i+u)}a=c}}descendants(e){this.nodesBetween(0,this.size,e)}textBetween(e,t,r,i){let o="",s=!0;return this.nodesBetween(e,t,(a,l)=>{let c=a.isText?a.text.slice(Math.max(e,l)-l,t-l):a.isLeaf?i?typeof i=="function"?i(a):i:a.type.spec.leafText?a.type.spec.leafText(a):"":"";a.isBlock&&(a.isLeaf&&c||a.isTextblock)&&r&&(s?s=!1:o+=r),o+=c},0),o}append(e){if(!e.size)return this;if(!this.size)return e;let t=this.lastChild,r=e.firstChild,i=this.content.slice(),o=0;for(t.isText&&t.sameMarkup(r)&&(i[i.length-1]=t.withText(t.text+r.text),o=1);o<e.content.length;o++)i.push(e.content[o]);return new x(i,this.size+e.size)}cut(e,t=this.size){if(e==0&&t==this.size)return this;let r=[],i=0;if(t>e)for(let o=0,s=0;s<t;o++){let a=this.content[o],l=s+a.nodeSize;l>e&&((s<e||l>t)&&(a.isText?a=a.cut(Math.max(0,e-s),Math.min(a.text.length,t-s)):a=a.cut(Math.max(0,e-s-1),Math.min(a.content.size,t-s-1))),r.push(a),i+=a.nodeSize),s=l}return new x(r,i)}cutByIndex(e,t){return e==t?x.empty:e==0&&t==this.content.length?this:new x(this.content.slice(e,t))}replaceChild(e,t){let r=this.content[e];if(r==t)return this;let i=this.content.slice(),o=this.size+t.nodeSize-r.nodeSize;return i[e]=t,new x(i,o)}addToStart(e){return new x([e].concat(this.content),this.size+e.nodeSize)}addToEnd(e){return new x(this.content.concat(e),this.size+e.nodeSize)}eq(e){if(this.content.length!=e.content.length)return!1;for(let t=0;t<this.content.length;t++)if(!this.content[t].eq(e.content[t]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(e){let t=this.content[e];if(!t)throw new RangeError("Index "+e+" out of range for "+this);return t}maybeChild(e){return this.content[e]||null}forEach(e){for(let t=0,r=0;t<this.content.length;t++){let i=this.content[t];e(i,r,t),r+=i.nodeSize}}findDiffStart(e,t=0){return Ak(this,e,t)}findDiffEnd(e,t=this.size,r=e.size){return bk(this,e,t,r)}findIndex(e,t=-1){if(e==0)return zl(0,e);if(e==this.size)return zl(this.content.length,e);if(e>this.size||e<0)throw new RangeError(`Position ${e} outside of fragment (${this})`);for(let r=0,i=0;;r++){let o=this.child(r),s=i+o.nodeSize;if(s>=e)return s==e||t>0?zl(r+1,s):zl(r,i);i=s}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(e=>e.toJSON()):null}static fromJSON(e,t){if(!t)return x.empty;if(!Array.isArray(t))throw new RangeError("Invalid input for Fragment.fromJSON");return new x(t.map(e.nodeFromJSON))}static fromArray(e){if(!e.length)return x.empty;let t,r=0;for(let i=0;i<e.length;i++){let o=e[i];r+=o.nodeSize,i&&o.isText&&e[i-1].sameMarkup(o)?(t||(t=e.slice(0,i)),t[t.length-1]=o.withText(t[t.length-1].text+o.text)):t&&t.push(o)}return new x(t||e,r)}static from(e){if(!e)return x.empty;if(e instanceof x)return e;if(Array.isArray(e))return this.fromArray(e);if(e.attrs)return new x([e],e.nodeSize);throw new RangeError("Can not convert "+e+" to a Fragment"+(e.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}x.empty=new x([],0);const Xd={index:0,offset:0};function zl(n,e){return Xd.index=n,Xd.offset=e,Xd}function ou(n,e){if(n===e)return!0;if(!(n&&typeof n=="object")||!(e&&typeof e=="object"))return!1;let t=Array.isArray(n);if(Array.isArray(e)!=t)return!1;if(t){if(n.length!=e.length)return!1;for(let r=0;r<n.length;r++)if(!ou(n[r],e[r]))return!1}else{for(let r in n)if(!(r in e)||!ou(n[r],e[r]))return!1;for(let r in e)if(!(r in n))return!1}return!0}let Se=class Hf{constructor(e,t){this.type=e,this.attrs=t}addToSet(e){let t,r=!1;for(let i=0;i<e.length;i++){let o=e[i];if(this.eq(o))return e;if(this.type.excludes(o.type))t||(t=e.slice(0,i));else{if(o.type.excludes(this.type))return e;!r&&o.type.rank>this.type.rank&&(t||(t=e.slice(0,i)),t.push(this),r=!0),t&&t.push(o)}}return t||(t=e.slice()),r||t.push(this),t}removeFromSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return e.slice(0,t).concat(e.slice(t+1));return e}isInSet(e){for(let t=0;t<e.length;t++)if(this.eq(e[t]))return!0;return!1}eq(e){return this==e||this.type==e.type&&ou(this.attrs,e.attrs)}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Mark.fromJSON");let r=e.marks[t.type];if(!r)throw new RangeError(`There is no mark type ${t.type} in this schema`);let i=r.create(t.attrs);return r.checkAttrs(i.attrs),i}static sameSet(e,t){if(e==t)return!0;if(e.length!=t.length)return!1;for(let r=0;r<e.length;r++)if(!e[r].eq(t[r]))return!1;return!0}static setFrom(e){if(!e||Array.isArray(e)&&e.length==0)return Hf.none;if(e instanceof Hf)return[e];let t=e.slice();return t.sort((r,i)=>r.type.rank-i.type.rank),t}};Se.none=[];class su extends Error{}class U{constructor(e,t,r){this.content=e,this.openStart=t,this.openEnd=r}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(e,t){let r=Nk(this.content,e+this.openStart,t);return r&&new U(r,this.openStart,this.openEnd)}removeBetween(e,t){return new U(Rk(this.content,e+this.openStart,t+this.openStart),this.openStart,this.openEnd)}eq(e){return this.content.eq(e.content)&&this.openStart==e.openStart&&this.openEnd==e.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let e={content:this.content.toJSON()};return this.openStart>0&&(e.openStart=this.openStart),this.openEnd>0&&(e.openEnd=this.openEnd),e}static fromJSON(e,t){if(!t)return U.empty;let r=t.openStart||0,i=t.openEnd||0;if(typeof r!="number"||typeof i!="number")throw new RangeError("Invalid input for Slice.fromJSON");return new U(x.fromJSON(e,t.content),r,i)}static maxOpen(e,t=!0){let r=0,i=0;for(let o=e.firstChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.firstChild)r++;for(let o=e.lastChild;o&&!o.isLeaf&&(t||!o.type.spec.isolating);o=o.lastChild)i++;return new U(e,r,i)}}U.empty=new U(x.empty,0,0);function Rk(n,e,t){let{index:r,offset:i}=n.findIndex(e),o=n.maybeChild(r),{index:s,offset:a}=n.findIndex(t);if(i==e||o.isText){if(a!=t&&!n.child(s).isText)throw new RangeError("Removing non-flat range");return n.cut(0,e).append(n.cut(t))}if(r!=s)throw new RangeError("Removing non-flat range");return n.replaceChild(r,o.copy(Rk(o.content,e-i-1,t-i-1)))}function Nk(n,e,t,r){let{index:i,offset:o}=n.findIndex(e),s=n.maybeChild(i);if(o==e||s.isText)return n.cut(0,e).append(t).append(n.cut(e));let a=Nk(s.content,e-o-1,t);return a&&n.replaceChild(i,s.copy(a))}function GM(n,e,t){if(t.openStart>n.depth)throw new su("Inserted content deeper than insertion position");if(n.depth-t.openStart!=e.depth-t.openEnd)throw new su("Inconsistent open depths");return xk(n,e,t,0)}function xk(n,e,t,r){let i=n.index(r),o=n.node(r);if(i==e.index(r)&&r<n.depth-t.openStart){let s=xk(n,e,t,r+1);return o.copy(o.content.replaceChild(i,s))}else if(t.content.size)if(!t.openStart&&!t.openEnd&&n.depth==r&&e.depth==r){let s=n.parent,a=s.content;return Vi(s,a.cut(0,n.parentOffset).append(t.content).append(a.cut(e.parentOffset)))}else{let{start:s,end:a}=qM(t,n);return Vi(o,Mk(n,s,a,e,r))}else return Vi(o,au(n,e,r))}function Ok(n,e){if(!e.type.compatibleContent(n.type))throw new su("Cannot join "+e.type.name+" onto "+n.type.name)}function Ff(n,e,t){let r=n.node(t);return Ok(r,e.node(t)),r}function $i(n,e){let t=e.length-1;t>=0&&n.isText&&n.sameMarkup(e[t])?e[t]=n.withText(e[t].text+n.text):e.push(n)}function ga(n,e,t,r){let i=(e||n).node(t),o=0,s=e?e.index(t):i.childCount;n&&(o=n.index(t),n.depth>t?o++:n.textOffset&&($i(n.nodeAfter,r),o++));for(let a=o;a<s;a++)$i(i.child(a),r);e&&e.depth==t&&e.textOffset&&$i(e.nodeBefore,r)}function Vi(n,e){return n.type.checkContent(e),n.copy(e)}function Mk(n,e,t,r,i){let o=n.depth>i&&Ff(n,e,i+1),s=r.depth>i&&Ff(t,r,i+1),a=[];return ga(null,n,i,a),o&&s&&e.index(i)==t.index(i)?(Ok(o,s),$i(Vi(o,Mk(n,e,t,r,i+1)),a)):(o&&$i(Vi(o,au(n,e,i+1)),a),ga(e,t,i,a),s&&$i(Vi(s,au(t,r,i+1)),a)),ga(r,null,i,a),new x(a)}function au(n,e,t){let r=[];if(ga(null,n,t,r),n.depth>t){let i=Ff(n,e,t+1);$i(Vi(i,au(n,e,t+1)),r)}return ga(e,null,t,r),new x(r)}function qM(n,e){let t=e.depth-n.openStart,i=e.node(t).copy(n.content);for(let o=t-1;o>=0;o--)i=e.node(o).copy(x.from(i));return{start:i.resolveNoCache(n.openStart+t),end:i.resolveNoCache(i.content.size-n.openEnd-t)}}class $a{constructor(e,t,r){this.pos=e,this.path=t,this.parentOffset=r,this.depth=t.length/3-1}resolveDepth(e){return e==null?this.depth:e<0?this.depth+e:e}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(e){return this.path[this.resolveDepth(e)*3]}index(e){return this.path[this.resolveDepth(e)*3+1]}indexAfter(e){return e=this.resolveDepth(e),this.index(e)+(e==this.depth&&!this.textOffset?0:1)}start(e){return e=this.resolveDepth(e),e==0?0:this.path[e*3-1]+1}end(e){return e=this.resolveDepth(e),this.start(e)+this.node(e).content.size}before(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position before the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]}after(e){if(e=this.resolveDepth(e),!e)throw new RangeError("There is no position after the top-level node");return e==this.depth+1?this.pos:this.path[e*3-1]+this.path[e*3].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let e=this.parent,t=this.index(this.depth);if(t==e.childCount)return null;let r=this.pos-this.path[this.path.length-1],i=e.child(t);return r?e.child(t).cut(r):i}get nodeBefore(){let e=this.index(this.depth),t=this.pos-this.path[this.path.length-1];return t?this.parent.child(e).cut(0,t):e==0?null:this.parent.child(e-1)}posAtIndex(e,t){t=this.resolveDepth(t);let r=this.path[t*3],i=t==0?0:this.path[t*3-1]+1;for(let o=0;o<e;o++)i+=r.child(o).nodeSize;return i}marks(){let e=this.parent,t=this.index();if(e.content.size==0)return Se.none;if(this.textOffset)return e.child(t).marks;let r=e.maybeChild(t-1),i=e.maybeChild(t);if(!r){let a=r;r=i,i=a}let o=r.marks;for(var s=0;s<o.length;s++)o[s].type.spec.inclusive===!1&&(!i||!o[s].isInSet(i.marks))&&(o=o[s--].removeFromSet(o));return o}marksAcross(e){let t=this.parent.maybeChild(this.index());if(!t||!t.isInline)return null;let r=t.marks,i=e.parent.maybeChild(e.index());for(var o=0;o<r.length;o++)r[o].type.spec.inclusive===!1&&(!i||!r[o].isInSet(i.marks))&&(r=r[o--].removeFromSet(r));return r}sharedDepth(e){for(let t=this.depth;t>0;t--)if(this.start(t)<=e&&this.end(t)>=e)return t;return 0}blockRange(e=this,t){if(e.pos<this.pos)return e.blockRange(this);for(let r=this.depth-(this.parent.inlineContent||this.pos==e.pos?1:0);r>=0;r--)if(e.pos<=this.end(r)&&(!t||t(this.node(r))))return new lu(this,e,r);return null}sameParent(e){return this.pos-this.parentOffset==e.pos-e.parentOffset}max(e){return e.pos>this.pos?e:this}min(e){return e.pos<this.pos?e:this}toString(){let e="";for(let t=1;t<=this.depth;t++)e+=(e?"/":"")+this.node(t).type.name+"_"+this.index(t-1);return e+":"+this.parentOffset}static resolve(e,t){if(!(t>=0&&t<=e.content.size))throw new RangeError("Position "+t+" out of range");let r=[],i=0,o=t;for(let s=e;;){let{index:a,offset:l}=s.content.findIndex(o),c=o-l;if(r.push(s,a,i+l),!c||(s=s.child(a),s.isText))break;o=c-1,i+=l+1}return new $a(t,r,o)}static resolveCached(e,t){let r=bv.get(e);if(r)for(let o=0;o<r.elts.length;o++){let s=r.elts[o];if(s.pos==t)return s}else bv.set(e,r=new QM);let i=r.elts[r.i]=$a.resolve(e,t);return r.i=(r.i+1)%YM,i}}class QM{constructor(){this.elts=[],this.i=0}}const YM=12,bv=new WeakMap;class lu{constructor(e,t,r){this.$from=e,this.$to=t,this.depth=r}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const JM=Object.create(null);let gi=class Bf{constructor(e,t,r,i=Se.none){this.type=e,this.attrs=t,this.marks=i,this.content=r||x.empty}get children(){return this.content.content}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(e){return this.content.child(e)}maybeChild(e){return this.content.maybeChild(e)}forEach(e){this.content.forEach(e)}nodesBetween(e,t,r,i=0){this.content.nodesBetween(e,t,r,i,this)}descendants(e){this.nodesBetween(0,this.content.size,e)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(e,t,r,i){return this.content.textBetween(e,t,r,i)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(e){return this==e||this.sameMarkup(e)&&this.content.eq(e.content)}sameMarkup(e){return this.hasMarkup(e.type,e.attrs,e.marks)}hasMarkup(e,t,r){return this.type==e&&ou(this.attrs,t||e.defaultAttrs||JM)&&Se.sameSet(this.marks,r||Se.none)}copy(e=null){return e==this.content?this:new Bf(this.type,this.attrs,e,this.marks)}mark(e){return e==this.marks?this:new Bf(this.type,this.attrs,this.content,e)}cut(e,t=this.content.size){return e==0&&t==this.content.size?this:this.copy(this.content.cut(e,t))}slice(e,t=this.content.size,r=!1){if(e==t)return U.empty;let i=this.resolve(e),o=this.resolve(t),s=r?0:i.sharedDepth(t),a=i.start(s),c=i.node(s).content.cut(i.pos-a,o.pos-a);return new U(c,i.depth-s,o.depth-s)}replace(e,t,r){return GM(this.resolve(e),this.resolve(t),r)}nodeAt(e){for(let t=this;;){let{index:r,offset:i}=t.content.findIndex(e);if(t=t.maybeChild(r),!t)return null;if(i==e||t.isText)return t;e-=i+1}}childAfter(e){let{index:t,offset:r}=this.content.findIndex(e);return{node:this.content.maybeChild(t),index:t,offset:r}}childBefore(e){if(e==0)return{node:null,index:0,offset:0};let{index:t,offset:r}=this.content.findIndex(e);if(r<e)return{node:this.content.child(t),index:t,offset:r};let i=this.content.child(t-1);return{node:i,index:t-1,offset:r-i.nodeSize}}resolve(e){return $a.resolveCached(this,e)}resolveNoCache(e){return $a.resolve(this,e)}rangeHasMark(e,t,r){let i=!1;return t>e&&this.nodesBetween(e,t,o=>(r.isInSet(o.marks)&&(i=!0),!i)),i}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let e=this.type.name;return this.content.size&&(e+="("+this.content.toStringInner()+")"),_k(this.marks,e)}contentMatchAt(e){let t=this.type.contentMatch.matchFragment(this.content,0,e);if(!t)throw new Error("Called contentMatchAt on a node with invalid content");return t}canReplace(e,t,r=x.empty,i=0,o=r.childCount){let s=this.contentMatchAt(e).matchFragment(r,i,o),a=s&&s.matchFragment(this.content,t);if(!a||!a.validEnd)return!1;for(let l=i;l<o;l++)if(!this.type.allowsMarks(r.child(l).marks))return!1;return!0}canReplaceWith(e,t,r,i){if(i&&!this.type.allowsMarks(i))return!1;let o=this.contentMatchAt(e).matchType(r),s=o&&o.matchFragment(this.content,t);return s?s.validEnd:!1}canAppend(e){return e.content.size?this.canReplace(this.childCount,this.childCount,e.content):this.type.compatibleContent(e.type)}check(){this.type.checkContent(this.content),this.type.checkAttrs(this.attrs);let e=Se.none;for(let t=0;t<this.marks.length;t++){let r=this.marks[t];r.type.checkAttrs(r.attrs),e=r.addToSet(e)}if(!Se.sameSet(e,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(t=>t.type.name)}`);this.content.forEach(t=>t.check())}toJSON(){let e={type:this.type.name};for(let t in this.attrs){e.attrs=this.attrs;break}return this.content.size&&(e.content=this.content.toJSON()),this.marks.length&&(e.marks=this.marks.map(t=>t.toJSON())),e}static fromJSON(e,t){if(!t)throw new RangeError("Invalid input for Node.fromJSON");let r;if(t.marks){if(!Array.isArray(t.marks))throw new RangeError("Invalid mark data for Node.fromJSON");r=t.marks.map(e.markFromJSON)}if(t.type=="text"){if(typeof t.text!="string")throw new RangeError("Invalid text node in JSON");return e.text(t.text,r)}let i=x.fromJSON(e,t.content),o=e.nodeType(t.type).create(t.attrs,i,r);return o.type.checkAttrs(o.attrs),o}};gi.prototype.text=void 0;class cu extends gi{constructor(e,t,r,i){if(super(e,t,null,i),!r)throw new RangeError("Empty text nodes are not allowed");this.text=r}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):_k(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(e,t){return this.text.slice(e,t)}get nodeSize(){return this.text.length}mark(e){return e==this.marks?this:new cu(this.type,this.attrs,this.text,e)}withText(e){return e==this.text?this:new cu(this.type,this.attrs,e,this.marks)}cut(e=0,t=this.text.length){return e==0&&t==this.text.length?this:this.withText(this.text.slice(e,t))}eq(e){return this.sameMarkup(e)&&this.text==e.text}toJSON(){let e=super.toJSON();return e.text=this.text,e}}function _k(n,e){for(let t=n.length-1;t>=0;t--)e=n[t].type.name+"("+e+")";return e}class so{constructor(e){this.validEnd=e,this.next=[],this.wrapCache=[]}static parse(e,t){let r=new XM(e,t);if(r.next==null)return so.empty;let i=Pk(r);r.next&&r.err("Unexpected trailing text");let o=o_(i_(i));return s_(o,r),o}matchType(e){for(let t=0;t<this.next.length;t++)if(this.next[t].type==e)return this.next[t].next;return null}matchFragment(e,t=0,r=e.childCount){let i=this;for(let o=t;i&&o<r;o++)i=i.matchType(e.child(o).type);return i}get inlineContent(){return this.next.length!=0&&this.next[0].type.isInline}get defaultType(){for(let e=0;e<this.next.length;e++){let{type:t}=this.next[e];if(!(t.isText||t.hasRequiredAttrs()))return t}return null}compatible(e){for(let t=0;t<this.next.length;t++)for(let r=0;r<e.next.length;r++)if(this.next[t].type==e.next[r].type)return!0;return!1}fillBefore(e,t=!1,r=0){let i=[this];function o(s,a){let l=s.matchFragment(e,r);if(l&&(!t||l.validEnd))return x.from(a.map(c=>c.createAndFill()));for(let c=0;c<s.next.length;c++){let{type:u,next:d}=s.next[c];if(!(u.isText||u.hasRequiredAttrs())&&i.indexOf(d)==-1){i.push(d);let h=o(d,a.concat(u));if(h)return h}}return null}return o(this,[])}findWrapping(e){for(let r=0;r<this.wrapCache.length;r+=2)if(this.wrapCache[r]==e)return this.wrapCache[r+1];let t=this.computeWrapping(e);return this.wrapCache.push(e,t),t}computeWrapping(e){let t=Object.create(null),r=[{match:this,type:null,via:null}];for(;r.length;){let i=r.shift(),o=i.match;if(o.matchType(e)){let s=[];for(let a=i;a.type;a=a.via)s.push(a.type);return s.reverse()}for(let s=0;s<o.next.length;s++){let{type:a,next:l}=o.next[s];!a.isLeaf&&!a.hasRequiredAttrs()&&!(a.name in t)&&(!i.type||l.validEnd)&&(r.push({match:a.contentMatch,type:a,via:i}),t[a.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(e){if(e>=this.next.length)throw new RangeError(`There's no ${e}th edge in this content match`);return this.next[e]}toString(){let e=[];function t(r){e.push(r);for(let i=0;i<r.next.length;i++)e.indexOf(r.next[i].next)==-1&&t(r.next[i].next)}return t(this),e.map((r,i)=>{let o=i+(r.validEnd?"*":" ")+" ";for(let s=0;s<r.next.length;s++)o+=(s?", ":"")+r.next[s].type.name+"->"+e.indexOf(r.next[s].next);return o}).join(`
`)}}so.empty=new so(!0);class XM{constructor(e,t){this.string=e,this.nodeTypes=t,this.inline=null,this.pos=0,this.tokens=e.split(/\s*(?=\b|\W|$)/),this.tokens[this.tokens.length-1]==""&&this.tokens.pop(),this.tokens[0]==""&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(e){return this.next==e&&(this.pos++||!0)}err(e){throw new SyntaxError(e+" (in content expression '"+this.string+"')")}}function Pk(n){let e=[];do e.push(ZM(n));while(n.eat("|"));return e.length==1?e[0]:{type:"choice",exprs:e}}function ZM(n){let e=[];do e.push(e_(n));while(n.next&&n.next!=")"&&n.next!="|");return e.length==1?e[0]:{type:"seq",exprs:e}}function e_(n){let e=r_(n);for(;;)if(n.eat("+"))e={type:"plus",expr:e};else if(n.eat("*"))e={type:"star",expr:e};else if(n.eat("?"))e={type:"opt",expr:e};else if(n.eat("{"))e=t_(n,e);else break;return e}function Rv(n){/\D/.test(n.next)&&n.err("Expected number, got '"+n.next+"'");let e=Number(n.next);return n.pos++,e}function t_(n,e){let t=Rv(n),r=t;return n.eat(",")&&(n.next!="}"?r=Rv(n):r=-1),n.eat("}")||n.err("Unclosed braced range"),{type:"range",min:t,max:r,expr:e}}function n_(n,e){let t=n.nodeTypes,r=t[e];if(r)return[r];let i=[];for(let o in t){let s=t[o];s.isInGroup(e)&&i.push(s)}return i.length==0&&n.err("No node type or group '"+e+"' found"),i}function r_(n){if(n.eat("(")){let e=Pk(n);return n.eat(")")||n.err("Missing closing paren"),e}else if(/\W/.test(n.next))n.err("Unexpected token '"+n.next+"'");else{let e=n_(n,n.next).map(t=>(n.inline==null?n.inline=t.isInline:n.inline!=t.isInline&&n.err("Mixing inline and block content"),{type:"name",value:t}));return n.pos++,e.length==1?e[0]:{type:"choice",exprs:e}}}function i_(n){let e=[[]];return i(o(n,0),t()),e;function t(){return e.push([])-1}function r(s,a,l){let c={term:l,to:a};return e[s].push(c),c}function i(s,a){s.forEach(l=>l.to=a)}function o(s,a){if(s.type=="choice")return s.exprs.reduce((l,c)=>l.concat(o(c,a)),[]);if(s.type=="seq")for(let l=0;;l++){let c=o(s.exprs[l],a);if(l==s.exprs.length-1)return c;i(c,a=t())}else if(s.type=="star"){let l=t();return r(a,l),i(o(s.expr,l),l),[r(l)]}else if(s.type=="plus"){let l=t();return i(o(s.expr,a),l),i(o(s.expr,l),l),[r(l)]}else{if(s.type=="opt")return[r(a)].concat(o(s.expr,a));if(s.type=="range"){let l=a;for(let c=0;c<s.min;c++){let u=t();i(o(s.expr,l),u),l=u}if(s.max==-1)i(o(s.expr,l),l);else for(let c=s.min;c<s.max;c++){let u=t();r(l,u),i(o(s.expr,l),u),l=u}return[r(l)]}else{if(s.type=="name")return[r(a,void 0,s.value)];throw new Error("Unknown expr type")}}}}function Dk(n,e){return e-n}function Nv(n,e){let t=[];return r(e),t.sort(Dk);function r(i){let o=n[i];if(o.length==1&&!o[0].term)return r(o[0].to);t.push(i);for(let s=0;s<o.length;s++){let{term:a,to:l}=o[s];!a&&t.indexOf(l)==-1&&r(l)}}}function o_(n){let e=Object.create(null);return t(Nv(n,0));function t(r){let i=[];r.forEach(s=>{n[s].forEach(({term:a,to:l})=>{if(!a)return;let c;for(let u=0;u<i.length;u++)i[u][0]==a&&(c=i[u][1]);Nv(n,l).forEach(u=>{c||i.push([a,c=[]]),c.indexOf(u)==-1&&c.push(u)})})});let o=e[r.join(",")]=new so(r.indexOf(n.length-1)>-1);for(let s=0;s<i.length;s++){let a=i[s][1].sort(Dk);o.next.push({type:i[s][0],next:e[a.join(",")]||t(a)})}return o}}function s_(n,e){for(let t=0,r=[n];t<r.length;t++){let i=r[t],o=!i.validEnd,s=[];for(let a=0;a<i.next.length;a++){let{type:l,next:c}=i.next[a];s.push(l.name),o&&!(l.isText||l.hasRequiredAttrs())&&(o=!1),r.indexOf(c)==-1&&r.push(c)}o&&e.err("Only non-generatable nodes ("+s.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}function Lk(n){let e=Object.create(null);for(let t in n){let r=n[t];if(!r.hasDefault)return null;e[t]=r.default}return e}function Uk(n,e){let t=Object.create(null);for(let r in n){let i=e&&e[r];if(i===void 0){let o=n[r];if(o.hasDefault)i=o.default;else throw new RangeError("No value supplied for attribute "+r)}t[r]=i}return t}function Hk(n,e,t,r){for(let i in e)if(!(i in n))throw new RangeError(`Unsupported attribute ${i} for ${t} of type ${i}`);for(let i in n){let o=n[i];o.validate&&o.validate(e[i])}}function Fk(n,e){let t=Object.create(null);if(e)for(let r in e)t[r]=new l_(n,r,e[r]);return t}let xv=class Bk{constructor(e,t,r){this.name=e,this.schema=t,this.spec=r,this.markSet=null,this.groups=r.group?r.group.split(" "):[],this.attrs=Fk(e,r.attrs),this.defaultAttrs=Lk(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(r.inline||e=="text"),this.isText=e=="text"}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==so.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}isInGroup(e){return this.groups.indexOf(e)>-1}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let e in this.attrs)if(this.attrs[e].isRequired)return!0;return!1}compatibleContent(e){return this==e||this.contentMatch.compatible(e.contentMatch)}computeAttrs(e){return!e&&this.defaultAttrs?this.defaultAttrs:Uk(this.attrs,e)}create(e=null,t,r){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new gi(this,this.computeAttrs(e),x.from(t),Se.setFrom(r))}createChecked(e=null,t,r){return t=x.from(t),this.checkContent(t),new gi(this,this.computeAttrs(e),t,Se.setFrom(r))}createAndFill(e=null,t,r){if(e=this.computeAttrs(e),t=x.from(t),t.size){let s=this.contentMatch.fillBefore(t);if(!s)return null;t=s.append(t)}let i=this.contentMatch.matchFragment(t),o=i&&i.fillBefore(x.empty,!0);return o?new gi(this,e,t.append(o),Se.setFrom(r)):null}validContent(e){let t=this.contentMatch.matchFragment(e);if(!t||!t.validEnd)return!1;for(let r=0;r<e.childCount;r++)if(!this.allowsMarks(e.child(r).marks))return!1;return!0}checkContent(e){if(!this.validContent(e))throw new RangeError(`Invalid content for node ${this.name}: ${e.toString().slice(0,50)}`)}checkAttrs(e){Hk(this.attrs,e,"node",this.name)}allowsMarkType(e){return this.markSet==null||this.markSet.indexOf(e)>-1}allowsMarks(e){if(this.markSet==null)return!0;for(let t=0;t<e.length;t++)if(!this.allowsMarkType(e[t].type))return!1;return!0}allowedMarks(e){if(this.markSet==null)return e;let t;for(let r=0;r<e.length;r++)this.allowsMarkType(e[r].type)?t&&t.push(e[r]):t||(t=e.slice(0,r));return t?t.length?t:Se.none:e}static compile(e,t){let r=Object.create(null);e.forEach((o,s)=>r[o]=new Bk(o,t,s));let i=t.spec.topNode||"doc";if(!r[i])throw new RangeError("Schema is missing its top node type ('"+i+"')");if(!r.text)throw new RangeError("Every schema needs a 'text' type");for(let o in r.text.attrs)throw new RangeError("The text node type should not have attributes");return r}};function a_(n,e,t){let r=t.split("|");return i=>{let o=i===null?"null":typeof i;if(r.indexOf(o)<0)throw new RangeError(`Expected value of type ${r} for attribute ${e} on type ${n}, got ${o}`)}}class l_{constructor(e,t,r){this.hasDefault=Object.prototype.hasOwnProperty.call(r,"default"),this.default=r.default,this.validate=typeof r.validate=="string"?a_(e,t,r.validate):r.validate}get isRequired(){return!this.hasDefault}}class ed{constructor(e,t,r,i){this.name=e,this.rank=t,this.schema=r,this.spec=i,this.attrs=Fk(e,i.attrs),this.excluded=null;let o=Lk(this.attrs);this.instance=o?new Se(this,o):null}create(e=null){return!e&&this.instance?this.instance:new Se(this,Uk(this.attrs,e))}static compile(e,t){let r=Object.create(null),i=0;return e.forEach((o,s)=>r[o]=new ed(o,i++,t,s)),r}removeFromSet(e){for(var t=0;t<e.length;t++)e[t].type==this&&(e=e.slice(0,t).concat(e.slice(t+1)),t--);return e}isInSet(e){for(let t=0;t<e.length;t++)if(e[t].type==this)return e[t]}checkAttrs(e){Hk(this.attrs,e,"mark",this.name)}excludes(e){return this.excluded.indexOf(e)>-1}}class zk{constructor(e){this.linebreakReplacement=null,this.cached=Object.create(null);let t=this.spec={};for(let i in e)t[i]=e[i];t.nodes=ft.from(e.nodes),t.marks=ft.from(e.marks||{}),this.nodes=xv.compile(this.spec.nodes,this),this.marks=ed.compile(this.spec.marks,this);let r=Object.create(null);for(let i in this.nodes){if(i in this.marks)throw new RangeError(i+" can not be both a node and a mark");let o=this.nodes[i],s=o.spec.content||"",a=o.spec.marks;if(o.contentMatch=r[s]||(r[s]=so.parse(s,this.nodes)),o.inlineContent=o.contentMatch.inlineContent,o.spec.linebreakReplacement){if(this.linebreakReplacement)throw new RangeError("Multiple linebreak nodes defined");if(!o.isInline||!o.isLeaf)throw new RangeError("Linebreak replacement nodes must be inline leaf nodes");this.linebreakReplacement=o}o.markSet=a=="_"?null:a?Ov(this,a.split(" ")):a==""||!o.inlineContent?[]:null}for(let i in this.marks){let o=this.marks[i],s=o.spec.excludes;o.excluded=s==null?[o]:s==""?[]:Ov(this,s.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(e,t=null,r,i){if(typeof e=="string")e=this.nodeType(e);else if(e instanceof xv){if(e.schema!=this)throw new RangeError("Node type from different schema used ("+e.name+")")}else throw new RangeError("Invalid node type: "+e);return e.createChecked(t,r,i)}text(e,t){let r=this.nodes.text;return new cu(r,r.defaultAttrs,e,Se.setFrom(t))}mark(e,t){return typeof e=="string"&&(e=this.marks[e]),e.create(t)}nodeFromJSON(e){return gi.fromJSON(this,e)}markFromJSON(e){return Se.fromJSON(this,e)}nodeType(e){let t=this.nodes[e];if(!t)throw new RangeError("Unknown node type: "+e);return t}}function Ov(n,e){let t=[];for(let r=0;r<e.length;r++){let i=e[r],o=n.marks[i],s=o;if(o)t.push(o);else for(let a in n.marks){let l=n.marks[a];(i=="_"||l.spec.group&&l.spec.group.split(" ").indexOf(i)>-1)&&t.push(s=l)}if(!s)throw new SyntaxError("Unknown mark type: '"+e[r]+"'")}return t}function c_(n){return n.tag!=null}function u_(n){return n.style!=null}let ya=class zf{constructor(e,t){this.schema=e,this.rules=t,this.tags=[],this.styles=[];let r=this.matchedStyles=[];t.forEach(i=>{if(c_(i))this.tags.push(i);else if(u_(i)){let o=/[^=]*/.exec(i.style)[0];r.indexOf(o)<0&&r.push(o),this.styles.push(i)}}),this.normalizeLists=!this.tags.some(i=>{if(!/^(ul|ol)\b/.test(i.tag)||!i.node)return!1;let o=e.nodes[i.node];return o.contentMatch.matchType(o)})}parse(e,t={}){let r=new _v(this,t,!1);return r.addAll(e,Se.none,t.from,t.to),r.finish()}parseSlice(e,t={}){let r=new _v(this,t,!0);return r.addAll(e,Se.none,t.from,t.to),U.maxOpen(r.finish())}matchTag(e,t,r){for(let i=r?this.tags.indexOf(r)+1:0;i<this.tags.length;i++){let o=this.tags[i];if(f_(e,o.tag)&&(o.namespace===void 0||e.namespaceURI==o.namespace)&&(!o.context||t.matchesContext(o.context))){if(o.getAttrs){let s=o.getAttrs(e);if(s===!1)continue;o.attrs=s||void 0}return o}}}matchStyle(e,t,r,i){for(let o=i?this.styles.indexOf(i)+1:0;o<this.styles.length;o++){let s=this.styles[o],a=s.style;if(!(a.indexOf(e)!=0||s.context&&!r.matchesContext(s.context)||a.length>e.length&&(a.charCodeAt(e.length)!=61||a.slice(e.length+1)!=t))){if(s.getAttrs){let l=s.getAttrs(t);if(l===!1)continue;s.attrs=l||void 0}return s}}}static schemaRules(e){let t=[];function r(i){let o=i.priority==null?50:i.priority,s=0;for(;s<t.length;s++){let a=t[s];if((a.priority==null?50:a.priority)<o)break}t.splice(s,0,i)}for(let i in e.marks){let o=e.marks[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Pv(s)),s.mark||s.ignore||s.clearMark||(s.mark=i)})}for(let i in e.nodes){let o=e.nodes[i].spec.parseDOM;o&&o.forEach(s=>{r(s=Pv(s)),s.node||s.ignore||s.mark||(s.node=i)})}return t}static fromSchema(e){return e.cached.domParser||(e.cached.domParser=new zf(e,zf.schemaRules(e)))}};const jk={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},d_={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Kk={ol:!0,ul:!0},Va=1,jf=2,va=4;function Mv(n,e,t){return e!=null?(e?Va:0)|(e==="full"?jf:0):n&&n.whitespace=="pre"?Va|jf:t&~va}class jl{constructor(e,t,r,i,o,s){this.type=e,this.attrs=t,this.marks=r,this.solid=i,this.options=s,this.content=[],this.activeMarks=Se.none,this.match=o||(s&va?null:e.contentMatch)}findWrapping(e){if(!this.match){if(!this.type)return[];let t=this.type.contentMatch.fillBefore(x.from(e));if(t)this.match=this.type.contentMatch.matchFragment(t);else{let r=this.type.contentMatch,i;return(i=r.findWrapping(e.type))?(this.match=r,i):null}}return this.match.findWrapping(e.type)}finish(e){if(!(this.options&Va)){let r=this.content[this.content.length-1],i;if(r&&r.isText&&(i=/[ \t\r\n\u000c]+$/.exec(r.text))){let o=r;r.text.length==i[0].length?this.content.pop():this.content[this.content.length-1]=o.withText(o.text.slice(0,o.text.length-i[0].length))}}let t=x.from(this.content);return!e&&this.match&&(t=t.append(this.match.fillBefore(x.empty,!0))),this.type?this.type.create(this.attrs,t,this.marks):t}inlineContext(e){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:e.parentNode&&!jk.hasOwnProperty(e.parentNode.nodeName.toLowerCase())}}class _v{constructor(e,t,r){this.parser=e,this.options=t,this.isOpen=r,this.open=0,this.localPreserveWS=!1;let i=t.topNode,o,s=Mv(null,t.preserveWhitespace,0)|(r?va:0);i?o=new jl(i.type,i.attrs,Se.none,!0,t.topMatch||i.type.contentMatch,s):r?o=new jl(null,null,Se.none,!0,null,s):o=new jl(e.schema.topNodeType,null,Se.none,!0,null,s),this.nodes=[o],this.find=t.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(e,t){e.nodeType==3?this.addTextNode(e,t):e.nodeType==1&&this.addElement(e,t)}addTextNode(e,t){let r=e.nodeValue,i=this.top,o=i.options&jf?"full":this.localPreserveWS||(i.options&Va)>0;if(o==="full"||i.inlineContext(e)||/[^ \t\r\n\u000c]/.test(r)){if(o)o!=="full"?r=r.replace(/\r?\n|\r/g," "):r=r.replace(/\r\n?/g,`
`);else if(r=r.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(r)&&this.open==this.nodes.length-1){let s=i.content[i.content.length-1],a=e.previousSibling;(!s||a&&a.nodeName=="BR"||s.isText&&/[ \t\r\n\u000c]$/.test(s.text))&&(r=r.slice(1))}r&&this.insertNode(this.parser.schema.text(r),t),this.findInText(e)}else this.findInside(e)}addElement(e,t,r){let i=this.localPreserveWS,o=this.top;(e.tagName=="PRE"||/pre/.test(e.style&&e.style.whiteSpace))&&(this.localPreserveWS=!0);let s=e.nodeName.toLowerCase(),a;Kk.hasOwnProperty(s)&&this.parser.normalizeLists&&h_(e);let l=this.options.ruleFromNode&&this.options.ruleFromNode(e)||(a=this.parser.matchTag(e,this,r));e:if(l?l.ignore:d_.hasOwnProperty(s))this.findInside(e),this.ignoreFallback(e,t);else if(!l||l.skip||l.closeParent){l&&l.closeParent?this.open=Math.max(0,this.open-1):l&&l.skip.nodeType&&(e=l.skip);let c,u=this.needsBlock;if(jk.hasOwnProperty(s))o.content.length&&o.content[0].isInline&&this.open&&(this.open--,o=this.top),c=!0,o.type||(this.needsBlock=!0);else if(!e.firstChild){this.leafFallback(e,t);break e}let d=l&&l.skip?t:this.readStyles(e,t);d&&this.addAll(e,d),c&&this.sync(o),this.needsBlock=u}else{let c=this.readStyles(e,t);c&&this.addElementByRule(e,l,c,l.consuming===!1?a:void 0)}this.localPreserveWS=i}leafFallback(e,t){e.nodeName=="BR"&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(e.ownerDocument.createTextNode(`
`),t)}ignoreFallback(e,t){e.nodeName=="BR"&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"),t)}readStyles(e,t){let r=e.style;if(r&&r.length)for(let i=0;i<this.parser.matchedStyles.length;i++){let o=this.parser.matchedStyles[i],s=r.getPropertyValue(o);if(s)for(let a=void 0;;){let l=this.parser.matchStyle(o,s,this,a);if(!l)break;if(l.ignore)return null;if(l.clearMark?t=t.filter(c=>!l.clearMark(c)):t=t.concat(this.parser.schema.marks[l.mark].create(l.attrs)),l.consuming===!1)a=l;else break}}return t}addElementByRule(e,t,r,i){let o,s;if(t.node)if(s=this.parser.schema.nodes[t.node],s.isLeaf)this.insertNode(s.create(t.attrs),r)||this.leafFallback(e,r);else{let l=this.enter(s,t.attrs||null,r,t.preserveWhitespace);l&&(o=!0,r=l)}else{let l=this.parser.schema.marks[t.mark];r=r.concat(l.create(t.attrs))}let a=this.top;if(s&&s.isLeaf)this.findInside(e);else if(i)this.addElement(e,r,i);else if(t.getContent)this.findInside(e),t.getContent(e,this.parser.schema).forEach(l=>this.insertNode(l,r));else{let l=e;typeof t.contentElement=="string"?l=e.querySelector(t.contentElement):typeof t.contentElement=="function"?l=t.contentElement(e):t.contentElement&&(l=t.contentElement),this.findAround(e,l,!0),this.addAll(l,r),this.findAround(e,l,!1)}o&&this.sync(a)&&this.open--}addAll(e,t,r,i){let o=r||0;for(let s=r?e.childNodes[r]:e.firstChild,a=i==null?null:e.childNodes[i];s!=a;s=s.nextSibling,++o)this.findAtPoint(e,o),this.addDOM(s,t);this.findAtPoint(e,o)}findPlace(e,t){let r,i;for(let o=this.open;o>=0;o--){let s=this.nodes[o],a=s.findWrapping(e);if(a&&(!r||r.length>a.length)&&(r=a,i=s,!a.length)||s.solid)break}if(!r)return null;this.sync(i);for(let o=0;o<r.length;o++)t=this.enterInner(r[o],null,t,!1);return t}insertNode(e,t){if(e.isInline&&this.needsBlock&&!this.top.type){let i=this.textblockFromContext();i&&(t=this.enterInner(i,null,t))}let r=this.findPlace(e,t);if(r){this.closeExtra();let i=this.top;i.match&&(i.match=i.match.matchType(e.type));let o=Se.none;for(let s of r.concat(e.marks))(i.type?i.type.allowsMarkType(s.type):Dv(s.type,e.type))&&(o=s.addToSet(o));return i.content.push(e.mark(o)),!0}return!1}enter(e,t,r,i){let o=this.findPlace(e.create(t),r);return o&&(o=this.enterInner(e,t,r,!0,i)),o}enterInner(e,t,r,i=!1,o){this.closeExtra();let s=this.top;s.match=s.match&&s.match.matchType(e);let a=Mv(e,o,s.options);s.options&va&&s.content.length==0&&(a|=va);let l=Se.none;return r=r.filter(c=>(s.type?s.type.allowsMarkType(c.type):Dv(c.type,e))?(l=c.addToSet(l),!1):!0),this.nodes.push(new jl(e,t,l,i,null,a)),this.open++,r}closeExtra(e=!1){let t=this.nodes.length-1;if(t>this.open){for(;t>this.open;t--)this.nodes[t-1].content.push(this.nodes[t].finish(e));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(!!(this.isOpen||this.options.topOpen))}sync(e){for(let t=this.open;t>=0;t--){if(this.nodes[t]==e)return this.open=t,!0;this.localPreserveWS&&(this.nodes[t].options|=Va)}return!1}get currentPos(){this.closeExtra();let e=0;for(let t=this.open;t>=0;t--){let r=this.nodes[t].content;for(let i=r.length-1;i>=0;i--)e+=r[i].nodeSize;t&&e++}return e}findAtPoint(e,t){if(this.find)for(let r=0;r<this.find.length;r++)this.find[r].node==e&&this.find[r].offset==t&&(this.find[r].pos=this.currentPos)}findInside(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].pos==null&&e.nodeType==1&&e.contains(this.find[t].node)&&(this.find[t].pos=this.currentPos)}findAround(e,t,r){if(e!=t&&this.find)for(let i=0;i<this.find.length;i++)this.find[i].pos==null&&e.nodeType==1&&e.contains(this.find[i].node)&&t.compareDocumentPosition(this.find[i].node)&(r?2:4)&&(this.find[i].pos=this.currentPos)}findInText(e){if(this.find)for(let t=0;t<this.find.length;t++)this.find[t].node==e&&(this.find[t].pos=this.currentPos-(e.nodeValue.length-this.find[t].offset))}matchesContext(e){if(e.indexOf("|")>-1)return e.split(/\s*\|\s*/).some(this.matchesContext,this);let t=e.split("/"),r=this.options.context,i=!this.isOpen&&(!r||r.parent.type==this.nodes[0].type),o=-(r?r.depth+1:0)+(i?0:1),s=(a,l)=>{for(;a>=0;a--){let c=t[a];if(c==""){if(a==t.length-1||a==0)continue;for(;l>=o;l--)if(s(a-1,l))return!0;return!1}else{let u=l>0||l==0&&i?this.nodes[l].type:r&&l>=o?r.node(l-o).type:null;if(!u||u.name!=c&&!u.isInGroup(c))return!1;l--}}return!0};return s(t.length-1,this.open)}textblockFromContext(){let e=this.options.context;if(e)for(let t=e.depth;t>=0;t--){let r=e.node(t).contentMatchAt(e.indexAfter(t)).defaultType;if(r&&r.isTextblock&&r.defaultAttrs)return r}for(let t in this.parser.schema.nodes){let r=this.parser.schema.nodes[t];if(r.isTextblock&&r.defaultAttrs)return r}}}function h_(n){for(let e=n.firstChild,t=null;e;e=e.nextSibling){let r=e.nodeType==1?e.nodeName.toLowerCase():null;r&&Kk.hasOwnProperty(r)&&t?(t.appendChild(e),e=t):r=="li"?t=e:r&&(t=null)}}function f_(n,e){return(n.matches||n.msMatchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector).call(n,e)}function Pv(n){let e={};for(let t in n)e[t]=n[t];return e}function Dv(n,e){let t=e.schema.nodes;for(let r in t){let i=t[r];if(!i.allowsMarkType(n))continue;let o=[],s=a=>{o.push(a);for(let l=0;l<a.edgeCount;l++){let{type:c,next:u}=a.edge(l);if(c==e||o.indexOf(u)<0&&s(u))return!0}};if(s(i.contentMatch))return!0}}class po{constructor(e,t){this.nodes=e,this.marks=t}serializeFragment(e,t={},r){r||(r=Zd(t).createDocumentFragment());let i=r,o=[];return e.forEach(s=>{if(o.length||s.marks.length){let a=0,l=0;for(;a<o.length&&l<s.marks.length;){let c=s.marks[l];if(!this.marks[c.type.name]){l++;continue}if(!c.eq(o[a][0])||c.type.spec.spanning===!1)break;a++,l++}for(;a<o.length;)i=o.pop()[1];for(;l<s.marks.length;){let c=s.marks[l++],u=this.serializeMark(c,s.isInline,t);u&&(o.push([c,i]),i.appendChild(u.dom),i=u.contentDOM||u.dom)}}i.appendChild(this.serializeNodeInner(s,t))}),r}serializeNodeInner(e,t){let{dom:r,contentDOM:i}=cc(Zd(t),this.nodes[e.type.name](e),null,e.attrs);if(i){if(e.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(e.content,t,i)}return r}serializeNode(e,t={}){let r=this.serializeNodeInner(e,t);for(let i=e.marks.length-1;i>=0;i--){let o=this.serializeMark(e.marks[i],e.isInline,t);o&&((o.contentDOM||o.dom).appendChild(r),r=o.dom)}return r}serializeMark(e,t,r={}){let i=this.marks[e.type.name];return i&&cc(Zd(r),i(e,t),null,e.attrs)}static renderSpec(e,t,r=null,i){return cc(e,t,r,i)}static fromSchema(e){return e.cached.domSerializer||(e.cached.domSerializer=new po(this.nodesFromSchema(e),this.marksFromSchema(e)))}static nodesFromSchema(e){let t=Lv(e.nodes);return t.text||(t.text=r=>r.text),t}static marksFromSchema(e){return Lv(e.marks)}}function Lv(n){let e={};for(let t in n){let r=n[t].spec.toDOM;r&&(e[t]=r)}return e}function Zd(n){return n.document||window.document}const Uv=new WeakMap;function p_(n){let e=Uv.get(n);return e===void 0&&Uv.set(n,e=m_(n)),e}function m_(n){let e=null;function t(r){if(r&&typeof r=="object")if(Array.isArray(r))if(typeof r[0]=="string")e||(e=[]),e.push(r);else for(let i=0;i<r.length;i++)t(r[i]);else for(let i in r)t(r[i])}return t(n),e}function cc(n,e,t,r){if(typeof e=="string")return{dom:n.createTextNode(e)};if(e.nodeType!=null)return{dom:e};if(e.dom&&e.dom.nodeType!=null)return e;let i=e[0],o;if(typeof i!="string")throw new RangeError("Invalid array passed to renderSpec");if(r&&(o=p_(r))&&o.indexOf(e)>-1)throw new RangeError("Using an array from an attribute object as a DOM spec. This may be an attempted cross site scripting attack.");let s=i.indexOf(" ");s>0&&(t=i.slice(0,s),i=i.slice(s+1));let a,l=t?n.createElementNS(t,i):n.createElement(i),c=e[1],u=1;if(c&&typeof c=="object"&&c.nodeType==null&&!Array.isArray(c)){u=2;for(let d in c)if(c[d]!=null){let h=d.indexOf(" ");h>0?l.setAttributeNS(d.slice(0,h),d.slice(h+1),c[d]):l.setAttribute(d,c[d])}}for(let d=u;d<e.length;d++){let h=e[d];if(h===0){if(d<e.length-1||d>u)throw new RangeError("Content hole must be the only child of its parent node");return{dom:l,contentDOM:l}}else{let{dom:f,contentDOM:p}=cc(n,h,t,r);if(l.appendChild(f),p){if(a)throw new RangeError("Multiple content holes");a=p}}}return{dom:l,contentDOM:a}}const $k=65535,Vk=Math.pow(2,16);function g_(n,e){return n+e*Vk}function Hv(n){return n&$k}function y_(n){return(n-(n&$k))/Vk}const Wk=1,Gk=2,uc=4,qk=8;class Kf{constructor(e,t,r){this.pos=e,this.delInfo=t,this.recover=r}get deleted(){return(this.delInfo&qk)>0}get deletedBefore(){return(this.delInfo&(Wk|uc))>0}get deletedAfter(){return(this.delInfo&(Gk|uc))>0}get deletedAcross(){return(this.delInfo&uc)>0}}class dn{constructor(e,t=!1){if(this.ranges=e,this.inverted=t,!e.length&&dn.empty)return dn.empty}recover(e){let t=0,r=Hv(e);if(!this.inverted)for(let i=0;i<r;i++)t+=this.ranges[i*3+2]-this.ranges[i*3+1];return this.ranges[r*3]+t+y_(e)}mapResult(e,t=1){return this._map(e,t,!1)}map(e,t=1){return this._map(e,t,!0)}_map(e,t,r){let i=0,o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?i:0);if(l>e)break;let c=this.ranges[a+o],u=this.ranges[a+s],d=l+c;if(e<=d){let h=c?e==l?-1:e==d?1:t:t,f=l+i+(h<0?0:u);if(r)return f;let p=e==(t<0?l:d)?null:g_(a/3,e-l),m=e==l?Gk:e==d?Wk:uc;return(t<0?e!=l:e!=d)&&(m|=qk),new Kf(f,m,p)}i+=u-c}return r?e+i:new Kf(e+i,0,null)}touches(e,t){let r=0,i=Hv(t),o=this.inverted?2:1,s=this.inverted?1:2;for(let a=0;a<this.ranges.length;a+=3){let l=this.ranges[a]-(this.inverted?r:0);if(l>e)break;let c=this.ranges[a+o],u=l+c;if(e<=u&&a==i*3)return!0;r+=this.ranges[a+s]-c}return!1}forEach(e){let t=this.inverted?2:1,r=this.inverted?1:2;for(let i=0,o=0;i<this.ranges.length;i+=3){let s=this.ranges[i],a=s-(this.inverted?o:0),l=s+(this.inverted?0:o),c=this.ranges[i+t],u=this.ranges[i+r];e(a,a+c,l,l+u),o+=u-c}}invert(){return new dn(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(e){return e==0?dn.empty:new dn(e<0?[0,-e,0]:[0,0,e])}}dn.empty=new dn([]);class Wa{constructor(e,t,r=0,i=e?e.length:0){this.mirror=t,this.from=r,this.to=i,this._maps=e||[],this.ownData=!(e||t)}get maps(){return this._maps}slice(e=0,t=this.maps.length){return new Wa(this._maps,this.mirror,e,t)}appendMap(e,t){this.ownData||(this._maps=this._maps.slice(),this.mirror=this.mirror&&this.mirror.slice(),this.ownData=!0),this.to=this._maps.push(e),t!=null&&this.setMirror(this._maps.length-1,t)}appendMapping(e){for(let t=0,r=this._maps.length;t<e._maps.length;t++){let i=e.getMirror(t);this.appendMap(e._maps[t],i!=null&&i<t?r+i:void 0)}}getMirror(e){if(this.mirror){for(let t=0;t<this.mirror.length;t++)if(this.mirror[t]==e)return this.mirror[t+(t%2?-1:1)]}}setMirror(e,t){this.mirror||(this.mirror=[]),this.mirror.push(e,t)}appendMappingInverted(e){for(let t=e.maps.length-1,r=this._maps.length+e._maps.length;t>=0;t--){let i=e.getMirror(t);this.appendMap(e._maps[t].invert(),i!=null&&i>t?r-i-1:void 0)}}invert(){let e=new Wa;return e.appendMappingInverted(this),e}map(e,t=1){if(this.mirror)return this._map(e,t,!0);for(let r=this.from;r<this.to;r++)e=this._maps[r].map(e,t);return e}mapResult(e,t=1){return this._map(e,t,!1)}_map(e,t,r){let i=0;for(let o=this.from;o<this.to;o++){let s=this._maps[o],a=s.mapResult(e,t);if(a.recover!=null){let l=this.getMirror(o);if(l!=null&&l>o&&l<this.to){o=l,e=this._maps[l].recover(a.recover);continue}}i|=a.delInfo,e=a.pos}return r?e:new Kf(e,i,null)}}const eh=Object.create(null);class xt{getMap(){return dn.empty}merge(e){return null}static fromJSON(e,t){if(!t||!t.stepType)throw new RangeError("Invalid input for Step.fromJSON");let r=eh[t.stepType];if(!r)throw new RangeError(`No step type ${t.stepType} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in eh)throw new RangeError("Duplicate use of step JSON ID "+e);return eh[e]=t,t.prototype.jsonID=e,t}}class Ge{constructor(e,t){this.doc=e,this.failed=t}static ok(e){return new Ge(e,null)}static fail(e){return new Ge(null,e)}static fromReplace(e,t,r,i){try{return Ge.ok(e.replace(t,r,i))}catch(o){if(o instanceof su)return Ge.fail(o.message);throw o}}}function Qm(n,e,t){let r=[];for(let i=0;i<n.childCount;i++){let o=n.child(i);o.content.size&&(o=o.copy(Qm(o.content,e,o))),o.isInline&&(o=e(o,t,i)),r.push(o)}return x.fromArray(r)}class ni extends xt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=e.resolve(this.from),i=r.node(r.sharedDepth(this.to)),o=new U(Qm(t.content,(s,a)=>!s.isAtom||!a.type.allowsMarkType(this.mark.type)?s:s.mark(this.mark.addToSet(s.marks)),i),t.openStart,t.openEnd);return Ge.fromReplace(e,this.from,this.to,o)}invert(){return new or(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new ni(t.pos,r.pos,this.mark)}merge(e){return e instanceof ni&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new ni(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new ni(t.from,t.to,e.markFromJSON(t.mark))}}xt.jsonID("addMark",ni);class or extends xt{constructor(e,t,r){super(),this.from=e,this.to=t,this.mark=r}apply(e){let t=e.slice(this.from,this.to),r=new U(Qm(t.content,i=>i.mark(this.mark.removeFromSet(i.marks)),e),t.openStart,t.openEnd);return Ge.fromReplace(e,this.from,this.to,r)}invert(){return new ni(this.from,this.to,this.mark)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deleted&&r.deleted||t.pos>=r.pos?null:new or(t.pos,r.pos,this.mark)}merge(e){return e instanceof or&&e.mark.eq(this.mark)&&this.from<=e.to&&this.to>=e.from?new or(Math.min(this.from,e.from),Math.max(this.to,e.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new or(t.from,t.to,e.markFromJSON(t.mark))}}xt.jsonID("removeMark",or);class ri extends xt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ge.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.addToSet(t.marks));return Ge.fromReplace(e,this.pos,this.pos+1,new U(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);if(t){let r=this.mark.addToSet(t.marks);if(r.length==t.marks.length){for(let i=0;i<t.marks.length;i++)if(!t.marks[i].isInSet(r))return new ri(this.pos,t.marks[i]);return new ri(this.pos,this.mark)}}return new ms(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ri(t.pos,this.mark)}toJSON(){return{stepType:"addNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for AddNodeMarkStep.fromJSON");return new ri(t.pos,e.markFromJSON(t.mark))}}xt.jsonID("addNodeMark",ri);class ms extends xt{constructor(e,t){super(),this.pos=e,this.mark=t}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ge.fail("No node at mark step's position");let r=t.type.create(t.attrs,null,this.mark.removeFromSet(t.marks));return Ge.fromReplace(e,this.pos,this.pos+1,new U(x.from(r),0,t.isLeaf?0:1))}invert(e){let t=e.nodeAt(this.pos);return!t||!this.mark.isInSet(t.marks)?this:new ri(this.pos,this.mark)}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new ms(t.pos,this.mark)}toJSON(){return{stepType:"removeNodeMark",pos:this.pos,mark:this.mark.toJSON()}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for RemoveNodeMarkStep.fromJSON");return new ms(t.pos,e.markFromJSON(t.mark))}}xt.jsonID("removeNodeMark",ms);class ot extends xt{constructor(e,t,r,i=!1){super(),this.from=e,this.to=t,this.slice=r,this.structure=i}apply(e){return this.structure&&$f(e,this.from,this.to)?Ge.fail("Structure replace would overwrite content"):Ge.fromReplace(e,this.from,this.to,this.slice)}getMap(){return new dn([this.from,this.to-this.from,this.slice.size])}invert(e){return new ot(this.from,this.from+this.slice.size,e.slice(this.from,this.to))}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1);return t.deletedAcross&&r.deletedAcross?null:new ot(t.pos,Math.max(t.pos,r.pos),this.slice)}merge(e){if(!(e instanceof ot)||e.structure||this.structure)return null;if(this.from+this.slice.size==e.from&&!this.slice.openEnd&&!e.slice.openStart){let t=this.slice.size+e.slice.size==0?U.empty:new U(this.slice.content.append(e.slice.content),this.slice.openStart,e.slice.openEnd);return new ot(this.from,this.to+(e.to-e.from),t,this.structure)}else if(e.to==this.from&&!this.slice.openStart&&!e.slice.openEnd){let t=this.slice.size+e.slice.size==0?U.empty:new U(e.slice.content.append(this.slice.content),e.slice.openStart,this.slice.openEnd);return new ot(e.from,this.to,t,this.structure)}else return null}toJSON(){let e={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number")throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new ot(t.from,t.to,U.fromJSON(e,t.slice),!!t.structure)}}xt.jsonID("replace",ot);class at extends xt{constructor(e,t,r,i,o,s,a=!1){super(),this.from=e,this.to=t,this.gapFrom=r,this.gapTo=i,this.slice=o,this.insert=s,this.structure=a}apply(e){if(this.structure&&($f(e,this.from,this.gapFrom)||$f(e,this.gapTo,this.to)))return Ge.fail("Structure gap-replace would overwrite content");let t=e.slice(this.gapFrom,this.gapTo);if(t.openStart||t.openEnd)return Ge.fail("Gap is not a flat range");let r=this.slice.insertAt(this.insert,t.content);return r?Ge.fromReplace(e,this.from,this.to,r):Ge.fail("Content does not fit in gap")}getMap(){return new dn([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(e){let t=this.gapTo-this.gapFrom;return new at(this.from,this.from+this.slice.size+t,this.from+this.insert,this.from+this.insert+t,e.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(e){let t=e.mapResult(this.from,1),r=e.mapResult(this.to,-1),i=this.from==this.gapFrom?t.pos:e.map(this.gapFrom,-1),o=this.to==this.gapTo?r.pos:e.map(this.gapTo,1);return t.deletedAcross&&r.deletedAcross||i<t.pos||o>r.pos?null:new at(t.pos,r.pos,i,o,this.slice,this.insert,this.structure)}toJSON(){let e={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(e.slice=this.slice.toJSON()),this.structure&&(e.structure=!0),e}static fromJSON(e,t){if(typeof t.from!="number"||typeof t.to!="number"||typeof t.gapFrom!="number"||typeof t.gapTo!="number"||typeof t.insert!="number")throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new at(t.from,t.to,t.gapFrom,t.gapTo,U.fromJSON(e,t.slice),t.insert,!!t.structure)}}xt.jsonID("replaceAround",at);function $f(n,e,t){let r=n.resolve(e),i=t-e,o=r.depth;for(;i>0&&o>0&&r.indexAfter(o)==r.node(o).childCount;)o--,i--;if(i>0){let s=r.node(o).maybeChild(r.indexAfter(o));for(;i>0;){if(!s||s.isLeaf)return!0;s=s.firstChild,i--}}return!1}function v_(n,e,t,r){let i=[],o=[],s,a;n.doc.nodesBetween(e,t,(l,c,u)=>{if(!l.isInline)return;let d=l.marks;if(!r.isInSet(d)&&u.type.allowsMarkType(r.type)){let h=Math.max(c,e),f=Math.min(c+l.nodeSize,t),p=r.addToSet(d);for(let m=0;m<d.length;m++)d[m].isInSet(p)||(s&&s.to==h&&s.mark.eq(d[m])?s.to=f:i.push(s=new or(h,f,d[m])));a&&a.to==h?a.to=f:o.push(a=new ni(h,f,r))}}),i.forEach(l=>n.step(l)),o.forEach(l=>n.step(l))}function C_(n,e,t,r){let i=[],o=0;n.doc.nodesBetween(e,t,(s,a)=>{if(!s.isInline)return;o++;let l=null;if(r instanceof ed){let c=s.marks,u;for(;u=r.isInSet(c);)(l||(l=[])).push(u),c=u.removeFromSet(c)}else r?r.isInSet(s.marks)&&(l=[r]):l=s.marks;if(l&&l.length){let c=Math.min(a+s.nodeSize,t);for(let u=0;u<l.length;u++){let d=l[u],h;for(let f=0;f<i.length;f++){let p=i[f];p.step==o-1&&d.eq(i[f].style)&&(h=p)}h?(h.to=c,h.step=o):i.push({style:d,from:Math.max(a,e),to:c,step:o})}}}),i.forEach(s=>n.step(new or(s.from,s.to,s.style)))}function Ym(n,e,t,r=t.contentMatch,i=!0){let o=n.doc.nodeAt(e),s=[],a=e+1;for(let l=0;l<o.childCount;l++){let c=o.child(l),u=a+c.nodeSize,d=r.matchType(c.type);if(!d)s.push(new ot(a,u,U.empty));else{r=d;for(let h=0;h<c.marks.length;h++)t.allowsMarkType(c.marks[h].type)||n.step(new or(a,u,c.marks[h]));if(i&&c.isText&&t.whitespace!="pre"){let h,f=/\r?\n|\r/g,p;for(;h=f.exec(c.text);)p||(p=new U(x.from(t.schema.text(" ",t.allowedMarks(c.marks))),0,0)),s.push(new ot(a+h.index,a+h.index+h[0].length,p))}}a=u}if(!r.validEnd){let l=r.fillBefore(x.empty,!0);n.replace(a,a,new U(l,0,0))}for(let l=s.length-1;l>=0;l--)n.step(s[l])}function S_(n,e,t){return(e==0||n.canReplace(e,n.childCount))&&(t==n.childCount||n.canReplace(0,t))}function xs(n){let t=n.parent.content.cutByIndex(n.startIndex,n.endIndex);for(let r=n.depth;;--r){let i=n.$from.node(r),o=n.$from.index(r),s=n.$to.indexAfter(r);if(r<n.depth&&i.canReplace(o,s,t))return r;if(r==0||i.type.spec.isolating||!S_(i,o,s))break}return null}function w_(n,e,t){let{$from:r,$to:i,depth:o}=e,s=r.before(o+1),a=i.after(o+1),l=s,c=a,u=x.empty,d=0;for(let p=o,m=!1;p>t;p--)m||r.index(p)>0?(m=!0,u=x.from(r.node(p).copy(u)),d++):l--;let h=x.empty,f=0;for(let p=o,m=!1;p>t;p--)m||i.after(p+1)<i.end(p)?(m=!0,h=x.from(i.node(p).copy(h)),f++):c++;n.step(new at(l,c,s,a,new U(u.append(h),d,f),u.size-d,!0))}function Jm(n,e,t=null,r=n){let i=T_(n,e),o=i&&E_(r,e);return o?i.map(Fv).concat({type:e,attrs:t}).concat(o.map(Fv)):null}function Fv(n){return{type:n,attrs:null}}function T_(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.contentMatchAt(r).findWrapping(e);if(!o)return null;let s=o.length?o[0]:e;return t.canReplaceWith(r,i,s)?o:null}function E_(n,e){let{parent:t,startIndex:r,endIndex:i}=n,o=t.child(r),s=e.contentMatch.findWrapping(o.type);if(!s)return null;let l=(s.length?s[s.length-1]:e).contentMatch;for(let c=r;l&&c<i;c++)l=l.matchType(t.child(c).type);return!l||!l.validEnd?null:s}function k_(n,e,t){let r=x.empty;for(let s=t.length-1;s>=0;s--){if(r.size){let a=t[s].type.contentMatch.matchFragment(r);if(!a||!a.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}r=x.from(t[s].type.create(t[s].attrs,r))}let i=e.start,o=e.end;n.step(new at(i,o,i,o,new U(r,0,0),t.length,!0))}function I_(n,e,t,r,i){if(!r.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let o=n.steps.length;n.doc.nodesBetween(e,t,(s,a)=>{let l=typeof i=="function"?i(s):i;if(s.isTextblock&&!s.hasMarkup(r,l)&&A_(n.doc,n.mapping.slice(o).map(a),r)){let c=null;if(r.schema.linebreakReplacement){let f=r.whitespace=="pre",p=!!r.contentMatch.matchType(r.schema.linebreakReplacement);f&&!p?c=!1:!f&&p&&(c=!0)}c===!1&&Yk(n,s,a,o),Ym(n,n.mapping.slice(o).map(a,1),r,void 0,c===null);let u=n.mapping.slice(o),d=u.map(a,1),h=u.map(a+s.nodeSize,1);return n.step(new at(d,h,d+1,h-1,new U(x.from(r.create(l,null,s.marks)),0,0),1,!0)),c===!0&&Qk(n,s,a,o),!1}})}function Qk(n,e,t,r){e.forEach((i,o)=>{if(i.isText){let s,a=/\r?\n|\r/g;for(;s=a.exec(i.text);){let l=n.mapping.slice(r).map(t+1+o+s.index);n.replaceWith(l,l+1,e.type.schema.linebreakReplacement.create())}}})}function Yk(n,e,t,r){e.forEach((i,o)=>{if(i.type==i.type.schema.linebreakReplacement){let s=n.mapping.slice(r).map(t+1+o);n.replaceWith(s,s+1,e.type.schema.text(`
`))}})}function A_(n,e,t){let r=n.resolve(e),i=r.index();return r.parent.canReplaceWith(i,i+1,t)}function b_(n,e,t,r,i){let o=n.doc.nodeAt(e);if(!o)throw new RangeError("No node at given position");t||(t=o.type);let s=t.create(r,null,i||o.marks);if(o.isLeaf)return n.replaceWith(e,e+o.nodeSize,s);if(!t.validContent(o.content))throw new RangeError("Invalid content for node type "+t.name);n.step(new at(e,e+o.nodeSize,e+1,e+o.nodeSize-1,new U(x.from(s),0,0),1,!0))}function Zo(n,e,t=1,r){let i=n.resolve(e),o=i.depth-t,s=r&&r[r.length-1]||i.parent;if(o<0||i.parent.type.spec.isolating||!i.parent.canReplace(i.index(),i.parent.childCount)||!s.type.validContent(i.parent.content.cutByIndex(i.index(),i.parent.childCount)))return!1;for(let c=i.depth-1,u=t-2;c>o;c--,u--){let d=i.node(c),h=i.index(c);if(d.type.spec.isolating)return!1;let f=d.content.cutByIndex(h,d.childCount),p=r&&r[u+1];p&&(f=f.replaceChild(0,p.type.create(p.attrs)));let m=r&&r[u]||d;if(!d.canReplace(h+1,d.childCount)||!m.type.validContent(f))return!1}let a=i.indexAfter(o),l=r&&r[0];return i.node(o).canReplaceWith(a,a,l?l.type:i.node(o+1).type)}function R_(n,e,t=1,r){let i=n.doc.resolve(e),o=x.empty,s=x.empty;for(let a=i.depth,l=i.depth-t,c=t-1;a>l;a--,c--){o=x.from(i.node(a).copy(o));let u=r&&r[c];s=x.from(u?u.type.create(u.attrs,s):i.node(a).copy(s))}n.step(new ot(e,e,new U(o.append(s),t,t),!0))}function Ri(n,e){let t=n.resolve(e),r=t.index();return Jk(t.nodeBefore,t.nodeAfter)&&t.parent.canReplace(r,r+1)}function N_(n,e){e.content.size||n.type.compatibleContent(e.type);let t=n.contentMatchAt(n.childCount),{linebreakReplacement:r}=n.type.schema;for(let i=0;i<e.childCount;i++){let o=e.child(i),s=o.type==r?n.type.schema.nodes.text:o.type;if(t=t.matchType(s),!t||!n.type.allowsMarks(o.marks))return!1}return t.validEnd}function Jk(n,e){return!!(n&&e&&!n.isLeaf&&N_(n,e))}function td(n,e,t=-1){let r=n.resolve(e);for(let i=r.depth;;i--){let o,s,a=r.index(i);if(i==r.depth?(o=r.nodeBefore,s=r.nodeAfter):t>0?(o=r.node(i+1),a++,s=r.node(i).maybeChild(a)):(o=r.node(i).maybeChild(a-1),s=r.node(i+1)),o&&!o.isTextblock&&Jk(o,s)&&r.node(i).canReplace(a,a+1))return e;if(i==0)break;e=t<0?r.before(i):r.after(i)}}function x_(n,e,t){let r=null,{linebreakReplacement:i}=n.doc.type.schema,o=n.doc.resolve(e-t),s=o.node().type;if(i&&s.inlineContent){let u=s.whitespace=="pre",d=!!s.contentMatch.matchType(i);u&&!d?r=!1:!u&&d&&(r=!0)}let a=n.steps.length;if(r===!1){let u=n.doc.resolve(e+t);Yk(n,u.node(),u.before(),a)}s.inlineContent&&Ym(n,e+t-1,s,o.node().contentMatchAt(o.index()),r==null);let l=n.mapping.slice(a),c=l.map(e-t);if(n.step(new ot(c,l.map(e+t,-1),U.empty,!0)),r===!0){let u=n.doc.resolve(c);Qk(n,u.node(),u.before(),n.steps.length)}return n}function O_(n,e,t){let r=n.resolve(e);if(r.parent.canReplaceWith(r.index(),r.index(),t))return e;if(r.parentOffset==0)for(let i=r.depth-1;i>=0;i--){let o=r.index(i);if(r.node(i).canReplaceWith(o,o,t))return r.before(i+1);if(o>0)return null}if(r.parentOffset==r.parent.content.size)for(let i=r.depth-1;i>=0;i--){let o=r.indexAfter(i);if(r.node(i).canReplaceWith(o,o,t))return r.after(i+1);if(o<r.node(i).childCount)return null}return null}function Xk(n,e,t){let r=n.resolve(e);if(!t.content.size)return e;let i=t.content;for(let o=0;o<t.openStart;o++)i=i.firstChild.content;for(let o=1;o<=(t.openStart==0&&t.size?2:1);o++)for(let s=r.depth;s>=0;s--){let a=s==r.depth?0:r.pos<=(r.start(s+1)+r.end(s+1))/2?-1:1,l=r.index(s)+(a>0?1:0),c=r.node(s),u=!1;if(o==1)u=c.canReplace(l,l,i);else{let d=c.contentMatchAt(l).findWrapping(i.firstChild.type);u=d&&c.canReplaceWith(l,l,d[0])}if(u)return a==0?r.pos:a<0?r.before(s+1):r.after(s+1)}return null}function nd(n,e,t=e,r=U.empty){if(e==t&&!r.size)return null;let i=n.resolve(e),o=n.resolve(t);return Zk(i,o,r)?new ot(e,t,r):new M_(i,o,r).fit()}function Zk(n,e,t){return!t.openStart&&!t.openEnd&&n.start()==e.start()&&n.parent.canReplace(n.index(),e.index(),t.content)}class M_{constructor(e,t,r){this.$from=e,this.$to=t,this.unplaced=r,this.frontier=[],this.placed=x.empty;for(let i=0;i<=e.depth;i++){let o=e.node(i);this.frontier.push({type:o.type,match:o.contentMatchAt(e.indexAfter(i))})}for(let i=e.depth;i>0;i--)this.placed=x.from(e.node(i).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let c=this.findFittable();c?this.placeNodes(c):this.openMore()||this.dropNode()}let e=this.mustMoveInline(),t=this.placed.size-this.depth-this.$from.depth,r=this.$from,i=this.close(e<0?this.$to:r.doc.resolve(e));if(!i)return null;let o=this.placed,s=r.depth,a=i.depth;for(;s&&a&&o.childCount==1;)o=o.firstChild.content,s--,a--;let l=new U(o,s,a);return e>-1?new at(r.pos,e,this.$to.pos,this.$to.end(),l,t):l.size||r.pos!=this.$to.pos?new ot(r.pos,i.pos,l):null}findFittable(){let e=this.unplaced.openStart;for(let t=this.unplaced.content,r=0,i=this.unplaced.openEnd;r<e;r++){let o=t.firstChild;if(t.childCount>1&&(i=0),o.type.spec.isolating&&i<=r){e=r;break}t=o.content}for(let t=1;t<=2;t++)for(let r=t==1?e:this.unplaced.openStart;r>=0;r--){let i,o=null;r?(o=th(this.unplaced.content,r-1).firstChild,i=o.content):i=this.unplaced.content;let s=i.firstChild;for(let a=this.depth;a>=0;a--){let{type:l,match:c}=this.frontier[a],u,d=null;if(t==1&&(s?c.matchType(s.type)||(d=c.fillBefore(x.from(s),!1)):o&&l.compatibleContent(o.type)))return{sliceDepth:r,frontierDepth:a,parent:o,inject:d};if(t==2&&s&&(u=c.findWrapping(s.type)))return{sliceDepth:r,frontierDepth:a,parent:o,wrap:u};if(o&&c.matchType(o.type))break}}}openMore(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=th(e,t);return!i.childCount||i.firstChild.isLeaf?!1:(this.unplaced=new U(e,t+1,Math.max(r,i.size+t>=e.size-r?t+1:0)),!0)}dropNode(){let{content:e,openStart:t,openEnd:r}=this.unplaced,i=th(e,t);if(i.childCount<=1&&t>0){let o=e.size-t<=t+i.size;this.unplaced=new U(Qs(e,t-1,1),t-1,o?t-1:r)}else this.unplaced=new U(Qs(e,t,1),t,r)}placeNodes({sliceDepth:e,frontierDepth:t,parent:r,inject:i,wrap:o}){for(;this.depth>t;)this.closeFrontierNode();if(o)for(let m=0;m<o.length;m++)this.openFrontierNode(o[m]);let s=this.unplaced,a=r?r.content:s.content,l=s.openStart-e,c=0,u=[],{match:d,type:h}=this.frontier[t];if(i){for(let m=0;m<i.childCount;m++)u.push(i.child(m));d=d.matchFragment(i)}let f=a.size+e-(s.content.size-s.openEnd);for(;c<a.childCount;){let m=a.child(c),v=d.matchType(m.type);if(!v)break;c++,(c>1||l==0||m.content.size)&&(d=v,u.push(e0(m.mark(h.allowedMarks(m.marks)),c==1?l:0,c==a.childCount?f:-1)))}let p=c==a.childCount;p||(f=-1),this.placed=Ys(this.placed,t,x.from(u)),this.frontier[t].match=d,p&&f<0&&r&&r.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let m=0,v=a;m<f;m++){let g=v.lastChild;this.frontier.push({type:g.type,match:g.contentMatchAt(g.childCount)}),v=g.content}this.unplaced=p?e==0?U.empty:new U(Qs(s.content,e-1,1),e-1,f<0?s.openEnd:e-1):new U(Qs(s.content,e,c),s.openStart,s.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let e=this.frontier[this.depth],t;if(!e.type.isTextblock||!nh(this.$to,this.$to.depth,e.type,e.match,!1)||this.$to.depth==this.depth&&(t=this.findCloseLevel(this.$to))&&t.depth==this.depth)return-1;let{depth:r}=this.$to,i=this.$to.after(r);for(;r>1&&i==this.$to.end(--r);)++i;return i}findCloseLevel(e){e:for(let t=Math.min(this.depth,e.depth);t>=0;t--){let{match:r,type:i}=this.frontier[t],o=t<e.depth&&e.end(t+1)==e.pos+(e.depth-(t+1)),s=nh(e,t,i,r,o);if(s){for(let a=t-1;a>=0;a--){let{match:l,type:c}=this.frontier[a],u=nh(e,a,c,l,!0);if(!u||u.childCount)continue e}return{depth:t,fit:s,move:o?e.doc.resolve(e.after(t+1)):e}}}}close(e){let t=this.findCloseLevel(e);if(!t)return null;for(;this.depth>t.depth;)this.closeFrontierNode();t.fit.childCount&&(this.placed=Ys(this.placed,t.depth,t.fit)),e=t.move;for(let r=t.depth+1;r<=e.depth;r++){let i=e.node(r),o=i.type.contentMatch.fillBefore(i.content,!0,e.index(r));this.openFrontierNode(i.type,i.attrs,o)}return e}openFrontierNode(e,t=null,r){let i=this.frontier[this.depth];i.match=i.match.matchType(e),this.placed=Ys(this.placed,this.depth,x.from(e.create(t,r))),this.frontier.push({type:e,match:e.contentMatch})}closeFrontierNode(){let t=this.frontier.pop().match.fillBefore(x.empty,!0);t.childCount&&(this.placed=Ys(this.placed,this.frontier.length,t))}}function Qs(n,e,t){return e==0?n.cutByIndex(t,n.childCount):n.replaceChild(0,n.firstChild.copy(Qs(n.firstChild.content,e-1,t)))}function Ys(n,e,t){return e==0?n.append(t):n.replaceChild(n.childCount-1,n.lastChild.copy(Ys(n.lastChild.content,e-1,t)))}function th(n,e){for(let t=0;t<e;t++)n=n.firstChild.content;return n}function e0(n,e,t){if(e<=0)return n;let r=n.content;return e>1&&(r=r.replaceChild(0,e0(r.firstChild,e-1,r.childCount==1?t-1:0))),e>0&&(r=n.type.contentMatch.fillBefore(r).append(r),t<=0&&(r=r.append(n.type.contentMatch.matchFragment(r).fillBefore(x.empty,!0)))),n.copy(r)}function nh(n,e,t,r,i){let o=n.node(e),s=i?n.indexAfter(e):n.index(e);if(s==o.childCount&&!t.compatibleContent(o.type))return null;let a=r.fillBefore(o.content,!0,s);return a&&!__(t,o.content,s)?a:null}function __(n,e,t){for(let r=t;r<e.childCount;r++)if(!n.allowsMarks(e.child(r).marks))return!0;return!1}function P_(n){return n.spec.defining||n.spec.definingForContent}function D_(n,e,t,r){if(!r.size)return n.deleteRange(e,t);let i=n.doc.resolve(e),o=n.doc.resolve(t);if(Zk(i,o,r))return n.step(new ot(e,t,r));let s=n0(i,n.doc.resolve(t));s[s.length-1]==0&&s.pop();let a=-(i.depth+1);s.unshift(a);for(let h=i.depth,f=i.pos-1;h>0;h--,f--){let p=i.node(h).type.spec;if(p.defining||p.definingAsContext||p.isolating)break;s.indexOf(h)>-1?a=h:i.before(h)==f&&s.splice(1,0,-h)}let l=s.indexOf(a),c=[],u=r.openStart;for(let h=r.content,f=0;;f++){let p=h.firstChild;if(c.push(p),f==r.openStart)break;h=p.content}for(let h=u-1;h>=0;h--){let f=c[h],p=P_(f.type);if(p&&!f.sameMarkup(i.node(Math.abs(a)-1)))u=h;else if(p||!f.type.isTextblock)break}for(let h=r.openStart;h>=0;h--){let f=(h+u+1)%(r.openStart+1),p=c[f];if(p)for(let m=0;m<s.length;m++){let v=s[(m+l)%s.length],g=!0;v<0&&(g=!1,v=-v);let y=i.node(v-1),C=i.index(v-1);if(y.canReplaceWith(C,C,p.type,p.marks))return n.replace(i.before(v),g?o.after(v):t,new U(t0(r.content,0,r.openStart,f),f,r.openEnd))}}let d=n.steps.length;for(let h=s.length-1;h>=0&&(n.replace(e,t,r),!(n.steps.length>d));h--){let f=s[h];f<0||(e=i.before(f),t=o.after(f))}}function t0(n,e,t,r,i){if(e<t){let o=n.firstChild;n=n.replaceChild(0,o.copy(t0(o.content,e+1,t,r,o)))}if(e>r){let o=i.contentMatchAt(0),s=o.fillBefore(n).append(n);n=s.append(o.matchFragment(s).fillBefore(x.empty,!0))}return n}function L_(n,e,t,r){if(!r.isInline&&e==t&&n.doc.resolve(e).parent.content.size){let i=O_(n.doc,e,r.type);i!=null&&(e=t=i)}n.replaceRange(e,t,new U(x.from(r),0,0))}function U_(n,e,t){let r=n.doc.resolve(e),i=n.doc.resolve(t),o=n0(r,i);for(let s=0;s<o.length;s++){let a=o[s],l=s==o.length-1;if(l&&a==0||r.node(a).type.contentMatch.validEnd)return n.delete(r.start(a),i.end(a));if(a>0&&(l||r.node(a-1).canReplace(r.index(a-1),i.indexAfter(a-1))))return n.delete(r.before(a),i.after(a))}for(let s=1;s<=r.depth&&s<=i.depth;s++)if(e-r.start(s)==r.depth-s&&t>r.end(s)&&i.end(s)-t!=i.depth-s&&r.start(s-1)==i.start(s-1)&&r.node(s-1).canReplace(r.index(s-1),i.index(s-1)))return n.delete(r.before(s),t);n.delete(e,t)}function n0(n,e){let t=[],r=Math.min(n.depth,e.depth);for(let i=r;i>=0;i--){let o=n.start(i);if(o<n.pos-(n.depth-i)||e.end(i)>e.pos+(e.depth-i)||n.node(i).type.spec.isolating||e.node(i).type.spec.isolating)break;(o==e.start(i)||i==n.depth&&i==e.depth&&n.parent.inlineContent&&e.parent.inlineContent&&i&&e.start(i-1)==o-1)&&t.push(i)}return t}class es extends xt{constructor(e,t,r){super(),this.pos=e,this.attr=t,this.value=r}apply(e){let t=e.nodeAt(this.pos);if(!t)return Ge.fail("No node at attribute step's position");let r=Object.create(null);for(let o in t.attrs)r[o]=t.attrs[o];r[this.attr]=this.value;let i=t.type.create(r,null,t.marks);return Ge.fromReplace(e,this.pos,this.pos+1,new U(x.from(i),0,t.isLeaf?0:1))}getMap(){return dn.empty}invert(e){return new es(this.pos,this.attr,e.nodeAt(this.pos).attrs[this.attr])}map(e){let t=e.mapResult(this.pos,1);return t.deletedAfter?null:new es(t.pos,this.attr,this.value)}toJSON(){return{stepType:"attr",pos:this.pos,attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.pos!="number"||typeof t.attr!="string")throw new RangeError("Invalid input for AttrStep.fromJSON");return new es(t.pos,t.attr,t.value)}}xt.jsonID("attr",es);class Ga extends xt{constructor(e,t){super(),this.attr=e,this.value=t}apply(e){let t=Object.create(null);for(let i in e.attrs)t[i]=e.attrs[i];t[this.attr]=this.value;let r=e.type.create(t,e.content,e.marks);return Ge.ok(r)}getMap(){return dn.empty}invert(e){return new Ga(this.attr,e.attrs[this.attr])}map(e){return this}toJSON(){return{stepType:"docAttr",attr:this.attr,value:this.value}}static fromJSON(e,t){if(typeof t.attr!="string")throw new RangeError("Invalid input for DocAttrStep.fromJSON");return new Ga(t.attr,t.value)}}xt.jsonID("docAttr",Ga);let gs=class extends Error{};gs=function n(e){let t=Error.call(this,e);return t.__proto__=n.prototype,t};gs.prototype=Object.create(Error.prototype);gs.prototype.constructor=gs;gs.prototype.name="TransformError";class H_{constructor(e){this.doc=e,this.steps=[],this.docs=[],this.mapping=new Wa}get before(){return this.docs.length?this.docs[0]:this.doc}step(e){let t=this.maybeStep(e);if(t.failed)throw new gs(t.failed);return this}maybeStep(e){let t=e.apply(this.doc);return t.failed||this.addStep(e,t.doc),t}get docChanged(){return this.steps.length>0}addStep(e,t){this.docs.push(this.doc),this.steps.push(e),this.mapping.appendMap(e.getMap()),this.doc=t}replace(e,t=e,r=U.empty){let i=nd(this.doc,e,t,r);return i&&this.step(i),this}replaceWith(e,t,r){return this.replace(e,t,new U(x.from(r),0,0))}delete(e,t){return this.replace(e,t,U.empty)}insert(e,t){return this.replaceWith(e,e,t)}replaceRange(e,t,r){return D_(this,e,t,r),this}replaceRangeWith(e,t,r){return L_(this,e,t,r),this}deleteRange(e,t){return U_(this,e,t),this}lift(e,t){return w_(this,e,t),this}join(e,t=1){return x_(this,e,t),this}wrap(e,t){return k_(this,e,t),this}setBlockType(e,t=e,r,i=null){return I_(this,e,t,r,i),this}setNodeMarkup(e,t,r=null,i){return b_(this,e,t,r,i),this}setNodeAttribute(e,t,r){return this.step(new es(e,t,r)),this}setDocAttribute(e,t){return this.step(new Ga(e,t)),this}addNodeMark(e,t){return this.step(new ri(e,t)),this}removeNodeMark(e,t){if(!(t instanceof Se)){let r=this.doc.nodeAt(e);if(!r)throw new RangeError("No node at position "+e);if(t=t.isInSet(r.marks),!t)return this}return this.step(new ms(e,t)),this}split(e,t=1,r){return R_(this,e,t,r),this}addMark(e,t,r){return v_(this,e,t,r),this}removeMark(e,t,r){return C_(this,e,t,r),this}clearIncompatible(e,t,r){return Ym(this,e,t,r),this}}const rh=Object.create(null);class Z{constructor(e,t,r){this.$anchor=e,this.$head=t,this.ranges=r||[new F_(e.min(t),e.max(t))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let e=this.ranges;for(let t=0;t<e.length;t++)if(e[t].$from.pos!=e[t].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(e,t=U.empty){let r=t.content.lastChild,i=null;for(let a=0;a<t.openEnd;a++)i=r,r=r.lastChild;let o=e.steps.length,s=this.ranges;for(let a=0;a<s.length;a++){let{$from:l,$to:c}=s[a],u=e.mapping.slice(o);e.replaceRange(u.map(l.pos),u.map(c.pos),a?U.empty:t),a==0&&jv(e,o,(r?r.isInline:i&&i.isTextblock)?-1:1)}}replaceWith(e,t){let r=e.steps.length,i=this.ranges;for(let o=0;o<i.length;o++){let{$from:s,$to:a}=i[o],l=e.mapping.slice(r),c=l.map(s.pos),u=l.map(a.pos);o?e.deleteRange(c,u):(e.replaceRangeWith(c,u,t),jv(e,r,t.isInline?-1:1))}}static findFrom(e,t,r=!1){let i=e.parent.inlineContent?new J(e):Io(e.node(0),e.parent,e.pos,e.index(),t,r);if(i)return i;for(let o=e.depth-1;o>=0;o--){let s=t<0?Io(e.node(0),e.node(o),e.before(o+1),e.index(o),t,r):Io(e.node(0),e.node(o),e.after(o+1),e.index(o)+1,t,r);if(s)return s}return null}static near(e,t=1){return this.findFrom(e,t)||this.findFrom(e,-t)||new Rn(e.node(0))}static atStart(e){return Io(e,e,0,0,1)||new Rn(e)}static atEnd(e){return Io(e,e,e.content.size,e.childCount,-1)||new Rn(e)}static fromJSON(e,t){if(!t||!t.type)throw new RangeError("Invalid input for Selection.fromJSON");let r=rh[t.type];if(!r)throw new RangeError(`No selection type ${t.type} defined`);return r.fromJSON(e,t)}static jsonID(e,t){if(e in rh)throw new RangeError("Duplicate use of selection JSON ID "+e);return rh[e]=t,t.prototype.jsonID=e,t}getBookmark(){return J.between(this.$anchor,this.$head).getBookmark()}}Z.prototype.visible=!0;class F_{constructor(e,t){this.$from=e,this.$to=t}}let Bv=!1;function zv(n){!Bv&&!n.parent.inlineContent&&(Bv=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+n.parent.type.name+")"))}class J extends Z{constructor(e,t=e){zv(e),zv(t),super(e,t)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(e,t){let r=e.resolve(t.map(this.head));if(!r.parent.inlineContent)return Z.near(r);let i=e.resolve(t.map(this.anchor));return new J(i.parent.inlineContent?i:r,r)}replace(e,t=U.empty){if(super.replace(e,t),t==U.empty){let r=this.$from.marksAcross(this.$to);r&&e.ensureMarks(r)}}eq(e){return e instanceof J&&e.anchor==this.anchor&&e.head==this.head}getBookmark(){return new rd(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(e,t){if(typeof t.anchor!="number"||typeof t.head!="number")throw new RangeError("Invalid input for TextSelection.fromJSON");return new J(e.resolve(t.anchor),e.resolve(t.head))}static create(e,t,r=t){let i=e.resolve(t);return new this(i,r==t?i:e.resolve(r))}static between(e,t,r){let i=e.pos-t.pos;if((!r||i)&&(r=i>=0?1:-1),!t.parent.inlineContent){let o=Z.findFrom(t,r,!0)||Z.findFrom(t,-r,!0);if(o)t=o.$head;else return Z.near(t,r)}return e.parent.inlineContent||(i==0?e=t:(e=(Z.findFrom(e,-r,!0)||Z.findFrom(e,r,!0)).$anchor,e.pos<t.pos!=i<0&&(e=t))),new J(e,t)}}Z.jsonID("text",J);class rd{constructor(e,t){this.anchor=e,this.head=t}map(e){return new rd(e.map(this.anchor),e.map(this.head))}resolve(e){return J.between(e.resolve(this.anchor),e.resolve(this.head))}}class G extends Z{constructor(e){let t=e.nodeAfter,r=e.node(0).resolve(e.pos+t.nodeSize);super(e,r),this.node=t}map(e,t){let{deleted:r,pos:i}=t.mapResult(this.anchor),o=e.resolve(i);return r?Z.near(o):new G(o)}content(){return new U(x.from(this.node),0,0)}eq(e){return e instanceof G&&e.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new Xm(this.anchor)}static fromJSON(e,t){if(typeof t.anchor!="number")throw new RangeError("Invalid input for NodeSelection.fromJSON");return new G(e.resolve(t.anchor))}static create(e,t){return new G(e.resolve(t))}static isSelectable(e){return!e.isText&&e.type.spec.selectable!==!1}}G.prototype.visible=!1;Z.jsonID("node",G);class Xm{constructor(e){this.anchor=e}map(e){let{deleted:t,pos:r}=e.mapResult(this.anchor);return t?new rd(r,r):new Xm(r)}resolve(e){let t=e.resolve(this.anchor),r=t.nodeAfter;return r&&G.isSelectable(r)?new G(t):Z.near(t)}}class Rn extends Z{constructor(e){super(e.resolve(0),e.resolve(e.content.size))}replace(e,t=U.empty){if(t==U.empty){e.delete(0,e.doc.content.size);let r=Z.atStart(e.doc);r.eq(e.selection)||e.setSelection(r)}else super.replace(e,t)}toJSON(){return{type:"all"}}static fromJSON(e){return new Rn(e)}map(e){return new Rn(e)}eq(e){return e instanceof Rn}getBookmark(){return B_}}Z.jsonID("all",Rn);const B_={map(){return this},resolve(n){return new Rn(n)}};function Io(n,e,t,r,i,o=!1){if(e.inlineContent)return J.create(n,t);for(let s=r-(i>0?0:1);i>0?s<e.childCount:s>=0;s+=i){let a=e.child(s);if(a.isAtom){if(!o&&G.isSelectable(a))return G.create(n,t-(i<0?a.nodeSize:0))}else{let l=Io(n,a,t+i,i<0?a.childCount:0,i,o);if(l)return l}t+=a.nodeSize*i}return null}function jv(n,e,t){let r=n.steps.length-1;if(r<e)return;let i=n.steps[r];if(!(i instanceof ot||i instanceof at))return;let o=n.mapping.maps[r],s;o.forEach((a,l,c,u)=>{s==null&&(s=u)}),n.setSelection(Z.near(n.doc.resolve(s),t))}const Kv=1,Kl=2,$v=4;class z_ extends H_{constructor(e){super(e.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=e.selection,this.storedMarks=e.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(e){if(e.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=e,this.curSelectionFor=this.steps.length,this.updated=(this.updated|Kv)&~Kl,this.storedMarks=null,this}get selectionSet(){return(this.updated&Kv)>0}setStoredMarks(e){return this.storedMarks=e,this.updated|=Kl,this}ensureMarks(e){return Se.sameSet(this.storedMarks||this.selection.$from.marks(),e)||this.setStoredMarks(e),this}addStoredMark(e){return this.ensureMarks(e.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(e){return this.ensureMarks(e.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(this.updated&Kl)>0}addStep(e,t){super.addStep(e,t),this.updated=this.updated&~Kl,this.storedMarks=null}setTime(e){return this.time=e,this}replaceSelection(e){return this.selection.replace(this,e),this}replaceSelectionWith(e,t=!0){let r=this.selection;return t&&(e=e.mark(this.storedMarks||(r.empty?r.$from.marks():r.$from.marksAcross(r.$to)||Se.none))),r.replaceWith(this,e),this}deleteSelection(){return this.selection.replace(this),this}insertText(e,t,r){let i=this.doc.type.schema;if(t==null)return e?this.replaceSelectionWith(i.text(e),!0):this.deleteSelection();{if(r==null&&(r=t),r=r??t,!e)return this.deleteRange(t,r);let o=this.storedMarks;if(!o){let s=this.doc.resolve(t);o=r==t?s.marks():s.marksAcross(this.doc.resolve(r))}return this.replaceRangeWith(t,r,i.text(e,o)),this.selection.empty||this.setSelection(Z.near(this.selection.$to)),this}}setMeta(e,t){return this.meta[typeof e=="string"?e:e.key]=t,this}getMeta(e){return this.meta[typeof e=="string"?e:e.key]}get isGeneric(){for(let e in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=$v,this}get scrolledIntoView(){return(this.updated&$v)>0}}function Vv(n,e){return!e||!n?n:n.bind(e)}class Js{constructor(e,t,r){this.name=e,this.init=Vv(t.init,r),this.apply=Vv(t.apply,r)}}const j_=[new Js("doc",{init(n){return n.doc||n.schema.topNodeType.createAndFill()},apply(n){return n.doc}}),new Js("selection",{init(n,e){return n.selection||Z.atStart(e.doc)},apply(n){return n.selection}}),new Js("storedMarks",{init(n){return n.storedMarks||null},apply(n,e,t,r){return r.selection.$cursor?n.storedMarks:null}}),new Js("scrollToSelection",{init(){return 0},apply(n,e){return n.scrolledIntoView?e+1:e}})];class ih{constructor(e,t){this.schema=e,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=j_.slice(),t&&t.forEach(r=>{if(this.pluginsByKey[r.key])throw new RangeError("Adding different instances of a keyed plugin ("+r.key+")");this.plugins.push(r),this.pluginsByKey[r.key]=r,r.spec.state&&this.fields.push(new Js(r.key,r.spec.state,r))})}}class jo{constructor(e){this.config=e}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(e){return this.applyTransaction(e).state}filterTransaction(e,t=-1){for(let r=0;r<this.config.plugins.length;r++)if(r!=t){let i=this.config.plugins[r];if(i.spec.filterTransaction&&!i.spec.filterTransaction.call(i,e,this))return!1}return!0}applyTransaction(e){if(!this.filterTransaction(e))return{state:this,transactions:[]};let t=[e],r=this.applyInner(e),i=null;for(;;){let o=!1;for(let s=0;s<this.config.plugins.length;s++){let a=this.config.plugins[s];if(a.spec.appendTransaction){let l=i?i[s].n:0,c=i?i[s].state:this,u=l<t.length&&a.spec.appendTransaction.call(a,l?t.slice(l):t,c,r);if(u&&r.filterTransaction(u,s)){if(u.setMeta("appendedTransaction",e),!i){i=[];for(let d=0;d<this.config.plugins.length;d++)i.push(d<s?{state:r,n:t.length}:{state:this,n:0})}t.push(u),r=r.applyInner(u),o=!0}i&&(i[s]={state:r,n:t.length})}}if(!o)return{state:r,transactions:t}}}applyInner(e){if(!e.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let t=new jo(this.config),r=this.config.fields;for(let i=0;i<r.length;i++){let o=r[i];t[o.name]=o.apply(e,this[o.name],this,t)}return t}get tr(){return new z_(this)}static create(e){let t=new ih(e.doc?e.doc.type.schema:e.schema,e.plugins),r=new jo(t);for(let i=0;i<t.fields.length;i++)r[t.fields[i].name]=t.fields[i].init(e,r);return r}reconfigure(e){let t=new ih(this.schema,e.plugins),r=t.fields,i=new jo(t);for(let o=0;o<r.length;o++){let s=r[o].name;i[s]=this.hasOwnProperty(s)?this[s]:r[o].init(e,i)}return i}toJSON(e){let t={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(t.storedMarks=this.storedMarks.map(r=>r.toJSON())),e&&typeof e=="object")for(let r in e){if(r=="doc"||r=="selection")throw new RangeError("The JSON fields `doc` and `selection` are reserved");let i=e[r],o=i.spec.state;o&&o.toJSON&&(t[r]=o.toJSON.call(i,this[i.key]))}return t}static fromJSON(e,t,r){if(!t)throw new RangeError("Invalid input for EditorState.fromJSON");if(!e.schema)throw new RangeError("Required config field 'schema' missing");let i=new ih(e.schema,e.plugins),o=new jo(i);return i.fields.forEach(s=>{if(s.name=="doc")o.doc=gi.fromJSON(e.schema,t.doc);else if(s.name=="selection")o.selection=Z.fromJSON(o.doc,t.selection);else if(s.name=="storedMarks")t.storedMarks&&(o.storedMarks=t.storedMarks.map(e.schema.markFromJSON));else{if(r)for(let a in r){let l=r[a],c=l.spec.state;if(l.key==s.name&&c&&c.fromJSON&&Object.prototype.hasOwnProperty.call(t,a)){o[s.name]=c.fromJSON.call(l,e,t[a],o);return}}o[s.name]=s.init(e,o)}}),o}}function r0(n,e,t){for(let r in n){let i=n[r];i instanceof Function?i=i.bind(e):r=="handleDOMEvents"&&(i=r0(i,e,{})),t[r]=i}return t}class jt{constructor(e){this.spec=e,this.props={},e.props&&r0(e.props,this,this.props),this.key=e.key?e.key.key:i0("plugin")}getState(e){return e[this.key]}}const oh=Object.create(null);function i0(n){return n in oh?n+"$"+ ++oh[n]:(oh[n]=0,n+"$")}class Gn{constructor(e="key"){this.key=i0(e)}get(e){return e.config.pluginsByKey[this.key]}getState(e){return e[this.key]}}const pt=function(n){for(var e=0;;e++)if(n=n.previousSibling,!n)return e},ys=function(n){let e=n.assignedSlot||n.parentNode;return e&&e.nodeType==11?e.host:e};let Vf=null;const yr=function(n,e,t){let r=Vf||(Vf=document.createRange());return r.setEnd(n,t??n.nodeValue.length),r.setStart(n,e||0),r},K_=function(){Vf=null},ao=function(n,e,t,r){return t&&(Wv(n,e,t,r,-1)||Wv(n,e,t,r,1))},$_=/^(img|br|input|textarea|hr)$/i;function Wv(n,e,t,r,i){for(;;){if(n==t&&e==r)return!0;if(e==(i<0?0:kn(n))){let o=n.parentNode;if(!o||o.nodeType!=1||dl(n)||$_.test(n.nodeName)||n.contentEditable=="false")return!1;e=pt(n)+(i<0?0:1),n=o}else if(n.nodeType==1){if(n=n.childNodes[e+(i<0?-1:0)],n.contentEditable=="false")return!1;e=i<0?kn(n):0}else return!1}}function kn(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function V_(n,e){for(;;){if(n.nodeType==3&&e)return n;if(n.nodeType==1&&e>0){if(n.contentEditable=="false")return null;n=n.childNodes[e-1],e=kn(n)}else if(n.parentNode&&!dl(n))e=pt(n),n=n.parentNode;else return null}}function W_(n,e){for(;;){if(n.nodeType==3&&e<n.nodeValue.length)return n;if(n.nodeType==1&&e<n.childNodes.length){if(n.contentEditable=="false")return null;n=n.childNodes[e],e=0}else if(n.parentNode&&!dl(n))e=pt(n)+1,n=n.parentNode;else return null}}function G_(n,e,t){for(let r=e==0,i=e==kn(n);r||i;){if(n==t)return!0;let o=pt(n);if(n=n.parentNode,!n)return!1;r=r&&o==0,i=i&&o==kn(n)}}function dl(n){let e;for(let t=n;t&&!(e=t.pmViewDesc);t=t.parentNode);return e&&e.node&&e.node.isBlock&&(e.dom==n||e.contentDOM==n)}const id=function(n){return n.focusNode&&ao(n.focusNode,n.focusOffset,n.anchorNode,n.anchorOffset)};function _i(n,e){let t=document.createEvent("Event");return t.initEvent("keydown",!0,!0),t.keyCode=n,t.key=t.code=e,t}function q_(n){let e=n.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function Q_(n,e,t){if(n.caretPositionFromPoint)try{let r=n.caretPositionFromPoint(e,t);if(r)return{node:r.offsetNode,offset:Math.min(kn(r.offsetNode),r.offset)}}catch{}if(n.caretRangeFromPoint){let r=n.caretRangeFromPoint(e,t);if(r)return{node:r.startContainer,offset:Math.min(kn(r.startContainer),r.startOffset)}}}const ur=typeof navigator<"u"?navigator:null,Gv=typeof document<"u"?document:null,Ni=ur&&ur.userAgent||"",Wf=/Edge\/(\d+)/.exec(Ni),o0=/MSIE \d/.exec(Ni),Gf=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ni),Jt=!!(o0||Gf||Wf),yi=o0?document.documentMode:Gf?+Gf[1]:Wf?+Wf[1]:0,Wn=!Jt&&/gecko\/(\d+)/i.test(Ni);Wn&&+(/Firefox\/(\d+)/.exec(Ni)||[0,0])[1];const qf=!Jt&&/Chrome\/(\d+)/.exec(Ni),bt=!!qf,s0=qf?+qf[1]:0,Pt=!Jt&&!!ur&&/Apple Computer/.test(ur.vendor),vs=Pt&&(/Mobile\/\w+/.test(Ni)||!!ur&&ur.maxTouchPoints>2),wn=vs||(ur?/Mac/.test(ur.platform):!1),Y_=ur?/Win/.test(ur.platform):!1,Er=/Android \d/.test(Ni),hl=!!Gv&&"webkitFontSmoothing"in Gv.documentElement.style,J_=hl?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0;function X_(n){let e=n.defaultView&&n.defaultView.visualViewport;return e?{left:0,right:e.width,top:0,bottom:e.height}:{left:0,right:n.documentElement.clientWidth,top:0,bottom:n.documentElement.clientHeight}}function pr(n,e){return typeof n=="number"?n:n[e]}function Z_(n){let e=n.getBoundingClientRect(),t=e.width/n.offsetWidth||1,r=e.height/n.offsetHeight||1;return{left:e.left,right:e.left+n.clientWidth*t,top:e.top,bottom:e.top+n.clientHeight*r}}function qv(n,e,t){let r=n.someProp("scrollThreshold")||0,i=n.someProp("scrollMargin")||5,o=n.dom.ownerDocument;for(let s=t||n.dom;s;){if(s.nodeType!=1){s=ys(s);continue}let a=s,l=a==o.body,c=l?X_(o):Z_(a),u=0,d=0;if(e.top<c.top+pr(r,"top")?d=-(c.top-e.top+pr(i,"top")):e.bottom>c.bottom-pr(r,"bottom")&&(d=e.bottom-e.top>c.bottom-c.top?e.top+pr(i,"top")-c.top:e.bottom-c.bottom+pr(i,"bottom")),e.left<c.left+pr(r,"left")?u=-(c.left-e.left+pr(i,"left")):e.right>c.right-pr(r,"right")&&(u=e.right-c.right+pr(i,"right")),u||d)if(l)o.defaultView.scrollBy(u,d);else{let f=a.scrollLeft,p=a.scrollTop;d&&(a.scrollTop+=d),u&&(a.scrollLeft+=u);let m=a.scrollLeft-f,v=a.scrollTop-p;e={left:e.left-m,top:e.top-v,right:e.right-m,bottom:e.bottom-v}}let h=l?"fixed":getComputedStyle(s).position;if(/^(fixed|sticky)$/.test(h))break;s=h=="absolute"?s.offsetParent:ys(s)}}function eP(n){let e=n.dom.getBoundingClientRect(),t=Math.max(0,e.top),r,i;for(let o=(e.left+e.right)/2,s=t+1;s<Math.min(innerHeight,e.bottom);s+=5){let a=n.root.elementFromPoint(o,s);if(!a||a==n.dom||!n.dom.contains(a))continue;let l=a.getBoundingClientRect();if(l.top>=t-20){r=a,i=l.top;break}}return{refDOM:r,refTop:i,stack:a0(n.dom)}}function a0(n){let e=[],t=n.ownerDocument;for(let r=n;r&&(e.push({dom:r,top:r.scrollTop,left:r.scrollLeft}),n!=t);r=ys(r));return e}function tP({refDOM:n,refTop:e,stack:t}){let r=n?n.getBoundingClientRect().top:0;l0(t,r==0?0:r-e)}function l0(n,e){for(let t=0;t<n.length;t++){let{dom:r,top:i,left:o}=n[t];r.scrollTop!=i+e&&(r.scrollTop=i+e),r.scrollLeft!=o&&(r.scrollLeft=o)}}let So=null;function nP(n){if(n.setActive)return n.setActive();if(So)return n.focus(So);let e=a0(n);n.focus(So==null?{get preventScroll(){return So={preventScroll:!0},!0}}:void 0),So||(So=!1,l0(e,0))}function c0(n,e){let t,r=2e8,i,o=0,s=e.top,a=e.top,l,c;for(let u=n.firstChild,d=0;u;u=u.nextSibling,d++){let h;if(u.nodeType==1)h=u.getClientRects();else if(u.nodeType==3)h=yr(u).getClientRects();else continue;for(let f=0;f<h.length;f++){let p=h[f];if(p.top<=s&&p.bottom>=a){s=Math.max(p.bottom,s),a=Math.min(p.top,a);let m=p.left>e.left?p.left-e.left:p.right<e.left?e.left-p.right:0;if(m<r){t=u,r=m,i=m&&t.nodeType==3?{left:p.right<e.left?p.right:p.left,top:e.top}:e,u.nodeType==1&&m&&(o=d+(e.left>=(p.left+p.right)/2?1:0));continue}}else p.top>e.top&&!l&&p.left<=e.left&&p.right>=e.left&&(l=u,c={left:Math.max(p.left,Math.min(p.right,e.left)),top:p.top});!t&&(e.left>=p.right&&e.top>=p.top||e.left>=p.left&&e.top>=p.bottom)&&(o=d+1)}}return!t&&l&&(t=l,i=c,r=0),t&&t.nodeType==3?rP(t,i):!t||r&&t.nodeType==1?{node:n,offset:o}:c0(t,i)}function rP(n,e){let t=n.nodeValue.length,r=document.createRange();for(let i=0;i<t;i++){r.setEnd(n,i+1),r.setStart(n,i);let o=Kr(r,1);if(o.top!=o.bottom&&Zm(e,o))return{node:n,offset:i+(e.left>=(o.left+o.right)/2?1:0)}}return{node:n,offset:0}}function Zm(n,e){return n.left>=e.left-1&&n.left<=e.right+1&&n.top>=e.top-1&&n.top<=e.bottom+1}function iP(n,e){let t=n.parentNode;return t&&/^li$/i.test(t.nodeName)&&e.left<n.getBoundingClientRect().left?t:n}function oP(n,e,t){let{node:r,offset:i}=c0(e,t),o=-1;if(r.nodeType==1&&!r.firstChild){let s=r.getBoundingClientRect();o=s.left!=s.right&&t.left>(s.left+s.right)/2?1:-1}return n.docView.posFromDOM(r,i,o)}function sP(n,e,t,r){let i=-1;for(let o=e,s=!1;o!=n.dom;){let a=n.docView.nearestDesc(o,!0),l;if(!a)return null;if(a.dom.nodeType==1&&(a.node.isBlock&&a.parent||!a.contentDOM)&&((l=a.dom.getBoundingClientRect()).width||l.height)&&(a.node.isBlock&&a.parent&&(!s&&l.left>r.left||l.top>r.top?i=a.posBefore:(!s&&l.right<r.left||l.bottom<r.top)&&(i=a.posAfter),s=!0),!a.contentDOM&&i<0&&!a.node.isText))return(a.node.isBlock?r.top<(l.top+l.bottom)/2:r.left<(l.left+l.right)/2)?a.posBefore:a.posAfter;o=a.dom.parentNode}return i>-1?i:n.docView.posFromDOM(e,t,-1)}function u0(n,e,t){let r=n.childNodes.length;if(r&&t.top<t.bottom)for(let i=Math.max(0,Math.min(r-1,Math.floor(r*(e.top-t.top)/(t.bottom-t.top))-2)),o=i;;){let s=n.childNodes[o];if(s.nodeType==1){let a=s.getClientRects();for(let l=0;l<a.length;l++){let c=a[l];if(Zm(e,c))return u0(s,e,c)}}if((o=(o+1)%r)==i)break}return n}function aP(n,e){let t=n.dom.ownerDocument,r,i=0,o=Q_(t,e.left,e.top);o&&({node:r,offset:i}=o);let s=(n.root.elementFromPoint?n.root:t).elementFromPoint(e.left,e.top),a;if(!s||!n.dom.contains(s.nodeType!=1?s.parentNode:s)){let c=n.dom.getBoundingClientRect();if(!Zm(e,c)||(s=u0(n.dom,e,c),!s))return null}if(Pt)for(let c=s;r&&c;c=ys(c))c.draggable&&(r=void 0);if(s=iP(s,e),r){if(Wn&&r.nodeType==1&&(i=Math.min(i,r.childNodes.length),i<r.childNodes.length)){let u=r.childNodes[i],d;u.nodeName=="IMG"&&(d=u.getBoundingClientRect()).right<=e.left&&d.bottom>e.top&&i++}let c;hl&&i&&r.nodeType==1&&(c=r.childNodes[i-1]).nodeType==1&&c.contentEditable=="false"&&c.getBoundingClientRect().top>=e.top&&i--,r==n.dom&&i==r.childNodes.length-1&&r.lastChild.nodeType==1&&e.top>r.lastChild.getBoundingClientRect().bottom?a=n.state.doc.content.size:(i==0||r.nodeType!=1||r.childNodes[i-1].nodeName!="BR")&&(a=sP(n,r,i,e))}a==null&&(a=oP(n,s,e));let l=n.docView.nearestDesc(s,!0);return{pos:a,inside:l?l.posAtStart-l.border:-1}}function Qv(n){return n.top<n.bottom||n.left<n.right}function Kr(n,e){let t=n.getClientRects();if(t.length){let r=t[e<0?0:t.length-1];if(Qv(r))return r}return Array.prototype.find.call(t,Qv)||n.getBoundingClientRect()}const lP=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function d0(n,e,t){let{node:r,offset:i,atom:o}=n.docView.domFromPos(e,t<0?-1:1),s=hl||Wn;if(r.nodeType==3)if(s&&(lP.test(r.nodeValue)||(t<0?!i:i==r.nodeValue.length))){let l=Kr(yr(r,i,i),t);if(Wn&&i&&/\s/.test(r.nodeValue[i-1])&&i<r.nodeValue.length){let c=Kr(yr(r,i-1,i-1),-1);if(c.top==l.top){let u=Kr(yr(r,i,i+1),-1);if(u.top!=l.top)return Ks(u,u.left<c.left)}}return l}else{let l=i,c=i,u=t<0?1:-1;return t<0&&!i?(c++,u=-1):t>=0&&i==r.nodeValue.length?(l--,u=1):t<0?l--:c++,Ks(Kr(yr(r,l,c),u),u<0)}if(!n.state.doc.resolve(e-(o||0)).parent.inlineContent){if(o==null&&i&&(t<0||i==kn(r))){let l=r.childNodes[i-1];if(l.nodeType==1)return sh(l.getBoundingClientRect(),!1)}if(o==null&&i<kn(r)){let l=r.childNodes[i];if(l.nodeType==1)return sh(l.getBoundingClientRect(),!0)}return sh(r.getBoundingClientRect(),t>=0)}if(o==null&&i&&(t<0||i==kn(r))){let l=r.childNodes[i-1],c=l.nodeType==3?yr(l,kn(l)-(s?0:1)):l.nodeType==1&&(l.nodeName!="BR"||!l.nextSibling)?l:null;if(c)return Ks(Kr(c,1),!1)}if(o==null&&i<kn(r)){let l=r.childNodes[i];for(;l.pmViewDesc&&l.pmViewDesc.ignoreForCoords;)l=l.nextSibling;let c=l?l.nodeType==3?yr(l,0,s?0:1):l.nodeType==1?l:null:null;if(c)return Ks(Kr(c,-1),!0)}return Ks(Kr(r.nodeType==3?yr(r):r,-t),t>=0)}function Ks(n,e){if(n.width==0)return n;let t=e?n.left:n.right;return{top:n.top,bottom:n.bottom,left:t,right:t}}function sh(n,e){if(n.height==0)return n;let t=e?n.top:n.bottom;return{top:t,bottom:t,left:n.left,right:n.right}}function h0(n,e,t){let r=n.state,i=n.root.activeElement;r!=e&&n.updateState(e),i!=n.dom&&n.focus();try{return t()}finally{r!=e&&n.updateState(r),i!=n.dom&&i&&i.focus()}}function cP(n,e,t){let r=e.selection,i=t=="up"?r.$from:r.$to;return h0(n,e,()=>{let{node:o}=n.docView.domFromPos(i.pos,t=="up"?-1:1);for(;;){let a=n.docView.nearestDesc(o,!0);if(!a)break;if(a.node.isBlock){o=a.contentDOM||a.dom;break}o=a.dom.parentNode}let s=d0(n,i.pos,1);for(let a=o.firstChild;a;a=a.nextSibling){let l;if(a.nodeType==1)l=a.getClientRects();else if(a.nodeType==3)l=yr(a,0,a.nodeValue.length).getClientRects();else continue;for(let c=0;c<l.length;c++){let u=l[c];if(u.bottom>u.top+1&&(t=="up"?s.top-u.top>(u.bottom-s.top)*2:u.bottom-s.bottom>(s.bottom-u.top)*2))return!1}}return!0})}const uP=/[\u0590-\u08ac]/;function dP(n,e,t){let{$head:r}=e.selection;if(!r.parent.isTextblock)return!1;let i=r.parentOffset,o=!i,s=i==r.parent.content.size,a=n.domSelection();return a?!uP.test(r.parent.textContent)||!a.modify?t=="left"||t=="backward"?o:s:h0(n,e,()=>{let{focusNode:l,focusOffset:c,anchorNode:u,anchorOffset:d}=n.domSelectionRange(),h=a.caretBidiLevel;a.modify("move",t,"character");let f=r.depth?n.docView.domAfterPos(r.before()):n.dom,{focusNode:p,focusOffset:m}=n.domSelectionRange(),v=p&&!f.contains(p.nodeType==1?p:p.parentNode)||l==p&&c==m;try{a.collapse(u,d),l&&(l!=u||c!=d)&&a.extend&&a.extend(l,c)}catch{}return h!=null&&(a.caretBidiLevel=h),v}):r.pos==r.start()||r.pos==r.end()}let Yv=null,Jv=null,Xv=!1;function hP(n,e,t){return Yv==e&&Jv==t?Xv:(Yv=e,Jv=t,Xv=t=="up"||t=="down"?cP(n,e,t):dP(n,e,t))}const Nn=0,Zv=1,Fi=2,dr=3;class fl{constructor(e,t,r,i){this.parent=e,this.children=t,this.dom=r,this.contentDOM=i,this.dirty=Nn,r.pmViewDesc=this}matchesWidget(e){return!1}matchesMark(e){return!1}matchesNode(e,t,r){return!1}matchesHack(e){return!1}parseRule(){return null}stopEvent(e){return!1}get size(){let e=0;for(let t=0;t<this.children.length;t++)e+=this.children[t].size;return e}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let e=0;e<this.children.length;e++)this.children[e].destroy()}posBeforeChild(e){for(let t=0,r=this.posAtStart;;t++){let i=this.children[t];if(i==e)return r;r+=i.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(e,t,r){if(this.contentDOM&&this.contentDOM.contains(e.nodeType==1?e:e.parentNode))if(r<0){let o,s;if(e==this.contentDOM)o=e.childNodes[t-1];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.previousSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.previousSibling;return o?this.posBeforeChild(s)+s.size:this.posAtStart}else{let o,s;if(e==this.contentDOM)o=e.childNodes[t];else{for(;e.parentNode!=this.contentDOM;)e=e.parentNode;o=e.nextSibling}for(;o&&!((s=o.pmViewDesc)&&s.parent==this);)o=o.nextSibling;return o?this.posBeforeChild(s):this.posAtEnd}let i;if(e==this.dom&&this.contentDOM)i=t>pt(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))i=e.compareDocumentPosition(this.contentDOM)&2;else if(this.dom.firstChild){if(t==0)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!1;break}if(o.previousSibling)break}if(i==null&&t==e.childNodes.length)for(let o=e;;o=o.parentNode){if(o==this.dom){i=!0;break}if(o.nextSibling)break}}return i??r>0?this.posAtEnd:this.posAtStart}nearestDesc(e,t=!1){for(let r=!0,i=e;i;i=i.parentNode){let o=this.getDesc(i),s;if(o&&(!t||o.node))if(r&&(s=o.nodeDOM)&&!(s.nodeType==1?s.contains(e.nodeType==1?e:e.parentNode):s==e))r=!1;else return o}}getDesc(e){let t=e.pmViewDesc;for(let r=t;r;r=r.parent)if(r==this)return t}posFromDOM(e,t,r){for(let i=e;i;i=i.parentNode){let o=this.getDesc(i);if(o)return o.localPosFromDOM(e,t,r)}return-1}descAt(e){for(let t=0,r=0;t<this.children.length;t++){let i=this.children[t],o=r+i.size;if(r==e&&o!=r){for(;!i.border&&i.children.length;)for(let s=0;s<i.children.length;s++){let a=i.children[s];if(a.size){i=a;break}}return i}if(e<o)return i.descAt(e-r-i.border);r=o}}domFromPos(e,t){if(!this.contentDOM)return{node:this.dom,offset:0,atom:e+1};let r=0,i=0;for(let o=0;r<this.children.length;r++){let s=this.children[r],a=o+s.size;if(a>e||s instanceof p0){i=e-o;break}o=a}if(i)return this.children[r].domFromPos(i-this.children[r].border,t);for(let o;r&&!(o=this.children[r-1]).size&&o instanceof f0&&o.side>=0;r--);if(t<=0){let o,s=!0;for(;o=r?this.children[r-1]:null,!(!o||o.dom.parentNode==this.contentDOM);r--,s=!1);return o&&t&&s&&!o.border&&!o.domAtom?o.domFromPos(o.size,t):{node:this.contentDOM,offset:o?pt(o.dom)+1:0}}else{let o,s=!0;for(;o=r<this.children.length?this.children[r]:null,!(!o||o.dom.parentNode==this.contentDOM);r++,s=!1);return o&&s&&!o.border&&!o.domAtom?o.domFromPos(0,t):{node:this.contentDOM,offset:o?pt(o.dom):this.contentDOM.childNodes.length}}}parseRange(e,t,r=0){if(this.children.length==0)return{node:this.contentDOM,from:e,to:t,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let i=-1,o=-1;for(let s=r,a=0;;a++){let l=this.children[a],c=s+l.size;if(i==-1&&e<=c){let u=s+l.border;if(e>=u&&t<=c-l.border&&l.node&&l.contentDOM&&this.contentDOM.contains(l.contentDOM))return l.parseRange(e,t,u);e=s;for(let d=a;d>0;d--){let h=this.children[d-1];if(h.size&&h.dom.parentNode==this.contentDOM&&!h.emptyChildAt(1)){i=pt(h.dom)+1;break}e-=h.size}i==-1&&(i=0)}if(i>-1&&(c>t||a==this.children.length-1)){t=c;for(let u=a+1;u<this.children.length;u++){let d=this.children[u];if(d.size&&d.dom.parentNode==this.contentDOM&&!d.emptyChildAt(-1)){o=pt(d.dom);break}t+=d.size}o==-1&&(o=this.contentDOM.childNodes.length);break}s=c}return{node:this.contentDOM,from:e,to:t,fromOffset:i,toOffset:o}}emptyChildAt(e){if(this.border||!this.contentDOM||!this.children.length)return!1;let t=this.children[e<0?0:this.children.length-1];return t.size==0||t.emptyChildAt(e)}domAfterPos(e){let{node:t,offset:r}=this.domFromPos(e,0);if(t.nodeType!=1||r==t.childNodes.length)throw new RangeError("No node after pos "+e);return t.childNodes[r]}setSelection(e,t,r,i=!1){let o=Math.min(e,t),s=Math.max(e,t);for(let f=0,p=0;f<this.children.length;f++){let m=this.children[f],v=p+m.size;if(o>p&&s<v)return m.setSelection(e-p-m.border,t-p-m.border,r,i);p=v}let a=this.domFromPos(e,e?-1:1),l=t==e?a:this.domFromPos(t,t?-1:1),c=r.root.getSelection(),u=r.domSelectionRange(),d=!1;if((Wn||Pt)&&e==t){let{node:f,offset:p}=a;if(f.nodeType==3){if(d=!!(p&&f.nodeValue[p-1]==`
`),d&&p==f.nodeValue.length)for(let m=f,v;m;m=m.parentNode){if(v=m.nextSibling){v.nodeName=="BR"&&(a=l={node:v.parentNode,offset:pt(v)+1});break}let g=m.pmViewDesc;if(g&&g.node&&g.node.isBlock)break}}else{let m=f.childNodes[p-1];d=m&&(m.nodeName=="BR"||m.contentEditable=="false")}}if(Wn&&u.focusNode&&u.focusNode!=l.node&&u.focusNode.nodeType==1){let f=u.focusNode.childNodes[u.focusOffset];f&&f.contentEditable=="false"&&(i=!0)}if(!(i||d&&Pt)&&ao(a.node,a.offset,u.anchorNode,u.anchorOffset)&&ao(l.node,l.offset,u.focusNode,u.focusOffset))return;let h=!1;if((c.extend||e==t)&&!d){c.collapse(a.node,a.offset);try{e!=t&&c.extend(l.node,l.offset),h=!0}catch{}}if(!h){if(e>t){let p=a;a=l,l=p}let f=document.createRange();f.setEnd(l.node,l.offset),f.setStart(a.node,a.offset),c.removeAllRanges(),c.addRange(f)}}ignoreMutation(e){return!this.contentDOM&&e.type!="selection"}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(e,t){for(let r=0,i=0;i<this.children.length;i++){let o=this.children[i],s=r+o.size;if(r==s?e<=s&&t>=r:e<s&&t>r){let a=r+o.border,l=s-o.border;if(e>=a&&t<=l){this.dirty=e==r||t==s?Fi:Zv,e==a&&t==l&&(o.contentLost||o.dom.parentNode!=this.contentDOM)?o.dirty=dr:o.markDirty(e-a,t-a);return}else o.dirty=o.dom==o.contentDOM&&o.dom.parentNode==this.contentDOM&&!o.children.length?Fi:dr}r=s}this.dirty=Fi}markParentsDirty(){let e=1;for(let t=this.parent;t;t=t.parent,e++){let r=e==1?Fi:Zv;t.dirty<r&&(t.dirty=r)}}get domAtom(){return!1}get ignoreForCoords(){return!1}isText(e){return!1}}class f0 extends fl{constructor(e,t,r,i){let o,s=t.type.toDOM;if(typeof s=="function"&&(s=s(r,()=>{if(!o)return i;if(o.parent)return o.parent.posBeforeChild(o)})),!t.type.spec.raw){if(s.nodeType!=1){let a=document.createElement("span");a.appendChild(s),s=a}s.contentEditable="false",s.classList.add("ProseMirror-widget")}super(e,[],s,null),this.widget=t,this.widget=t,o=this}matchesWidget(e){return this.dirty==Nn&&e.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(e){let t=this.widget.spec.stopEvent;return t?t(e):!1}ignoreMutation(e){return e.type!="selection"||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class fP extends fl{constructor(e,t,r,i){super(e,[],t,null),this.textDOM=r,this.text=i}get size(){return this.text.length}localPosFromDOM(e,t){return e!=this.textDOM?this.posAtStart+(t?this.size:0):this.posAtStart+t}domFromPos(e){return{node:this.textDOM,offset:e}}ignoreMutation(e){return e.type==="characterData"&&e.target.nodeValue==e.oldValue}}class lo extends fl{constructor(e,t,r,i,o){super(e,[],r,i),this.mark=t,this.spec=o}static create(e,t,r,i){let o=i.nodeViews[t.type.name],s=o&&o(t,i,r);return(!s||!s.dom)&&(s=po.renderSpec(document,t.type.spec.toDOM(t,r),null,t.attrs)),new lo(e,t,s.dom,s.contentDOM||s.dom,s)}parseRule(){return this.dirty&dr||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM}}matchesMark(e){return this.dirty!=dr&&this.mark.eq(e)}markDirty(e,t){if(super.markDirty(e,t),this.dirty!=Nn){let r=this.parent;for(;!r.node;)r=r.parent;r.dirty<this.dirty&&(r.dirty=this.dirty),this.dirty=Nn}}slice(e,t,r){let i=lo.create(this.parent,this.mark,!0,r),o=this.children,s=this.size;t<s&&(o=Yf(o,t,s,r)),e>0&&(o=Yf(o,0,e,r));for(let a=0;a<o.length;a++)o[a].parent=i;return i.children=o,i}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}}class vi extends fl{constructor(e,t,r,i,o,s,a,l,c){super(e,[],o,s),this.node=t,this.outerDeco=r,this.innerDeco=i,this.nodeDOM=a}static create(e,t,r,i,o,s){let a=o.nodeViews[t.type.name],l,c=a&&a(t,o,()=>{if(!l)return s;if(l.parent)return l.parent.posBeforeChild(l)},r,i),u=c&&c.dom,d=c&&c.contentDOM;if(t.isText){if(!u)u=document.createTextNode(t.text);else if(u.nodeType!=3)throw new RangeError("Text must be rendered as a DOM text node")}else u||({dom:u,contentDOM:d}=po.renderSpec(document,t.type.spec.toDOM(t),null,t.attrs));!d&&!t.isText&&u.nodeName!="BR"&&(u.hasAttribute("contenteditable")||(u.contentEditable="false"),t.type.spec.draggable&&(u.draggable=!0));let h=u;return u=y0(u,r,t),c?l=new pP(e,t,r,i,u,d||null,h,c,o,s+1):t.isText?new od(e,t,r,i,u,h,o):new vi(e,t,r,i,u,d||null,h,o,s+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let e={node:this.node.type.name,attrs:this.node.attrs};if(this.node.type.whitespace=="pre"&&(e.preserveWhitespace="full"),!this.contentDOM)e.getContent=()=>this.node.content;else if(!this.contentLost)e.contentElement=this.contentDOM;else{for(let t=this.children.length-1;t>=0;t--){let r=this.children[t];if(this.dom.contains(r.dom.parentNode)){e.contentElement=r.dom.parentNode;break}}e.contentElement||(e.getContent=()=>x.empty)}return e}matchesNode(e,t,r){return this.dirty==Nn&&e.eq(this.node)&&uu(t,this.outerDeco)&&r.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(e,t){let r=this.node.inlineContent,i=t,o=e.composing?this.localCompositionInfo(e,t):null,s=o&&o.pos>-1?o:null,a=o&&o.pos<0,l=new gP(this,s&&s.node,e);CP(this.node,this.innerDeco,(c,u,d)=>{c.spec.marks?l.syncToMarks(c.spec.marks,r,e):c.type.side>=0&&!d&&l.syncToMarks(u==this.node.childCount?Se.none:this.node.child(u).marks,r,e),l.placeWidget(c,e,i)},(c,u,d,h)=>{l.syncToMarks(c.marks,r,e);let f;l.findNodeMatch(c,u,d,h)||a&&e.state.selection.from>i&&e.state.selection.to<i+c.nodeSize&&(f=l.findIndexWithChild(o.node))>-1&&l.updateNodeAt(c,u,d,f,e)||l.updateNextNode(c,u,d,e,h,i)||l.addNode(c,u,d,e,i),i+=c.nodeSize}),l.syncToMarks([],r,e),this.node.isTextblock&&l.addTextblockHacks(),l.destroyRest(),(l.changed||this.dirty==Fi)&&(s&&this.protectLocalComposition(e,s),m0(this.contentDOM,this.children,e),vs&&SP(this.dom))}localCompositionInfo(e,t){let{from:r,to:i}=e.state.selection;if(!(e.state.selection instanceof J)||r<t||i>t+this.node.content.size)return null;let o=e.input.compositionNode;if(!o||!this.dom.contains(o.parentNode))return null;if(this.node.inlineContent){let s=o.nodeValue,a=wP(this.node.content,s,r-t,i-t);return a<0?null:{node:o,pos:a,text:s}}else return{node:o,pos:-1,text:""}}protectLocalComposition(e,{node:t,pos:r,text:i}){if(this.getDesc(t))return;let o=t;for(;o.parentNode!=this.contentDOM;o=o.parentNode){for(;o.previousSibling;)o.parentNode.removeChild(o.previousSibling);for(;o.nextSibling;)o.parentNode.removeChild(o.nextSibling);o.pmViewDesc&&(o.pmViewDesc=void 0)}let s=new fP(this,o,t,i);e.input.compositionNodes.push(s),this.children=Yf(this.children,r,r+i.length,e,s)}update(e,t,r,i){return this.dirty==dr||!e.sameMarkup(this.node)?!1:(this.updateInner(e,t,r,i),!0)}updateInner(e,t,r,i){this.updateOuterDeco(t),this.node=e,this.innerDeco=r,this.contentDOM&&this.updateChildren(i,this.posAtStart),this.dirty=Nn}updateOuterDeco(e){if(uu(e,this.outerDeco))return;let t=this.nodeDOM.nodeType!=1,r=this.dom;this.dom=g0(this.dom,this.nodeDOM,Qf(this.outerDeco,this.node,t),Qf(e,this.node,t)),this.dom!=r&&(r.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=e}selectNode(){this.nodeDOM.nodeType==1&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){this.nodeDOM.nodeType==1&&(this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable"))}get domAtom(){return this.node.isAtom}}function eC(n,e,t,r,i){y0(r,e,n);let o=new vi(void 0,n,e,t,r,r,r,i,0);return o.contentDOM&&o.updateChildren(i,0),o}class od extends vi{constructor(e,t,r,i,o,s,a){super(e,t,r,i,o,null,s,a,0)}parseRule(){let e=this.nodeDOM.parentNode;for(;e&&e!=this.dom&&!e.pmIsDeco;)e=e.parentNode;return{skip:e||!0}}update(e,t,r,i){return this.dirty==dr||this.dirty!=Nn&&!this.inParent()||!e.sameMarkup(this.node)?!1:(this.updateOuterDeco(t),(this.dirty!=Nn||e.text!=this.node.text)&&e.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=e.text,i.trackWrites==this.nodeDOM&&(i.trackWrites=null)),this.node=e,this.dirty=Nn,!0)}inParent(){let e=this.parent.contentDOM;for(let t=this.nodeDOM;t;t=t.parentNode)if(t==e)return!0;return!1}domFromPos(e){return{node:this.nodeDOM,offset:e}}localPosFromDOM(e,t,r){return e==this.nodeDOM?this.posAtStart+Math.min(t,this.node.text.length):super.localPosFromDOM(e,t,r)}ignoreMutation(e){return e.type!="characterData"&&e.type!="selection"}slice(e,t,r){let i=this.node.cut(e,t),o=document.createTextNode(i.text);return new od(this.parent,i,this.outerDeco,this.innerDeco,o,o,r)}markDirty(e,t){super.markDirty(e,t),this.dom!=this.nodeDOM&&(e==0||t==this.nodeDOM.nodeValue.length)&&(this.dirty=dr)}get domAtom(){return!1}isText(e){return this.node.text==e}}class p0 extends fl{parseRule(){return{ignore:!0}}matchesHack(e){return this.dirty==Nn&&this.dom.nodeName==e}get domAtom(){return!0}get ignoreForCoords(){return this.dom.nodeName=="IMG"}}class pP extends vi{constructor(e,t,r,i,o,s,a,l,c,u){super(e,t,r,i,o,s,a,c,u),this.spec=l}update(e,t,r,i){if(this.dirty==dr)return!1;if(this.spec.update&&(this.node.type==e.type||this.spec.multiType)){let o=this.spec.update(e,t,r);return o&&this.updateInner(e,t,r,i),o}else return!this.contentDOM&&!e.isLeaf?!1:super.update(e,t,r,i)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(e,t,r,i){this.spec.setSelection?this.spec.setSelection(e,t,r.root):super.setSelection(e,t,r,i)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(e){return this.spec.stopEvent?this.spec.stopEvent(e):!1}ignoreMutation(e){return this.spec.ignoreMutation?this.spec.ignoreMutation(e):super.ignoreMutation(e)}}function m0(n,e,t){let r=n.firstChild,i=!1;for(let o=0;o<e.length;o++){let s=e[o],a=s.dom;if(a.parentNode==n){for(;a!=r;)r=tC(r),i=!0;r=r.nextSibling}else i=!0,n.insertBefore(a,r);if(s instanceof lo){let l=r?r.previousSibling:n.lastChild;m0(s.contentDOM,s.children,t),r=l?l.nextSibling:n.firstChild}}for(;r;)r=tC(r),i=!0;i&&t.trackWrites==n&&(t.trackWrites=null)}const Ca=function(n){n&&(this.nodeName=n)};Ca.prototype=Object.create(null);const Bi=[new Ca];function Qf(n,e,t){if(n.length==0)return Bi;let r=t?Bi[0]:new Ca,i=[r];for(let o=0;o<n.length;o++){let s=n[o].type.attrs;if(s){s.nodeName&&i.push(r=new Ca(s.nodeName));for(let a in s){let l=s[a];l!=null&&(t&&i.length==1&&i.push(r=new Ca(e.isInline?"span":"div")),a=="class"?r.class=(r.class?r.class+" ":"")+l:a=="style"?r.style=(r.style?r.style+";":"")+l:a!="nodeName"&&(r[a]=l))}}}return i}function g0(n,e,t,r){if(t==Bi&&r==Bi)return e;let i=e;for(let o=0;o<r.length;o++){let s=r[o],a=t[o];if(o){let l;a&&a.nodeName==s.nodeName&&i!=n&&(l=i.parentNode)&&l.nodeName.toLowerCase()==s.nodeName||(l=document.createElement(s.nodeName),l.pmIsDeco=!0,l.appendChild(i),a=Bi[0]),i=l}mP(i,a||Bi[0],s)}return i}function mP(n,e,t){for(let r in e)r!="class"&&r!="style"&&r!="nodeName"&&!(r in t)&&n.removeAttribute(r);for(let r in t)r!="class"&&r!="style"&&r!="nodeName"&&t[r]!=e[r]&&n.setAttribute(r,t[r]);if(e.class!=t.class){let r=e.class?e.class.split(" ").filter(Boolean):[],i=t.class?t.class.split(" ").filter(Boolean):[];for(let o=0;o<r.length;o++)i.indexOf(r[o])==-1&&n.classList.remove(r[o]);for(let o=0;o<i.length;o++)r.indexOf(i[o])==-1&&n.classList.add(i[o]);n.classList.length==0&&n.removeAttribute("class")}if(e.style!=t.style){if(e.style){let r=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g,i;for(;i=r.exec(e.style);)n.style.removeProperty(i[1])}t.style&&(n.style.cssText+=t.style)}}function y0(n,e,t){return g0(n,n,Bi,Qf(e,t,n.nodeType!=1))}function uu(n,e){if(n.length!=e.length)return!1;for(let t=0;t<n.length;t++)if(!n[t].type.eq(e[t].type))return!1;return!0}function tC(n){let e=n.nextSibling;return n.parentNode.removeChild(n),e}class gP{constructor(e,t,r){this.lock=t,this.view=r,this.index=0,this.stack=[],this.changed=!1,this.top=e,this.preMatch=yP(e.node.content,e)}destroyBetween(e,t){if(e!=t){for(let r=e;r<t;r++)this.top.children[r].destroy();this.top.children.splice(e,t-e),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(e,t,r){let i=0,o=this.stack.length>>1,s=Math.min(o,e.length);for(;i<s&&(i==o-1?this.top:this.stack[i+1<<1]).matchesMark(e[i])&&e[i].type.spec.spanning!==!1;)i++;for(;i<o;)this.destroyRest(),this.top.dirty=Nn,this.index=this.stack.pop(),this.top=this.stack.pop(),o--;for(;o<e.length;){this.stack.push(this.top,this.index+1);let a=-1;for(let l=this.index;l<Math.min(this.index+3,this.top.children.length);l++){let c=this.top.children[l];if(c.matchesMark(e[o])&&!this.isLocked(c.dom)){a=l;break}}if(a>-1)a>this.index&&(this.changed=!0,this.destroyBetween(this.index,a)),this.top=this.top.children[this.index];else{let l=lo.create(this.top,e[o],t,r);this.top.children.splice(this.index,0,l),this.top=l,this.changed=!0}this.index=0,o++}}findNodeMatch(e,t,r,i){let o=-1,s;if(i>=this.preMatch.index&&(s=this.preMatch.matches[i-this.preMatch.index]).parent==this.top&&s.matchesNode(e,t,r))o=this.top.children.indexOf(s,this.index);else for(let a=this.index,l=Math.min(this.top.children.length,a+5);a<l;a++){let c=this.top.children[a];if(c.matchesNode(e,t,r)&&!this.preMatch.matched.has(c)){o=a;break}}return o<0?!1:(this.destroyBetween(this.index,o),this.index++,!0)}updateNodeAt(e,t,r,i,o){let s=this.top.children[i];return s.dirty==dr&&s.dom==s.contentDOM&&(s.dirty=Fi),s.update(e,t,r,o)?(this.destroyBetween(this.index,i),this.index++,!0):!1}findIndexWithChild(e){for(;;){let t=e.parentNode;if(!t)return-1;if(t==this.top.contentDOM){let r=e.pmViewDesc;if(r){for(let i=this.index;i<this.top.children.length;i++)if(this.top.children[i]==r)return i}return-1}e=t}}updateNextNode(e,t,r,i,o,s){for(let a=this.index;a<this.top.children.length;a++){let l=this.top.children[a];if(l instanceof vi){let c=this.preMatch.matched.get(l);if(c!=null&&c!=o)return!1;let u=l.dom,d,h=this.isLocked(u)&&!(e.isText&&l.node&&l.node.isText&&l.nodeDOM.nodeValue==e.text&&l.dirty!=dr&&uu(t,l.outerDeco));if(!h&&l.update(e,t,r,i))return this.destroyBetween(this.index,a),l.dom!=u&&(this.changed=!0),this.index++,!0;if(!h&&(d=this.recreateWrapper(l,e,t,r,i,s)))return this.destroyBetween(this.index,a),this.top.children[this.index]=d,d.contentDOM&&(d.dirty=Fi,d.updateChildren(i,s+1),d.dirty=Nn),this.changed=!0,this.index++,!0;break}}return!1}recreateWrapper(e,t,r,i,o,s){if(e.dirty||t.isAtom||!e.children.length||!e.node.content.eq(t.content)||!uu(r,e.outerDeco)||!i.eq(e.innerDeco))return null;let a=vi.create(this.top,t,r,i,o,s);if(a.contentDOM){a.children=e.children,e.children=[];for(let l of a.children)l.parent=a}return e.destroy(),a}addNode(e,t,r,i,o){let s=vi.create(this.top,e,t,r,i,o);s.contentDOM&&s.updateChildren(i,o+1),this.top.children.splice(this.index++,0,s),this.changed=!0}placeWidget(e,t,r){let i=this.index<this.top.children.length?this.top.children[this.index]:null;if(i&&i.matchesWidget(e)&&(e==i.widget||!i.widget.type.toDOM.parentNode))this.index++;else{let o=new f0(this.top,e,t,r);this.top.children.splice(this.index++,0,o),this.changed=!0}}addTextblockHacks(){let e=this.top.children[this.index-1],t=this.top;for(;e instanceof lo;)t=e,e=t.children[t.children.length-1];(!e||!(e instanceof od)||/\n$/.test(e.node.text)||this.view.requiresGeckoHackNode&&/\s$/.test(e.node.text))&&((Pt||bt)&&e&&e.dom.contentEditable=="false"&&this.addHackNode("IMG",t),this.addHackNode("BR",this.top))}addHackNode(e,t){if(t==this.top&&this.index<t.children.length&&t.children[this.index].matchesHack(e))this.index++;else{let r=document.createElement(e);e=="IMG"&&(r.className="ProseMirror-separator",r.alt=""),e=="BR"&&(r.className="ProseMirror-trailingBreak");let i=new p0(this.top,[],r,null);t!=this.top?t.children.push(i):t.children.splice(this.index++,0,i),this.changed=!0}}isLocked(e){return this.lock&&(e==this.lock||e.nodeType==1&&e.contains(this.lock.parentNode))}}function yP(n,e){let t=e,r=t.children.length,i=n.childCount,o=new Map,s=[];e:for(;i>0;){let a;for(;;)if(r){let c=t.children[r-1];if(c instanceof lo)t=c,r=c.children.length;else{a=c,r--;break}}else{if(t==e)break e;r=t.parent.children.indexOf(t),t=t.parent}let l=a.node;if(l){if(l!=n.child(i-1))break;--i,o.set(a,i),s.push(a)}}return{index:i,matched:o,matches:s.reverse()}}function vP(n,e){return n.type.side-e.type.side}function CP(n,e,t,r){let i=e.locals(n),o=0;if(i.length==0){for(let c=0;c<n.childCount;c++){let u=n.child(c);r(u,i,e.forChild(o,u),c),o+=u.nodeSize}return}let s=0,a=[],l=null;for(let c=0;;){let u,d;for(;s<i.length&&i[s].to==o;){let v=i[s++];v.widget&&(u?(d||(d=[u])).push(v):u=v)}if(u)if(d){d.sort(vP);for(let v=0;v<d.length;v++)t(d[v],c,!!l)}else t(u,c,!!l);let h,f;if(l)f=-1,h=l,l=null;else if(c<n.childCount)f=c,h=n.child(c++);else break;for(let v=0;v<a.length;v++)a[v].to<=o&&a.splice(v--,1);for(;s<i.length&&i[s].from<=o&&i[s].to>o;)a.push(i[s++]);let p=o+h.nodeSize;if(h.isText){let v=p;s<i.length&&i[s].from<v&&(v=i[s].from);for(let g=0;g<a.length;g++)a[g].to<v&&(v=a[g].to);v<p&&(l=h.cut(v-o),h=h.cut(0,v-o),p=v,f=-1)}else for(;s<i.length&&i[s].to<p;)s++;let m=h.isInline&&!h.isLeaf?a.filter(v=>!v.inline):a.slice();r(h,m,e.forChild(o,h),f),o=p}}function SP(n){if(n.nodeName=="UL"||n.nodeName=="OL"){let e=n.style.cssText;n.style.cssText=e+"; list-style: square !important",window.getComputedStyle(n).listStyle,n.style.cssText=e}}function wP(n,e,t,r){for(let i=0,o=0;i<n.childCount&&o<=r;){let s=n.child(i++),a=o;if(o+=s.nodeSize,!s.isText)continue;let l=s.text;for(;i<n.childCount;){let c=n.child(i++);if(o+=c.nodeSize,!c.isText)break;l+=c.text}if(o>=t){if(o>=r&&l.slice(r-e.length-a,r-a)==e)return r-e.length;let c=a<r?l.lastIndexOf(e,r-a-1):-1;if(c>=0&&c+e.length+a>=t)return a+c;if(t==r&&l.length>=r+e.length-a&&l.slice(r-a,r-a+e.length)==e)return r}}return-1}function Yf(n,e,t,r,i){let o=[];for(let s=0,a=0;s<n.length;s++){let l=n[s],c=a,u=a+=l.size;c>=t||u<=e?o.push(l):(c<e&&o.push(l.slice(0,e-c,r)),i&&(o.push(i),i=void 0),u>t&&o.push(l.slice(t-c,l.size,r)))}return o}function eg(n,e=null){let t=n.domSelectionRange(),r=n.state.doc;if(!t.focusNode)return null;let i=n.docView.nearestDesc(t.focusNode),o=i&&i.size==0,s=n.docView.posFromDOM(t.focusNode,t.focusOffset,1);if(s<0)return null;let a=r.resolve(s),l,c;if(id(t)){for(l=s;i&&!i.node;)i=i.parent;let d=i.node;if(i&&d.isAtom&&G.isSelectable(d)&&i.parent&&!(d.isInline&&G_(t.focusNode,t.focusOffset,i.dom))){let h=i.posBefore;c=new G(s==h?a:r.resolve(h))}}else{if(t instanceof n.dom.ownerDocument.defaultView.Selection&&t.rangeCount>1){let d=s,h=s;for(let f=0;f<t.rangeCount;f++){let p=t.getRangeAt(f);d=Math.min(d,n.docView.posFromDOM(p.startContainer,p.startOffset,1)),h=Math.max(h,n.docView.posFromDOM(p.endContainer,p.endOffset,-1))}if(d<0)return null;[l,s]=h==n.state.selection.anchor?[h,d]:[d,h],a=r.resolve(s)}else l=n.docView.posFromDOM(t.anchorNode,t.anchorOffset,1);if(l<0)return null}let u=r.resolve(l);if(!c){let d=e=="pointer"||n.state.selection.head<a.pos&&!o?1:-1;c=tg(n,u,a,d)}return c}function v0(n){return n.editable?n.hasFocus():S0(n)&&document.activeElement&&document.activeElement.contains(n.dom)}function Ar(n,e=!1){let t=n.state.selection;if(C0(n,t),!!v0(n)){if(!e&&n.input.mouseDown&&n.input.mouseDown.allowDefault&&bt){let r=n.domSelectionRange(),i=n.domObserver.currentSelection;if(r.anchorNode&&i.anchorNode&&ao(r.anchorNode,r.anchorOffset,i.anchorNode,i.anchorOffset)){n.input.mouseDown.delayedSelectionSync=!0,n.domObserver.setCurSelection();return}}if(n.domObserver.disconnectSelection(),n.cursorWrapper)EP(n);else{let{anchor:r,head:i}=t,o,s;nC&&!(t instanceof J)&&(t.$from.parent.inlineContent||(o=rC(n,t.from)),!t.empty&&!t.$from.parent.inlineContent&&(s=rC(n,t.to))),n.docView.setSelection(r,i,n,e),nC&&(o&&iC(o),s&&iC(s)),t.visible?n.dom.classList.remove("ProseMirror-hideselection"):(n.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&TP(n))}n.domObserver.setCurSelection(),n.domObserver.connectSelection()}}const nC=Pt||bt&&s0<63;function rC(n,e){let{node:t,offset:r}=n.docView.domFromPos(e,0),i=r<t.childNodes.length?t.childNodes[r]:null,o=r?t.childNodes[r-1]:null;if(Pt&&i&&i.contentEditable=="false")return ah(i);if((!i||i.contentEditable=="false")&&(!o||o.contentEditable=="false")){if(i)return ah(i);if(o)return ah(o)}}function ah(n){return n.contentEditable="true",Pt&&n.draggable&&(n.draggable=!1,n.wasDraggable=!0),n}function iC(n){n.contentEditable="false",n.wasDraggable&&(n.draggable=!0,n.wasDraggable=null)}function TP(n){let e=n.dom.ownerDocument;e.removeEventListener("selectionchange",n.input.hideSelectionGuard);let t=n.domSelectionRange(),r=t.anchorNode,i=t.anchorOffset;e.addEventListener("selectionchange",n.input.hideSelectionGuard=()=>{(t.anchorNode!=r||t.anchorOffset!=i)&&(e.removeEventListener("selectionchange",n.input.hideSelectionGuard),setTimeout(()=>{(!v0(n)||n.state.selection.visible)&&n.dom.classList.remove("ProseMirror-hideselection")},20))})}function EP(n){let e=n.domSelection(),t=document.createRange();if(!e)return;let r=n.cursorWrapper.dom,i=r.nodeName=="IMG";i?t.setStart(r.parentNode,pt(r)+1):t.setStart(r,0),t.collapse(!0),e.removeAllRanges(),e.addRange(t),!i&&!n.state.selection.visible&&Jt&&yi<=11&&(r.disabled=!0,r.disabled=!1)}function C0(n,e){if(e instanceof G){let t=n.docView.descAt(e.from);t!=n.lastSelectedViewDesc&&(oC(n),t&&t.selectNode(),n.lastSelectedViewDesc=t)}else oC(n)}function oC(n){n.lastSelectedViewDesc&&(n.lastSelectedViewDesc.parent&&n.lastSelectedViewDesc.deselectNode(),n.lastSelectedViewDesc=void 0)}function tg(n,e,t,r){return n.someProp("createSelectionBetween",i=>i(n,e,t))||J.between(e,t,r)}function sC(n){return n.editable&&!n.hasFocus()?!1:S0(n)}function S0(n){let e=n.domSelectionRange();if(!e.anchorNode)return!1;try{return n.dom.contains(e.anchorNode.nodeType==3?e.anchorNode.parentNode:e.anchorNode)&&(n.editable||n.dom.contains(e.focusNode.nodeType==3?e.focusNode.parentNode:e.focusNode))}catch{return!1}}function kP(n){let e=n.docView.domFromPos(n.state.selection.anchor,0),t=n.domSelectionRange();return ao(e.node,e.offset,t.anchorNode,t.anchorOffset)}function Jf(n,e){let{$anchor:t,$head:r}=n.selection,i=e>0?t.max(r):t.min(r),o=i.parent.inlineContent?i.depth?n.doc.resolve(e>0?i.after():i.before()):null:i;return o&&Z.findFrom(o,e)}function Gr(n,e){return n.dispatch(n.state.tr.setSelection(e).scrollIntoView()),!0}function aC(n,e,t){let r=n.state.selection;if(r instanceof J)if(t.indexOf("s")>-1){let{$head:i}=r,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter;if(!o||o.isText||!o.isLeaf)return!1;let s=n.state.doc.resolve(i.pos+o.nodeSize*(e<0?-1:1));return Gr(n,new J(r.$anchor,s))}else if(r.empty){if(n.endOfTextblock(e>0?"forward":"backward")){let i=Jf(n.state,e);return i&&i instanceof G?Gr(n,i):!1}else if(!(wn&&t.indexOf("m")>-1)){let i=r.$head,o=i.textOffset?null:e<0?i.nodeBefore:i.nodeAfter,s;if(!o||o.isText)return!1;let a=e<0?i.pos-o.nodeSize:i.pos;return o.isAtom||(s=n.docView.descAt(a))&&!s.contentDOM?G.isSelectable(o)?Gr(n,new G(e<0?n.state.doc.resolve(i.pos-o.nodeSize):i)):hl?Gr(n,new J(n.state.doc.resolve(e<0?a:a+o.nodeSize))):!1:!1}}else return!1;else{if(r instanceof G&&r.node.isInline)return Gr(n,new J(e>0?r.$to:r.$from));{let i=Jf(n.state,e);return i?Gr(n,i):!1}}}function du(n){return n.nodeType==3?n.nodeValue.length:n.childNodes.length}function Sa(n,e){let t=n.pmViewDesc;return t&&t.size==0&&(e<0||n.nextSibling||n.nodeName!="BR")}function wo(n,e){return e<0?IP(n):AP(n)}function IP(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i,o,s=!1;for(Wn&&t.nodeType==1&&r<du(t)&&Sa(t.childNodes[r],-1)&&(s=!0);;)if(r>0){if(t.nodeType!=1)break;{let a=t.childNodes[r-1];if(Sa(a,-1))i=t,o=--r;else if(a.nodeType==3)t=a,r=t.nodeValue.length;else break}}else{if(w0(t))break;{let a=t.previousSibling;for(;a&&Sa(a,-1);)i=t.parentNode,o=pt(a),a=a.previousSibling;if(a)t=a,r=du(t);else{if(t=t.parentNode,t==n.dom)break;r=0}}}s?Xf(n,t,r):i&&Xf(n,i,o)}function AP(n){let e=n.domSelectionRange(),t=e.focusNode,r=e.focusOffset;if(!t)return;let i=du(t),o,s;for(;;)if(r<i){if(t.nodeType!=1)break;let a=t.childNodes[r];if(Sa(a,1))o=t,s=++r;else break}else{if(w0(t))break;{let a=t.nextSibling;for(;a&&Sa(a,1);)o=a.parentNode,s=pt(a)+1,a=a.nextSibling;if(a)t=a,r=0,i=du(t);else{if(t=t.parentNode,t==n.dom)break;r=i=0}}}o&&Xf(n,o,s)}function w0(n){let e=n.pmViewDesc;return e&&e.node&&e.node.isBlock}function bP(n,e){for(;n&&e==n.childNodes.length&&!dl(n);)e=pt(n)+1,n=n.parentNode;for(;n&&e<n.childNodes.length;){let t=n.childNodes[e];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=0}}function RP(n,e){for(;n&&!e&&!dl(n);)e=pt(n),n=n.parentNode;for(;n&&e;){let t=n.childNodes[e-1];if(t.nodeType==3)return t;if(t.nodeType==1&&t.contentEditable=="false")break;n=t,e=n.childNodes.length}}function Xf(n,e,t){if(e.nodeType!=3){let o,s;(s=bP(e,t))?(e=s,t=0):(o=RP(e,t))&&(e=o,t=o.nodeValue.length)}let r=n.domSelection();if(!r)return;if(id(r)){let o=document.createRange();o.setEnd(e,t),o.setStart(e,t),r.removeAllRanges(),r.addRange(o)}else r.extend&&r.extend(e,t);n.domObserver.setCurSelection();let{state:i}=n;setTimeout(()=>{n.state==i&&Ar(n)},50)}function lC(n,e){let t=n.state.doc.resolve(e);if(!(bt||Y_)&&t.parent.inlineContent){let i=n.coordsAtPos(e);if(e>t.start()){let o=n.coordsAtPos(e-1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left<i.left?"ltr":"rtl"}if(e<t.end()){let o=n.coordsAtPos(e+1),s=(o.top+o.bottom)/2;if(s>i.top&&s<i.bottom&&Math.abs(o.left-i.left)>1)return o.left>i.left?"ltr":"rtl"}}return getComputedStyle(n.dom).direction=="rtl"?"rtl":"ltr"}function cC(n,e,t){let r=n.state.selection;if(r instanceof J&&!r.empty||t.indexOf("s")>-1||wn&&t.indexOf("m")>-1)return!1;let{$from:i,$to:o}=r;if(!i.parent.inlineContent||n.endOfTextblock(e<0?"up":"down")){let s=Jf(n.state,e);if(s&&s instanceof G)return Gr(n,s)}if(!i.parent.inlineContent){let s=e<0?i:o,a=r instanceof Rn?Z.near(s,e):Z.findFrom(s,e);return a?Gr(n,a):!1}return!1}function uC(n,e){if(!(n.state.selection instanceof J))return!0;let{$head:t,$anchor:r,empty:i}=n.state.selection;if(!t.sameParent(r))return!0;if(!i)return!1;if(n.endOfTextblock(e>0?"forward":"backward"))return!0;let o=!t.textOffset&&(e<0?t.nodeBefore:t.nodeAfter);if(o&&!o.isText){let s=n.state.tr;return e<0?s.delete(t.pos-o.nodeSize,t.pos):s.delete(t.pos,t.pos+o.nodeSize),n.dispatch(s),!0}return!1}function dC(n,e,t){n.domObserver.stop(),e.contentEditable=t,n.domObserver.start()}function NP(n){if(!Pt||n.state.selection.$head.parentOffset>0)return!1;let{focusNode:e,focusOffset:t}=n.domSelectionRange();if(e&&e.nodeType==1&&t==0&&e.firstChild&&e.firstChild.contentEditable=="false"){let r=e.firstChild;dC(n,r,"true"),setTimeout(()=>dC(n,r,"false"),20)}return!1}function xP(n){let e="";return n.ctrlKey&&(e+="c"),n.metaKey&&(e+="m"),n.altKey&&(e+="a"),n.shiftKey&&(e+="s"),e}function OP(n,e){let t=e.keyCode,r=xP(e);if(t==8||wn&&t==72&&r=="c")return uC(n,-1)||wo(n,-1);if(t==46&&!e.shiftKey||wn&&t==68&&r=="c")return uC(n,1)||wo(n,1);if(t==13||t==27)return!0;if(t==37||wn&&t==66&&r=="c"){let i=t==37?lC(n,n.state.selection.from)=="ltr"?-1:1:-1;return aC(n,i,r)||wo(n,i)}else if(t==39||wn&&t==70&&r=="c"){let i=t==39?lC(n,n.state.selection.from)=="ltr"?1:-1:1;return aC(n,i,r)||wo(n,i)}else{if(t==38||wn&&t==80&&r=="c")return cC(n,-1,r)||wo(n,-1);if(t==40||wn&&t==78&&r=="c")return NP(n)||cC(n,1,r)||wo(n,1);if(r==(wn?"m":"c")&&(t==66||t==73||t==89||t==90))return!0}return!1}function ng(n,e){n.someProp("transformCopied",f=>{e=f(e,n)});let t=[],{content:r,openStart:i,openEnd:o}=e;for(;i>1&&o>1&&r.childCount==1&&r.firstChild.childCount==1;){i--,o--;let f=r.firstChild;t.push(f.type.name,f.attrs!=f.type.defaultAttrs?f.attrs:null),r=f.content}let s=n.someProp("clipboardSerializer")||po.fromSchema(n.state.schema),a=b0(),l=a.createElement("div");l.appendChild(s.serializeFragment(r,{document:a}));let c=l.firstChild,u,d=0;for(;c&&c.nodeType==1&&(u=A0[c.nodeName.toLowerCase()]);){for(let f=u.length-1;f>=0;f--){let p=a.createElement(u[f]);for(;l.firstChild;)p.appendChild(l.firstChild);l.appendChild(p),d++}c=l.firstChild}c&&c.nodeType==1&&c.setAttribute("data-pm-slice",`${i} ${o}${d?` -${d}`:""} ${JSON.stringify(t)}`);let h=n.someProp("clipboardTextSerializer",f=>f(e,n))||e.content.textBetween(0,e.content.size,`

`);return{dom:l,text:h,slice:e}}function T0(n,e,t,r,i){let o=i.parent.type.spec.code,s,a;if(!t&&!e)return null;let l=e&&(r||o||!t);if(l){if(n.someProp("transformPastedText",h=>{e=h(e,o||r,n)}),o)return e?new U(x.from(n.state.schema.text(e.replace(/\r\n?/g,`
`))),0,0):U.empty;let d=n.someProp("clipboardTextParser",h=>h(e,i,r,n));if(d)a=d;else{let h=i.marks(),{schema:f}=n.state,p=po.fromSchema(f);s=document.createElement("div"),e.split(/(?:\r\n?|\n)+/).forEach(m=>{let v=s.appendChild(document.createElement("p"));m&&v.appendChild(p.serializeNode(f.text(m,h)))})}}else n.someProp("transformPastedHTML",d=>{t=d(t,n)}),s=DP(t),hl&&LP(s);let c=s&&s.querySelector("[data-pm-slice]"),u=c&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(c.getAttribute("data-pm-slice")||"");if(u&&u[3])for(let d=+u[3];d>0;d--){let h=s.firstChild;for(;h&&h.nodeType!=1;)h=h.nextSibling;if(!h)break;s=h}if(a||(a=(n.someProp("clipboardParser")||n.someProp("domParser")||ya.fromSchema(n.state.schema)).parseSlice(s,{preserveWhitespace:!!(l||u),context:i,ruleFromNode(h){return h.nodeName=="BR"&&!h.nextSibling&&h.parentNode&&!MP.test(h.parentNode.nodeName)?{ignore:!0}:null}})),u)a=UP(hC(a,+u[1],+u[2]),u[4]);else if(a=U.maxOpen(_P(a.content,i),!0),a.openStart||a.openEnd){let d=0,h=0;for(let f=a.content.firstChild;d<a.openStart&&!f.type.spec.isolating;d++,f=f.firstChild);for(let f=a.content.lastChild;h<a.openEnd&&!f.type.spec.isolating;h++,f=f.lastChild);a=hC(a,d,h)}return n.someProp("transformPasted",d=>{a=d(a,n)}),a}const MP=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function _P(n,e){if(n.childCount<2)return n;for(let t=e.depth;t>=0;t--){let i=e.node(t).contentMatchAt(e.index(t)),o,s=[];if(n.forEach(a=>{if(!s)return;let l=i.findWrapping(a.type),c;if(!l)return s=null;if(c=s.length&&o.length&&k0(l,o,a,s[s.length-1],0))s[s.length-1]=c;else{s.length&&(s[s.length-1]=I0(s[s.length-1],o.length));let u=E0(a,l);s.push(u),i=i.matchType(u.type),o=l}}),s)return x.from(s)}return n}function E0(n,e,t=0){for(let r=e.length-1;r>=t;r--)n=e[r].create(null,x.from(n));return n}function k0(n,e,t,r,i){if(i<n.length&&i<e.length&&n[i]==e[i]){let o=k0(n,e,t,r.lastChild,i+1);if(o)return r.copy(r.content.replaceChild(r.childCount-1,o));if(r.contentMatchAt(r.childCount).matchType(i==n.length-1?t.type:n[i+1]))return r.copy(r.content.append(x.from(E0(t,n,i+1))))}}function I0(n,e){if(e==0)return n;let t=n.content.replaceChild(n.childCount-1,I0(n.lastChild,e-1)),r=n.contentMatchAt(n.childCount).fillBefore(x.empty,!0);return n.copy(t.append(r))}function Zf(n,e,t,r,i,o){let s=e<0?n.firstChild:n.lastChild,a=s.content;return n.childCount>1&&(o=0),i<r-1&&(a=Zf(a,e,t,r,i+1,o)),i>=t&&(a=e<0?s.contentMatchAt(0).fillBefore(a,o<=i).append(a):a.append(s.contentMatchAt(s.childCount).fillBefore(x.empty,!0))),n.replaceChild(e<0?0:n.childCount-1,s.copy(a))}function hC(n,e,t){return e<n.openStart&&(n=new U(Zf(n.content,-1,e,n.openStart,0,n.openEnd),e,n.openEnd)),t<n.openEnd&&(n=new U(Zf(n.content,1,t,n.openEnd,0,0),n.openStart,t)),n}const A0={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let fC=null;function b0(){return fC||(fC=document.implementation.createHTMLDocument("title"))}let lh=null;function PP(n){let e=window.trustedTypes;return e?(lh||(lh=e.createPolicy("ProseMirrorClipboard",{createHTML:t=>t})),lh.createHTML(n)):n}function DP(n){let e=/^(\s*<meta [^>]*>)*/.exec(n);e&&(n=n.slice(e[0].length));let t=b0().createElement("div"),r=/<([a-z][^>\s]+)/i.exec(n),i;if((i=r&&A0[r[1].toLowerCase()])&&(n=i.map(o=>"<"+o+">").join("")+n+i.map(o=>"</"+o+">").reverse().join("")),t.innerHTML=PP(n),i)for(let o=0;o<i.length;o++)t=t.querySelector(i[o])||t;return t}function LP(n){let e=n.querySelectorAll(bt?"span:not([class]):not([style])":"span.Apple-converted-space");for(let t=0;t<e.length;t++){let r=e[t];r.childNodes.length==1&&r.textContent==" "&&r.parentNode&&r.parentNode.replaceChild(n.ownerDocument.createTextNode(" "),r)}}function UP(n,e){if(!n.size)return n;let t=n.content.firstChild.type.schema,r;try{r=JSON.parse(e)}catch{return n}let{content:i,openStart:o,openEnd:s}=n;for(let a=r.length-2;a>=0;a-=2){let l=t.nodes[r[a]];if(!l||l.hasRequiredAttrs())break;i=x.from(l.create(r[a+1],i)),o++,s++}return new U(i,o,s)}const Dt={},Lt={},HP={touchstart:!0,touchmove:!0};class FP{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastFocus=0,this.lastTouch=0,this.lastChromeDelete=0,this.composing=!1,this.compositionNode=null,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.compositionID=1,this.compositionPendingChanges=0,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function BP(n){for(let e in Dt){let t=Dt[e];n.dom.addEventListener(e,n.input.eventHandlers[e]=r=>{jP(n,r)&&!rg(n,r)&&(n.editable||!(r.type in Lt))&&t(n,r)},HP[e]?{passive:!0}:void 0)}Pt&&n.dom.addEventListener("input",()=>null),ep(n)}function ii(n,e){n.input.lastSelectionOrigin=e,n.input.lastSelectionTime=Date.now()}function zP(n){n.domObserver.stop();for(let e in n.input.eventHandlers)n.dom.removeEventListener(e,n.input.eventHandlers[e]);clearTimeout(n.input.composingTimeout),clearTimeout(n.input.lastIOSEnterFallbackTimeout)}function ep(n){n.someProp("handleDOMEvents",e=>{for(let t in e)n.input.eventHandlers[t]||n.dom.addEventListener(t,n.input.eventHandlers[t]=r=>rg(n,r))})}function rg(n,e){return n.someProp("handleDOMEvents",t=>{let r=t[e.type];return r?r(n,e)||e.defaultPrevented:!1})}function jP(n,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target;t!=n.dom;t=t.parentNode)if(!t||t.nodeType==11||t.pmViewDesc&&t.pmViewDesc.stopEvent(e))return!1;return!0}function KP(n,e){!rg(n,e)&&Dt[e.type]&&(n.editable||!(e.type in Lt))&&Dt[e.type](n,e)}Lt.keydown=(n,e)=>{let t=e;if(n.input.shiftKey=t.keyCode==16||t.shiftKey,!N0(n,t)&&(n.input.lastKeyCode=t.keyCode,n.input.lastKeyCodeTime=Date.now(),!(Er&&bt&&t.keyCode==13)))if(t.keyCode!=229&&n.domObserver.forceFlush(),vs&&t.keyCode==13&&!t.ctrlKey&&!t.altKey&&!t.metaKey){let r=Date.now();n.input.lastIOSEnter=r,n.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{n.input.lastIOSEnter==r&&(n.someProp("handleKeyDown",i=>i(n,_i(13,"Enter"))),n.input.lastIOSEnter=0)},200)}else n.someProp("handleKeyDown",r=>r(n,t))||OP(n,t)?t.preventDefault():ii(n,"key")};Lt.keyup=(n,e)=>{e.keyCode==16&&(n.input.shiftKey=!1)};Lt.keypress=(n,e)=>{let t=e;if(N0(n,t)||!t.charCode||t.ctrlKey&&!t.altKey||wn&&t.metaKey)return;if(n.someProp("handleKeyPress",i=>i(n,t))){t.preventDefault();return}let r=n.state.selection;if(!(r instanceof J)||!r.$from.sameParent(r.$to)){let i=String.fromCharCode(t.charCode);!/[\r\n]/.test(i)&&!n.someProp("handleTextInput",o=>o(n,r.$from.pos,r.$to.pos,i))&&n.dispatch(n.state.tr.insertText(i).scrollIntoView()),t.preventDefault()}};function sd(n){return{left:n.clientX,top:n.clientY}}function $P(n,e){let t=e.x-n.clientX,r=e.y-n.clientY;return t*t+r*r<100}function ig(n,e,t,r,i){if(r==-1)return!1;let o=n.state.doc.resolve(r);for(let s=o.depth+1;s>0;s--)if(n.someProp(e,a=>s>o.depth?a(n,t,o.nodeAfter,o.before(s),i,!0):a(n,t,o.node(s),o.before(s),i,!1)))return!0;return!1}function ts(n,e,t){if(n.focused||n.focus(),n.state.selection.eq(e))return;let r=n.state.tr.setSelection(e);r.setMeta("pointer",!0),n.dispatch(r)}function VP(n,e){if(e==-1)return!1;let t=n.state.doc.resolve(e),r=t.nodeAfter;return r&&r.isAtom&&G.isSelectable(r)?(ts(n,new G(t)),!0):!1}function WP(n,e){if(e==-1)return!1;let t=n.state.selection,r,i;t instanceof G&&(r=t.node);let o=n.state.doc.resolve(e);for(let s=o.depth+1;s>0;s--){let a=s>o.depth?o.nodeAfter:o.node(s);if(G.isSelectable(a)){r&&t.$from.depth>0&&s>=t.$from.depth&&o.before(t.$from.depth+1)==t.$from.pos?i=o.before(t.$from.depth):i=o.before(s);break}}return i!=null?(ts(n,G.create(n.state.doc,i)),!0):!1}function GP(n,e,t,r,i){return ig(n,"handleClickOn",e,t,r)||n.someProp("handleClick",o=>o(n,e,r))||(i?WP(n,t):VP(n,t))}function qP(n,e,t,r){return ig(n,"handleDoubleClickOn",e,t,r)||n.someProp("handleDoubleClick",i=>i(n,e,r))}function QP(n,e,t,r){return ig(n,"handleTripleClickOn",e,t,r)||n.someProp("handleTripleClick",i=>i(n,e,r))||YP(n,t,r)}function YP(n,e,t){if(t.button!=0)return!1;let r=n.state.doc;if(e==-1)return r.inlineContent?(ts(n,J.create(r,0,r.content.size)),!0):!1;let i=r.resolve(e);for(let o=i.depth+1;o>0;o--){let s=o>i.depth?i.nodeAfter:i.node(o),a=i.before(o);if(s.inlineContent)ts(n,J.create(r,a+1,a+1+s.content.size));else if(G.isSelectable(s))ts(n,G.create(r,a));else continue;return!0}}function og(n){return hu(n)}const R0=wn?"metaKey":"ctrlKey";Dt.mousedown=(n,e)=>{let t=e;n.input.shiftKey=t.shiftKey;let r=og(n),i=Date.now(),o="singleClick";i-n.input.lastClick.time<500&&$P(t,n.input.lastClick)&&!t[R0]&&(n.input.lastClick.type=="singleClick"?o="doubleClick":n.input.lastClick.type=="doubleClick"&&(o="tripleClick")),n.input.lastClick={time:i,x:t.clientX,y:t.clientY,type:o};let s=n.posAtCoords(sd(t));s&&(o=="singleClick"?(n.input.mouseDown&&n.input.mouseDown.done(),n.input.mouseDown=new JP(n,s,t,!!r)):(o=="doubleClick"?qP:QP)(n,s.pos,s.inside,t)?t.preventDefault():ii(n,"pointer"))};class JP{constructor(e,t,r,i){this.view=e,this.pos=t,this.event=r,this.flushed=i,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=e.state.doc,this.selectNode=!!r[R0],this.allowDefault=r.shiftKey;let o,s;if(t.inside>-1)o=e.state.doc.nodeAt(t.inside),s=t.inside;else{let u=e.state.doc.resolve(t.pos);o=u.parent,s=u.depth?u.before():0}const a=i?null:r.target,l=a?e.docView.nearestDesc(a,!0):null;this.target=l&&l.dom.nodeType==1?l.dom:null;let{selection:c}=e.state;(r.button==0&&o.type.spec.draggable&&o.type.spec.selectable!==!1||c instanceof G&&c.from<=s&&c.to>s)&&(this.mightDrag={node:o,pos:s,addAttr:!!(this.target&&!this.target.draggable),setUneditable:!!(this.target&&Wn&&!this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),e.root.addEventListener("mouseup",this.up=this.up.bind(this)),e.root.addEventListener("mousemove",this.move=this.move.bind(this)),ii(e,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>Ar(this.view)),this.view.input.mouseDown=null}up(e){if(this.done(),!this.view.dom.contains(e.target))return;let t=this.pos;this.view.state.doc!=this.startDoc&&(t=this.view.posAtCoords(sd(e))),this.updateAllowDefault(e),this.allowDefault||!t?ii(this.view,"pointer"):GP(this.view,t.pos,t.inside,e,this.selectNode)?e.preventDefault():e.button==0&&(this.flushed||Pt&&this.mightDrag&&!this.mightDrag.node.isAtom||bt&&!this.view.state.selection.visible&&Math.min(Math.abs(t.pos-this.view.state.selection.from),Math.abs(t.pos-this.view.state.selection.to))<=2)?(ts(this.view,Z.near(this.view.state.doc.resolve(t.pos))),e.preventDefault()):ii(this.view,"pointer")}move(e){this.updateAllowDefault(e),ii(this.view,"pointer"),e.buttons==0&&this.done()}updateAllowDefault(e){!this.allowDefault&&(Math.abs(this.event.x-e.clientX)>4||Math.abs(this.event.y-e.clientY)>4)&&(this.allowDefault=!0)}}Dt.touchstart=n=>{n.input.lastTouch=Date.now(),og(n),ii(n,"pointer")};Dt.touchmove=n=>{n.input.lastTouch=Date.now(),ii(n,"pointer")};Dt.contextmenu=n=>og(n);function N0(n,e){return n.composing?!0:Pt&&Math.abs(e.timeStamp-n.input.compositionEndedAt)<500?(n.input.compositionEndedAt=-2e8,!0):!1}const XP=Er?5e3:-1;Lt.compositionstart=Lt.compositionupdate=n=>{if(!n.composing){n.domObserver.flush();let{state:e}=n,t=e.selection.$to;if(e.selection instanceof J&&(e.storedMarks||!t.textOffset&&t.parentOffset&&t.nodeBefore.marks.some(r=>r.type.spec.inclusive===!1)))n.markCursor=n.state.storedMarks||t.marks(),hu(n,!0),n.markCursor=null;else if(hu(n,!e.selection.empty),Wn&&e.selection.empty&&t.parentOffset&&!t.textOffset&&t.nodeBefore.marks.length){let r=n.domSelectionRange();for(let i=r.focusNode,o=r.focusOffset;i&&i.nodeType==1&&o!=0;){let s=o<0?i.lastChild:i.childNodes[o-1];if(!s)break;if(s.nodeType==3){let a=n.domSelection();a&&a.collapse(s,s.nodeValue.length);break}else i=s,o=-1}}n.input.composing=!0}x0(n,XP)};Lt.compositionend=(n,e)=>{n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=e.timeStamp,n.input.compositionPendingChanges=n.domObserver.pendingRecords().length?n.input.compositionID:0,n.input.compositionNode=null,n.input.compositionPendingChanges&&Promise.resolve().then(()=>n.domObserver.flush()),n.input.compositionID++,x0(n,20))};function x0(n,e){clearTimeout(n.input.composingTimeout),e>-1&&(n.input.composingTimeout=setTimeout(()=>hu(n),e))}function O0(n){for(n.composing&&(n.input.composing=!1,n.input.compositionEndedAt=eD());n.input.compositionNodes.length>0;)n.input.compositionNodes.pop().markParentsDirty()}function ZP(n){let e=n.domSelectionRange();if(!e.focusNode)return null;let t=V_(e.focusNode,e.focusOffset),r=W_(e.focusNode,e.focusOffset);if(t&&r&&t!=r){let i=r.pmViewDesc,o=n.domObserver.lastChangedTextNode;if(t==o||r==o)return o;if(!i||!i.isText(r.nodeValue))return r;if(n.input.compositionNode==r){let s=t.pmViewDesc;if(!(!s||!s.isText(t.nodeValue)))return r}}return t||r}function eD(){let n=document.createEvent("Event");return n.initEvent("event",!0,!0),n.timeStamp}function hu(n,e=!1){if(!(Er&&n.domObserver.flushingSoon>=0)){if(n.domObserver.forceFlush(),O0(n),e||n.docView&&n.docView.dirty){let t=eg(n);return t&&!t.eq(n.state.selection)?n.dispatch(n.state.tr.setSelection(t)):(n.markCursor||e)&&!n.state.selection.empty?n.dispatch(n.state.tr.deleteSelection()):n.updateState(n.state),!0}return!1}}function tD(n,e){if(!n.dom.parentNode)return;let t=n.dom.parentNode.appendChild(document.createElement("div"));t.appendChild(e),t.style.cssText="position: fixed; left: -10000px; top: 10px";let r=getSelection(),i=document.createRange();i.selectNodeContents(e),n.dom.blur(),r.removeAllRanges(),r.addRange(i),setTimeout(()=>{t.parentNode&&t.parentNode.removeChild(t),n.focus()},50)}const qa=Jt&&yi<15||vs&&J_<604;Dt.copy=Lt.cut=(n,e)=>{let t=e,r=n.state.selection,i=t.type=="cut";if(r.empty)return;let o=qa?null:t.clipboardData,s=r.content(),{dom:a,text:l}=ng(n,s);o?(t.preventDefault(),o.clearData(),o.setData("text/html",a.innerHTML),o.setData("text/plain",l)):tD(n,a),i&&n.dispatch(n.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))};function nD(n){return n.openStart==0&&n.openEnd==0&&n.content.childCount==1?n.content.firstChild:null}function rD(n,e){if(!n.dom.parentNode)return;let t=n.input.shiftKey||n.state.selection.$from.parent.type.spec.code,r=n.dom.parentNode.appendChild(document.createElement(t?"textarea":"div"));t||(r.contentEditable="true"),r.style.cssText="position: fixed; left: -10000px; top: 10px",r.focus();let i=n.input.shiftKey&&n.input.lastKeyCode!=45;setTimeout(()=>{n.focus(),r.parentNode&&r.parentNode.removeChild(r),t?Qa(n,r.value,null,i,e):Qa(n,r.textContent,r.innerHTML,i,e)},50)}function Qa(n,e,t,r,i){let o=T0(n,e,t,r,n.state.selection.$from);if(n.someProp("handlePaste",l=>l(n,i,o||U.empty)))return!0;if(!o)return!1;let s=nD(o),a=s?n.state.tr.replaceSelectionWith(s,r):n.state.tr.replaceSelection(o);return n.dispatch(a.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}function M0(n){let e=n.getData("text/plain")||n.getData("Text");if(e)return e;let t=n.getData("text/uri-list");return t?t.replace(/\r?\n/g," "):""}Lt.paste=(n,e)=>{let t=e;if(n.composing&&!Er)return;let r=qa?null:t.clipboardData,i=n.input.shiftKey&&n.input.lastKeyCode!=45;r&&Qa(n,M0(r),r.getData("text/html"),i,t)?t.preventDefault():rD(n,t)};class _0{constructor(e,t,r){this.slice=e,this.move=t,this.node=r}}const iD=wn?"altKey":"ctrlKey";function P0(n,e){let t=n.someProp("dragCopies",r=>!r(e));return t??!e[iD]}Dt.dragstart=(n,e)=>{let t=e,r=n.input.mouseDown;if(r&&r.done(),!t.dataTransfer)return;let i=n.state.selection,o=i.empty?null:n.posAtCoords(sd(t)),s;if(!(o&&o.pos>=i.from&&o.pos<=(i instanceof G?i.to-1:i.to))){if(r&&r.mightDrag)s=G.create(n.state.doc,r.mightDrag.pos);else if(t.target&&t.target.nodeType==1){let d=n.docView.nearestDesc(t.target,!0);d&&d.node.type.spec.draggable&&d!=n.docView&&(s=G.create(n.state.doc,d.posBefore))}}let a=(s||n.state.selection).content(),{dom:l,text:c,slice:u}=ng(n,a);(!t.dataTransfer.files.length||!bt||s0>120)&&t.dataTransfer.clearData(),t.dataTransfer.setData(qa?"Text":"text/html",l.innerHTML),t.dataTransfer.effectAllowed="copyMove",qa||t.dataTransfer.setData("text/plain",c),n.dragging=new _0(u,P0(n,t),s)};Dt.dragend=n=>{let e=n.dragging;window.setTimeout(()=>{n.dragging==e&&(n.dragging=null)},50)};Lt.dragover=Lt.dragenter=(n,e)=>e.preventDefault();Lt.drop=(n,e)=>{let t=e,r=n.dragging;if(n.dragging=null,!t.dataTransfer)return;let i=n.posAtCoords(sd(t));if(!i)return;let o=n.state.doc.resolve(i.pos),s=r&&r.slice;s?n.someProp("transformPasted",p=>{s=p(s,n)}):s=T0(n,M0(t.dataTransfer),qa?null:t.dataTransfer.getData("text/html"),!1,o);let a=!!(r&&P0(n,t));if(n.someProp("handleDrop",p=>p(n,t,s||U.empty,a))){t.preventDefault();return}if(!s)return;t.preventDefault();let l=s?Xk(n.state.doc,o.pos,s):o.pos;l==null&&(l=o.pos);let c=n.state.tr;if(a){let{node:p}=r;p?p.replace(c):c.deleteSelection()}let u=c.mapping.map(l),d=s.openStart==0&&s.openEnd==0&&s.content.childCount==1,h=c.doc;if(d?c.replaceRangeWith(u,u,s.content.firstChild):c.replaceRange(u,u,s),c.doc.eq(h))return;let f=c.doc.resolve(u);if(d&&G.isSelectable(s.content.firstChild)&&f.nodeAfter&&f.nodeAfter.sameMarkup(s.content.firstChild))c.setSelection(new G(f));else{let p=c.mapping.map(l);c.mapping.maps[c.mapping.maps.length-1].forEach((m,v,g,y)=>p=y),c.setSelection(tg(n,f,c.doc.resolve(p)))}n.focus(),n.dispatch(c.setMeta("uiEvent","drop"))};Dt.focus=n=>{n.input.lastFocus=Date.now(),n.focused||(n.domObserver.stop(),n.dom.classList.add("ProseMirror-focused"),n.domObserver.start(),n.focused=!0,setTimeout(()=>{n.docView&&n.hasFocus()&&!n.domObserver.currentSelection.eq(n.domSelectionRange())&&Ar(n)},20))};Dt.blur=(n,e)=>{let t=e;n.focused&&(n.domObserver.stop(),n.dom.classList.remove("ProseMirror-focused"),n.domObserver.start(),t.relatedTarget&&n.dom.contains(t.relatedTarget)&&n.domObserver.currentSelection.clear(),n.focused=!1)};Dt.beforeinput=(n,e)=>{if(bt&&Er&&e.inputType=="deleteContentBackward"){n.domObserver.flushSoon();let{domChangeCount:r}=n.input;setTimeout(()=>{if(n.input.domChangeCount!=r||(n.dom.blur(),n.focus(),n.someProp("handleKeyDown",o=>o(n,_i(8,"Backspace")))))return;let{$cursor:i}=n.state.selection;i&&i.pos>0&&n.dispatch(n.state.tr.delete(i.pos-1,i.pos).scrollIntoView())},50)}};for(let n in Lt)Dt[n]=Lt[n];function Ya(n,e){if(n==e)return!0;for(let t in n)if(n[t]!==e[t])return!1;for(let t in e)if(!(t in n))return!1;return!0}class fu{constructor(e,t){this.toDOM=e,this.spec=t||Wi,this.side=this.spec.side||0}map(e,t,r,i){let{pos:o,deleted:s}=e.mapResult(t.from+i,this.side<0?-1:1);return s?null:new pn(o-r,o-r,this)}valid(){return!0}eq(e){return this==e||e instanceof fu&&(this.spec.key&&this.spec.key==e.spec.key||this.toDOM==e.toDOM&&Ya(this.spec,e.spec))}destroy(e){this.spec.destroy&&this.spec.destroy(e)}}class Ci{constructor(e,t){this.attrs=e,this.spec=t||Wi}map(e,t,r,i){let o=e.map(t.from+i,this.spec.inclusiveStart?-1:1)-r,s=e.map(t.to+i,this.spec.inclusiveEnd?1:-1)-r;return o>=s?null:new pn(o,s,this)}valid(e,t){return t.from<t.to}eq(e){return this==e||e instanceof Ci&&Ya(this.attrs,e.attrs)&&Ya(this.spec,e.spec)}static is(e){return e.type instanceof Ci}destroy(){}}class sg{constructor(e,t){this.attrs=e,this.spec=t||Wi}map(e,t,r,i){let o=e.mapResult(t.from+i,1);if(o.deleted)return null;let s=e.mapResult(t.to+i,-1);return s.deleted||s.pos<=o.pos?null:new pn(o.pos-r,s.pos-r,this)}valid(e,t){let{index:r,offset:i}=e.content.findIndex(t.from),o;return i==t.from&&!(o=e.child(r)).isText&&i+o.nodeSize==t.to}eq(e){return this==e||e instanceof sg&&Ya(this.attrs,e.attrs)&&Ya(this.spec,e.spec)}destroy(){}}class pn{constructor(e,t,r){this.from=e,this.to=t,this.type=r}copy(e,t){return new pn(e,t,this.type)}eq(e,t=0){return this.type.eq(e.type)&&this.from+t==e.from&&this.to+t==e.to}map(e,t,r){return this.type.map(e,this,t,r)}static widget(e,t,r){return new pn(e,e,new fu(t,r))}static inline(e,t,r,i){return new pn(e,t,new Ci(r,i))}static node(e,t,r,i){return new pn(e,t,new sg(r,i))}get spec(){return this.type.spec}get inline(){return this.type instanceof Ci}get widget(){return this.type instanceof fu}}const Ao=[],Wi={};class Ve{constructor(e,t){this.local=e.length?e:Ao,this.children=t.length?t:Ao}static create(e,t){return t.length?pu(t,e,0,Wi):Et}find(e,t,r){let i=[];return this.findInner(e??0,t??1e9,i,0,r),i}findInner(e,t,r,i,o){for(let s=0;s<this.local.length;s++){let a=this.local[s];a.from<=t&&a.to>=e&&(!o||o(a.spec))&&r.push(a.copy(a.from+i,a.to+i))}for(let s=0;s<this.children.length;s+=3)if(this.children[s]<t&&this.children[s+1]>e){let a=this.children[s]+1;this.children[s+2].findInner(e-a,t-a,r,i+a,o)}}map(e,t,r){return this==Et||e.maps.length==0?this:this.mapInner(e,t,0,0,r||Wi)}mapInner(e,t,r,i,o){let s;for(let a=0;a<this.local.length;a++){let l=this.local[a].map(e,r,i);l&&l.type.valid(t,l)?(s||(s=[])).push(l):o.onRemove&&o.onRemove(this.local[a].spec)}return this.children.length?oD(this.children,s||[],e,t,r,i,o):s?new Ve(s.sort(Gi),Ao):Et}add(e,t){return t.length?this==Et?Ve.create(e,t):this.addInner(e,t,0):this}addInner(e,t,r){let i,o=0;e.forEach((a,l)=>{let c=l+r,u;if(u=L0(t,a,c)){for(i||(i=this.children.slice());o<i.length&&i[o]<l;)o+=3;i[o]==l?i[o+2]=i[o+2].addInner(a,u,c+1):i.splice(o,0,l,l+a.nodeSize,pu(u,a,c+1,Wi)),o+=3}});let s=D0(o?U0(t):t,-r);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||s.splice(a--,1);return new Ve(s.length?this.local.concat(s).sort(Gi):this.local,i||this.children)}remove(e){return e.length==0||this==Et?this:this.removeInner(e,0)}removeInner(e,t){let r=this.children,i=this.local;for(let o=0;o<r.length;o+=3){let s,a=r[o]+t,l=r[o+1]+t;for(let u=0,d;u<e.length;u++)(d=e[u])&&d.from>a&&d.to<l&&(e[u]=null,(s||(s=[])).push(d));if(!s)continue;r==this.children&&(r=this.children.slice());let c=r[o+2].removeInner(s,a+1);c!=Et?r[o+2]=c:(r.splice(o,3),o-=3)}if(i.length){for(let o=0,s;o<e.length;o++)if(s=e[o])for(let a=0;a<i.length;a++)i[a].eq(s,t)&&(i==this.local&&(i=this.local.slice()),i.splice(a--,1))}return r==this.children&&i==this.local?this:i.length||r.length?new Ve(i,r):Et}forChild(e,t){if(this==Et)return this;if(t.isLeaf)return Ve.empty;let r,i;for(let a=0;a<this.children.length;a+=3)if(this.children[a]>=e){this.children[a]==e&&(r=this.children[a+2]);break}let o=e+1,s=o+t.content.size;for(let a=0;a<this.local.length;a++){let l=this.local[a];if(l.from<s&&l.to>o&&l.type instanceof Ci){let c=Math.max(o,l.from)-o,u=Math.min(s,l.to)-o;c<u&&(i||(i=[])).push(l.copy(c,u))}}if(i){let a=new Ve(i.sort(Gi),Ao);return r?new Jr([a,r]):a}return r||Et}eq(e){if(this==e)return!0;if(!(e instanceof Ve)||this.local.length!=e.local.length||this.children.length!=e.children.length)return!1;for(let t=0;t<this.local.length;t++)if(!this.local[t].eq(e.local[t]))return!1;for(let t=0;t<this.children.length;t+=3)if(this.children[t]!=e.children[t]||this.children[t+1]!=e.children[t+1]||!this.children[t+2].eq(e.children[t+2]))return!1;return!0}locals(e){return ag(this.localsInner(e))}localsInner(e){if(this==Et)return Ao;if(e.inlineContent||!this.local.some(Ci.is))return this.local;let t=[];for(let r=0;r<this.local.length;r++)this.local[r].type instanceof Ci||t.push(this.local[r]);return t}forEachSet(e){e(this)}}Ve.empty=new Ve([],[]);Ve.removeOverlap=ag;const Et=Ve.empty;class Jr{constructor(e){this.members=e}map(e,t){const r=this.members.map(i=>i.map(e,t,Wi));return Jr.from(r)}forChild(e,t){if(t.isLeaf)return Ve.empty;let r=[];for(let i=0;i<this.members.length;i++){let o=this.members[i].forChild(e,t);o!=Et&&(o instanceof Jr?r=r.concat(o.members):r.push(o))}return Jr.from(r)}eq(e){if(!(e instanceof Jr)||e.members.length!=this.members.length)return!1;for(let t=0;t<this.members.length;t++)if(!this.members[t].eq(e.members[t]))return!1;return!0}locals(e){let t,r=!0;for(let i=0;i<this.members.length;i++){let o=this.members[i].localsInner(e);if(o.length)if(!t)t=o;else{r&&(t=t.slice(),r=!1);for(let s=0;s<o.length;s++)t.push(o[s])}}return t?ag(r?t:t.sort(Gi)):Ao}static from(e){switch(e.length){case 0:return Et;case 1:return e[0];default:return new Jr(e.every(t=>t instanceof Ve)?e:e.reduce((t,r)=>t.concat(r instanceof Ve?r:r.members),[]))}}forEachSet(e){for(let t=0;t<this.members.length;t++)this.members[t].forEachSet(e)}}function oD(n,e,t,r,i,o,s){let a=n.slice();for(let c=0,u=o;c<t.maps.length;c++){let d=0;t.maps[c].forEach((h,f,p,m)=>{let v=m-p-(f-h);for(let g=0;g<a.length;g+=3){let y=a[g+1];if(y<0||h>y+u-d)continue;let C=a[g]+u-d;f>=C?a[g+1]=h<=C?-2:-1:h>=u&&v&&(a[g]+=v,a[g+1]+=v)}d+=v}),u=t.maps[c].map(u,-1)}let l=!1;for(let c=0;c<a.length;c+=3)if(a[c+1]<0){if(a[c+1]==-2){l=!0,a[c+1]=-1;continue}let u=t.map(n[c]+o),d=u-i;if(d<0||d>=r.content.size){l=!0;continue}let h=t.map(n[c+1]+o,-1),f=h-i,{index:p,offset:m}=r.content.findIndex(d),v=r.maybeChild(p);if(v&&m==d&&m+v.nodeSize==f){let g=a[c+2].mapInner(t,v,u+1,n[c]+o+1,s);g!=Et?(a[c]=d,a[c+1]=f,a[c+2]=g):(a[c+1]=-2,l=!0)}else l=!0}if(l){let c=sD(a,n,e,t,i,o,s),u=pu(c,r,0,s);e=u.local;for(let d=0;d<a.length;d+=3)a[d+1]<0&&(a.splice(d,3),d-=3);for(let d=0,h=0;d<u.children.length;d+=3){let f=u.children[d];for(;h<a.length&&a[h]<f;)h+=3;a.splice(h,0,u.children[d],u.children[d+1],u.children[d+2])}}return new Ve(e.sort(Gi),a)}function D0(n,e){if(!e||!n.length)return n;let t=[];for(let r=0;r<n.length;r++){let i=n[r];t.push(new pn(i.from+e,i.to+e,i.type))}return t}function sD(n,e,t,r,i,o,s){function a(l,c){for(let u=0;u<l.local.length;u++){let d=l.local[u].map(r,i,c);d?t.push(d):s.onRemove&&s.onRemove(l.local[u].spec)}for(let u=0;u<l.children.length;u+=3)a(l.children[u+2],l.children[u]+c+1)}for(let l=0;l<n.length;l+=3)n[l+1]==-1&&a(n[l+2],e[l]+o+1);return t}function L0(n,e,t){if(e.isLeaf)return null;let r=t+e.nodeSize,i=null;for(let o=0,s;o<n.length;o++)(s=n[o])&&s.from>t&&s.to<r&&((i||(i=[])).push(s),n[o]=null);return i}function U0(n){let e=[];for(let t=0;t<n.length;t++)n[t]!=null&&e.push(n[t]);return e}function pu(n,e,t,r){let i=[],o=!1;e.forEach((a,l)=>{let c=L0(n,a,l+t);if(c){o=!0;let u=pu(c,a,t+l+1,r);u!=Et&&i.push(l,l+a.nodeSize,u)}});let s=D0(o?U0(n):n,-t).sort(Gi);for(let a=0;a<s.length;a++)s[a].type.valid(e,s[a])||(r.onRemove&&r.onRemove(s[a].spec),s.splice(a--,1));return s.length||i.length?new Ve(s,i):Et}function Gi(n,e){return n.from-e.from||n.to-e.to}function ag(n){let e=n;for(let t=0;t<e.length-1;t++){let r=e[t];if(r.from!=r.to)for(let i=t+1;i<e.length;i++){let o=e[i];if(o.from==r.from){o.to!=r.to&&(e==n&&(e=n.slice()),e[i]=o.copy(o.from,r.to),pC(e,i+1,o.copy(r.to,o.to)));continue}else{o.from<r.to&&(e==n&&(e=n.slice()),e[t]=r.copy(r.from,o.from),pC(e,i,r.copy(o.from,r.to)));break}}}return e}function pC(n,e,t){for(;e<n.length&&Gi(t,n[e])>0;)e++;n.splice(e,0,t)}function ch(n){let e=[];return n.someProp("decorations",t=>{let r=t(n.state);r&&r!=Et&&e.push(r)}),n.cursorWrapper&&e.push(Ve.create(n.state.doc,[n.cursorWrapper.deco])),Jr.from(e)}const aD={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},lD=Jt&&yi<=11;class cD{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(e){this.anchorNode=e.anchorNode,this.anchorOffset=e.anchorOffset,this.focusNode=e.focusNode,this.focusOffset=e.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(e){return e.anchorNode==this.anchorNode&&e.anchorOffset==this.anchorOffset&&e.focusNode==this.focusNode&&e.focusOffset==this.focusOffset}}class uD{constructor(e,t){this.view=e,this.handleDOMChange=t,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new cD,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.lastChangedTextNode=null,this.observer=window.MutationObserver&&new window.MutationObserver(r=>{for(let i=0;i<r.length;i++)this.queue.push(r[i]);Jt&&yi<=11&&r.some(i=>i.type=="childList"&&i.removedNodes.length||i.type=="characterData"&&i.oldValue.length>i.target.nodeValue.length)?this.flushSoon():this.flush()}),lD&&(this.onCharData=r=>{this.queue.push({target:r.target,type:"characterData",oldValue:r.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,aD)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let e=this.observer.takeRecords();if(e.length){for(let t=0;t<e.length;t++)this.queue.push(e[t]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(sC(this.view)){if(this.suppressingSelectionUpdates)return Ar(this.view);if(Jt&&yi<=11&&!this.view.state.selection.empty){let e=this.view.domSelectionRange();if(e.focusNode&&ao(e.focusNode,e.focusOffset,e.anchorNode,e.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelectionRange())}ignoreSelectionChange(e){if(!e.focusNode)return!0;let t=new Set,r;for(let o=e.focusNode;o;o=ys(o))t.add(o);for(let o=e.anchorNode;o;o=ys(o))if(t.has(o)){r=o;break}let i=r&&this.view.docView.nearestDesc(r);if(i&&i.ignoreMutation({type:"selection",target:r.nodeType==3?r.parentNode:r}))return this.setCurSelection(),!0}pendingRecords(){if(this.observer)for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}flush(){let{view:e}=this;if(!e.docView||this.flushingSoon>-1)return;let t=this.pendingRecords();t.length&&(this.queue=[]);let r=e.domSelectionRange(),i=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(r)&&sC(e)&&!this.ignoreSelectionChange(r),o=-1,s=-1,a=!1,l=[];if(e.editable)for(let u=0;u<t.length;u++){let d=this.registerMutation(t[u],l);d&&(o=o<0?d.from:Math.min(d.from,o),s=s<0?d.to:Math.max(d.to,s),d.typeOver&&(a=!0))}if(Wn&&l.length){let u=l.filter(d=>d.nodeName=="BR");if(u.length==2){let[d,h]=u;d.parentNode&&d.parentNode.parentNode==h.parentNode?h.remove():d.remove()}else{let{focusNode:d}=this.currentSelection;for(let h of u){let f=h.parentNode;f&&f.nodeName=="LI"&&(!d||fD(e,d)!=f)&&h.remove()}}}let c=null;o<0&&i&&e.input.lastFocus>Date.now()-200&&Math.max(e.input.lastTouch,e.input.lastClick.time)<Date.now()-300&&id(r)&&(c=eg(e))&&c.eq(Z.near(e.state.doc.resolve(0),1))?(e.input.lastFocus=0,Ar(e),this.currentSelection.set(r),e.scrollToSelection()):(o>-1||i)&&(o>-1&&(e.docView.markDirty(o,s),dD(e)),this.handleDOMChange(o,s,a,l),e.docView&&e.docView.dirty?e.updateState(e.state):this.currentSelection.eq(r)||Ar(e),this.currentSelection.set(r))}registerMutation(e,t){if(t.indexOf(e.target)>-1)return null;let r=this.view.docView.nearestDesc(e.target);if(e.type=="attributes"&&(r==this.view.docView||e.attributeName=="contenteditable"||e.attributeName=="style"&&!e.oldValue&&!e.target.getAttribute("style"))||!r||r.ignoreMutation(e))return null;if(e.type=="childList"){for(let u=0;u<e.addedNodes.length;u++){let d=e.addedNodes[u];t.push(d),d.nodeType==3&&(this.lastChangedTextNode=d)}if(r.contentDOM&&r.contentDOM!=r.dom&&!r.contentDOM.contains(e.target))return{from:r.posBefore,to:r.posAfter};let i=e.previousSibling,o=e.nextSibling;if(Jt&&yi<=11&&e.addedNodes.length)for(let u=0;u<e.addedNodes.length;u++){let{previousSibling:d,nextSibling:h}=e.addedNodes[u];(!d||Array.prototype.indexOf.call(e.addedNodes,d)<0)&&(i=d),(!h||Array.prototype.indexOf.call(e.addedNodes,h)<0)&&(o=h)}let s=i&&i.parentNode==e.target?pt(i)+1:0,a=r.localPosFromDOM(e.target,s,-1),l=o&&o.parentNode==e.target?pt(o):e.target.childNodes.length,c=r.localPosFromDOM(e.target,l,1);return{from:a,to:c}}else return e.type=="attributes"?{from:r.posAtStart-r.border,to:r.posAtEnd+r.border}:(this.lastChangedTextNode=e.target,{from:r.posAtStart,to:r.posAtEnd,typeOver:e.target.nodeValue==e.oldValue})}}let mC=new WeakMap,gC=!1;function dD(n){if(!mC.has(n)&&(mC.set(n,null),["normal","nowrap","pre-line"].indexOf(getComputedStyle(n.dom).whiteSpace)!==-1)){if(n.requiresGeckoHackNode=Wn,gC)return;console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."),gC=!0}}function yC(n,e){let t=e.startContainer,r=e.startOffset,i=e.endContainer,o=e.endOffset,s=n.domAtPos(n.state.selection.anchor);return ao(s.node,s.offset,i,o)&&([t,r,i,o]=[i,o,t,r]),{anchorNode:t,anchorOffset:r,focusNode:i,focusOffset:o}}function hD(n,e){if(e.getComposedRanges){let i=e.getComposedRanges(n.root)[0];if(i)return yC(n,i)}let t;function r(i){i.preventDefault(),i.stopImmediatePropagation(),t=i.getTargetRanges()[0]}return n.dom.addEventListener("beforeinput",r,!0),document.execCommand("indent"),n.dom.removeEventListener("beforeinput",r,!0),t?yC(n,t):null}function fD(n,e){for(let t=e.parentNode;t&&t!=n.dom;t=t.parentNode){let r=n.docView.nearestDesc(t,!0);if(r&&r.node.isBlock)return t}return null}function pD(n,e,t){let{node:r,fromOffset:i,toOffset:o,from:s,to:a}=n.docView.parseRange(e,t),l=n.domSelectionRange(),c,u=l.anchorNode;if(u&&n.dom.contains(u.nodeType==1?u:u.parentNode)&&(c=[{node:u,offset:l.anchorOffset}],id(l)||c.push({node:l.focusNode,offset:l.focusOffset})),bt&&n.input.lastKeyCode===8)for(let v=o;v>i;v--){let g=r.childNodes[v-1],y=g.pmViewDesc;if(g.nodeName=="BR"&&!y){o=v;break}if(!y||y.size)break}let d=n.state.doc,h=n.someProp("domParser")||ya.fromSchema(n.state.schema),f=d.resolve(s),p=null,m=h.parse(r,{topNode:f.parent,topMatch:f.parent.contentMatchAt(f.index()),topOpen:!0,from:i,to:o,preserveWhitespace:f.parent.type.whitespace=="pre"?"full":!0,findPositions:c,ruleFromNode:mD,context:f});if(c&&c[0].pos!=null){let v=c[0].pos,g=c[1]&&c[1].pos;g==null&&(g=v),p={anchor:v+s,head:g+s}}return{doc:m,sel:p,from:s,to:a}}function mD(n){let e=n.pmViewDesc;if(e)return e.parseRule();if(n.nodeName=="BR"&&n.parentNode){if(Pt&&/^(ul|ol)$/i.test(n.parentNode.nodeName)){let t=document.createElement("div");return t.appendChild(document.createElement("li")),{skip:t}}else if(n.parentNode.lastChild==n||Pt&&/^(tr|table)$/i.test(n.parentNode.nodeName))return{ignore:!0}}else if(n.nodeName=="IMG"&&n.getAttribute("mark-placeholder"))return{ignore:!0};return null}const gD=/^(a|abbr|acronym|b|bd[io]|big|br|button|cite|code|data(list)?|del|dfn|em|i|ins|kbd|label|map|mark|meter|output|q|ruby|s|samp|small|span|strong|su[bp]|time|u|tt|var)$/i;function yD(n,e,t,r,i){let o=n.input.compositionPendingChanges||(n.composing?n.input.compositionID:0);if(n.input.compositionPendingChanges=0,e<0){let N=n.input.lastSelectionTime>Date.now()-50?n.input.lastSelectionOrigin:null,_=eg(n,N);if(_&&!n.state.selection.eq(_)){if(bt&&Er&&n.input.lastKeyCode===13&&Date.now()-100<n.input.lastKeyCodeTime&&n.someProp("handleKeyDown",ue=>ue(n,_i(13,"Enter"))))return;let V=n.state.tr.setSelection(_);N=="pointer"?V.setMeta("pointer",!0):N=="key"&&V.scrollIntoView(),o&&V.setMeta("composition",o),n.dispatch(V)}return}let s=n.state.doc.resolve(e),a=s.sharedDepth(t);e=s.before(a+1),t=n.state.doc.resolve(t).after(a+1);let l=n.state.selection,c=pD(n,e,t),u=n.state.doc,d=u.slice(c.from,c.to),h,f;n.input.lastKeyCode===8&&Date.now()-100<n.input.lastKeyCodeTime?(h=n.state.selection.to,f="end"):(h=n.state.selection.from,f="start"),n.input.lastKeyCode=null;let p=SD(d.content,c.doc.content,c.from,h,f);if(p&&n.input.domChangeCount++,(vs&&n.input.lastIOSEnter>Date.now()-225||Er)&&i.some(N=>N.nodeType==1&&!gD.test(N.nodeName))&&(!p||p.endA>=p.endB)&&n.someProp("handleKeyDown",N=>N(n,_i(13,"Enter")))){n.input.lastIOSEnter=0;return}if(!p)if(r&&l instanceof J&&!l.empty&&l.$head.sameParent(l.$anchor)&&!n.composing&&!(c.sel&&c.sel.anchor!=c.sel.head))p={start:l.from,endA:l.to,endB:l.to};else{if(c.sel){let N=vC(n,n.state.doc,c.sel);if(N&&!N.eq(n.state.selection)){let _=n.state.tr.setSelection(N);o&&_.setMeta("composition",o),n.dispatch(_)}}return}n.state.selection.from<n.state.selection.to&&p.start==p.endB&&n.state.selection instanceof J&&(p.start>n.state.selection.from&&p.start<=n.state.selection.from+2&&n.state.selection.from>=c.from?p.start=n.state.selection.from:p.endA<n.state.selection.to&&p.endA>=n.state.selection.to-2&&n.state.selection.to<=c.to&&(p.endB+=n.state.selection.to-p.endA,p.endA=n.state.selection.to)),Jt&&yi<=11&&p.endB==p.start+1&&p.endA==p.start&&p.start>c.from&&c.doc.textBetween(p.start-c.from-1,p.start-c.from+1)=="  "&&(p.start--,p.endA--,p.endB--);let m=c.doc.resolveNoCache(p.start-c.from),v=c.doc.resolveNoCache(p.endB-c.from),g=u.resolve(p.start),y=m.sameParent(v)&&m.parent.inlineContent&&g.end()>=p.endA,C;if((vs&&n.input.lastIOSEnter>Date.now()-225&&(!y||i.some(N=>N.nodeName=="DIV"||N.nodeName=="P"))||!y&&m.pos<c.doc.content.size&&(!m.sameParent(v)||!m.parent.inlineContent)&&(C=Z.findFrom(c.doc.resolve(m.pos+1),1,!0))&&C.head>m.pos)&&n.someProp("handleKeyDown",N=>N(n,_i(13,"Enter")))){n.input.lastIOSEnter=0;return}if(n.state.selection.anchor>p.start&&CD(u,p.start,p.endA,m,v)&&n.someProp("handleKeyDown",N=>N(n,_i(8,"Backspace")))){Er&&bt&&n.domObserver.suppressSelectionUpdates();return}bt&&p.endB==p.start&&(n.input.lastChromeDelete=Date.now()),Er&&!y&&m.start()!=v.start()&&v.parentOffset==0&&m.depth==v.depth&&c.sel&&c.sel.anchor==c.sel.head&&c.sel.head==p.endA&&(p.endB-=2,v=c.doc.resolveNoCache(p.endB-c.from),setTimeout(()=>{n.someProp("handleKeyDown",function(N){return N(n,_i(13,"Enter"))})},20));let w=p.start,E=p.endA,I,b,R;if(y){if(m.pos==v.pos)Jt&&yi<=11&&m.parentOffset==0&&(n.domObserver.suppressSelectionUpdates(),setTimeout(()=>Ar(n),20)),I=n.state.tr.delete(w,E),b=u.resolve(p.start).marksAcross(u.resolve(p.endA));else if(p.endA==p.endB&&(R=vD(m.parent.content.cut(m.parentOffset,v.parentOffset),g.parent.content.cut(g.parentOffset,p.endA-g.start()))))I=n.state.tr,R.type=="add"?I.addMark(w,E,R.mark):I.removeMark(w,E,R.mark);else if(m.parent.child(m.index()).isText&&m.index()==v.index()-(v.textOffset?0:1)){let N=m.parent.textBetween(m.parentOffset,v.parentOffset);if(n.someProp("handleTextInput",_=>_(n,w,E,N)))return;I=n.state.tr.insertText(N,w,E)}}if(I||(I=n.state.tr.replace(w,E,c.doc.slice(p.start-c.from,p.endB-c.from))),c.sel){let N=vC(n,I.doc,c.sel);N&&!(bt&&n.composing&&N.empty&&(p.start!=p.endB||n.input.lastChromeDelete<Date.now()-100)&&(N.head==w||N.head==I.mapping.map(E)-1)||Jt&&N.empty&&N.head==w)&&I.setSelection(N)}b&&I.ensureMarks(b),o&&I.setMeta("composition",o),n.dispatch(I.scrollIntoView())}function vC(n,e,t){return Math.max(t.anchor,t.head)>e.content.size?null:tg(n,e.resolve(t.anchor),e.resolve(t.head))}function vD(n,e){let t=n.firstChild.marks,r=e.firstChild.marks,i=t,o=r,s,a,l;for(let u=0;u<r.length;u++)i=r[u].removeFromSet(i);for(let u=0;u<t.length;u++)o=t[u].removeFromSet(o);if(i.length==1&&o.length==0)a=i[0],s="add",l=u=>u.mark(a.addToSet(u.marks));else if(i.length==0&&o.length==1)a=o[0],s="remove",l=u=>u.mark(a.removeFromSet(u.marks));else return null;let c=[];for(let u=0;u<e.childCount;u++)c.push(l(e.child(u)));if(x.from(c).eq(n))return{mark:a,type:s}}function CD(n,e,t,r,i){if(t-e<=i.pos-r.pos||uh(r,!0,!1)<i.pos)return!1;let o=n.resolve(e);if(!r.parent.isTextblock){let a=o.nodeAfter;return a!=null&&t==e+a.nodeSize}if(o.parentOffset<o.parent.content.size||!o.parent.isTextblock)return!1;let s=n.resolve(uh(o,!0,!0));return!s.parent.isTextblock||s.pos>t||uh(s,!0,!1)<t?!1:r.parent.content.cut(r.parentOffset).eq(s.parent.content)}function uh(n,e,t){let r=n.depth,i=e?n.end():n.pos;for(;r>0&&(e||n.indexAfter(r)==n.node(r).childCount);)r--,i++,e=!1;if(t){let o=n.node(r).maybeChild(n.indexAfter(r));for(;o&&!o.isLeaf;)o=o.firstChild,i++}return i}function SD(n,e,t,r,i){let o=n.findDiffStart(e,t);if(o==null)return null;let{a:s,b:a}=n.findDiffEnd(e,t+n.size,t+e.size);if(i=="end"){let l=Math.max(0,o-Math.min(s,a));r-=s+l-o}if(s<o&&n.size<e.size){let l=r<=o&&r>=s?o-r:0;o-=l,o&&o<e.size&&CC(e.textBetween(o-1,o+1))&&(o+=l?1:-1),a=o+(a-s),s=o}else if(a<o){let l=r<=o&&r>=a?o-r:0;o-=l,o&&o<n.size&&CC(n.textBetween(o-1,o+1))&&(o+=l?1:-1),s=o+(s-a),a=o}return{start:o,endA:s,endB:a}}function CC(n){if(n.length!=2)return!1;let e=n.charCodeAt(0),t=n.charCodeAt(1);return e>=56320&&e<=57343&&t>=55296&&t<=56319}class wD{constructor(e,t){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new FP,this.prevDirectPlugins=[],this.pluginViews=[],this.requiresGeckoHackNode=!1,this.dragging=null,this._props=t,this.state=t.state,this.directPlugins=t.plugins||[],this.directPlugins.forEach(kC),this.dispatch=this.dispatch.bind(this),this.dom=e&&e.mount||document.createElement("div"),e&&(e.appendChild?e.appendChild(this.dom):typeof e=="function"?e(this.dom):e.mount&&(this.mounted=!0)),this.editable=TC(this),wC(this),this.nodeViews=EC(this),this.docView=eC(this.state.doc,SC(this),ch(this),this.dom,this),this.domObserver=new uD(this,(r,i,o,s)=>yD(this,r,i,o,s)),this.domObserver.start(),BP(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let e=this._props;this._props={};for(let t in e)this._props[t]=e[t];this._props.state=this.state}return this._props}update(e){e.handleDOMEvents!=this._props.handleDOMEvents&&ep(this);let t=this._props;this._props=e,e.plugins&&(e.plugins.forEach(kC),this.directPlugins=e.plugins),this.updateStateInner(e.state,t)}setProps(e){let t={};for(let r in this._props)t[r]=this._props[r];t.state=this.state;for(let r in e)t[r]=e[r];this.update(t)}updateState(e){this.updateStateInner(e,this._props)}updateStateInner(e,t){var r;let i=this.state,o=!1,s=!1;e.storedMarks&&this.composing&&(O0(this),s=!0),this.state=e;let a=i.plugins!=e.plugins||this._props.plugins!=t.plugins;if(a||this._props.plugins!=t.plugins||this._props.nodeViews!=t.nodeViews){let f=EC(this);ED(f,this.nodeViews)&&(this.nodeViews=f,o=!0)}(a||t.handleDOMEvents!=this._props.handleDOMEvents)&&ep(this),this.editable=TC(this),wC(this);let l=ch(this),c=SC(this),u=i.plugins!=e.plugins&&!i.doc.eq(e.doc)?"reset":e.scrollToSelection>i.scrollToSelection?"to selection":"preserve",d=o||!this.docView.matchesNode(e.doc,c,l);(d||!e.selection.eq(i.selection))&&(s=!0);let h=u=="preserve"&&s&&this.dom.style.overflowAnchor==null&&eP(this);if(s){this.domObserver.stop();let f=d&&(Jt||bt)&&!this.composing&&!i.selection.empty&&!e.selection.empty&&TD(i.selection,e.selection);if(d){let p=bt?this.trackWrites=this.domSelectionRange().focusNode:null;this.composing&&(this.input.compositionNode=ZP(this)),(o||!this.docView.update(e.doc,c,l,this))&&(this.docView.updateOuterDeco(c),this.docView.destroy(),this.docView=eC(e.doc,c,l,this.dom,this)),p&&!this.trackWrites&&(f=!0)}f||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelectionRange())&&kP(this))?Ar(this,f):(C0(this,e.selection),this.domObserver.setCurSelection()),this.domObserver.start()}this.updatePluginViews(i),!((r=this.dragging)===null||r===void 0)&&r.node&&!i.doc.eq(e.doc)&&this.updateDraggedNode(this.dragging,i),u=="reset"?this.dom.scrollTop=0:u=="to selection"?this.scrollToSelection():h&&tP(h)}scrollToSelection(){let e=this.domSelectionRange().focusNode;if(!(!e||!this.dom.contains(e.nodeType==1?e:e.parentNode))){if(!this.someProp("handleScrollToSelection",t=>t(this)))if(this.state.selection instanceof G){let t=this.docView.domAfterPos(this.state.selection.from);t.nodeType==1&&qv(this,t.getBoundingClientRect(),e)}else qv(this,this.coordsAtPos(this.state.selection.head,1),e)}}destroyPluginViews(){let e;for(;e=this.pluginViews.pop();)e.destroy&&e.destroy()}updatePluginViews(e){if(!e||e.plugins!=this.state.plugins||this.directPlugins!=this.prevDirectPlugins){this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let t=0;t<this.directPlugins.length;t++){let r=this.directPlugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}for(let t=0;t<this.state.plugins.length;t++){let r=this.state.plugins[t];r.spec.view&&this.pluginViews.push(r.spec.view(this))}}else for(let t=0;t<this.pluginViews.length;t++){let r=this.pluginViews[t];r.update&&r.update(this,e)}}updateDraggedNode(e,t){let r=e.node,i=-1;if(this.state.doc.nodeAt(r.from)==r.node)i=r.from;else{let o=r.from+(this.state.doc.content.size-t.doc.content.size);(o>0&&this.state.doc.nodeAt(o))==r.node&&(i=o)}this.dragging=new _0(e.slice,e.move,i<0?void 0:G.create(this.state.doc,i))}someProp(e,t){let r=this._props&&this._props[e],i;if(r!=null&&(i=t?t(r):r))return i;for(let s=0;s<this.directPlugins.length;s++){let a=this.directPlugins[s].props[e];if(a!=null&&(i=t?t(a):a))return i}let o=this.state.plugins;if(o)for(let s=0;s<o.length;s++){let a=o[s].props[e];if(a!=null&&(i=t?t(a):a))return i}}hasFocus(){if(Jt){let e=this.root.activeElement;if(e==this.dom)return!0;if(!e||!this.dom.contains(e))return!1;for(;e&&this.dom!=e&&this.dom.contains(e);){if(e.contentEditable=="false")return!1;e=e.parentElement}return!0}return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&nP(this.dom),Ar(this),this.domObserver.start()}get root(){let e=this._root;if(e==null){for(let t=this.dom.parentNode;t;t=t.parentNode)if(t.nodeType==9||t.nodeType==11&&t.host)return t.getSelection||(Object.getPrototypeOf(t).getSelection=()=>t.ownerDocument.getSelection()),this._root=t}return e||document}updateRoot(){this._root=null}posAtCoords(e){return aP(this,e)}coordsAtPos(e,t=1){return d0(this,e,t)}domAtPos(e,t=0){return this.docView.domFromPos(e,t)}nodeDOM(e){let t=this.docView.descAt(e);return t?t.nodeDOM:null}posAtDOM(e,t,r=-1){let i=this.docView.posFromDOM(e,t,r);if(i==null)throw new RangeError("DOM position not inside the editor");return i}endOfTextblock(e,t){return hP(this,t||this.state,e)}pasteHTML(e,t){return Qa(this,"",e,!1,t||new ClipboardEvent("paste"))}pasteText(e,t){return Qa(this,e,null,!0,t||new ClipboardEvent("paste"))}serializeForClipboard(e){return ng(this,e)}destroy(){this.docView&&(zP(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],ch(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null,K_())}get isDestroyed(){return this.docView==null}dispatchEvent(e){return KP(this,e)}dispatch(e){let t=this._props.dispatchTransaction;t?t.call(this,e):this.updateState(this.state.apply(e))}domSelectionRange(){let e=this.domSelection();return e?Pt&&this.root.nodeType===11&&q_(this.dom.ownerDocument)==this.dom&&hD(this,e)||e:{focusNode:null,focusOffset:0,anchorNode:null,anchorOffset:0}}domSelection(){return this.root.getSelection()}}function SC(n){let e=Object.create(null);return e.class="ProseMirror",e.contenteditable=String(n.editable),n.someProp("attributes",t=>{if(typeof t=="function"&&(t=t(n.state)),t)for(let r in t)r=="class"?e.class+=" "+t[r]:r=="style"?e.style=(e.style?e.style+";":"")+t[r]:!e[r]&&r!="contenteditable"&&r!="nodeName"&&(e[r]=String(t[r]))}),e.translate||(e.translate="no"),[pn.node(0,n.state.doc.content.size,e)]}function wC(n){if(n.markCursor){let e=document.createElement("img");e.className="ProseMirror-separator",e.setAttribute("mark-placeholder","true"),e.setAttribute("alt",""),n.cursorWrapper={dom:e,deco:pn.widget(n.state.selection.from,e,{raw:!0,marks:n.markCursor})}}else n.cursorWrapper=null}function TC(n){return!n.someProp("editable",e=>e(n.state)===!1)}function TD(n,e){let t=Math.min(n.$anchor.sharedDepth(n.head),e.$anchor.sharedDepth(e.head));return n.$anchor.start(t)!=e.$anchor.start(t)}function EC(n){let e=Object.create(null);function t(r){for(let i in r)Object.prototype.hasOwnProperty.call(e,i)||(e[i]=r[i])}return n.someProp("nodeViews",t),n.someProp("markViews",t),e}function ED(n,e){let t=0,r=0;for(let i in n){if(n[i]!=e[i])return!0;t++}for(let i in e)r++;return t!=r}function kC(n){if(n.spec.state||n.spec.filterTransaction||n.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}var Ei={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},mu={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},kD=typeof navigator<"u"&&/Mac/.test(navigator.platform),ID=typeof navigator<"u"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent);for(var mt=0;mt<10;mt++)Ei[48+mt]=Ei[96+mt]=String(mt);for(var mt=1;mt<=24;mt++)Ei[mt+111]="F"+mt;for(var mt=65;mt<=90;mt++)Ei[mt]=String.fromCharCode(mt+32),mu[mt]=String.fromCharCode(mt);for(var dh in Ei)mu.hasOwnProperty(dh)||(mu[dh]=Ei[dh]);function AD(n){var e=kD&&n.metaKey&&n.shiftKey&&!n.ctrlKey&&!n.altKey||ID&&n.shiftKey&&n.key&&n.key.length==1||n.key=="Unidentified",t=!e&&n.key||(n.shiftKey?mu:Ei)[n.keyCode]||n.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}const bD=typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):!1;function RD(n){let e=n.split(/-(?!$)/),t=e[e.length-1];t=="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a++){let l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))bD?s=!0:i=!0;else throw new Error("Unrecognized modifier name: "+l)}return r&&(t="Alt-"+t),i&&(t="Ctrl-"+t),s&&(t="Meta-"+t),o&&(t="Shift-"+t),t}function ND(n){let e=Object.create(null);for(let t in n)e[RD(t)]=n[t];return e}function hh(n,e,t=!0){return e.altKey&&(n="Alt-"+n),e.ctrlKey&&(n="Ctrl-"+n),e.metaKey&&(n="Meta-"+n),t&&e.shiftKey&&(n="Shift-"+n),n}function xD(n){return new jt({props:{handleKeyDown:H0(n)}})}function H0(n){let e=ND(n);return function(t,r){let i=AD(r),o,s=e[hh(i,r)];if(s&&s(t.state,t.dispatch,t))return!0;if(i.length==1&&i!=" "){if(r.shiftKey){let a=e[hh(i,r,!1)];if(a&&a(t.state,t.dispatch,t))return!0}if((r.shiftKey||r.altKey||r.metaKey||i.charCodeAt(0)>127)&&(o=Ei[r.keyCode])&&o!=i){let a=e[hh(o,r)];if(a&&a(t.state,t.dispatch,t))return!0}}return!1}}const OD=(n,e)=>n.selection.empty?!1:(e&&e(n.tr.deleteSelection().scrollIntoView()),!0);function F0(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("backward",n):t.parentOffset>0)?null:t}const MD=(n,e,t)=>{let r=F0(n,t);if(!r)return!1;let i=lg(r);if(!i){let s=r.blockRange(),a=s&&xs(s);return a==null?!1:(e&&e(n.tr.lift(s,a).scrollIntoView()),!0)}let o=i.nodeBefore;if(K0(n,i,e,-1))return!0;if(r.parent.content.size==0&&(Cs(o,"end")||G.isSelectable(o)))for(let s=r.depth;;s--){let a=nd(n.doc,r.before(s),r.after(s),U.empty);if(a&&a.slice.size<a.to-a.from){if(e){let l=n.tr.step(a);l.setSelection(Cs(o,"end")?Z.findFrom(l.doc.resolve(l.mapping.map(i.pos,-1)),-1):G.create(l.doc,i.pos-o.nodeSize)),e(l.scrollIntoView())}return!0}if(s==1||r.node(s-1).childCount>1)break}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos-o.nodeSize,i.pos).scrollIntoView()),!0):!1},_D=(n,e,t)=>{let r=F0(n,t);if(!r)return!1;let i=lg(r);return i?B0(n,i,e):!1},PD=(n,e,t)=>{let r=z0(n,t);if(!r)return!1;let i=cg(r);return i?B0(n,i,e):!1};function B0(n,e,t){let r=e.nodeBefore,i=r,o=e.pos-1;for(;!i.isTextblock;o--){if(i.type.spec.isolating)return!1;let u=i.lastChild;if(!u)return!1;i=u}let s=e.nodeAfter,a=s,l=e.pos+1;for(;!a.isTextblock;l++){if(a.type.spec.isolating)return!1;let u=a.firstChild;if(!u)return!1;a=u}let c=nd(n.doc,o,l,U.empty);if(!c||c.from!=o||c instanceof ot&&c.slice.size>=l-o)return!1;if(t){let u=n.tr.step(c);u.setSelection(J.create(u.doc,o)),t(u.scrollIntoView())}return!0}function Cs(n,e,t=!1){for(let r=n;r;r=e=="start"?r.firstChild:r.lastChild){if(r.isTextblock)return!0;if(t&&r.childCount!=1)return!1}return!1}const DD=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("backward",n):r.parentOffset>0)return!1;o=lg(r)}let s=o&&o.nodeBefore;return!s||!G.isSelectable(s)?!1:(e&&e(n.tr.setSelection(G.create(n.doc,o.pos-s.nodeSize)).scrollIntoView()),!0)};function lg(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){if(n.index(e)>0)return n.doc.resolve(n.before(e+1));if(n.node(e).type.spec.isolating)break}return null}function z0(n,e){let{$cursor:t}=n.selection;return!t||(e?!e.endOfTextblock("forward",n):t.parentOffset<t.parent.content.size)?null:t}const LD=(n,e,t)=>{let r=z0(n,t);if(!r)return!1;let i=cg(r);if(!i)return!1;let o=i.nodeAfter;if(K0(n,i,e,1))return!0;if(r.parent.content.size==0&&(Cs(o,"start")||G.isSelectable(o))){let s=nd(n.doc,r.before(),r.after(),U.empty);if(s&&s.slice.size<s.to-s.from){if(e){let a=n.tr.step(s);a.setSelection(Cs(o,"start")?Z.findFrom(a.doc.resolve(a.mapping.map(i.pos)),1):G.create(a.doc,a.mapping.map(i.pos))),e(a.scrollIntoView())}return!0}}return o.isAtom&&i.depth==r.depth-1?(e&&e(n.tr.delete(i.pos,i.pos+o.nodeSize).scrollIntoView()),!0):!1},UD=(n,e,t)=>{let{$head:r,empty:i}=n.selection,o=r;if(!i)return!1;if(r.parent.isTextblock){if(t?!t.endOfTextblock("forward",n):r.parentOffset<r.parent.content.size)return!1;o=cg(r)}let s=o&&o.nodeAfter;return!s||!G.isSelectable(s)?!1:(e&&e(n.tr.setSelection(G.create(n.doc,o.pos)).scrollIntoView()),!0)};function cg(n){if(!n.parent.type.spec.isolating)for(let e=n.depth-1;e>=0;e--){let t=n.node(e);if(n.index(e)+1<t.childCount)return n.doc.resolve(n.after(e+1));if(t.type.spec.isolating)break}return null}const HD=(n,e)=>{let t=n.selection,r=t instanceof G,i;if(r){if(t.node.isTextblock||!Ri(n.doc,t.from))return!1;i=t.from}else if(i=td(n.doc,t.from,-1),i==null)return!1;if(e){let o=n.tr.join(i);r&&o.setSelection(G.create(o.doc,i-n.doc.resolve(i).nodeBefore.nodeSize)),e(o.scrollIntoView())}return!0},FD=(n,e)=>{let t=n.selection,r;if(t instanceof G){if(t.node.isTextblock||!Ri(n.doc,t.to))return!1;r=t.to}else if(r=td(n.doc,t.to,1),r==null)return!1;return e&&e(n.tr.join(r).scrollIntoView()),!0},BD=(n,e)=>{let{$from:t,$to:r}=n.selection,i=t.blockRange(r),o=i&&xs(i);return o==null?!1:(e&&e(n.tr.lift(i,o).scrollIntoView()),!0)},zD=(n,e)=>{let{$head:t,$anchor:r}=n.selection;return!t.parent.type.spec.code||!t.sameParent(r)?!1:(e&&e(n.tr.insertText(`
`).scrollIntoView()),!0)};function j0(n){for(let e=0;e<n.edgeCount;e++){let{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}const jD=(n,e)=>{let{$head:t,$anchor:r}=n.selection;if(!t.parent.type.spec.code||!t.sameParent(r))return!1;let i=t.node(-1),o=t.indexAfter(-1),s=j0(i.contentMatchAt(o));if(!s||!i.canReplaceWith(o,o,s))return!1;if(e){let a=t.after(),l=n.tr.replaceWith(a,a,s.createAndFill());l.setSelection(Z.near(l.doc.resolve(a),1)),e(l.scrollIntoView())}return!0},KD=(n,e)=>{let t=n.selection,{$from:r,$to:i}=t;if(t instanceof Rn||r.parent.inlineContent||i.parent.inlineContent)return!1;let o=j0(i.parent.contentMatchAt(i.indexAfter()));if(!o||!o.isTextblock)return!1;if(e){let s=(!r.parentOffset&&i.index()<i.parent.childCount?r:i).pos,a=n.tr.insert(s,o.createAndFill());a.setSelection(J.create(a.doc,s+1)),e(a.scrollIntoView())}return!0},$D=(n,e)=>{let{$cursor:t}=n.selection;if(!t||t.parent.content.size)return!1;if(t.depth>1&&t.after()!=t.end(-1)){let o=t.before();if(Zo(n.doc,o))return e&&e(n.tr.split(o).scrollIntoView()),!0}let r=t.blockRange(),i=r&&xs(r);return i==null?!1:(e&&e(n.tr.lift(r,i).scrollIntoView()),!0)},VD=(n,e)=>{let{$from:t,to:r}=n.selection,i,o=t.sharedDepth(r);return o==0?!1:(i=t.before(o),e&&e(n.tr.setSelection(G.create(n.doc,i))),!0)};function WD(n,e,t){let r=e.nodeBefore,i=e.nodeAfter,o=e.index();return!r||!i||!r.type.compatibleContent(i.type)?!1:!r.content.size&&e.parent.canReplace(o-1,o)?(t&&t(n.tr.delete(e.pos-r.nodeSize,e.pos).scrollIntoView()),!0):!e.parent.canReplace(o,o+1)||!(i.isTextblock||Ri(n.doc,e.pos))?!1:(t&&t(n.tr.join(e.pos).scrollIntoView()),!0)}function K0(n,e,t,r){let i=e.nodeBefore,o=e.nodeAfter,s,a,l=i.type.spec.isolating||o.type.spec.isolating;if(!l&&WD(n,e,t))return!0;let c=!l&&e.parent.canReplace(e.index(),e.index()+1);if(c&&(s=(a=i.contentMatchAt(i.childCount)).findWrapping(o.type))&&a.matchType(s[0]||o.type).validEnd){if(t){let f=e.pos+o.nodeSize,p=x.empty;for(let g=s.length-1;g>=0;g--)p=x.from(s[g].create(null,p));p=x.from(i.copy(p));let m=n.tr.step(new at(e.pos-1,f,e.pos,f,new U(p,1,0),s.length,!0)),v=m.doc.resolve(f+2*s.length);v.nodeAfter&&v.nodeAfter.type==i.type&&Ri(m.doc,v.pos)&&m.join(v.pos),t(m.scrollIntoView())}return!0}let u=o.type.spec.isolating||r>0&&l?null:Z.findFrom(e,1),d=u&&u.$from.blockRange(u.$to),h=d&&xs(d);if(h!=null&&h>=e.depth)return t&&t(n.tr.lift(d,h).scrollIntoView()),!0;if(c&&Cs(o,"start",!0)&&Cs(i,"end")){let f=i,p=[];for(;p.push(f),!f.isTextblock;)f=f.lastChild;let m=o,v=1;for(;!m.isTextblock;m=m.firstChild)v++;if(f.canReplace(f.childCount,f.childCount,m.content)){if(t){let g=x.empty;for(let C=p.length-1;C>=0;C--)g=x.from(p[C].copy(g));let y=n.tr.step(new at(e.pos-p.length,e.pos+o.nodeSize,e.pos+v,e.pos+o.nodeSize-v,new U(g,p.length,0),0,!0));t(y.scrollIntoView())}return!0}}return!1}function $0(n){return function(e,t){let r=e.selection,i=n<0?r.$from:r.$to,o=i.depth;for(;i.node(o).isInline;){if(!o)return!1;o--}return i.node(o).isTextblock?(t&&t(e.tr.setSelection(J.create(e.doc,n<0?i.start(o):i.end(o)))),!0):!1}}const GD=$0(-1),qD=$0(1);function QD(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o),a=s&&Jm(s,n,e);return a?(r&&r(t.tr.wrap(s,a).scrollIntoView()),!0):!1}}function IC(n,e=null){return function(t,r){let i=!1;for(let o=0;o<t.selection.ranges.length&&!i;o++){let{$from:{pos:s},$to:{pos:a}}=t.selection.ranges[o];t.doc.nodesBetween(s,a,(l,c)=>{if(i)return!1;if(!(!l.isTextblock||l.hasMarkup(n,e)))if(l.type==n)i=!0;else{let u=t.doc.resolve(c),d=u.index();i=u.parent.canReplaceWith(d,d+1,n)}})}if(!i)return!1;if(r){let o=t.tr;for(let s=0;s<t.selection.ranges.length;s++){let{$from:{pos:a},$to:{pos:l}}=t.selection.ranges[s];o.setBlockType(a,l,n,e)}r(o.scrollIntoView())}return!0}}typeof navigator<"u"?/Mac|iP(hone|[oa]d)/.test(navigator.platform):typeof os<"u"&&os.platform&&os.platform()=="darwin";function YD(n,e=null){return function(t,r){let{$from:i,$to:o}=t.selection,s=i.blockRange(o);if(!s)return!1;let a=r?t.tr:null;return JD(a,s,n,e)?(r&&r(a.scrollIntoView()),!0):!1}}function JD(n,e,t,r=null){let i=!1,o=e,s=e.$from.doc;if(e.depth>=2&&e.$from.node(e.depth-1).type.compatibleContent(t)&&e.startIndex==0){if(e.$from.index(e.depth-1)==0)return!1;let l=s.resolve(e.start-2);o=new lu(l,l,e.depth),e.endIndex<e.parent.childCount&&(e=new lu(e.$from,s.resolve(e.$to.end(e.depth)),e.depth)),i=!0}let a=Jm(o,t,r,e);return a?(n&&XD(n,e,a,i,t),!0):!1}function XD(n,e,t,r,i){let o=x.empty;for(let u=t.length-1;u>=0;u--)o=x.from(t[u].type.create(t[u].attrs,o));n.step(new at(e.start-(r?2:0),e.end,e.start,e.end,new U(o,0,0),t.length,!0));let s=0;for(let u=0;u<t.length;u++)t[u].type==i&&(s=u+1);let a=t.length-s,l=e.start+t.length-(r?2:0),c=e.parent;for(let u=e.startIndex,d=e.endIndex,h=!0;u<d;u++,h=!1)!h&&Zo(n.doc,l,a)&&(n.split(l,a),l+=2*a),l+=c.child(u).nodeSize;return n}function ZD(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,s=>s.childCount>0&&s.firstChild.type==n);return o?t?r.node(o.depth-1).type==n?eL(e,t,n,o):tL(e,t,o):!0:!1}}function eL(n,e,t,r){let i=n.tr,o=r.end,s=r.$to.end(r.depth);o<s&&(i.step(new at(o-1,s,o,s,new U(x.from(t.create(null,r.parent.copy())),1,0),1,!0)),r=new lu(i.doc.resolve(r.$from.pos),i.doc.resolve(s),r.depth));const a=xs(r);if(a==null)return!1;i.lift(r,a);let l=i.doc.resolve(i.mapping.map(o,-1)-1);return Ri(i.doc,l.pos)&&l.nodeBefore.type==l.nodeAfter.type&&i.join(l.pos),e(i.scrollIntoView()),!0}function tL(n,e,t){let r=n.tr,i=t.parent;for(let f=t.end,p=t.endIndex-1,m=t.startIndex;p>m;p--)f-=i.child(p).nodeSize,r.delete(f-1,f+1);let o=r.doc.resolve(t.start),s=o.nodeAfter;if(r.mapping.map(t.end)!=t.start+o.nodeAfter.nodeSize)return!1;let a=t.startIndex==0,l=t.endIndex==i.childCount,c=o.node(-1),u=o.index(-1);if(!c.canReplace(u+(a?0:1),u+1,s.content.append(l?x.empty:x.from(i))))return!1;let d=o.pos,h=d+s.nodeSize;return r.step(new at(d-(a?1:0),h+(l?1:0),d+1,h-1,new U((a?x.empty:x.from(i.copy(x.empty))).append(l?x.empty:x.from(i.copy(x.empty))),a?0:1,l?0:1),a?0:1)),e(r.scrollIntoView()),!0}function nL(n){return function(e,t){let{$from:r,$to:i}=e.selection,o=r.blockRange(i,c=>c.childCount>0&&c.firstChild.type==n);if(!o)return!1;let s=o.startIndex;if(s==0)return!1;let a=o.parent,l=a.child(s-1);if(l.type!=n)return!1;if(t){let c=l.lastChild&&l.lastChild.type==a.type,u=x.from(c?n.create():null),d=new U(x.from(n.create(null,x.from(a.type.create(null,u)))),c?3:1,0),h=o.start,f=o.end;t(e.tr.step(new at(h-(c?3:1),f,h,f,d,1,!0)).scrollIntoView())}return!0}}function ad(n){const{state:e,transaction:t}=n;let{selection:r}=t,{doc:i}=t,{storedMarks:o}=t;return{...e,apply:e.apply.bind(e),applyTransaction:e.applyTransaction.bind(e),plugins:e.plugins,schema:e.schema,reconfigure:e.reconfigure.bind(e),toJSON:e.toJSON.bind(e),get storedMarks(){return o},get selection(){return r},get doc(){return i},get tr(){return r=t.selection,i=t.doc,o=t.storedMarks,t}}}class ld{constructor(e){this.editor=e.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=e.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:e,editor:t,state:r}=this,{view:i}=t,{tr:o}=r,s=this.buildProps(o);return Object.fromEntries(Object.entries(e).map(([a,l])=>[a,(...u)=>{const d=l(...u)(s);return!o.getMeta("preventDispatch")&&!this.hasCustomState&&i.dispatch(o),d}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a=[],l=!!e,c=e||o.tr,u=()=>(!l&&t&&!c.getMeta("preventDispatch")&&!this.hasCustomState&&s.dispatch(c),a.every(h=>h===!0)),d={...Object.fromEntries(Object.entries(r).map(([h,f])=>[h,(...m)=>{const v=this.buildProps(c,t),g=f(...m)(v);return a.push(g),d}])),run:u};return d}createCan(e){const{rawCommands:t,state:r}=this,i=!1,o=e||r.tr,s=this.buildProps(o,i);return{...Object.fromEntries(Object.entries(t).map(([l,c])=>[l,(...u)=>c(...u)({...s,dispatch:void 0})])),chain:()=>this.createChain(o,i)}}buildProps(e,t=!0){const{rawCommands:r,editor:i,state:o}=this,{view:s}=i,a={tr:e,editor:i,view:s,state:ad({state:o,transaction:e}),dispatch:t?()=>{}:void 0,chain:()=>this.createChain(e,t),can:()=>this.createCan(e),get commands(){return Object.fromEntries(Object.entries(r).map(([l,c])=>[l,(...u)=>c(...u)(a)]))}};return a}}class rL{constructor(){this.callbacks={}}on(e,t){return this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t),this}emit(e,...t){const r=this.callbacks[e];return r&&r.forEach(i=>i.apply(this,t)),this}off(e,t){const r=this.callbacks[e];return r&&(t?this.callbacks[e]=r.filter(i=>i!==t):delete this.callbacks[e]),this}once(e,t){const r=(...i)=>{this.off(e,r),t.apply(this,i)};return this.on(e,r)}removeAllListeners(){this.callbacks={}}}function j(n,e,t){return n.config[e]===void 0&&n.parent?j(n.parent,e,t):typeof n.config[e]=="function"?n.config[e].bind({...t,parent:n.parent?j(n.parent,e,t):null}):n.config[e]}function cd(n){const e=n.filter(i=>i.type==="extension"),t=n.filter(i=>i.type==="node"),r=n.filter(i=>i.type==="mark");return{baseExtensions:e,nodeExtensions:t,markExtensions:r}}function V0(n){const e=[],{nodeExtensions:t,markExtensions:r}=cd(n),i=[...t,...r],o={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return n.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage,extensions:i},l=j(s,"addGlobalAttributes",a);if(!l)return;l().forEach(u=>{u.types.forEach(d=>{Object.entries(u.attributes).forEach(([h,f])=>{e.push({type:d,name:h,attribute:{...o,...f}})})})})}),i.forEach(s=>{const a={name:s.name,options:s.options,storage:s.storage},l=j(s,"addAttributes",a);if(!l)return;const c=l();Object.entries(c).forEach(([u,d])=>{const h={...o,...d};typeof(h==null?void 0:h.default)=="function"&&(h.default=h.default()),h!=null&&h.isRequired&&(h==null?void 0:h.default)===void 0&&delete h.default,e.push({type:s.name,name:u,attribute:h})})}),e}function ct(n,e){if(typeof n=="string"){if(!e.nodes[n])throw Error(`There is no node type named '${n}'. Maybe you forgot to add the extension?`);return e.nodes[n]}return n}function Ut(...n){return n.filter(e=>!!e).reduce((e,t)=>{const r={...e};return Object.entries(t).forEach(([i,o])=>{if(!r[i]){r[i]=o;return}if(i==="class"){const a=o?String(o).split(" "):[],l=r[i]?r[i].split(" "):[],c=a.filter(u=>!l.includes(u));r[i]=[...l,...c].join(" ")}else if(i==="style"){const a=o?o.split(";").map(u=>u.trim()).filter(Boolean):[],l=r[i]?r[i].split(";").map(u=>u.trim()).filter(Boolean):[],c=new Map;l.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),a.forEach(u=>{const[d,h]=u.split(":").map(f=>f.trim());c.set(d,h)}),r[i]=Array.from(c.entries()).map(([u,d])=>`${u}: ${d}`).join("; ")}else r[i]=o}),r},{})}function tp(n,e){return e.filter(t=>t.type===n.type.name).filter(t=>t.attribute.rendered).map(t=>t.attribute.renderHTML?t.attribute.renderHTML(n.attrs)||{}:{[t.name]:n.attrs[t.name]}).reduce((t,r)=>Ut(t,r),{})}function W0(n){return typeof n=="function"}function ne(n,e=void 0,...t){return W0(n)?e?n.bind(e)(...t):n(...t):n}function iL(n={}){return Object.keys(n).length===0&&n.constructor===Object}function oL(n){return typeof n!="string"?n:n.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(n):n==="true"?!0:n==="false"?!1:n}function AC(n,e){return"style"in n?n:{...n,getAttrs:t=>{const r=n.getAttrs?n.getAttrs(t):n.attrs;if(r===!1)return!1;const i=e.reduce((o,s)=>{const a=s.attribute.parseHTML?s.attribute.parseHTML(t):oL(t.getAttribute(s.name));return a==null?o:{...o,[s.name]:a}},{});return{...r,...i}}}}function bC(n){return Object.fromEntries(Object.entries(n).filter(([e,t])=>e==="attrs"&&iL(t)?!1:t!=null))}function sL(n,e){var t;const r=V0(n),{nodeExtensions:i,markExtensions:o}=cd(n),s=(t=i.find(c=>j(c,"topNode")))===null||t===void 0?void 0:t.name,a=Object.fromEntries(i.map(c=>{const u=r.filter(g=>g.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((g,y)=>{const C=j(y,"extendNodeSchema",d);return{...g,...C?C(c):{}}},{}),f=bC({...h,content:ne(j(c,"content",d)),marks:ne(j(c,"marks",d)),group:ne(j(c,"group",d)),inline:ne(j(c,"inline",d)),atom:ne(j(c,"atom",d)),selectable:ne(j(c,"selectable",d)),draggable:ne(j(c,"draggable",d)),code:ne(j(c,"code",d)),whitespace:ne(j(c,"whitespace",d)),linebreakReplacement:ne(j(c,"linebreakReplacement",d)),defining:ne(j(c,"defining",d)),isolating:ne(j(c,"isolating",d)),attrs:Object.fromEntries(u.map(g=>{var y;return[g.name,{default:(y=g==null?void 0:g.attribute)===null||y===void 0?void 0:y.default}]}))}),p=ne(j(c,"parseHTML",d));p&&(f.parseDOM=p.map(g=>AC(g,u)));const m=j(c,"renderHTML",d);m&&(f.toDOM=g=>m({node:g,HTMLAttributes:tp(g,u)}));const v=j(c,"renderText",d);return v&&(f.toText=v),[c.name,f]})),l=Object.fromEntries(o.map(c=>{const u=r.filter(v=>v.type===c.name),d={name:c.name,options:c.options,storage:c.storage,editor:e},h=n.reduce((v,g)=>{const y=j(g,"extendMarkSchema",d);return{...v,...y?y(c):{}}},{}),f=bC({...h,inclusive:ne(j(c,"inclusive",d)),excludes:ne(j(c,"excludes",d)),group:ne(j(c,"group",d)),spanning:ne(j(c,"spanning",d)),code:ne(j(c,"code",d)),attrs:Object.fromEntries(u.map(v=>{var g;return[v.name,{default:(g=v==null?void 0:v.attribute)===null||g===void 0?void 0:g.default}]}))}),p=ne(j(c,"parseHTML",d));p&&(f.parseDOM=p.map(v=>AC(v,u)));const m=j(c,"renderHTML",d);return m&&(f.toDOM=v=>m({mark:v,HTMLAttributes:tp(v,u)})),[c.name,f]}));return new zk({topNode:s,nodes:a,marks:l})}function fh(n,e){return e.nodes[n]||e.marks[n]||null}function RC(n,e){return Array.isArray(e)?e.some(t=>(typeof t=="string"?t:t.name)===n.name):e}function ug(n,e){const t=po.fromSchema(e).serializeFragment(n),i=document.implementation.createHTMLDocument().createElement("div");return i.appendChild(t),i.innerHTML}const aL=(n,e=500)=>{let t="";const r=n.parentOffset;return n.parent.nodesBetween(Math.max(0,r-e),r,(i,o,s,a)=>{var l,c;const u=((c=(l=i.type.spec).toText)===null||c===void 0?void 0:c.call(l,{node:i,pos:o,parent:s,index:a}))||i.textContent||"%leaf%";t+=i.isAtom&&!i.isText?u:u.slice(0,Math.max(0,r-o))}),t};function dg(n){return Object.prototype.toString.call(n)==="[object RegExp]"}class ud{constructor(e){this.find=e.find,this.handler=e.handler}}const lL=(n,e)=>{if(dg(e))return e.exec(n);const t=e(n);if(!t)return null;const r=[t.text];return r.index=t.index,r.input=n,r.data=t.data,t.replaceWith&&(t.text.includes(t.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),r.push(t.replaceWith)),r};function $l(n){var e;const{editor:t,from:r,to:i,text:o,rules:s,plugin:a}=n,{view:l}=t;if(l.composing)return!1;const c=l.state.doc.resolve(r);if(c.parent.type.spec.code||!((e=c.nodeBefore||c.nodeAfter)===null||e===void 0)&&e.marks.find(h=>h.type.spec.code))return!1;let u=!1;const d=aL(c)+o;return s.forEach(h=>{if(u)return;const f=lL(d,h.find);if(!f)return;const p=l.state.tr,m=ad({state:l.state,transaction:p}),v={from:r-(f[0].length-o.length),to:i},{commands:g,chain:y,can:C}=new ld({editor:t,state:m});h.handler({state:m,range:v,match:f,commands:g,chain:y,can:C})===null||!p.steps.length||(p.setMeta(a,{transform:p,from:r,to:i,text:o}),l.dispatch(p),u=!0)}),u}function cL(n){const{editor:e,rules:t}=n,r=new jt({state:{init(){return null},apply(i,o,s){const a=i.getMeta(r);if(a)return a;const l=i.getMeta("applyInputRules");return!!l&&setTimeout(()=>{let{text:u}=l;typeof u=="string"?u=u:u=ug(x.from(u),s.schema);const{from:d}=l,h=d+u.length;$l({editor:e,from:d,to:h,text:u,rules:t,plugin:r})}),i.selectionSet||i.docChanged?null:o}},props:{handleTextInput(i,o,s,a){return $l({editor:e,from:o,to:s,text:a,rules:t,plugin:r})},handleDOMEvents:{compositionend:i=>(setTimeout(()=>{const{$cursor:o}=i.state.selection;o&&$l({editor:e,from:o.pos,to:o.pos,text:"",rules:t,plugin:r})}),!1)},handleKeyDown(i,o){if(o.key!=="Enter")return!1;const{$cursor:s}=i.state.selection;return s?$l({editor:e,from:s.pos,to:s.pos,text:`
`,rules:t,plugin:r}):!1}},isInputRules:!0});return r}function uL(n){return Object.prototype.toString.call(n).slice(8,-1)}function Vl(n){return uL(n)!=="Object"?!1:n.constructor===Object&&Object.getPrototypeOf(n)===Object.prototype}function dd(n,e){const t={...n};return Vl(n)&&Vl(e)&&Object.keys(e).forEach(r=>{Vl(e[r])&&Vl(n[r])?t[r]=dd(n[r],e[r]):t[r]=e[r]}),t}class ki{constructor(e={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ne(j(this,"addOptions",{name:this.name}))),this.storage=ne(j(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new ki(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>dd(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new ki(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ne(j(t,"addOptions",{name:t.name})),t.storage=ne(j(t,"addStorage",{name:t.name,options:t.options})),t}static handleExit({editor:e,mark:t}){const{tr:r}=e.state,i=e.state.selection.$from;if(i.pos===i.end()){const s=i.marks();if(!!!s.find(c=>(c==null?void 0:c.type.name)===t.name))return!1;const l=s.find(c=>(c==null?void 0:c.type.name)===t.name);return l&&r.removeStoredMark(l),r.insertText(" ",i.pos),e.view.dispatch(r),!0}return!1}}function dL(n){return typeof n=="number"}class hL{constructor(e){this.find=e.find,this.handler=e.handler}}const fL=(n,e,t)=>{if(dg(e))return[...n.matchAll(e)];const r=e(n,t);return r?r.map(i=>{const o=[i.text];return o.index=i.index,o.input=n,o.data=i.data,i.replaceWith&&(i.text.includes(i.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),o.push(i.replaceWith)),o}):[]};function pL(n){const{editor:e,state:t,from:r,to:i,rule:o,pasteEvent:s,dropEvent:a}=n,{commands:l,chain:c,can:u}=new ld({editor:e,state:t}),d=[];return t.doc.nodesBetween(r,i,(f,p)=>{if(!f.isTextblock||f.type.spec.code)return;const m=Math.max(r,p),v=Math.min(i,p+f.content.size),g=f.textBetween(m-p,v-p,void 0,"￼");fL(g,o.find,s).forEach(C=>{if(C.index===void 0)return;const w=m+C.index+1,E=w+C[0].length,I={from:t.tr.mapping.map(w),to:t.tr.mapping.map(E)},b=o.handler({state:t,range:I,match:C,commands:l,chain:c,can:u,pasteEvent:s,dropEvent:a});d.push(b)})}),d.every(f=>f!==null)}let Wl=null;const mL=n=>{var e;const t=new ClipboardEvent("paste",{clipboardData:new DataTransfer});return(e=t.clipboardData)===null||e===void 0||e.setData("text/html",n),t};function gL(n){const{editor:e,rules:t}=n;let r=null,i=!1,o=!1,s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,a;try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}const l=({state:u,from:d,to:h,rule:f,pasteEvt:p})=>{const m=u.tr,v=ad({state:u,transaction:m});if(!(!pL({editor:e,state:v,from:Math.max(d-1,0),to:h.b-1,rule:f,pasteEvent:p,dropEvent:a})||!m.steps.length)){try{a=typeof DragEvent<"u"?new DragEvent("drop"):null}catch{a=null}return s=typeof ClipboardEvent<"u"?new ClipboardEvent("paste"):null,m}};return t.map(u=>new jt({view(d){const h=p=>{var m;r=!((m=d.dom.parentElement)===null||m===void 0)&&m.contains(p.target)?d.dom.parentElement:null,r&&(Wl=e)},f=()=>{Wl&&(Wl=null)};return window.addEventListener("dragstart",h),window.addEventListener("dragend",f),{destroy(){window.removeEventListener("dragstart",h),window.removeEventListener("dragend",f)}}},props:{handleDOMEvents:{drop:(d,h)=>{if(o=r===d.dom.parentElement,a=h,!o){const f=Wl;f&&setTimeout(()=>{const p=f.state.selection;p&&f.commands.deleteRange({from:p.from,to:p.to})},10)}return!1},paste:(d,h)=>{var f;const p=(f=h.clipboardData)===null||f===void 0?void 0:f.getData("text/html");return s=h,i=!!(p!=null&&p.includes("data-pm-slice")),!1}}},appendTransaction:(d,h,f)=>{const p=d[0],m=p.getMeta("uiEvent")==="paste"&&!i,v=p.getMeta("uiEvent")==="drop"&&!o,g=p.getMeta("applyPasteRules"),y=!!g;if(!m&&!v&&!y)return;if(y){let{text:E}=g;typeof E=="string"?E=E:E=ug(x.from(E),f.schema);const{from:I}=g,b=I+E.length,R=mL(E);return l({rule:u,state:f,from:I,to:{b},pasteEvt:R})}const C=h.doc.content.findDiffStart(f.doc.content),w=h.doc.content.findDiffEnd(f.doc.content);if(!(!dL(C)||!w||C===w.b))return l({rule:u,state:f,from:C,to:w,pasteEvt:s})}}))}function yL(n){const e=n.filter((t,r)=>n.indexOf(t)!==r);return Array.from(new Set(e))}class Ko{constructor(e,t){this.splittableMarks=[],this.editor=t,this.extensions=Ko.resolve(e),this.schema=sL(this.extensions,t),this.setupExtensions()}static resolve(e){const t=Ko.sort(Ko.flatten(e)),r=yL(t.map(i=>i.name));return r.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${r.map(i=>`'${i}'`).join(", ")}]. This can lead to issues.`),t}static flatten(e){return e.map(t=>{const r={name:t.name,options:t.options,storage:t.storage},i=j(t,"addExtensions",r);return i?[t,...this.flatten(i())]:t}).flat(10)}static sort(e){return e.sort((r,i)=>{const o=j(r,"priority")||100,s=j(i,"priority")||100;return o>s?-1:o<s?1:0})}get commands(){return this.extensions.reduce((e,t)=>{const r={name:t.name,options:t.options,storage:t.storage,editor:this.editor,type:fh(t.name,this.schema)},i=j(t,"addCommands",r);return i?{...e,...i()}:e},{})}get plugins(){const{editor:e}=this,t=Ko.sort([...this.extensions].reverse()),r=[],i=[],o=t.map(s=>{const a={name:s.name,options:s.options,storage:s.storage,editor:e,type:fh(s.name,this.schema)},l=[],c=j(s,"addKeyboardShortcuts",a);let u={};if(s.type==="mark"&&j(s,"exitable",a)&&(u.ArrowRight=()=>ki.handleExit({editor:e,mark:s})),c){const m=Object.fromEntries(Object.entries(c()).map(([v,g])=>[v,()=>g({editor:e})]));u={...u,...m}}const d=xD(u);l.push(d);const h=j(s,"addInputRules",a);RC(s,e.options.enableInputRules)&&h&&r.push(...h());const f=j(s,"addPasteRules",a);RC(s,e.options.enablePasteRules)&&f&&i.push(...f());const p=j(s,"addProseMirrorPlugins",a);if(p){const m=p();l.push(...m)}return l}).flat();return[cL({editor:e,rules:r}),...gL({editor:e,rules:i}),...o]}get attributes(){return V0(this.extensions)}get nodeViews(){const{editor:e}=this,{nodeExtensions:t}=cd(this.extensions);return Object.fromEntries(t.filter(r=>!!j(r,"addNodeView")).map(r=>{const i=this.attributes.filter(l=>l.type===r.name),o={name:r.name,options:r.options,storage:r.storage,editor:e,type:ct(r.name,this.schema)},s=j(r,"addNodeView",o);if(!s)return[];const a=(l,c,u,d,h)=>{const f=tp(l,i);return s()({node:l,view:c,getPos:u,decorations:d,innerDecorations:h,editor:e,extension:r,HTMLAttributes:f})};return[r.name,a]}))}setupExtensions(){this.extensions.forEach(e=>{var t;this.editor.extensionStorage[e.name]=e.storage;const r={name:e.name,options:e.options,storage:e.storage,editor:this.editor,type:fh(e.name,this.schema)};e.type==="mark"&&(!((t=ne(j(e,"keepOnSplit",r)))!==null&&t!==void 0)||t)&&this.splittableMarks.push(e.name);const i=j(e,"onBeforeCreate",r),o=j(e,"onCreate",r),s=j(e,"onUpdate",r),a=j(e,"onSelectionUpdate",r),l=j(e,"onTransaction",r),c=j(e,"onFocus",r),u=j(e,"onBlur",r),d=j(e,"onDestroy",r);i&&this.editor.on("beforeCreate",i),o&&this.editor.on("create",o),s&&this.editor.on("update",s),a&&this.editor.on("selectionUpdate",a),l&&this.editor.on("transaction",l),c&&this.editor.on("focus",c),u&&this.editor.on("blur",u),d&&this.editor.on("destroy",d)})}}class Nt{constructor(e={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ne(j(this,"addOptions",{name:this.name}))),this.storage=ne(j(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Nt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>dd(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Nt({...this.config,...e});return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ne(j(t,"addOptions",{name:t.name})),t.storage=ne(j(t,"addStorage",{name:t.name,options:t.options})),t}}function G0(n,e,t){const{from:r,to:i}=e,{blockSeparator:o=`

`,textSerializers:s={}}=t||{};let a="";return n.nodesBetween(r,i,(l,c,u,d)=>{var h;l.isBlock&&c>r&&(a+=o);const f=s==null?void 0:s[l.type.name];if(f)return u&&(a+=f({node:l,pos:c,parent:u,index:d,range:e})),!1;l.isText&&(a+=(h=l==null?void 0:l.text)===null||h===void 0?void 0:h.slice(Math.max(r,c)-c,i-c))}),a}function q0(n){return Object.fromEntries(Object.entries(n.nodes).filter(([,e])=>e.spec.toText).map(([e,t])=>[e,t.spec.toText]))}const vL=Nt.create({name:"clipboardTextSerializer",addOptions(){return{blockSeparator:void 0}},addProseMirrorPlugins(){return[new jt({key:new Gn("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:n}=this,{state:e,schema:t}=n,{doc:r,selection:i}=e,{ranges:o}=i,s=Math.min(...o.map(u=>u.$from.pos)),a=Math.max(...o.map(u=>u.$to.pos)),l=q0(t);return G0(r,{from:s,to:a},{...this.options.blockSeparator!==void 0?{blockSeparator:this.options.blockSeparator}:{},textSerializers:l})}}})]}}),CL=()=>({editor:n,view:e})=>(requestAnimationFrame(()=>{var t;n.isDestroyed||(e.dom.blur(),(t=window==null?void 0:window.getSelection())===null||t===void 0||t.removeAllRanges())}),!0),SL=(n=!1)=>({commands:e})=>e.setContent("",n),wL=()=>({state:n,tr:e,dispatch:t})=>{const{selection:r}=e,{ranges:i}=r;return t&&i.forEach(({$from:o,$to:s})=>{n.doc.nodesBetween(o.pos,s.pos,(a,l)=>{if(a.type.isText)return;const{doc:c,mapping:u}=e,d=c.resolve(u.map(l)),h=c.resolve(u.map(l+a.nodeSize)),f=d.blockRange(h);if(!f)return;const p=xs(f);if(a.type.isTextblock){const{defaultType:m}=d.parent.contentMatchAt(d.index());e.setNodeMarkup(f.start,m)}(p||p===0)&&e.lift(f,p)})}),!0},TL=n=>e=>n(e),EL=()=>({state:n,dispatch:e})=>KD(n,e),kL=(n,e)=>({editor:t,tr:r})=>{const{state:i}=t,o=i.doc.slice(n.from,n.to);r.deleteRange(n.from,n.to);const s=r.mapping.map(e);return r.insert(s,o.content),r.setSelection(new J(r.doc.resolve(s-1))),!0},IL=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,r=t.$anchor.node();if(r.content.size>0)return!1;const i=n.selection.$anchor;for(let o=i.depth;o>0;o-=1)if(i.node(o).type===r.type){if(e){const a=i.before(o),l=i.after(o);n.delete(a,l).scrollIntoView()}return!0}return!1},AL=n=>({tr:e,state:t,dispatch:r})=>{const i=ct(n,t.schema),o=e.selection.$anchor;for(let s=o.depth;s>0;s-=1)if(o.node(s).type===i){if(r){const l=o.before(s),c=o.after(s);e.delete(l,c).scrollIntoView()}return!0}return!1},bL=n=>({tr:e,dispatch:t})=>{const{from:r,to:i}=n;return t&&e.delete(r,i),!0},RL=()=>({state:n,dispatch:e})=>OD(n,e),NL=()=>({commands:n})=>n.keyboardShortcut("Enter"),xL=()=>({state:n,dispatch:e})=>jD(n,e);function gu(n,e,t={strict:!0}){const r=Object.keys(e);return r.length?r.every(i=>t.strict?e[i]===n[i]:dg(e[i])?e[i].test(n[i]):e[i]===n[i]):!0}function Q0(n,e,t={}){return n.find(r=>r.type===e&&gu(Object.fromEntries(Object.keys(t).map(i=>[i,r.attrs[i]])),t))}function NC(n,e,t={}){return!!Q0(n,e,t)}function hg(n,e,t){var r;if(!n||!e)return;let i=n.parent.childAfter(n.parentOffset);if((!i.node||!i.node.marks.some(u=>u.type===e))&&(i=n.parent.childBefore(n.parentOffset)),!i.node||!i.node.marks.some(u=>u.type===e)||(t=t||((r=i.node.marks[0])===null||r===void 0?void 0:r.attrs),!Q0([...i.node.marks],e,t)))return;let s=i.index,a=n.start()+i.offset,l=s+1,c=a+i.node.nodeSize;for(;s>0&&NC([...n.parent.child(s-1).marks],e,t);)s-=1,a-=n.parent.child(s).nodeSize;for(;l<n.parent.childCount&&NC([...n.parent.child(l).marks],e,t);)c+=n.parent.child(l).nodeSize,l+=1;return{from:a,to:c}}function xi(n,e){if(typeof n=="string"){if(!e.marks[n])throw Error(`There is no mark type named '${n}'. Maybe you forgot to add the extension?`);return e.marks[n]}return n}const OL=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const o=xi(n,r.schema),{doc:s,selection:a}=t,{$from:l,from:c,to:u}=a;if(i){const d=hg(l,o,e);if(d&&d.from<=c&&d.to>=u){const h=J.create(s,d.from,d.to);t.setSelection(h)}}return!0},ML=n=>e=>{const t=typeof n=="function"?n(e):n;for(let r=0;r<t.length;r+=1)if(t[r](e))return!0;return!1};function Y0(n){return n instanceof J}function zi(n=0,e=0,t=0){return Math.min(Math.max(n,e),t)}function J0(n,e=null){if(!e)return null;const t=Z.atStart(n),r=Z.atEnd(n);if(e==="start"||e===!0)return t;if(e==="end")return r;const i=t.from,o=r.to;return e==="all"?J.create(n,zi(0,i,o),zi(n.content.size,i,o)):J.create(n,zi(e,i,o),zi(e,i,o))}function _L(){return navigator.platform==="Android"||/android/i.test(navigator.userAgent)}function fg(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}const PL=(n=null,e={})=>({editor:t,view:r,tr:i,dispatch:o})=>{e={scrollIntoView:!0,...e};const s=()=>{(fg()||_L())&&r.dom.focus(),requestAnimationFrame(()=>{t.isDestroyed||(r.focus(),e!=null&&e.scrollIntoView&&t.commands.scrollIntoView())})};if(r.hasFocus()&&n===null||n===!1)return!0;if(o&&n===null&&!Y0(t.state.selection))return s(),!0;const a=J0(i.doc,n)||t.state.selection,l=t.state.selection.eq(a);return o&&(l||i.setSelection(a),l&&i.storedMarks&&i.setStoredMarks(i.storedMarks),s()),!0},DL=(n,e)=>t=>n.every((r,i)=>e(r,{...t,index:i})),LL=(n,e)=>({tr:t,commands:r})=>r.insertContentAt({from:t.selection.from,to:t.selection.to},n,e),X0=n=>{const e=n.childNodes;for(let t=e.length-1;t>=0;t-=1){const r=e[t];r.nodeType===3&&r.nodeValue&&/^(\n\s\s|\n)$/.test(r.nodeValue)?n.removeChild(r):r.nodeType===1&&X0(r)}return n};function Gl(n){const e=`<body>${n}</body>`,t=new window.DOMParser().parseFromString(e,"text/html").body;return X0(t)}function yu(n,e,t){if(n instanceof gi||n instanceof x)return n;t={slice:!0,parseOptions:{},...t};const r=typeof n=="object"&&n!==null,i=typeof n=="string";if(r)try{if(Array.isArray(n)&&n.length>0)return x.fromArray(n.map(a=>e.nodeFromJSON(a)));const s=e.nodeFromJSON(n);return t.errorOnInvalidContent&&s.check(),s}catch(o){if(t.errorOnInvalidContent)throw new Error("[tiptap error]: Invalid JSON content",{cause:o});return console.warn("[tiptap warn]: Invalid content.","Passed value:",n,"Error:",o),yu("",e,t)}if(i){if(t.errorOnInvalidContent){let s=!1,a="";const l=new zk({topNode:e.spec.topNode,marks:e.spec.marks,nodes:e.spec.nodes.append({__tiptap__private__unknown__catch__all__node:{content:"inline*",group:"block",parseDOM:[{tag:"*",getAttrs:c=>(s=!0,a=typeof c=="string"?c:c.outerHTML,null)}]}})});if(t.slice?ya.fromSchema(l).parseSlice(Gl(n),t.parseOptions):ya.fromSchema(l).parse(Gl(n),t.parseOptions),t.errorOnInvalidContent&&s)throw new Error("[tiptap error]: Invalid HTML content",{cause:new Error(`Invalid element found: ${a}`)})}const o=ya.fromSchema(e);return t.slice?o.parseSlice(Gl(n),t.parseOptions).content:o.parse(Gl(n),t.parseOptions)}return yu("",e,t)}function UL(n,e,t){const r=n.steps.length-1;if(r<e)return;const i=n.steps[r];if(!(i instanceof ot||i instanceof at))return;const o=n.mapping.maps[r];let s=0;o.forEach((a,l,c,u)=>{s===0&&(s=u)}),n.setSelection(Z.near(n.doc.resolve(s),t))}const HL=n=>!("type"in n),FL=(n,e,t)=>({tr:r,dispatch:i,editor:o})=>{var s;if(i){t={parseOptions:o.options.parseOptions,updateSelection:!0,applyInputRules:!1,applyPasteRules:!1,...t};let a;try{a=yu(e,o.schema,{parseOptions:{preserveWhitespace:"full",...t.parseOptions},errorOnInvalidContent:(s=t.errorOnInvalidContent)!==null&&s!==void 0?s:o.options.enableContentCheck})}catch(p){return o.emit("contentError",{editor:o,error:p,disableCollaboration:()=>{o.storage.collaboration&&(o.storage.collaboration.isDisabled=!0)}}),!1}let{from:l,to:c}=typeof n=="number"?{from:n,to:n}:{from:n.from,to:n.to},u=!0,d=!0;if((HL(a)?a:[a]).forEach(p=>{p.check(),u=u?p.isText&&p.marks.length===0:!1,d=d?p.isBlock:!1}),l===c&&d){const{parent:p}=r.doc.resolve(l);p.isTextblock&&!p.type.spec.code&&!p.childCount&&(l-=1,c+=1)}let f;if(u){if(Array.isArray(e))f=e.map(p=>p.text||"").join("");else if(e instanceof x){let p="";e.forEach(m=>{m.text&&(p+=m.text)}),f=p}else typeof e=="object"&&e&&e.text?f=e.text:f=e;r.insertText(f,l,c)}else f=a,r.replaceWith(l,c,f);t.updateSelection&&UL(r,r.steps.length-1,-1),t.applyInputRules&&r.setMeta("applyInputRules",{from:l,text:f}),t.applyPasteRules&&r.setMeta("applyPasteRules",{from:l,text:f})}return!0},BL=()=>({state:n,dispatch:e})=>HD(n,e),zL=()=>({state:n,dispatch:e})=>FD(n,e),jL=()=>({state:n,dispatch:e})=>MD(n,e),KL=()=>({state:n,dispatch:e})=>LD(n,e),$L=()=>({state:n,dispatch:e,tr:t})=>{try{const r=td(n.doc,n.selection.$from.pos,-1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},VL=()=>({state:n,dispatch:e,tr:t})=>{try{const r=td(n.doc,n.selection.$from.pos,1);return r==null?!1:(t.join(r,2),e&&e(t),!0)}catch{return!1}},WL=()=>({state:n,dispatch:e})=>_D(n,e),GL=()=>({state:n,dispatch:e})=>PD(n,e);function Z0(){return typeof navigator<"u"?/Mac/.test(navigator.platform):!1}function qL(n){const e=n.split(/-(?!$)/);let t=e[e.length-1];t==="Space"&&(t=" ");let r,i,o,s;for(let a=0;a<e.length-1;a+=1){const l=e[a];if(/^(cmd|meta|m)$/i.test(l))s=!0;else if(/^a(lt)?$/i.test(l))r=!0;else if(/^(c|ctrl|control)$/i.test(l))i=!0;else if(/^s(hift)?$/i.test(l))o=!0;else if(/^mod$/i.test(l))fg()||Z0()?s=!0:i=!0;else throw new Error(`Unrecognized modifier name: ${l}`)}return r&&(t=`Alt-${t}`),i&&(t=`Ctrl-${t}`),s&&(t=`Meta-${t}`),o&&(t=`Shift-${t}`),t}const QL=n=>({editor:e,view:t,tr:r,dispatch:i})=>{const o=qL(n).split(/-(?!$)/),s=o.find(c=>!["Alt","Ctrl","Meta","Shift"].includes(c)),a=new KeyboardEvent("keydown",{key:s==="Space"?" ":s,altKey:o.includes("Alt"),ctrlKey:o.includes("Ctrl"),metaKey:o.includes("Meta"),shiftKey:o.includes("Shift"),bubbles:!0,cancelable:!0}),l=e.captureTransaction(()=>{t.someProp("handleKeyDown",c=>c(t,a))});return l==null||l.steps.forEach(c=>{const u=c.map(r.mapping);u&&i&&r.maybeStep(u)}),!0};function Ja(n,e,t={}){const{from:r,to:i,empty:o}=n.selection,s=e?ct(e,n.schema):null,a=[];n.doc.nodesBetween(r,i,(d,h)=>{if(d.isText)return;const f=Math.max(r,h),p=Math.min(i,h+d.nodeSize);a.push({node:d,from:f,to:p})});const l=i-r,c=a.filter(d=>s?s.name===d.node.type.name:!0).filter(d=>gu(d.node.attrs,t,{strict:!1}));return o?!!c.length:c.reduce((d,h)=>d+h.to-h.from,0)>=l}const YL=(n,e={})=>({state:t,dispatch:r})=>{const i=ct(n,t.schema);return Ja(t,i,e)?BD(t,r):!1},JL=()=>({state:n,dispatch:e})=>$D(n,e),XL=n=>({state:e,dispatch:t})=>{const r=ct(n,e.schema);return ZD(r)(e,t)},ZL=()=>({state:n,dispatch:e})=>zD(n,e);function hd(n,e){return e.nodes[n]?"node":e.marks[n]?"mark":null}function xC(n,e){const t=typeof e=="string"?[e]:e;return Object.keys(n).reduce((r,i)=>(t.includes(i)||(r[i]=n[i]),r),{})}const eU=(n,e)=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=hd(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=ct(n,r.schema)),a==="mark"&&(s=xi(n,r.schema)),i&&t.selection.ranges.forEach(l=>{r.doc.nodesBetween(l.$from.pos,l.$to.pos,(c,u)=>{o&&o===c.type&&t.setNodeMarkup(u,void 0,xC(c.attrs,e)),s&&c.marks.length&&c.marks.forEach(d=>{s===d.type&&t.addMark(u,u+c.nodeSize,s.create(xC(d.attrs,e)))})})}),!0):!1},tU=()=>({tr:n,dispatch:e})=>(e&&n.scrollIntoView(),!0),nU=()=>({tr:n,dispatch:e})=>{if(e){const t=new Rn(n.doc);n.setSelection(t)}return!0},rU=()=>({state:n,dispatch:e})=>DD(n,e),iU=()=>({state:n,dispatch:e})=>UD(n,e),oU=()=>({state:n,dispatch:e})=>VD(n,e),sU=()=>({state:n,dispatch:e})=>qD(n,e),aU=()=>({state:n,dispatch:e})=>GD(n,e);function np(n,e,t={},r={}){return yu(n,e,{slice:!1,parseOptions:t,errorOnInvalidContent:r.errorOnInvalidContent})}const lU=(n,e=!1,t={},r={})=>({editor:i,tr:o,dispatch:s,commands:a})=>{var l,c;const{doc:u}=o;if(t.preserveWhitespace!=="full"){const d=np(n,i.schema,t,{errorOnInvalidContent:(l=r.errorOnInvalidContent)!==null&&l!==void 0?l:i.options.enableContentCheck});return s&&o.replaceWith(0,u.content.size,d).setMeta("preventUpdate",!e),!0}return s&&o.setMeta("preventUpdate",!e),a.insertContentAt({from:0,to:u.content.size},n,{parseOptions:t,errorOnInvalidContent:(c=r.errorOnInvalidContent)!==null&&c!==void 0?c:i.options.enableContentCheck})};function eI(n,e){const t=xi(e,n.schema),{from:r,to:i,empty:o}=n.selection,s=[];o?(n.storedMarks&&s.push(...n.storedMarks),s.push(...n.selection.$head.marks())):n.doc.nodesBetween(r,i,l=>{s.push(...l.marks)});const a=s.find(l=>l.type.name===t.name);return a?{...a.attrs}:{}}function cU(n){for(let e=0;e<n.edgeCount;e+=1){const{type:t}=n.edge(e);if(t.isTextblock&&!t.hasRequiredAttrs())return t}return null}function uU(n,e){for(let t=n.depth;t>0;t-=1){const r=n.node(t);if(e(r))return{pos:t>0?n.before(t):0,start:n.start(t),depth:t,node:r}}}function pg(n){return e=>uU(e.$from,n)}function dU(n,e){const t={from:0,to:n.content.size};return G0(n,t,e)}function hU(n,e){const t=ct(e,n.schema),{from:r,to:i}=n.selection,o=[];n.doc.nodesBetween(r,i,a=>{o.push(a)});const s=o.reverse().find(a=>a.type.name===t.name);return s?{...s.attrs}:{}}function fU(n,e){const t=hd(typeof e=="string"?e:e.name,n.schema);return t==="node"?hU(n,e):t==="mark"?eI(n,e):{}}function tI(n,e,t){const r=[];return n===e?t.resolve(n).marks().forEach(i=>{const o=t.resolve(n),s=hg(o,i.type);s&&r.push({mark:i,...s})}):t.nodesBetween(n,e,(i,o)=>{!i||(i==null?void 0:i.nodeSize)===void 0||r.push(...i.marks.map(s=>({from:o,to:o+i.nodeSize,mark:s})))}),r}function dc(n,e,t){return Object.fromEntries(Object.entries(t).filter(([r])=>{const i=n.find(o=>o.type===e&&o.name===r);return i?i.attribute.keepOnSplit:!1}))}function rp(n,e,t={}){const{empty:r,ranges:i}=n.selection,o=e?xi(e,n.schema):null;if(r)return!!(n.storedMarks||n.selection.$from.marks()).filter(d=>o?o.name===d.type.name:!0).find(d=>gu(d.attrs,t,{strict:!1}));let s=0;const a=[];if(i.forEach(({$from:d,$to:h})=>{const f=d.pos,p=h.pos;n.doc.nodesBetween(f,p,(m,v)=>{if(!m.isText&&!m.marks.length)return;const g=Math.max(f,v),y=Math.min(p,v+m.nodeSize),C=y-g;s+=C,a.push(...m.marks.map(w=>({mark:w,from:g,to:y})))})}),s===0)return!1;const l=a.filter(d=>o?o.name===d.mark.type.name:!0).filter(d=>gu(d.mark.attrs,t,{strict:!1})).reduce((d,h)=>d+h.to-h.from,0),c=a.filter(d=>o?d.mark.type!==o&&d.mark.type.excludes(o):!0).reduce((d,h)=>d+h.to-h.from,0);return(l>0?l+c:l)>=s}function pU(n,e,t={}){if(!e)return Ja(n,null,t)||rp(n,null,t);const r=hd(e,n.schema);return r==="node"?Ja(n,e,t):r==="mark"?rp(n,e,t):!1}function OC(n,e){const{nodeExtensions:t}=cd(e),r=t.find(s=>s.name===n);if(!r)return!1;const i={name:r.name,options:r.options,storage:r.storage},o=ne(j(r,"group",i));return typeof o!="string"?!1:o.split(" ").includes("list")}function fd(n,{checkChildren:e=!0,ignoreWhitespace:t=!1}={}){var r;if(t){if(n.type.name==="hardBreak")return!0;if(n.isText)return/^\s*$/m.test((r=n.text)!==null&&r!==void 0?r:"")}if(n.isText)return!n.text;if(n.isAtom||n.isLeaf)return!1;if(n.content.childCount===0)return!0;if(e){let i=!0;return n.content.forEach(o=>{i!==!1&&(fd(o,{ignoreWhitespace:t,checkChildren:e})||(i=!1))}),i}return!1}function mU(n){return n instanceof G}function gU(n,e,t){var r;const{selection:i}=e;let o=null;if(Y0(i)&&(o=i.$cursor),o){const a=(r=n.storedMarks)!==null&&r!==void 0?r:o.marks();return!!t.isInSet(a)||!a.some(l=>l.type.excludes(t))}const{ranges:s}=i;return s.some(({$from:a,$to:l})=>{let c=a.depth===0?n.doc.inlineContent&&n.doc.type.allowsMarkType(t):!1;return n.doc.nodesBetween(a.pos,l.pos,(u,d,h)=>{if(c)return!1;if(u.isInline){const f=!h||h.type.allowsMarkType(t),p=!!t.isInSet(u.marks)||!u.marks.some(m=>m.type.excludes(t));c=f&&p}return!c}),c})}const yU=(n,e={})=>({tr:t,state:r,dispatch:i})=>{const{selection:o}=t,{empty:s,ranges:a}=o,l=xi(n,r.schema);if(i)if(s){const c=eI(r,l);t.addStoredMark(l.create({...c,...e}))}else a.forEach(c=>{const u=c.$from.pos,d=c.$to.pos;r.doc.nodesBetween(u,d,(h,f)=>{const p=Math.max(f,u),m=Math.min(f+h.nodeSize,d);h.marks.find(g=>g.type===l)?h.marks.forEach(g=>{l===g.type&&t.addMark(p,m,l.create({...g.attrs,...e}))}):t.addMark(p,m,l.create(e))})});return gU(r,t,l)},vU=(n,e)=>({tr:t})=>(t.setMeta(n,e),!0),CU=(n,e={})=>({state:t,dispatch:r,chain:i})=>{const o=ct(n,t.schema);let s;return t.selection.$anchor.sameParent(t.selection.$head)&&(s=t.selection.$anchor.parent.attrs),o.isTextblock?i().command(({commands:a})=>IC(o,{...s,...e})(t)?!0:a.clearNodes()).command(({state:a})=>IC(o,{...s,...e})(a,r)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},SU=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,i=zi(n,0,r.content.size),o=G.create(r,i);e.setSelection(o)}return!0},wU=n=>({tr:e,dispatch:t})=>{if(t){const{doc:r}=e,{from:i,to:o}=typeof n=="number"?{from:n,to:n}:n,s=J.atStart(r).from,a=J.atEnd(r).to,l=zi(i,s,a),c=zi(o,s,a),u=J.create(r,l,c);e.setSelection(u)}return!0},TU=n=>({state:e,dispatch:t})=>{const r=ct(n,e.schema);return nL(r)(e,t)};function MC(n,e){const t=n.storedMarks||n.selection.$to.parentOffset&&n.selection.$from.marks();if(t){const r=t.filter(i=>e==null?void 0:e.includes(i.type.name));n.tr.ensureMarks(r)}}const EU=({keepMarks:n=!0}={})=>({tr:e,state:t,dispatch:r,editor:i})=>{const{selection:o,doc:s}=e,{$from:a,$to:l}=o,c=i.extensionManager.attributes,u=dc(c,a.node().type.name,a.node().attrs);if(o instanceof G&&o.node.isBlock)return!a.parentOffset||!Zo(s,a.pos)?!1:(r&&(n&&MC(t,i.extensionManager.splittableMarks),e.split(a.pos).scrollIntoView()),!0);if(!a.parent.isBlock)return!1;const d=l.parentOffset===l.parent.content.size,h=a.depth===0?void 0:cU(a.node(-1).contentMatchAt(a.indexAfter(-1)));let f=d&&h?[{type:h,attrs:u}]:void 0,p=Zo(e.doc,e.mapping.map(a.pos),1,f);if(!f&&!p&&Zo(e.doc,e.mapping.map(a.pos),1,h?[{type:h}]:void 0)&&(p=!0,f=h?[{type:h,attrs:u}]:void 0),r){if(p&&(o instanceof J&&e.deleteSelection(),e.split(e.mapping.map(a.pos),1,f),h&&!d&&!a.parentOffset&&a.parent.type!==h)){const m=e.mapping.map(a.before()),v=e.doc.resolve(m);a.node(-1).canReplaceWith(v.index(),v.index()+1,h)&&e.setNodeMarkup(e.mapping.map(a.before()),h)}n&&MC(t,i.extensionManager.splittableMarks),e.scrollIntoView()}return p},kU=(n,e={})=>({tr:t,state:r,dispatch:i,editor:o})=>{var s;const a=ct(n,r.schema),{$from:l,$to:c}=r.selection,u=r.selection.node;if(u&&u.isBlock||l.depth<2||!l.sameParent(c))return!1;const d=l.node(-1);if(d.type!==a)return!1;const h=o.extensionManager.attributes;if(l.parent.content.size===0&&l.node(-1).childCount===l.indexAfter(-1)){if(l.depth===2||l.node(-3).type!==a||l.index(-2)!==l.node(-2).childCount-1)return!1;if(i){let g=x.empty;const y=l.index(-1)?1:l.index(-2)?2:3;for(let R=l.depth-y;R>=l.depth-3;R-=1)g=x.from(l.node(R).copy(g));const C=l.indexAfter(-1)<l.node(-2).childCount?1:l.indexAfter(-2)<l.node(-3).childCount?2:3,w={...dc(h,l.node().type.name,l.node().attrs),...e},E=((s=a.contentMatch.defaultType)===null||s===void 0?void 0:s.createAndFill(w))||void 0;g=g.append(x.from(a.createAndFill(null,E)||void 0));const I=l.before(l.depth-(y-1));t.replace(I,l.after(-C),new U(g,4-y,0));let b=-1;t.doc.nodesBetween(I,t.doc.content.size,(R,N)=>{if(b>-1)return!1;R.isTextblock&&R.content.size===0&&(b=N+1)}),b>-1&&t.setSelection(J.near(t.doc.resolve(b))),t.scrollIntoView()}return!0}const f=c.pos===l.end()?d.contentMatchAt(0).defaultType:null,p={...dc(h,d.type.name,d.attrs),...e},m={...dc(h,l.node().type.name,l.node().attrs),...e};t.delete(l.pos,c.pos);const v=f?[{type:a,attrs:p},{type:f,attrs:m}]:[{type:a,attrs:p}];if(!Zo(t.doc,l.pos,2))return!1;if(i){const{selection:g,storedMarks:y}=r,{splittableMarks:C}=o.extensionManager,w=y||g.$to.parentOffset&&g.$from.marks();if(t.split(l.pos,2,v).scrollIntoView(),!w||!i)return!0;const E=w.filter(I=>C.includes(I.type.name));t.ensureMarks(E)}return!0},ph=(n,e)=>{const t=pg(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(Math.max(0,t.pos-1)).before(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Ri(n.doc,t.pos)&&n.join(t.pos),!0},mh=(n,e)=>{const t=pg(s=>s.type===e)(n.selection);if(!t)return!0;const r=n.doc.resolve(t.start).after(t.depth);if(r===void 0)return!0;const i=n.doc.nodeAt(r);return t.node.type===(i==null?void 0:i.type)&&Ri(n.doc,r)&&n.join(r),!0},IU=(n,e,t,r={})=>({editor:i,tr:o,state:s,dispatch:a,chain:l,commands:c,can:u})=>{const{extensions:d,splittableMarks:h}=i.extensionManager,f=ct(n,s.schema),p=ct(e,s.schema),{selection:m,storedMarks:v}=s,{$from:g,$to:y}=m,C=g.blockRange(y),w=v||m.$to.parentOffset&&m.$from.marks();if(!C)return!1;const E=pg(I=>OC(I.type.name,d))(m);if(C.depth>=1&&E&&C.depth-E.depth<=1){if(E.node.type===f)return c.liftListItem(p);if(OC(E.node.type.name,d)&&f.validContent(E.node.content)&&a)return l().command(()=>(o.setNodeMarkup(E.pos,f),!0)).command(()=>ph(o,f)).command(()=>mh(o,f)).run()}return!t||!w||!a?l().command(()=>u().wrapInList(f,r)?!0:c.clearNodes()).wrapInList(f,r).command(()=>ph(o,f)).command(()=>mh(o,f)).run():l().command(()=>{const I=u().wrapInList(f,r),b=w.filter(R=>h.includes(R.type.name));return o.ensureMarks(b),I?!0:c.clearNodes()}).wrapInList(f,r).command(()=>ph(o,f)).command(()=>mh(o,f)).run()},AU=(n,e={},t={})=>({state:r,commands:i})=>{const{extendEmptyMarkRange:o=!1}=t,s=xi(n,r.schema);return rp(r,s,e)?i.unsetMark(s,{extendEmptyMarkRange:o}):i.setMark(s,e)},bU=(n,e,t={})=>({state:r,commands:i})=>{const o=ct(n,r.schema),s=ct(e,r.schema),a=Ja(r,o,t);let l;return r.selection.$anchor.sameParent(r.selection.$head)&&(l=r.selection.$anchor.parent.attrs),a?i.setNode(s,l):i.setNode(o,{...l,...t})},RU=(n,e={})=>({state:t,commands:r})=>{const i=ct(n,t.schema);return Ja(t,i,e)?r.lift(i):r.wrapIn(i,e)},NU=()=>({state:n,dispatch:e})=>{const t=n.plugins;for(let r=0;r<t.length;r+=1){const i=t[r];let o;if(i.spec.isInputRules&&(o=i.getState(n))){if(e){const s=n.tr,a=o.transform;for(let l=a.steps.length-1;l>=0;l-=1)s.step(a.steps[l].invert(a.docs[l]));if(o.text){const l=s.doc.resolve(o.from).marks();s.replaceWith(o.from,o.to,n.schema.text(o.text,l))}else s.delete(o.from,o.to)}return!0}}return!1},xU=()=>({tr:n,dispatch:e})=>{const{selection:t}=n,{empty:r,ranges:i}=t;return r||e&&i.forEach(o=>{n.removeMark(o.$from.pos,o.$to.pos)}),!0},OU=(n,e={})=>({tr:t,state:r,dispatch:i})=>{var o;const{extendEmptyMarkRange:s=!1}=e,{selection:a}=t,l=xi(n,r.schema),{$from:c,empty:u,ranges:d}=a;if(!i)return!0;if(u&&s){let{from:h,to:f}=a;const p=(o=c.marks().find(v=>v.type===l))===null||o===void 0?void 0:o.attrs,m=hg(c,l,p);m&&(h=m.from,f=m.to),t.removeMark(h,f,l)}else d.forEach(h=>{t.removeMark(h.$from.pos,h.$to.pos,l)});return t.removeStoredMark(l),!0},MU=(n,e={})=>({tr:t,state:r,dispatch:i})=>{let o=null,s=null;const a=hd(typeof n=="string"?n:n.name,r.schema);return a?(a==="node"&&(o=ct(n,r.schema)),a==="mark"&&(s=xi(n,r.schema)),i&&t.selection.ranges.forEach(l=>{const c=l.$from.pos,u=l.$to.pos;let d,h,f,p;t.selection.empty?r.doc.nodesBetween(c,u,(m,v)=>{o&&o===m.type&&(f=Math.max(v,c),p=Math.min(v+m.nodeSize,u),d=v,h=m)}):r.doc.nodesBetween(c,u,(m,v)=>{v<c&&o&&o===m.type&&(f=Math.max(v,c),p=Math.min(v+m.nodeSize,u),d=v,h=m),v>=c&&v<=u&&(o&&o===m.type&&t.setNodeMarkup(v,void 0,{...m.attrs,...e}),s&&m.marks.length&&m.marks.forEach(g=>{if(s===g.type){const y=Math.max(v,c),C=Math.min(v+m.nodeSize,u);t.addMark(y,C,s.create({...g.attrs,...e}))}}))}),h&&(d!==void 0&&t.setNodeMarkup(d,void 0,{...h.attrs,...e}),s&&h.marks.length&&h.marks.forEach(m=>{s===m.type&&t.addMark(f,p,s.create({...m.attrs,...e}))}))}),!0):!1},_U=(n,e={})=>({state:t,dispatch:r})=>{const i=ct(n,t.schema);return QD(i,e)(t,r)},PU=(n,e={})=>({state:t,dispatch:r})=>{const i=ct(n,t.schema);return YD(i,e)(t,r)};var DU=Object.freeze({__proto__:null,blur:CL,clearContent:SL,clearNodes:wL,command:TL,createParagraphNear:EL,cut:kL,deleteCurrentNode:IL,deleteNode:AL,deleteRange:bL,deleteSelection:RL,enter:NL,exitCode:xL,extendMarkRange:OL,first:ML,focus:PL,forEach:DL,insertContent:LL,insertContentAt:FL,joinBackward:jL,joinDown:zL,joinForward:KL,joinItemBackward:$L,joinItemForward:VL,joinTextblockBackward:WL,joinTextblockForward:GL,joinUp:BL,keyboardShortcut:QL,lift:YL,liftEmptyBlock:JL,liftListItem:XL,newlineInCode:ZL,resetAttributes:eU,scrollIntoView:tU,selectAll:nU,selectNodeBackward:rU,selectNodeForward:iU,selectParentNode:oU,selectTextblockEnd:sU,selectTextblockStart:aU,setContent:lU,setMark:yU,setMeta:vU,setNode:CU,setNodeSelection:SU,setTextSelection:wU,sinkListItem:TU,splitBlock:EU,splitListItem:kU,toggleList:IU,toggleMark:AU,toggleNode:bU,toggleWrap:RU,undoInputRule:NU,unsetAllMarks:xU,unsetMark:OU,updateAttributes:MU,wrapIn:_U,wrapInList:PU});const LU=Nt.create({name:"commands",addCommands(){return{...DU}}}),UU=Nt.create({name:"drop",addProseMirrorPlugins(){return[new jt({key:new Gn("tiptapDrop"),props:{handleDrop:(n,e,t,r)=>{this.editor.emit("drop",{editor:this.editor,event:e,slice:t,moved:r})}}})]}}),HU=Nt.create({name:"editable",addProseMirrorPlugins(){return[new jt({key:new Gn("editable"),props:{editable:()=>this.editor.options.editable}})]}}),FU=new Gn("focusEvents"),BU=Nt.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:n}=this;return[new jt({key:FU,props:{handleDOMEvents:{focus:(e,t)=>{n.isFocused=!0;const r=n.state.tr.setMeta("focus",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1},blur:(e,t)=>{n.isFocused=!1;const r=n.state.tr.setMeta("blur",{event:t}).setMeta("addToHistory",!1);return e.dispatch(r),!1}}}})]}}),zU=Nt.create({name:"keymap",addKeyboardShortcuts(){const n=()=>this.editor.commands.first(({commands:s})=>[()=>s.undoInputRule(),()=>s.command(({tr:a})=>{const{selection:l,doc:c}=a,{empty:u,$anchor:d}=l,{pos:h,parent:f}=d,p=d.parent.isTextblock&&h>0?a.doc.resolve(h-1):d,m=p.parent.type.spec.isolating,v=d.pos-d.parentOffset,g=m&&p.parent.childCount===1?v===d.pos:Z.atStart(c).from===h;return!u||!f.type.isTextblock||f.textContent.length||!g||g&&d.parent.type.name==="paragraph"?!1:s.clearNodes()}),()=>s.deleteSelection(),()=>s.joinBackward(),()=>s.selectNodeBackward()]),e=()=>this.editor.commands.first(({commands:s})=>[()=>s.deleteSelection(),()=>s.deleteCurrentNode(),()=>s.joinForward(),()=>s.selectNodeForward()]),r={Enter:()=>this.editor.commands.first(({commands:s})=>[()=>s.newlineInCode(),()=>s.createParagraphNear(),()=>s.liftEmptyBlock(),()=>s.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:n,"Mod-Backspace":n,"Shift-Backspace":n,Delete:e,"Mod-Delete":e,"Mod-a":()=>this.editor.commands.selectAll()},i={...r},o={...r,"Ctrl-h":n,"Alt-Backspace":n,"Ctrl-d":e,"Ctrl-Alt-Backspace":e,"Alt-Delete":e,"Alt-d":e,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()};return fg()||Z0()?o:i},addProseMirrorPlugins(){return[new jt({key:new Gn("clearDocument"),appendTransaction:(n,e,t)=>{if(n.some(m=>m.getMeta("composition")))return;const r=n.some(m=>m.docChanged)&&!e.doc.eq(t.doc),i=n.some(m=>m.getMeta("preventClearDocument"));if(!r||i)return;const{empty:o,from:s,to:a}=e.selection,l=Z.atStart(e.doc).from,c=Z.atEnd(e.doc).to;if(o||!(s===l&&a===c)||!fd(t.doc))return;const h=t.tr,f=ad({state:t,transaction:h}),{commands:p}=new ld({editor:this.editor,state:f});if(p.clearNodes(),!!h.steps.length)return h}})]}}),jU=Nt.create({name:"paste",addProseMirrorPlugins(){return[new jt({key:new Gn("tiptapPaste"),props:{handlePaste:(n,e,t)=>{this.editor.emit("paste",{editor:this.editor,event:e,slice:t})}}})]}}),KU=Nt.create({name:"tabindex",addProseMirrorPlugins(){return[new jt({key:new Gn("tabindex"),props:{attributes:()=>this.editor.isEditable?{tabindex:"0"}:{}}})]}});class Pi{get name(){return this.node.type.name}constructor(e,t,r=!1,i=null){this.currentNode=null,this.actualDepth=null,this.isBlock=r,this.resolvedPos=e,this.editor=t,this.currentNode=i}get node(){return this.currentNode||this.resolvedPos.node()}get element(){return this.editor.view.domAtPos(this.pos).node}get depth(){var e;return(e=this.actualDepth)!==null&&e!==void 0?e:this.resolvedPos.depth}get pos(){return this.resolvedPos.pos}get content(){return this.node.content}set content(e){let t=this.from,r=this.to;if(this.isBlock){if(this.content.size===0){console.error(`You can’t set content on a block node. Tried to set content on ${this.name} at ${this.pos}`);return}t=this.from+1,r=this.to-1}this.editor.commands.insertContentAt({from:t,to:r},e)}get attributes(){return this.node.attrs}get textContent(){return this.node.textContent}get size(){return this.node.nodeSize}get from(){return this.isBlock?this.pos:this.resolvedPos.start(this.resolvedPos.depth)}get range(){return{from:this.from,to:this.to}}get to(){return this.isBlock?this.pos+this.size:this.resolvedPos.end(this.resolvedPos.depth)+(this.node.isText?0:1)}get parent(){if(this.depth===0)return null;const e=this.resolvedPos.start(this.resolvedPos.depth-1),t=this.resolvedPos.doc.resolve(e);return new Pi(t,this.editor)}get before(){let e=this.resolvedPos.doc.resolve(this.from-(this.isBlock?1:2));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.from-3)),new Pi(e,this.editor)}get after(){let e=this.resolvedPos.doc.resolve(this.to+(this.isBlock?2:1));return e.depth!==this.depth&&(e=this.resolvedPos.doc.resolve(this.to+3)),new Pi(e,this.editor)}get children(){const e=[];return this.node.content.forEach((t,r)=>{const i=t.isBlock&&!t.isTextblock,o=t.isAtom&&!t.isText,s=this.pos+r+(o?0:1),a=this.resolvedPos.doc.resolve(s);if(!i&&a.depth<=this.depth)return;const l=new Pi(a,this.editor,i,i?t:null);i&&(l.actualDepth=this.depth+1),e.push(new Pi(a,this.editor,i,i?t:null))}),e}get firstChild(){return this.children[0]||null}get lastChild(){const e=this.children;return e[e.length-1]||null}closest(e,t={}){let r=null,i=this.parent;for(;i&&!r;){if(i.node.type.name===e)if(Object.keys(t).length>0){const o=i.node.attrs,s=Object.keys(t);for(let a=0;a<s.length;a+=1){const l=s[a];if(o[l]!==t[l])break}}else r=i;i=i.parent}return r}querySelector(e,t={}){return this.querySelectorAll(e,t,!0)[0]||null}querySelectorAll(e,t={},r=!1){let i=[];if(!this.children||this.children.length===0)return i;const o=Object.keys(t);return this.children.forEach(s=>{r&&i.length>0||(s.node.type.name===e&&o.every(l=>t[l]===s.node.attrs[l])&&i.push(s),!(r&&i.length>0)&&(i=i.concat(s.querySelectorAll(e,t,r))))}),i}setAttribute(e){const{tr:t}=this.editor.state;t.setNodeMarkup(this.from,void 0,{...this.node.attrs,...e}),this.editor.view.dispatch(t)}}const $U=`.ProseMirror {
  position: relative;
}

.ProseMirror {
  word-wrap: break-word;
  white-space: pre-wrap;
  white-space: break-spaces;
  -webkit-font-variant-ligatures: none;
  font-variant-ligatures: none;
  font-feature-settings: "liga" 0; /* the above doesn't seem to work in Edge */
}

.ProseMirror [contenteditable="false"] {
  white-space: normal;
}

.ProseMirror [contenteditable="false"] [contenteditable="true"] {
  white-space: pre-wrap;
}

.ProseMirror pre {
  white-space: pre-wrap;
}

img.ProseMirror-separator {
  display: inline !important;
  border: none !important;
  margin: 0 !important;
  width: 0 !important;
  height: 0 !important;
}

.ProseMirror-gapcursor {
  display: none;
  pointer-events: none;
  position: absolute;
  margin: 0;
}

.ProseMirror-gapcursor:after {
  content: "";
  display: block;
  position: absolute;
  top: -2px;
  width: 20px;
  border-top: 1px solid black;
  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;
}

@keyframes ProseMirror-cursor-blink {
  to {
    visibility: hidden;
  }
}

.ProseMirror-hideselection *::selection {
  background: transparent;
}

.ProseMirror-hideselection *::-moz-selection {
  background: transparent;
}

.ProseMirror-hideselection * {
  caret-color: transparent;
}

.ProseMirror-focused .ProseMirror-gapcursor {
  display: block;
}

.tippy-box[data-animation=fade][data-state=hidden] {
  opacity: 0
}`;function VU(n,e,t){const r=document.querySelector("style[data-tiptap-style]");if(r!==null)return r;const i=document.createElement("style");return e&&i.setAttribute("nonce",e),i.setAttribute("data-tiptap-style",""),i.innerHTML=n,document.getElementsByTagName("head")[0].appendChild(i),i}class WU extends rL{constructor(e={}){super(),this.isFocused=!1,this.isInitialized=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},coreExtensionOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,enableContentCheck:!1,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null,onContentError:({error:t})=>{throw t},onPaste:()=>null,onDrop:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(e),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.on("contentError",this.options.onContentError),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),this.on("drop",({event:t,slice:r,moved:i})=>this.options.onDrop(t,r,i)),this.on("paste",({event:t,slice:r})=>this.options.onPaste(t,r)),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}),this.isInitialized=!0)},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=VU($U,this.options.injectNonce))}setOptions(e={}){this.options={...this.options,...e},!(!this.view||!this.state||this.isDestroyed)&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(e,t=!0){this.setOptions({editable:e}),t&&this.emit("update",{editor:this,transaction:this.state.tr})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(e,t){const r=W0(t)?t(e,[...this.state.plugins]):[...this.state.plugins,e],i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}unregisterPlugin(e){if(this.isDestroyed)return;const t=this.state.plugins;let r=t;if([].concat(e).forEach(o=>{const s=typeof o=="string"?`${o}$`:o.key;r=t.filter(a=>!a.key.startsWith(s))}),t.length===r.length)return;const i=this.state.reconfigure({plugins:r});return this.view.updateState(i),i}createExtensionManager(){var e,t;const i=[...this.options.enableCoreExtensions?[HU,vL.configure({blockSeparator:(t=(e=this.options.coreExtensionOptions)===null||e===void 0?void 0:e.clipboardTextSerializer)===null||t===void 0?void 0:t.blockSeparator}),LU,BU,zU,KU,UU,jU].filter(o=>typeof this.options.enableCoreExtensions=="object"?this.options.enableCoreExtensions[o.name]!==!1:!0):[],...this.options.extensions].filter(o=>["extension","node","mark"].includes(o==null?void 0:o.type));this.extensionManager=new Ko(i,this)}createCommandManager(){this.commandManager=new ld({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){var e;let t;try{t=np(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:this.options.enableContentCheck})}catch(s){if(!(s instanceof Error)||!["[tiptap error]: Invalid JSON content","[tiptap error]: Invalid HTML content"].includes(s.message))throw s;this.emit("contentError",{editor:this,error:s,disableCollaboration:()=>{this.storage.collaboration&&(this.storage.collaboration.isDisabled=!0),this.options.extensions=this.options.extensions.filter(a=>a.name!=="collaboration"),this.createExtensionManager()}}),t=np(this.options.content,this.schema,this.options.parseOptions,{errorOnInvalidContent:!1})}const r=J0(t,this.options.autofocus);this.view=new wD(this.options.element,{...this.options.editorProps,attributes:{role:"textbox",...(e=this.options.editorProps)===null||e===void 0?void 0:e.attributes},dispatchTransaction:this.dispatchTransaction.bind(this),state:jo.create({doc:t,selection:r||void 0})});const i=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(i),this.createNodeViews(),this.prependClass();const o=this.view.dom;o.editor=this}createNodeViews(){this.view.isDestroyed||this.view.setProps({nodeViews:this.extensionManager.nodeViews})}prependClass(){this.view.dom.className=`tiptap ${this.view.dom.className}`}captureTransaction(e){this.isCapturingTransaction=!0,e(),this.isCapturingTransaction=!1;const t=this.capturedTransaction;return this.capturedTransaction=null,t}dispatchTransaction(e){if(this.view.isDestroyed)return;if(this.isCapturingTransaction){if(!this.capturedTransaction){this.capturedTransaction=e;return}e.steps.forEach(s=>{var a;return(a=this.capturedTransaction)===null||a===void 0?void 0:a.step(s)});return}const t=this.state.apply(e),r=!this.state.selection.eq(t.selection);this.emit("beforeTransaction",{editor:this,transaction:e,nextState:t}),this.view.updateState(t),this.emit("transaction",{editor:this,transaction:e}),r&&this.emit("selectionUpdate",{editor:this,transaction:e});const i=e.getMeta("focus"),o=e.getMeta("blur");i&&this.emit("focus",{editor:this,event:i.event,transaction:e}),o&&this.emit("blur",{editor:this,event:o.event,transaction:e}),!(!e.docChanged||e.getMeta("preventUpdate"))&&this.emit("update",{editor:this,transaction:e})}getAttributes(e){return fU(this.state,e)}isActive(e,t){const r=typeof e=="string"?e:null,i=typeof e=="string"?t:e;return pU(this.state,r,i)}getJSON(){return this.state.doc.toJSON()}getHTML(){return ug(this.state.doc.content,this.schema)}getText(e){const{blockSeparator:t=`

`,textSerializers:r={}}=e||{};return dU(this.state.doc,{blockSeparator:t,textSerializers:{...q0(this.schema),...r}})}get isEmpty(){return fd(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){if(this.emit("destroy"),this.view){const e=this.view.dom;e&&e.editor&&delete e.editor,this.view.destroy()}this.removeAllListeners()}get isDestroyed(){var e;return!(!((e=this.view)===null||e===void 0)&&e.docView)}$node(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelector(e,t))||null}$nodes(e,t){var r;return((r=this.$doc)===null||r===void 0?void 0:r.querySelectorAll(e,t))||null}$pos(e){const t=this.state.doc.resolve(e);return new Pi(t,this)}get $doc(){return this.$pos(0)}}function Ss(n){return new ud({find:n.find,handler:({state:e,range:t,match:r})=>{const i=ne(n.getAttributes,void 0,r);if(i===!1||i===null)return null;const{tr:o}=e,s=r[r.length-1],a=r[0];if(s){const l=a.search(/\S/),c=t.from+a.indexOf(s),u=c+s.length;if(tI(t.from,t.to,e.doc).filter(f=>f.mark.type.excluded.find(m=>m===n.type&&m!==f.mark.type)).filter(f=>f.to>c).length)return null;u<t.to&&o.delete(u,t.to),c>t.from&&o.delete(t.from+l,c);const h=t.from+l+s.length;o.addMark(t.from+l,h,n.type.create(i||{})),o.removeStoredMark(n.type)}}})}function GU(n){return new ud({find:n.find,handler:({state:e,range:t,match:r})=>{const i=ne(n.getAttributes,void 0,r)||{},{tr:o}=e,s=t.from;let a=t.to;const l=n.type.create(i);if(r[1]){const c=r[0].lastIndexOf(r[1]);let u=s+c;u>a?u=a:a=u+r[1].length;const d=r[0][r[0].length-1];o.insertText(d,s+r[0].length-1),o.replaceWith(u,a,l)}else if(r[0]){const c=n.type.isInline?s:s-1;o.insert(c,n.type.create(i)).delete(o.mapping.map(s),o.mapping.map(a))}o.scrollIntoView()}})}function ip(n){return new ud({find:n.find,handler:({state:e,range:t,match:r})=>{const i=e.doc.resolve(t.from),o=ne(n.getAttributes,void 0,r)||{};if(!i.node(-1).canReplaceWith(i.index(-1),i.indexAfter(-1),n.type))return null;e.tr.delete(t.from,t.to).setBlockType(t.from,t.from,n.type,o)}})}function Xa(n){return new ud({find:n.find,handler:({state:e,range:t,match:r,chain:i})=>{const o=ne(n.getAttributes,void 0,r)||{},s=e.tr.delete(t.from,t.to),l=s.doc.resolve(t.from).blockRange(),c=l&&Jm(l,n.type,o);if(!c)return null;if(s.wrap(l,c),n.keepMarks&&n.editor){const{selection:d,storedMarks:h}=e,{splittableMarks:f}=n.editor.extensionManager,p=h||d.$to.parentOffset&&d.$from.marks();if(p){const m=p.filter(v=>f.includes(v.type.name));s.ensureMarks(m)}}if(n.keepAttributes){const d=n.type.name==="bulletList"||n.type.name==="orderedList"?"listItem":"taskList";i().updateAttributes(d,o).run()}const u=s.doc.resolve(t.from-1).nodeBefore;u&&u.type===n.type&&Ri(s.doc,t.from-1)&&(!n.joinPredicate||n.joinPredicate(r,u))&&s.join(t.from-1)}})}class Xt{constructor(e={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config={...this.config,...e},this.name=this.config.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=ne(j(this,"addOptions",{name:this.name}))),this.storage=ne(j(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(e={}){return new Xt(e)}configure(e={}){const t=this.extend({...this.config,addOptions:()=>dd(this.options,e)});return t.name=this.name,t.parent=this.parent,t}extend(e={}){const t=new Xt(e);return t.parent=this,this.child=t,t.name=e.name?e.name:t.parent.name,e.defaultOptions&&Object.keys(e.defaultOptions).length>0&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${t.name}".`),t.options=ne(j(t,"addOptions",{name:t.name})),t.storage=ne(j(t,"addStorage",{name:t.name,options:t.options})),t}}function ws(n){return new hL({find:n.find,handler:({state:e,range:t,match:r,pasteEvent:i})=>{const o=ne(n.getAttributes,void 0,r,i);if(o===!1||o===null)return null;const{tr:s}=e,a=r[r.length-1],l=r[0];let c=t.to;if(a){const u=l.search(/\S/),d=t.from+l.indexOf(a),h=d+a.length;if(tI(t.from,t.to,e.doc).filter(p=>p.mark.type.excluded.find(v=>v===n.type&&v!==p.mark.type)).filter(p=>p.to>d).length)return null;h<t.to&&s.delete(h,t.to),d>t.from&&s.delete(t.from+u,d),c=t.from+u+a.length,s.addMark(t.from+u,c,n.type.create(o||{})),s.removeStoredMark(n.type)}}})}function qU(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var nI={exports:{}},gh={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _C;function QU(){if(_C)return gh;_C=1;var n=re;function e(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,i=n.useEffect,o=n.useLayoutEffect,s=n.useDebugValue;function a(d,h){var f=h(),p=r({inst:{value:f,getSnapshot:h}}),m=p[0].inst,v=p[1];return o(function(){m.value=f,m.getSnapshot=h,l(m)&&v({inst:m})},[d,f,h]),i(function(){return l(m)&&v({inst:m}),d(function(){l(m)&&v({inst:m})})},[d]),s(f),f}function l(d){var h=d.getSnapshot;d=d.value;try{var f=h();return!t(d,f)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:a;return gh.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:u,gh}nI.exports=QU();var mg=nI.exports;const YU=(...n)=>e=>{n.forEach(t=>{typeof t=="function"?t(e):t&&(t.current=e)})},JU=({contentComponent:n})=>{const e=mg.useSyncExternalStore(n.subscribe,n.getSnapshot,n.getServerSnapshot);return re.createElement(re.Fragment,null,Object.values(e))};function XU(){const n=new Set;let e={};return{subscribe(t){return n.add(t),()=>{n.delete(t)}},getSnapshot(){return e},getServerSnapshot(){return e},setRenderer(t,r){e={...e,[t]:jb.createPortal(r.reactElement,r.element,t)},n.forEach(i=>i())},removeRenderer(t){const r={...e};delete r[t],e=r,n.forEach(i=>i())}}}class ZU extends re.Component{constructor(e){var t;super(e),this.editorContentRef=re.createRef(),this.initialized=!1,this.state={hasContentComponentInitialized:!!(!((t=e.editor)===null||t===void 0)&&t.contentComponent)}}componentDidMount(){this.init()}componentDidUpdate(){this.init()}init(){const e=this.props.editor;if(e&&!e.isDestroyed&&e.options.element){if(e.contentComponent)return;const t=this.editorContentRef.current;t.append(...e.options.element.childNodes),e.setOptions({element:t}),e.contentComponent=XU(),this.state.hasContentComponentInitialized||(this.unsubscribeToContentComponent=e.contentComponent.subscribe(()=>{this.setState(r=>r.hasContentComponentInitialized?r:{hasContentComponentInitialized:!0}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent()})),e.createNodeViews(),this.initialized=!0}}componentWillUnmount(){const e=this.props.editor;if(!e||(this.initialized=!1,e.isDestroyed||e.view.setProps({nodeViews:{}}),this.unsubscribeToContentComponent&&this.unsubscribeToContentComponent(),e.contentComponent=null,!e.options.element.firstChild))return;const t=document.createElement("div");t.append(...e.options.element.childNodes),e.setOptions({element:t})}render(){const{editor:e,innerRef:t,...r}=this.props;return re.createElement(re.Fragment,null,re.createElement("div",{ref:YU(t,this.editorContentRef),...r}),(e==null?void 0:e.contentComponent)&&re.createElement(JU,{contentComponent:e.contentComponent}))}}const e2=S.forwardRef((n,e)=>{const t=re.useMemo(()=>Math.floor(Math.random()*4294967295).toString(),[n.editor]);return re.createElement(ZU,{key:t,innerRef:e,...n})}),t2=re.memo(e2);var n2=function n(e,t){if(e===t)return!0;if(e&&t&&typeof e=="object"&&typeof t=="object"){if(e.constructor!==t.constructor)return!1;var r,i,o;if(Array.isArray(e)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(!n(e[i],t[i]))return!1;return!0}if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;for(i of e.entries())if(!n(i[1],t.get(i[0])))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(i of e.entries())if(!t.has(i[0]))return!1;return!0}if(ArrayBuffer.isView(e)&&ArrayBuffer.isView(t)){if(r=e.length,r!=t.length)return!1;for(i=r;i--!==0;)if(e[i]!==t[i])return!1;return!0}if(e.constructor===RegExp)return e.source===t.source&&e.flags===t.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===t.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===t.toString();if(o=Object.keys(e),r=o.length,r!==Object.keys(t).length)return!1;for(i=r;i--!==0;)if(!Object.prototype.hasOwnProperty.call(t,o[i]))return!1;for(i=r;i--!==0;){var s=o[i];if(!(s==="_owner"&&e.$$typeof)&&!n(e[s],t[s]))return!1}return!0}return e!==e&&t!==t},r2=qU(n2),rI={exports:{}},yh={};/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PC;function i2(){if(PC)return yh;PC=1;var n=re,e=mg;function t(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:t,i=e.useSyncExternalStore,o=n.useRef,s=n.useEffect,a=n.useMemo,l=n.useDebugValue;return yh.useSyncExternalStoreWithSelector=function(c,u,d,h,f){var p=o(null);if(p.current===null){var m={hasValue:!1,value:null};p.current=m}else m=p.current;p=a(function(){function g(I){if(!y){if(y=!0,C=I,I=h(I),f!==void 0&&m.hasValue){var b=m.value;if(f(b,I))return w=b}return w=I}if(b=w,r(C,I))return b;var R=h(I);return f!==void 0&&f(b,R)?b:(C=I,w=R)}var y=!1,C,w,E=d===void 0?null:d;return[function(){return g(u())},E===null?void 0:function(){return g(E())}]},[u,d,h,f]);var v=i(c,p[0],p[1]);return s(function(){m.hasValue=!0,m.value=v},[v]),l(v),v},yh}rI.exports=i2();var o2=rI.exports;const s2=typeof window<"u"?S.useLayoutEffect:S.useEffect;class a2{constructor(e){this.transactionNumber=0,this.lastTransactionNumber=0,this.subscribers=new Set,this.editor=e,this.lastSnapshot={editor:e,transactionNumber:0},this.getSnapshot=this.getSnapshot.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.watch=this.watch.bind(this),this.subscribe=this.subscribe.bind(this)}getSnapshot(){return this.transactionNumber===this.lastTransactionNumber?this.lastSnapshot:(this.lastTransactionNumber=this.transactionNumber,this.lastSnapshot={editor:this.editor,transactionNumber:this.transactionNumber},this.lastSnapshot)}getServerSnapshot(){return{editor:null,transactionNumber:0}}subscribe(e){return this.subscribers.add(e),()=>{this.subscribers.delete(e)}}watch(e){if(this.editor=e,this.editor){const t=()=>{this.transactionNumber+=1,this.subscribers.forEach(i=>i())},r=this.editor;return r.on("transaction",t),()=>{r.off("transaction",t)}}}}function l2(n){var e;const[t]=S.useState(()=>new a2(n.editor)),r=o2.useSyncExternalStoreWithSelector(t.subscribe,t.getSnapshot,t.getServerSnapshot,n.selector,(e=n.equalityFn)!==null&&e!==void 0?e:r2);return s2(()=>t.watch(n.editor),[n.editor,t]),S.useDebugValue(r),r}const c2=!1,op=typeof window>"u",u2=op||!!(typeof window<"u"&&window.next);class gg{constructor(e){this.editor=null,this.subscriptions=new Set,this.isComponentMounted=!1,this.previousDeps=null,this.instanceId="",this.options=e,this.subscriptions=new Set,this.setEditor(this.getInitialEditor()),this.scheduleDestroy(),this.getEditor=this.getEditor.bind(this),this.getServerSnapshot=this.getServerSnapshot.bind(this),this.subscribe=this.subscribe.bind(this),this.refreshEditorInstance=this.refreshEditorInstance.bind(this),this.scheduleDestroy=this.scheduleDestroy.bind(this),this.onRender=this.onRender.bind(this),this.createEditor=this.createEditor.bind(this)}setEditor(e){this.editor=e,this.instanceId=Math.random().toString(36).slice(2,9),this.subscriptions.forEach(t=>t())}getInitialEditor(){if(this.options.current.immediatelyRender===void 0)return op||u2?null:this.createEditor();if(this.options.current.immediatelyRender&&op&&c2)throw new Error("Tiptap Error: SSR has been detected, and `immediatelyRender` has been set to `true` this is an unsupported configuration that may result in errors, explicitly set `immediatelyRender` to `false` to avoid hydration mismatches.");return this.options.current.immediatelyRender?this.createEditor():null}createEditor(){const e={...this.options.current,onBeforeCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onBeforeCreate)===null||o===void 0?void 0:o.call(i,...r)},onBlur:(...r)=>{var i,o;return(o=(i=this.options.current).onBlur)===null||o===void 0?void 0:o.call(i,...r)},onCreate:(...r)=>{var i,o;return(o=(i=this.options.current).onCreate)===null||o===void 0?void 0:o.call(i,...r)},onDestroy:(...r)=>{var i,o;return(o=(i=this.options.current).onDestroy)===null||o===void 0?void 0:o.call(i,...r)},onFocus:(...r)=>{var i,o;return(o=(i=this.options.current).onFocus)===null||o===void 0?void 0:o.call(i,...r)},onSelectionUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onSelectionUpdate)===null||o===void 0?void 0:o.call(i,...r)},onTransaction:(...r)=>{var i,o;return(o=(i=this.options.current).onTransaction)===null||o===void 0?void 0:o.call(i,...r)},onUpdate:(...r)=>{var i,o;return(o=(i=this.options.current).onUpdate)===null||o===void 0?void 0:o.call(i,...r)},onContentError:(...r)=>{var i,o;return(o=(i=this.options.current).onContentError)===null||o===void 0?void 0:o.call(i,...r)},onDrop:(...r)=>{var i,o;return(o=(i=this.options.current).onDrop)===null||o===void 0?void 0:o.call(i,...r)},onPaste:(...r)=>{var i,o;return(o=(i=this.options.current).onPaste)===null||o===void 0?void 0:o.call(i,...r)}};return new WU(e)}getEditor(){return this.editor}getServerSnapshot(){return null}subscribe(e){return this.subscriptions.add(e),()=>{this.subscriptions.delete(e)}}static compareOptions(e,t){return Object.keys(e).every(r=>["onCreate","onBeforeCreate","onDestroy","onUpdate","onTransaction","onFocus","onBlur","onSelectionUpdate","onContentError","onDrop","onPaste"].includes(r)?!0:r==="extensions"&&e.extensions&&t.extensions?e.extensions.length!==t.extensions.length?!1:e.extensions.every((i,o)=>{var s;return i===((s=t.extensions)===null||s===void 0?void 0:s[o])}):e[r]===t[r])}onRender(e){return()=>(this.isComponentMounted=!0,clearTimeout(this.scheduledDestructionTimeout),this.editor&&!this.editor.isDestroyed&&e.length===0?gg.compareOptions(this.options.current,this.editor.options)||this.editor.setOptions({...this.options.current,editable:this.editor.isEditable}):this.refreshEditorInstance(e),()=>{this.isComponentMounted=!1,this.scheduleDestroy()})}refreshEditorInstance(e){if(this.editor&&!this.editor.isDestroyed){if(this.previousDeps===null){this.previousDeps=e;return}if(this.previousDeps.length===e.length&&this.previousDeps.every((r,i)=>r===e[i]))return}this.editor&&!this.editor.isDestroyed&&this.editor.destroy(),this.setEditor(this.createEditor()),this.previousDeps=e}scheduleDestroy(){const e=this.instanceId,t=this.editor;this.scheduledDestructionTimeout=setTimeout(()=>{if(this.isComponentMounted&&this.instanceId===e){t&&t.setOptions(this.options.current);return}t&&!t.isDestroyed&&(t.destroy(),this.instanceId===e&&this.setEditor(null))},1)}}function d2(n={},e=[]){const t=S.useRef(n);t.current=n;const[r]=S.useState(()=>new gg(t)),i=mg.useSyncExternalStore(r.subscribe,r.getEditor,r.getServerSnapshot);return S.useDebugValue(i),S.useEffect(r.onRender(e)),l2({editor:i,selector:({transactionNumber:o})=>n.shouldRerenderOnTransaction===!1?null:n.immediatelyRender&&o===0?0:o+1}),i}const h2=S.createContext({editor:null});h2.Consumer;const f2=S.createContext({onDragStart:void 0}),p2=()=>S.useContext(f2);re.forwardRef((n,e)=>{const{onDragStart:t}=p2(),r=n.as||"div";return re.createElement(r,{...n,ref:e,"data-node-view-wrapper":"",onDragStart:t,style:{whiteSpace:"normal",...n.style}})});const m2=/^\s*>\s$/,g2=Xt.create({name:"blockquote",addOptions(){return{HTMLAttributes:{}}},content:"block+",group:"block",defining:!0,parseHTML(){return[{tag:"blockquote"}]},renderHTML({HTMLAttributes:n}){return["blockquote",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{setBlockquote:()=>({commands:n})=>n.wrapIn(this.name),toggleBlockquote:()=>({commands:n})=>n.toggleWrap(this.name),unsetBlockquote:()=>({commands:n})=>n.lift(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-b":()=>this.editor.commands.toggleBlockquote()}},addInputRules(){return[Xa({find:m2,type:this.type})]}}),y2=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))$/,v2=/(?:^|\s)(\*\*(?!\s+\*\*)((?:[^*]+))\*\*(?!\s+\*\*))/g,C2=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))$/,S2=/(?:^|\s)(__(?!\s+__)((?:[^_]+))__(?!\s+__))/g,w2=ki.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:n=>n.style.fontWeight!=="normal"&&null},{style:"font-weight=400",clearMark:n=>n.type.name===this.name},{style:"font-weight",getAttrs:n=>/^(bold(er)?|[5-9]\d{2,})$/.test(n)&&null}]},renderHTML({HTMLAttributes:n}){return["strong",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{setBold:()=>({commands:n})=>n.setMark(this.name),toggleBold:()=>({commands:n})=>n.toggleMark(this.name),unsetBold:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[Ss({find:y2,type:this.type}),Ss({find:C2,type:this.type})]},addPasteRules(){return[ws({find:v2,type:this.type}),ws({find:S2,type:this.type})]}}),T2="listItem",DC="textStyle",LC=/^\s*([-+*])\s$/,E2=Xt.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:n}){return["ul",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleBulletList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(T2,this.editor.getAttributes(DC)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let n=Xa({find:LC,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Xa({find:LC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(DC),editor:this.editor})),[n]}}),k2=/(^|[^`])`([^`]+)`(?!`)/,I2=/(^|[^`])`([^`]+)`(?!`)/g,A2=ki.create({name:"code",addOptions(){return{HTMLAttributes:{}}},excludes:"_",code:!0,exitable:!0,parseHTML(){return[{tag:"code"}]},renderHTML({HTMLAttributes:n}){return["code",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{setCode:()=>({commands:n})=>n.setMark(this.name),toggleCode:()=>({commands:n})=>n.toggleMark(this.name),unsetCode:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-e":()=>this.editor.commands.toggleCode()}},addInputRules(){return[Ss({find:k2,type:this.type})]},addPasteRules(){return[ws({find:I2,type:this.type})]}}),b2=/^```([a-z]+)?[\s\n]$/,R2=/^~~~([a-z]+)?[\s\n]$/,N2=Xt.create({name:"codeBlock",addOptions(){return{languageClassPrefix:"language-",exitOnTripleEnter:!0,exitOnArrowDown:!0,defaultLanguage:null,HTMLAttributes:{}}},content:"text*",marks:"",group:"block",code:!0,defining:!0,addAttributes(){return{language:{default:this.options.defaultLanguage,parseHTML:n=>{var e;const{languageClassPrefix:t}=this.options,o=[...((e=n.firstElementChild)===null||e===void 0?void 0:e.classList)||[]].filter(s=>s.startsWith(t)).map(s=>s.replace(t,""))[0];return o||null},rendered:!1}}},parseHTML(){return[{tag:"pre",preserveWhitespace:"full"}]},renderHTML({node:n,HTMLAttributes:e}){return["pre",Ut(this.options.HTMLAttributes,e),["code",{class:n.attrs.language?this.options.languageClassPrefix+n.attrs.language:null},0]]},addCommands(){return{setCodeBlock:n=>({commands:e})=>e.setNode(this.name,n),toggleCodeBlock:n=>({commands:e})=>e.toggleNode(this.name,"paragraph",n)}},addKeyboardShortcuts(){return{"Mod-Alt-c":()=>this.editor.commands.toggleCodeBlock(),Backspace:()=>{const{empty:n,$anchor:e}=this.editor.state.selection,t=e.pos===1;return!n||e.parent.type.name!==this.name?!1:t||!e.parent.textContent.length?this.editor.commands.clearNodes():!1},Enter:({editor:n})=>{if(!this.options.exitOnTripleEnter)return!1;const{state:e}=n,{selection:t}=e,{$from:r,empty:i}=t;if(!i||r.parent.type!==this.type)return!1;const o=r.parentOffset===r.parent.nodeSize-2,s=r.parent.textContent.endsWith(`

`);return!o||!s?!1:n.chain().command(({tr:a})=>(a.delete(r.pos-2,r.pos),!0)).exitCode().run()},ArrowDown:({editor:n})=>{if(!this.options.exitOnArrowDown)return!1;const{state:e}=n,{selection:t,doc:r}=e,{$from:i,empty:o}=t;if(!o||i.parent.type!==this.type||!(i.parentOffset===i.parent.nodeSize-2))return!1;const a=i.after();return a===void 0?!1:r.nodeAt(a)?n.commands.command(({tr:c})=>(c.setSelection(Z.near(r.resolve(a))),!0)):n.commands.exitCode()}}},addInputRules(){return[ip({find:b2,type:this.type,getAttributes:n=>({language:n[1]})}),ip({find:R2,type:this.type,getAttributes:n=>({language:n[1]})})]},addProseMirrorPlugins(){return[new jt({key:new Gn("codeBlockVSCodeHandler"),props:{handlePaste:(n,e)=>{if(!e.clipboardData||this.editor.isActive(this.type.name))return!1;const t=e.clipboardData.getData("text/plain"),r=e.clipboardData.getData("vscode-editor-data"),i=r?JSON.parse(r):void 0,o=i==null?void 0:i.mode;if(!t||!o)return!1;const{tr:s,schema:a}=n.state,l=a.text(t.replace(/\r\n?/g,`
`));return s.replaceSelectionWith(this.type.create({language:o},l)),s.selection.$from.parent.type!==this.type&&s.setSelection(J.near(s.doc.resolve(Math.max(0,s.selection.from-2)))),s.setMeta("paste",!0),n.dispatch(s),!0}}})]}}),x2=Xt.create({name:"doc",topNode:!0,content:"block+"});function O2(n={}){return new jt({view(e){return new M2(e,n)}})}class M2{constructor(e,t){var r;this.editorView=e,this.cursorPos=null,this.element=null,this.timeout=-1,this.width=(r=t.width)!==null&&r!==void 0?r:1,this.color=t.color===!1?void 0:t.color||"black",this.class=t.class,this.handlers=["dragover","dragend","drop","dragleave"].map(i=>{let o=s=>{this[i](s)};return e.dom.addEventListener(i,o),{name:i,handler:o}})}destroy(){this.handlers.forEach(({name:e,handler:t})=>this.editorView.dom.removeEventListener(e,t))}update(e,t){this.cursorPos!=null&&t.doc!=e.state.doc&&(this.cursorPos>e.state.doc.content.size?this.setCursor(null):this.updateOverlay())}setCursor(e){e!=this.cursorPos&&(this.cursorPos=e,e==null?(this.element.parentNode.removeChild(this.element),this.element=null):this.updateOverlay())}updateOverlay(){let e=this.editorView.state.doc.resolve(this.cursorPos),t=!e.parent.inlineContent,r;if(t){let a=e.nodeBefore,l=e.nodeAfter;if(a||l){let c=this.editorView.nodeDOM(this.cursorPos-(a?a.nodeSize:0));if(c){let u=c.getBoundingClientRect(),d=a?u.bottom:u.top;a&&l&&(d=(d+this.editorView.nodeDOM(this.cursorPos).getBoundingClientRect().top)/2),r={left:u.left,right:u.right,top:d-this.width/2,bottom:d+this.width/2}}}}if(!r){let a=this.editorView.coordsAtPos(this.cursorPos);r={left:a.left-this.width/2,right:a.left+this.width/2,top:a.top,bottom:a.bottom}}let i=this.editorView.dom.offsetParent;this.element||(this.element=i.appendChild(document.createElement("div")),this.class&&(this.element.className=this.class),this.element.style.cssText="position: absolute; z-index: 50; pointer-events: none;",this.color&&(this.element.style.backgroundColor=this.color)),this.element.classList.toggle("prosemirror-dropcursor-block",t),this.element.classList.toggle("prosemirror-dropcursor-inline",!t);let o,s;if(!i||i==document.body&&getComputedStyle(i).position=="static")o=-pageXOffset,s=-pageYOffset;else{let a=i.getBoundingClientRect();o=a.left-i.scrollLeft,s=a.top-i.scrollTop}this.element.style.left=r.left-o+"px",this.element.style.top=r.top-s+"px",this.element.style.width=r.right-r.left+"px",this.element.style.height=r.bottom-r.top+"px"}scheduleRemoval(e){clearTimeout(this.timeout),this.timeout=setTimeout(()=>this.setCursor(null),e)}dragover(e){if(!this.editorView.editable)return;let t=this.editorView.posAtCoords({left:e.clientX,top:e.clientY}),r=t&&t.inside>=0&&this.editorView.state.doc.nodeAt(t.inside),i=r&&r.type.spec.disableDropCursor,o=typeof i=="function"?i(this.editorView,t,e):i;if(t&&!o){let s=t.pos;if(this.editorView.dragging&&this.editorView.dragging.slice){let a=Xk(this.editorView.state.doc,s,this.editorView.dragging.slice);a!=null&&(s=a)}this.setCursor(s),this.scheduleRemoval(5e3)}}dragend(){this.scheduleRemoval(20)}drop(){this.scheduleRemoval(20)}dragleave(e){(e.target==this.editorView.dom||!this.editorView.dom.contains(e.relatedTarget))&&this.setCursor(null)}}const _2=Nt.create({name:"dropCursor",addOptions(){return{color:"currentColor",width:1,class:void 0}},addProseMirrorPlugins(){return[O2(this.options)]}});class Be extends Z{constructor(e){super(e,e)}map(e,t){let r=e.resolve(t.map(this.head));return Be.valid(r)?new Be(r):Z.near(r)}content(){return U.empty}eq(e){return e instanceof Be&&e.head==this.head}toJSON(){return{type:"gapcursor",pos:this.head}}static fromJSON(e,t){if(typeof t.pos!="number")throw new RangeError("Invalid input for GapCursor.fromJSON");return new Be(e.resolve(t.pos))}getBookmark(){return new yg(this.anchor)}static valid(e){let t=e.parent;if(t.isTextblock||!P2(e)||!D2(e))return!1;let r=t.type.spec.allowGapCursor;if(r!=null)return r;let i=t.contentMatchAt(e.index()).defaultType;return i&&i.isTextblock}static findGapCursorFrom(e,t,r=!1){e:for(;;){if(!r&&Be.valid(e))return e;let i=e.pos,o=null;for(let s=e.depth;;s--){let a=e.node(s);if(t>0?e.indexAfter(s)<a.childCount:e.index(s)>0){o=a.child(t>0?e.indexAfter(s):e.index(s)-1);break}else if(s==0)return null;i+=t;let l=e.doc.resolve(i);if(Be.valid(l))return l}for(;;){let s=t>0?o.firstChild:o.lastChild;if(!s){if(o.isAtom&&!o.isText&&!G.isSelectable(o)){e=e.doc.resolve(i+o.nodeSize*t),r=!1;continue e}break}o=s,i+=t;let a=e.doc.resolve(i);if(Be.valid(a))return a}return null}}}Be.prototype.visible=!1;Be.findFrom=Be.findGapCursorFrom;Z.jsonID("gapcursor",Be);class yg{constructor(e){this.pos=e}map(e){return new yg(e.map(this.pos))}resolve(e){let t=e.resolve(this.pos);return Be.valid(t)?new Be(t):Z.near(t)}}function P2(n){for(let e=n.depth;e>=0;e--){let t=n.index(e),r=n.node(e);if(t==0){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t-1);;i=i.lastChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function D2(n){for(let e=n.depth;e>=0;e--){let t=n.indexAfter(e),r=n.node(e);if(t==r.childCount){if(r.type.spec.isolating)return!0;continue}for(let i=r.child(t);;i=i.firstChild){if(i.childCount==0&&!i.inlineContent||i.isAtom||i.type.spec.isolating)return!0;if(i.inlineContent)return!1}}return!0}function L2(){return new jt({props:{decorations:B2,createSelectionBetween(n,e,t){return e.pos==t.pos&&Be.valid(t)?new Be(t):null},handleClick:H2,handleKeyDown:U2,handleDOMEvents:{beforeinput:F2}}})}const U2=H0({ArrowLeft:ql("horiz",-1),ArrowRight:ql("horiz",1),ArrowUp:ql("vert",-1),ArrowDown:ql("vert",1)});function ql(n,e){const t=n=="vert"?e>0?"down":"up":e>0?"right":"left";return function(r,i,o){let s=r.selection,a=e>0?s.$to:s.$from,l=s.empty;if(s instanceof J){if(!o.endOfTextblock(t)||a.depth==0)return!1;l=!1,a=r.doc.resolve(e>0?a.after():a.before())}let c=Be.findGapCursorFrom(a,e,l);return c?(i&&i(r.tr.setSelection(new Be(c))),!0):!1}}function H2(n,e,t){if(!n||!n.editable)return!1;let r=n.state.doc.resolve(e);if(!Be.valid(r))return!1;let i=n.posAtCoords({left:t.clientX,top:t.clientY});return i&&i.inside>-1&&G.isSelectable(n.state.doc.nodeAt(i.inside))?!1:(n.dispatch(n.state.tr.setSelection(new Be(r))),!0)}function F2(n,e){if(e.inputType!="insertCompositionText"||!(n.state.selection instanceof Be))return!1;let{$from:t}=n.state.selection,r=t.parent.contentMatchAt(t.index()).findWrapping(n.state.schema.nodes.text);if(!r)return!1;let i=x.empty;for(let s=r.length-1;s>=0;s--)i=x.from(r[s].createAndFill(null,i));let o=n.state.tr.replace(t.pos,t.pos,new U(i,0,0));return o.setSelection(J.near(o.doc.resolve(t.pos+1))),n.dispatch(o),!1}function B2(n){if(!(n.selection instanceof Be))return null;let e=document.createElement("div");return e.className="ProseMirror-gapcursor",Ve.create(n.doc,[pn.widget(n.selection.head,e,{key:"gapcursor"})])}const z2=Nt.create({name:"gapCursor",addProseMirrorPlugins(){return[L2()]},extendNodeSchema(n){var e;const t={name:n.name,options:n.options,storage:n.storage};return{allowGapCursor:(e=ne(j(n,"allowGapCursor",t)))!==null&&e!==void 0?e:null}}}),j2=Xt.create({name:"hardBreak",addOptions(){return{keepMarks:!0,HTMLAttributes:{}}},inline:!0,group:"inline",selectable:!1,linebreakReplacement:!0,parseHTML(){return[{tag:"br"}]},renderHTML({HTMLAttributes:n}){return["br",Ut(this.options.HTMLAttributes,n)]},renderText(){return`
`},addCommands(){return{setHardBreak:()=>({commands:n,chain:e,state:t,editor:r})=>n.first([()=>n.exitCode(),()=>n.command(()=>{const{selection:i,storedMarks:o}=t;if(i.$from.parent.type.spec.isolating)return!1;const{keepMarks:s}=this.options,{splittableMarks:a}=r.extensionManager,l=o||i.$to.parentOffset&&i.$from.marks();return e().insertContent({type:this.name}).command(({tr:c,dispatch:u})=>{if(u&&l&&s){const d=l.filter(h=>a.includes(h.type.name));c.ensureMarks(d)}return!0}).run()})])}},addKeyboardShortcuts(){return{"Mod-Enter":()=>this.editor.commands.setHardBreak(),"Shift-Enter":()=>this.editor.commands.setHardBreak()}}}),K2=Xt.create({name:"heading",addOptions(){return{levels:[1,2,3,4,5,6],HTMLAttributes:{}}},content:"inline*",group:"block",defining:!0,addAttributes(){return{level:{default:1,rendered:!1}}},parseHTML(){return this.options.levels.map(n=>({tag:`h${n}`,attrs:{level:n}}))},renderHTML({node:n,HTMLAttributes:e}){return[`h${this.options.levels.includes(n.attrs.level)?n.attrs.level:this.options.levels[0]}`,Ut(this.options.HTMLAttributes,e),0]},addCommands(){return{setHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.setNode(this.name,n):!1,toggleHeading:n=>({commands:e})=>this.options.levels.includes(n.level)?e.toggleNode(this.name,"paragraph",n):!1}},addKeyboardShortcuts(){return this.options.levels.reduce((n,e)=>({...n,[`Mod-Alt-${e}`]:()=>this.editor.commands.toggleHeading({level:e})}),{})},addInputRules(){return this.options.levels.map(n=>ip({find:new RegExp(`^(#{${Math.min(...this.options.levels)},${n}})\\s$`),type:this.type,getAttributes:{level:n}}))}});var vu=200,lt=function(){};lt.prototype.append=function(e){return e.length?(e=lt.from(e),!this.length&&e||e.length<vu&&this.leafAppend(e)||this.length<vu&&e.leafPrepend(this)||this.appendInner(e)):this};lt.prototype.prepend=function(e){return e.length?lt.from(e).append(this):this};lt.prototype.appendInner=function(e){return new $2(this,e)};lt.prototype.slice=function(e,t){return e===void 0&&(e=0),t===void 0&&(t=this.length),e>=t?lt.empty:this.sliceInner(Math.max(0,e),Math.min(this.length,t))};lt.prototype.get=function(e){if(!(e<0||e>=this.length))return this.getInner(e)};lt.prototype.forEach=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length),t<=r?this.forEachInner(e,t,r,0):this.forEachInvertedInner(e,t,r,0)};lt.prototype.map=function(e,t,r){t===void 0&&(t=0),r===void 0&&(r=this.length);var i=[];return this.forEach(function(o,s){return i.push(e(o,s))},t,r),i};lt.from=function(e){return e instanceof lt?e:e&&e.length?new iI(e):lt.empty};var iI=function(n){function e(r){n.call(this),this.values=r}n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e;var t={length:{configurable:!0},depth:{configurable:!0}};return e.prototype.flatten=function(){return this.values},e.prototype.sliceInner=function(i,o){return i==0&&o==this.length?this:new e(this.values.slice(i,o))},e.prototype.getInner=function(i){return this.values[i]},e.prototype.forEachInner=function(i,o,s,a){for(var l=o;l<s;l++)if(i(this.values[l],a+l)===!1)return!1},e.prototype.forEachInvertedInner=function(i,o,s,a){for(var l=o-1;l>=s;l--)if(i(this.values[l],a+l)===!1)return!1},e.prototype.leafAppend=function(i){if(this.length+i.length<=vu)return new e(this.values.concat(i.flatten()))},e.prototype.leafPrepend=function(i){if(this.length+i.length<=vu)return new e(i.flatten().concat(this.values))},t.length.get=function(){return this.values.length},t.depth.get=function(){return 0},Object.defineProperties(e.prototype,t),e}(lt);lt.empty=new iI([]);var $2=function(n){function e(t,r){n.call(this),this.left=t,this.right=r,this.length=t.length+r.length,this.depth=Math.max(t.depth,r.depth)+1}return n&&(e.__proto__=n),e.prototype=Object.create(n&&n.prototype),e.prototype.constructor=e,e.prototype.flatten=function(){return this.left.flatten().concat(this.right.flatten())},e.prototype.getInner=function(r){return r<this.left.length?this.left.get(r):this.right.get(r-this.left.length)},e.prototype.forEachInner=function(r,i,o,s){var a=this.left.length;if(i<a&&this.left.forEachInner(r,i,Math.min(o,a),s)===!1||o>a&&this.right.forEachInner(r,Math.max(i-a,0),Math.min(this.length,o)-a,s+a)===!1)return!1},e.prototype.forEachInvertedInner=function(r,i,o,s){var a=this.left.length;if(i>a&&this.right.forEachInvertedInner(r,i-a,Math.max(o,a)-a,s+a)===!1||o<a&&this.left.forEachInvertedInner(r,Math.min(i,a),o,s)===!1)return!1},e.prototype.sliceInner=function(r,i){if(r==0&&i==this.length)return this;var o=this.left.length;return i<=o?this.left.slice(r,i):r>=o?this.right.slice(r-o,i-o):this.left.slice(r,o).append(this.right.slice(0,i-o))},e.prototype.leafAppend=function(r){var i=this.right.leafAppend(r);if(i)return new e(this.left,i)},e.prototype.leafPrepend=function(r){var i=this.left.leafPrepend(r);if(i)return new e(i,this.right)},e.prototype.appendInner=function(r){return this.left.depth>=Math.max(this.right.depth,r.depth)+1?new e(this.left,new e(this.right,r)):new e(this,r)},e}(lt);const V2=500;class Un{constructor(e,t){this.items=e,this.eventCount=t}popEvent(e,t){if(this.eventCount==0)return null;let r=this.items.length;for(;;r--)if(this.items.get(r-1).selection){--r;break}let i,o;t&&(i=this.remapping(r,this.items.length),o=i.maps.length);let s=e.tr,a,l,c=[],u=[];return this.items.forEach((d,h)=>{if(!d.step){i||(i=this.remapping(r,h+1),o=i.maps.length),o--,u.push(d);return}if(i){u.push(new Zn(d.map));let f=d.step.map(i.slice(o)),p;f&&s.maybeStep(f).doc&&(p=s.mapping.maps[s.mapping.maps.length-1],c.push(new Zn(p,void 0,void 0,c.length+u.length))),o--,p&&i.appendMap(p,o)}else s.maybeStep(d.step);if(d.selection)return a=i?d.selection.map(i.slice(o)):d.selection,l=new Un(this.items.slice(0,r).append(u.reverse().concat(c)),this.eventCount-1),!1},this.items.length,0),{remaining:l,transform:s,selection:a}}addTransform(e,t,r,i){let o=[],s=this.eventCount,a=this.items,l=!i&&a.length?a.get(a.length-1):null;for(let u=0;u<e.steps.length;u++){let d=e.steps[u].invert(e.docs[u]),h=new Zn(e.mapping.maps[u],d,t),f;(f=l&&l.merge(h))&&(h=f,u?o.pop():a=a.slice(0,a.length-1)),o.push(h),t&&(s++,t=void 0),i||(l=h)}let c=s-r.depth;return c>G2&&(a=W2(a,c),s-=c),new Un(a.append(o),s)}remapping(e,t){let r=new Wa;return this.items.forEach((i,o)=>{let s=i.mirrorOffset!=null&&o-i.mirrorOffset>=e?r.maps.length-i.mirrorOffset:void 0;r.appendMap(i.map,s)},e,t),r}addMaps(e){return this.eventCount==0?this:new Un(this.items.append(e.map(t=>new Zn(t))),this.eventCount)}rebased(e,t){if(!this.eventCount)return this;let r=[],i=Math.max(0,this.items.length-t),o=e.mapping,s=e.steps.length,a=this.eventCount;this.items.forEach(h=>{h.selection&&a--},i);let l=t;this.items.forEach(h=>{let f=o.getMirror(--l);if(f==null)return;s=Math.min(s,f);let p=o.maps[f];if(h.step){let m=e.steps[f].invert(e.docs[f]),v=h.selection&&h.selection.map(o.slice(l+1,f));v&&a++,r.push(new Zn(p,m,v))}else r.push(new Zn(p))},i);let c=[];for(let h=t;h<s;h++)c.push(new Zn(o.maps[h]));let u=this.items.slice(0,i).append(c).append(r),d=new Un(u,a);return d.emptyItemCount()>V2&&(d=d.compress(this.items.length-r.length)),d}emptyItemCount(){let e=0;return this.items.forEach(t=>{t.step||e++}),e}compress(e=this.items.length){let t=this.remapping(0,e),r=t.maps.length,i=[],o=0;return this.items.forEach((s,a)=>{if(a>=e)i.push(s),s.selection&&o++;else if(s.step){let l=s.step.map(t.slice(r)),c=l&&l.getMap();if(r--,c&&t.appendMap(c,r),l){let u=s.selection&&s.selection.map(t.slice(r));u&&o++;let d=new Zn(c.invert(),l,u),h,f=i.length-1;(h=i.length&&i[f].merge(d))?i[f]=h:i.push(d)}}else s.map&&r--},this.items.length,0),new Un(lt.from(i.reverse()),o)}}Un.empty=new Un(lt.empty,0);function W2(n,e){let t;return n.forEach((r,i)=>{if(r.selection&&e--==0)return t=i,!1}),n.slice(t)}class Zn{constructor(e,t,r,i){this.map=e,this.step=t,this.selection=r,this.mirrorOffset=i}merge(e){if(this.step&&e.step&&!e.selection){let t=e.step.merge(this.step);if(t)return new Zn(t.getMap().invert(),t,this.selection)}}}class qr{constructor(e,t,r,i,o){this.done=e,this.undone=t,this.prevRanges=r,this.prevTime=i,this.prevComposition=o}}const G2=20;function q2(n,e,t,r){let i=t.getMeta(qi),o;if(i)return i.historyState;t.getMeta(J2)&&(n=new qr(n.done,n.undone,null,0,-1));let s=t.getMeta("appendedTransaction");if(t.steps.length==0)return n;if(s&&s.getMeta(qi))return s.getMeta(qi).redo?new qr(n.done.addTransform(t,void 0,r,hc(e)),n.undone,UC(t.mapping.maps),n.prevTime,n.prevComposition):new qr(n.done,n.undone.addTransform(t,void 0,r,hc(e)),null,n.prevTime,n.prevComposition);if(t.getMeta("addToHistory")!==!1&&!(s&&s.getMeta("addToHistory")===!1)){let a=t.getMeta("composition"),l=n.prevTime==0||!s&&n.prevComposition!=a&&(n.prevTime<(t.time||0)-r.newGroupDelay||!Q2(t,n.prevRanges)),c=s?vh(n.prevRanges,t.mapping):UC(t.mapping.maps);return new qr(n.done.addTransform(t,l?e.selection.getBookmark():void 0,r,hc(e)),Un.empty,c,t.time,a??n.prevComposition)}else return(o=t.getMeta("rebased"))?new qr(n.done.rebased(t,o),n.undone.rebased(t,o),vh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition):new qr(n.done.addMaps(t.mapping.maps),n.undone.addMaps(t.mapping.maps),vh(n.prevRanges,t.mapping),n.prevTime,n.prevComposition)}function Q2(n,e){if(!e)return!1;if(!n.docChanged)return!0;let t=!1;return n.mapping.maps[0].forEach((r,i)=>{for(let o=0;o<e.length;o+=2)r<=e[o+1]&&i>=e[o]&&(t=!0)}),t}function UC(n){let e=[];for(let t=n.length-1;t>=0&&e.length==0;t--)n[t].forEach((r,i,o,s)=>e.push(o,s));return e}function vh(n,e){if(!n)return null;let t=[];for(let r=0;r<n.length;r+=2){let i=e.map(n[r],1),o=e.map(n[r+1],-1);i<=o&&t.push(i,o)}return t}function Y2(n,e,t){let r=hc(e),i=qi.get(e).spec.config,o=(t?n.undone:n.done).popEvent(e,r);if(!o)return null;let s=o.selection.resolve(o.transform.doc),a=(t?n.done:n.undone).addTransform(o.transform,e.selection.getBookmark(),i,r),l=new qr(t?a:o.remaining,t?o.remaining:a,null,0,-1);return o.transform.setSelection(s).setMeta(qi,{redo:t,historyState:l})}let Ch=!1,HC=null;function hc(n){let e=n.plugins;if(HC!=e){Ch=!1,HC=e;for(let t=0;t<e.length;t++)if(e[t].spec.historyPreserveItems){Ch=!0;break}}return Ch}const qi=new Gn("history"),J2=new Gn("closeHistory");function X2(n={}){return n={depth:n.depth||100,newGroupDelay:n.newGroupDelay||500},new jt({key:qi,state:{init(){return new qr(Un.empty,Un.empty,null,0,-1)},apply(e,t,r){return q2(t,r,e,n)}},config:n,props:{handleDOMEvents:{beforeinput(e,t){let r=t.inputType,i=r=="historyUndo"?sI:r=="historyRedo"?aI:null;return i?(t.preventDefault(),i(e.state,e.dispatch)):!1}}}})}function oI(n,e){return(t,r)=>{let i=qi.getState(t);if(!i||(n?i.undone:i.done).eventCount==0)return!1;if(r){let o=Y2(i,t,n);o&&r(e?o.scrollIntoView():o)}return!0}}const sI=oI(!1,!0),aI=oI(!0,!0),Z2=Nt.create({name:"history",addOptions(){return{depth:100,newGroupDelay:500}},addCommands(){return{undo:()=>({state:n,dispatch:e})=>sI(n,e),redo:()=>({state:n,dispatch:e})=>aI(n,e)}},addProseMirrorPlugins(){return[X2(this.options)]},addKeyboardShortcuts(){return{"Mod-z":()=>this.editor.commands.undo(),"Shift-Mod-z":()=>this.editor.commands.redo(),"Mod-y":()=>this.editor.commands.redo(),"Mod-я":()=>this.editor.commands.undo(),"Shift-Mod-я":()=>this.editor.commands.redo()}}}),eH=Xt.create({name:"horizontalRule",addOptions(){return{HTMLAttributes:{}}},group:"block",parseHTML(){return[{tag:"hr"}]},renderHTML({HTMLAttributes:n}){return["hr",Ut(this.options.HTMLAttributes,n)]},addCommands(){return{setHorizontalRule:()=>({chain:n,state:e})=>{const{selection:t}=e,{$from:r,$to:i}=t,o=n();return r.parentOffset===0?o.insertContentAt({from:Math.max(r.pos-1,0),to:i.pos},{type:this.name}):mU(t)?o.insertContentAt(i.pos,{type:this.name}):o.insertContent({type:this.name}),o.command(({tr:s,dispatch:a})=>{var l;if(a){const{$to:c}=s.selection,u=c.end();if(c.nodeAfter)c.nodeAfter.isTextblock?s.setSelection(J.create(s.doc,c.pos+1)):c.nodeAfter.isBlock?s.setSelection(G.create(s.doc,c.pos)):s.setSelection(J.create(s.doc,c.pos));else{const d=(l=c.parent.type.contentMatch.defaultType)===null||l===void 0?void 0:l.create();d&&(s.insert(u,d),s.setSelection(J.create(s.doc,u+1)))}s.scrollIntoView()}return!0}).run()}}},addInputRules(){return[GU({find:/^(?:---|—-|___\s|\*\*\*\s)$/,type:this.type})]}}),tH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))$/,nH=/(?:^|\s)(\*(?!\s+\*)((?:[^*]+))\*(?!\s+\*))/g,rH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))$/,iH=/(?:^|\s)(_(?!\s+_)((?:[^_]+))_(?!\s+_))/g,oH=ki.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:n=>n.style.fontStyle!=="normal"&&null},{style:"font-style=normal",clearMark:n=>n.type.name===this.name},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:n}){return["em",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{setItalic:()=>({commands:n})=>n.setMark(this.name),toggleItalic:()=>({commands:n})=>n.toggleMark(this.name),unsetItalic:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[Ss({find:tH,type:this.type}),Ss({find:rH,type:this.type})]},addPasteRules(){return[ws({find:nH,type:this.type}),ws({find:iH,type:this.type})]}}),sH=Xt.create({name:"listItem",addOptions(){return{HTMLAttributes:{},bulletListTypeName:"bulletList",orderedListTypeName:"orderedList"}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:n}){return["li",Ut(this.options.HTMLAttributes,n),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),aH="listItem",FC="textStyle",BC=/^(\d+)\.\s$/,lH=Xt.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:n=>n.hasAttribute("start")?parseInt(n.getAttribute("start")||"",10):1},type:{default:null,parseHTML:n=>n.getAttribute("type")}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:n}){const{start:e,...t}=n;return e===1?["ol",Ut(this.options.HTMLAttributes,t),0]:["ol",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{toggleOrderedList:()=>({commands:n,chain:e})=>this.options.keepAttributes?e().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(aH,this.editor.getAttributes(FC)).run():n.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let n=Xa({find:BC,type:this.type,getAttributes:e=>({start:+e[1]}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(n=Xa({find:BC,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:e=>({start:+e[1],...this.editor.getAttributes(FC)}),joinPredicate:(e,t)=>t.childCount+t.attrs.start===+e[1],editor:this.editor})),[n]}}),cH=Xt.create({name:"paragraph",priority:1e3,addOptions(){return{HTMLAttributes:{}}},group:"block",content:"inline*",parseHTML(){return[{tag:"p"}]},renderHTML({HTMLAttributes:n}){return["p",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{setParagraph:()=>({commands:n})=>n.setNode(this.name)}},addKeyboardShortcuts(){return{"Mod-Alt-0":()=>this.editor.commands.setParagraph()}}}),uH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))$/,dH=/(?:^|\s)(~~(?!\s+~~)((?:[^~]+))~~(?!\s+~~))/g,hH=ki.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:n=>n.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:n}){return["s",Ut(this.options.HTMLAttributes,n),0]},addCommands(){return{setStrike:()=>({commands:n})=>n.setMark(this.name),toggleStrike:()=>({commands:n})=>n.toggleMark(this.name),unsetStrike:()=>({commands:n})=>n.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-s":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[Ss({find:uH,type:this.type})]},addPasteRules(){return[ws({find:dH,type:this.type})]}}),fH=Xt.create({name:"text",group:"inline"}),pH=Nt.create({name:"starterKit",addExtensions(){const n=[];return this.options.bold!==!1&&n.push(w2.configure(this.options.bold)),this.options.blockquote!==!1&&n.push(g2.configure(this.options.blockquote)),this.options.bulletList!==!1&&n.push(E2.configure(this.options.bulletList)),this.options.code!==!1&&n.push(A2.configure(this.options.code)),this.options.codeBlock!==!1&&n.push(N2.configure(this.options.codeBlock)),this.options.document!==!1&&n.push(x2.configure(this.options.document)),this.options.dropcursor!==!1&&n.push(_2.configure(this.options.dropcursor)),this.options.gapcursor!==!1&&n.push(z2.configure(this.options.gapcursor)),this.options.hardBreak!==!1&&n.push(j2.configure(this.options.hardBreak)),this.options.heading!==!1&&n.push(K2.configure(this.options.heading)),this.options.history!==!1&&n.push(Z2.configure(this.options.history)),this.options.horizontalRule!==!1&&n.push(eH.configure(this.options.horizontalRule)),this.options.italic!==!1&&n.push(oH.configure(this.options.italic)),this.options.listItem!==!1&&n.push(sH.configure(this.options.listItem)),this.options.orderedList!==!1&&n.push(lH.configure(this.options.orderedList)),this.options.paragraph!==!1&&n.push(cH.configure(this.options.paragraph)),this.options.strike!==!1&&n.push(hH.configure(this.options.strike)),this.options.text!==!1&&n.push(fH.configure(this.options.text)),n}}),mH=Nt.create({name:"placeholder",addOptions(){return{emptyEditorClass:"is-editor-empty",emptyNodeClass:"is-empty",placeholder:"Write something …",showOnlyWhenEditable:!0,showOnlyCurrent:!0,includeChildren:!1}},addProseMirrorPlugins(){return[new jt({key:new Gn("placeholder"),props:{decorations:({doc:n,selection:e})=>{const t=this.editor.isEditable||!this.options.showOnlyWhenEditable,{anchor:r}=e,i=[];if(!t)return null;const o=this.editor.isEmpty;return n.descendants((s,a)=>{const l=r>=a&&r<=a+s.nodeSize,c=!s.isLeaf&&fd(s);if((l||!this.options.showOnlyCurrent)&&c){const u=[this.options.emptyNodeClass];o&&u.push(this.options.emptyEditorClass);const d=pn.node(a,a+s.nodeSize,{class:u.join(" "),"data-placeholder":typeof this.options.placeholder=="function"?this.options.placeholder({editor:this.editor,node:s,pos:a,hasAnchor:l}):this.options.placeholder});i.push(d)}return this.options.includeChildren}),Ve.create(n,i)}}})]}}),gH=({isOpen:n,onClose:e})=>{const t=d2({extensions:[pH,mH.configure({placeholder:"Write your notes here..."})],content:localStorage.getItem("userNotes")||"",onUpdate:({editor:i})=>{localStorage.setItem("userNotes",i.getHTML())}});if(!n)return null;const r=({onClick:i,children:o,isActive:s=!1})=>k.jsx("button",{onClick:i,className:`p-2 rounded hover:bg-[#2D3139] transition-colors duration-200 ${s?"bg-[#2D3139] text-rose-500":"text-white"}`,children:o});return k.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50 bg-black bg-opacity-50",children:k.jsxs("div",{className:"w-[800px] h-[80vh] flex flex-col bg-[#181b21] bg-opacity-70 backdrop-blur-md rounded-lg shadow-xl border border-[#2D3139]",children:[k.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-[#2D3139]",children:[k.jsx("h2",{className:"text-lg font-semibold text-white",children:"Notes"}),k.jsx("button",{onClick:e,className:"text-gray-400 hover:text-white transition-colors duration-200",children:k.jsx(Df,{size:16})})]}),k.jsxs("div",{className:"p-2 border-b border-[#2D3139] flex gap-2",children:[k.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleBold().run(),isActive:t==null?void 0:t.isActive("bold"),children:k.jsx(bM,{size:18})}),k.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleItalic().run(),isActive:t==null?void 0:t.isActive("italic"),children:k.jsx(NM,{size:18})}),k.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleBulletList().run(),isActive:t==null?void 0:t.isActive("bulletList"),children:k.jsx(MM,{size:18})}),k.jsx(r,{onClick:()=>t==null?void 0:t.chain().focus().toggleOrderedList().run(),isActive:t==null?void 0:t.isActive("orderedList"),children:k.jsx(xM,{size:18})})]}),k.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:k.jsx(t2,{editor:t,className:"prose prose-invert max-w-none focus:outline-none"})})]})})},lI="kanban_sprint_name",zC="DAP - 24",yH="kanban_search_value",vH=()=>{try{return localStorage.getItem(lI)||zC}catch(n){return console.error("Error loading sprint name from localStorage:",n),zC}},CH=n=>{try{localStorage.setItem(lI,n)}catch(e){console.error("Error saving sprint name to localStorage:",e)}},SH=n=>{try{localStorage.setItem(yH,n)}catch(e){console.error("Error saving search value to localStorage:",e)}};function wH(n){switch(n){case 1:return"bg-yellow-500 hover:bg-yellow-600";case 2:return"bg-rose-500 hover:bg-rose-600";default:return"bg-[#181b21] hover:bg-[#1C1F26]"}}function TH({tasks:n,selectedIssueTypes:e,selectedAssignees:t,onIssueTypeChange:r,onAssigneeChange:i,bookmarkFilter:o,onBookmarkFilterChange:s,onRefresh:a,searchValue:l,onSearchChange:c,filteredTasksCount:u}){const[d,h]=S.useState(!1),[f,p]=S.useState(!1),[m,v]=S.useState(""),[g,y]=S.useState(!1),[C,w]=S.useState(!1),[E,I]=S.useState(null),[b,R]=S.useState(!1),[N,_]=S.useState(()=>vH()),V=S.useRef(null),ue=S.useRef(null),me=S.useRef(null),[Ee,Zt]=S.useState(!1),[Kt,He]=S.useState(!1),[D,K]=S.useState(!1),[q,de]=S.useState(!1),[ie,qe]=S.useState(!1),[ye,ee]=S.useState(l),W=S.useCallback((()=>{let L;return le=>{clearTimeout(L),L=setTimeout(()=>{c(le),SH(le)},300)}})(),[c]);S.useEffect(()=>{ee(l)},[l]);const Y=Array.from(new Set(n.map(L=>{if(L.rowData&&typeof L.rowData=="object"){const le=L.rowData["Issue Type"];return le&&typeof le=="string"?le:null}return null}).filter(L=>L!==null))).sort((L,le)=>L.localeCompare(le)),X=Array.from(new Set(n.map(L=>{if(L.rowData&&typeof L.rowData=="object"){const le=L.rowData.Assignee;return le&&typeof le=="string"?le:null}return null}).filter(L=>L!==null))).sort((L,le)=>L.localeCompare(le)),se=X.filter(L=>L.toLowerCase().includes(m.toLowerCase()));S.useEffect(()=>{function L(le){V.current&&!V.current.contains(le.target)&&h(!1),ue.current&&!ue.current.contains(le.target)&&p(!1)}return document.addEventListener("mousedown",L),()=>document.removeEventListener("mousedown",L)},[]),S.useEffect(()=>{ye.trim()&&K(!0)},[]);const B=L=>{_(L),CH(L)},Qe=async()=>{w(!0),I(null),R(!1);try{await a(N),R(!0),setTimeout(()=>R(!1),2e3)}catch(L){I(L instanceof Error?L.message:"Failed to refresh")}finally{w(!1)}},Ne=()=>{e.length===Y.length?r([]):r([...Y])},_e=()=>{t.length===X.length?i([]):i([...X])},ke=()=>{s((o+1)%3)};S.useEffect(()=>{if(!q&&!ie&&!ye.trim()&&D){const le=setTimeout(()=>{K(!1)},150);return()=>clearTimeout(le)}},[q,ie,ye,D]);const vt=()=>{qe(!0),K(!0)},we=()=>{qe(!1)},Ct=()=>{de(!0),K(!0)},$t=()=>{de(!1)},Ie=L=>{ee(L),W(L),L.trim()&&K(!0)};return k.jsxs(k.Fragment,{children:[k.jsxs("div",{className:"flex gap-4 items-center justify-end py-2 px-4 bg-[#000] border-b border-[#181b21]",children:[k.jsxs("div",{className:"flex items-center gap-2 mr-auto",children:[k.jsx("span",{className:"text-white text-sm",children:ye.trim()||e.length>0||t.length>0||o>0?"Filtered Tasks:":"Total Tasks:"}),k.jsx("span",{className:"flex h-5 min-w-[20px] items-center justify-center rounded-full bg-[#181b21] px-2 text-xs text-white border border-[#2D3139]",children:u}),(ye.trim()||e.length>0||t.length>0||o>0)&&k.jsxs("span",{className:"text-gray-400 text-xs",children:["of ",n.length]}),k.jsx("input",{type:"text",value:N,onChange:L=>B(L.target.value),className:"bg-[#181b21] text-white px-3 py-1 rounded-lg border border-[#2D3139] text-sm focus:outline-none focus:border-rose-500 w-20",placeholder:"Sprint Name"}),k.jsxs("button",{onClick:Qe,disabled:C,className:`
              p-2 rounded-full transition-colors duration-200 relative group
              ${E?"bg-rose-500 hover:bg-rose-600":"bg-[#181b21] hover:bg-[#1C1F26]"}
              text-white
            `,title:E||"Refresh tasks",children:[C?k.jsx(Pf,{className:"w-4 h-4 animate-spin"}):b?k.jsx(kk,{className:"w-4 h-4 text-green-500"}):E?k.jsx(PM,{className:"w-4 h-4"}):k.jsx(OM,{className:"w-4 h-4"}),E&&k.jsx("div",{className:"absolute left-1/2 -translate-x-1/2 -bottom-2 transform translate-y-full w-48 bg-rose-500 text-white text-xs rounded-lg py-1 px-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200 z-50",children:E})]})]}),k.jsx("div",{className:"relative flex items-center",onMouseEnter:vt,onMouseLeave:we,children:k.jsxs("div",{className:`
              flex items-center transition-all duration-300 ease-in-out
              ${D?"w-[300px] h-[32px]":"w-8 h-8"}
              bg-[#181b21] hover:bg-[#1C1F26] rounded-full
              border border-transparent hover:border-[#2D3139]
            `,children:[k.jsx("div",{className:"p-2 flex-shrink-0",children:k.jsx(Av,{size:16,className:"transition-transform duration-200 hover:scale-110"})}),D&&k.jsx("input",{ref:me,type:"text",value:ye,onChange:L=>Ie(L.target.value),onFocus:Ct,onBlur:$t,placeholder:"Search by Issue ID, Summary, Assignee...",className:`
                  flex-1 bg-transparent text-white text-sm placeholder-gray-400
                  focus:outline-none transition-all duration-300 ease-in-out
                  ${ye.trim()?"pr-8":"pr-4"}
                `,style:{transition:"opacity 300ms ease-in-out, width 300ms ease-in-out"}}),ye.trim()&&D&&k.jsx("button",{type:"button",onClick:()=>Ie(""),className:"absolute right-2 p-1 text-gray-400 hover:text-white transition-colors duration-200",title:"Clear search",children:k.jsx(Df,{size:14})})]})}),k.jsx("button",{onClick:()=>y(!0),className:"p-2 rounded-full transition-colors duration-200 text-white bg-[#181b21] hover:bg-[#1C1F26]",title:"Open Notes",children:k.jsx(_M,{size:16,className:"transition-transform duration-200 hover:scale-110"})}),k.jsx("button",{onClick:ke,className:`
            p-2 rounded-full transition-colors duration-200
            text-white ${wH(o)}
          `,title:o===0?"Filter bookmarks":o===1?"Show yellow bookmarks":"Show red bookmarks",children:k.jsx(Ek,{size:16,className:`${o>0?"fill-white":""} transition-transform duration-200 hover:scale-110`})}),k.jsxs("div",{ref:V,className:"relative",onMouseEnter:()=>Zt(!0),onMouseLeave:()=>{Zt(!1),d||setTimeout(()=>{Ee||h(!1)},100)},children:[k.jsxs("button",{onClick:()=>h(!d),className:`
              px-3 py-1.5 rounded-full text-sm font-medium transition-colors duration-200
              ${e.length>0?"bg-rose-500 text-white hover:bg-rose-600":"bg-[#181b21] text-white hover:bg-[#1C1F26]"}
            `,children:["Issue Type ",e.length>0&&`(${e.length})`]}),k.jsxs("div",{className:`absolute top-full right-0 mt-2 w-48 rounded-lg shadow-lg z-20 bg-[#181b21] bg-opacity-70 backdrop-blur-md
            transition-all duration-300 ease-in-out ${d||Ee?"opacity-100 max-h-screen":"opacity-0 max-h-0 overflow-hidden"}`,style:{transitionProperty:"opacity, max-height"},children:[k.jsx("div",{className:"p-2",children:k.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer border-b border-[#2D3139]",children:[k.jsx("input",{type:"checkbox",checked:e.length===Y.length,onChange:Ne,className:"mr-2"}),k.jsx("span",{className:"text-sm text-white font-medium",children:"Select All"})]})}),k.jsx("div",{className:"p-2 max-h-60 overflow-y-auto column-scroll",children:Y.map(L=>k.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer",children:[k.jsx("input",{type:"checkbox",checked:e.includes(L),onChange:()=>{const le=e.includes(L)?e.filter(Dr=>Dr!==L):[...e,L];r(le)},className:"mr-2"}),k.jsx("span",{className:"text-sm text-white",children:L})]},L))})]})]}),k.jsxs("div",{ref:ue,className:"relative",onMouseEnter:()=>He(!0),onMouseLeave:()=>{He(!1),f||setTimeout(()=>{Kt||p(!1)},100)},children:[k.jsxs("button",{onClick:()=>p(!f),className:`
              px-3 py-1.5 rounded-full text-sm font-medium transition-colors duration-200
              ${t.length>0?"bg-rose-500 text-white hover:bg-rose-600":"bg-[#181b21] text-white hover:bg-[#1C1F26]"}
            `,children:["Assignee ",t.length>0&&`(${t.length})`]}),k.jsxs("div",{className:`absolute top-full right-0 mt-2 w-80 rounded-lg shadow-lg z-20 bg-[#181b21] bg-opacity-70 backdrop-blur-md
            transition-all duration-300 ease-in-out ${f||Kt?"opacity-100 max-h-screen":"opacity-0 max-h-0 overflow-hidden"}`,style:{transitionProperty:"opacity, max-height"},children:[k.jsxs("div",{className:"p-2",children:[k.jsxs("div",{className:"relative mb-2",children:[k.jsx("input",{type:"text",placeholder:"Search assignees...",value:m,onChange:L=>v(L.target.value),className:"w-full bg-[#0c1015] border border-[#2D3139] rounded-full px-3 py-1.5 pl-8 text-sm text-white placeholder-gray-400 focus:outline-none focus:border-rose-500"}),k.jsx(Av,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),m&&k.jsx("button",{type:"button",onClick:()=>v(""),className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-white",children:k.jsx(Df,{className:"h-4 w-4"})})]}),k.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer border-b border-[#2D3139]",children:[k.jsx("input",{type:"checkbox",checked:t.length===X.length,onChange:_e,className:"mr-2"}),k.jsx("span",{className:"text-sm text-white font-medium",children:"Select All"})]})]}),k.jsx("div",{className:"p-2 max-h-60 overflow-y-auto column-scroll",children:se.map(L=>k.jsxs("label",{className:"flex items-center p-2 hover:bg-[#2D3139] rounded cursor-pointer",children:[k.jsx("input",{type:"checkbox",checked:t.includes(L),onChange:()=>{const le=t.includes(L)?t.filter(Dr=>Dr!==L):[...t,L];i(le)},className:"mr-2"}),k.jsx("span",{className:"text-sm text-white",children:L})]},L))})]})]}),k.jsx(WM,{})]}),k.jsx(gH,{isOpen:g,onClose:()=>y(!1)})]})}const EH="kanban_sprint_name",jC="DAP - 24",kH="kanban_search_value",IH=()=>{try{return localStorage.getItem(EH)||jC}catch(n){return console.error("Error loading sprint name from localStorage:",n),jC}},AH=()=>{try{return localStorage.getItem(kH)||""}catch(n){return console.error("Error loading search value from localStorage:",n),""}};function bH(){const{instance:n}=Fm(),[e,t]=S.useState([]),[r,i]=S.useState([]),[o,s]=S.useState(null),[a,l]=S.useState([]),[c,u]=S.useState([]),[d,h]=S.useState(0),[f,p]=S.useState(()=>AH()),[m,v]=S.useState(!0),[g,y]=S.useState(null),[C,w]=S.useState(!1),[E,I]=S.useState(!1),[b,R]=S.useState(null),[N,_]=S.useState(null),[V,ue]=S.useState(null),[me,Ee]=S.useState(null);S.useEffect(()=>{Zt(IH())},[]);const Zt=async ee=>{try{y(null),w(!1),R(null),_(null),t(se=>se.map(B=>({...B,isHighlighted:!1})));const W=await LM(ee),X=[...Array.from(new Set(W.map(se=>{var B;return(B=se.rowData)==null?void 0:B.Status}))).filter(se=>Uf.includes(se)).map(se=>({id:se,title:se,isHighlighted:!1})),{id:"Other Status",title:"Other Status",isHighlighted:!1}].sort((se,B)=>Bl(se.id)-Bl(B.id));t(X),i(W)}catch(W){console.error("Error loading task data:",W),y("Failed to load tasks. Please try again later."),w(!0)}finally{v(!1)}},Kt=(ee,W)=>{console.log("handleStatusCheckResult called with:",{taskId:ee,targetStatuses:W}),console.log("Current columns before processing:",e.map(Y=>({id:Y.id,title:Y.title,isHighlighted:Y.isHighlighted}))),R(null),_(null),t(Y=>Y.map(X=>({...X,isHighlighted:!1}))),setTimeout(()=>{R(ee),console.log("Set highlighted task ID to:",ee),t(Y=>{const X=[...Y],se=new Set(X.map(B=>B.id));return console.log("Existing column IDs:",Array.from(se)),W.forEach(B=>{if(console.log("Processing target status:",B),se.has(B))console.log("Column already exists for status:",B);else{console.log("Creating new column for status:",B);const Qe={id:B,title:B,isHighlighted:!0},Ne=X.findIndex(_e=>Bl(B)<Bl(_e.id));Ne===-1?X.push(Qe):X.splice(Ne,0,Qe),se.add(B)}}),X.forEach(B=>{const Qe=B.id,Ne=W.includes(Qe);console.log(`Column comparison - ID: "${Qe}", Target statuses: [${W.map(_e=>`"${_e}"`).join(", ")}], shouldHighlight: ${Ne}`),B.isHighlighted=Ne}),console.log("Final columns after processing:",X.map(B=>({id:B.id,title:B.title,isHighlighted:B.isHighlighted}))),X})},10)},He=()=>{console.log("clearHighlighting called"),R(null),_(null),t(ee=>{const W=ee.map(Y=>({...Y,isHighlighted:!1}));return console.log("Cleared highlighting for columns:",W.map(Y=>({id:Y.id,isHighlighted:Y.isHighlighted}))),W})},D=()=>{n.loginPopup(Qc).then(()=>{I(!1),console.log("Login successful")}).catch(ee=>{console.error("Login failed:",ee),I(!1)})},K=()=>{I(!1)},q=Yx(Qx(Wm,{activationConstraint:{distance:3}}));function de(ee){var W,Y;if(((W=ee.active.data.current)==null?void 0:W.type)==="Task"){const X=ee.active.data.current.task;s(X),Ee(X.columnId),console.log("Drag started - Task:",(Y=X.rowData)==null?void 0:Y["Issue Id"],"Original Column:",X.columnId)}}function ie(ee){var _e,ke,vt;const{active:W,over:Y}=ee;if(!Y)return;const X=W.id,se=Y.id;if(X===se)return;const B=((_e=W.data.current)==null?void 0:_e.type)==="Task",Qe=((ke=Y.data.current)==null?void 0:ke.type)==="Task";if(!B)return;B&&Qe&&i(we=>{const Ct=we.findIndex(Ie=>Ie.id===X),$t=we.findIndex(Ie=>Ie.id===se);return we[Ct].columnId!==we[$t].columnId&&(we[Ct].columnId=we[$t].columnId),ma(we,Ct,$t)});const Ne=((vt=Y.data.current)==null?void 0:vt.type)==="Column";B&&Ne&&i(we=>{const Ct=we.findIndex($t=>$t.id===X);return we[Ct].columnId=se,ma(we,Ct,Ct)})}async function qe(ee){var vt,we,Ct,$t;const{active:W,over:Y}=ee;if(s(null),!Y){Ee(null);return}const X=W.id,se=Y.id;if(X===se){Ee(null);return}const B=((vt=W.data.current)==null?void 0:vt.type)==="Task",Qe=((we=Y.data.current)==null?void 0:we.type)==="Task",Ne=((Ct=Y.data.current)==null?void 0:Ct.type)==="Column";if(!B){Ee(null);return}const _e=r.find(Ie=>Ie.id===X);if(!_e){Ee(null);return}let ke;if(Qe){const Ie=r.find(L=>L.id===se);if(!Ie){Ee(null);return}ke=Ie.columnId}else if(Ne)ke=se;else{Ee(null);return}if(console.log("Drag end - Original Column:",me,"New Column:",ke,"Should update:",me&&me!==ke),me&&me!==ke)try{console.log(`Updating task ${($t=_e.rowData)==null?void 0:$t["Issue Id"]} from ${me} to ${ke}`),ue(X),await BM(_e,ke),console.log("Task status updated successfully"),i(Ie=>Ie.map(L=>L.id===X?{...L,rowData:{...L.rowData,Status:ke}}:L)),R(null),_(X),t(Ie=>Ie.map(L=>({...L,isHighlighted:!1})))}catch(Ie){console.error("Failed to update task status:",Ie),i(L=>L.map(le=>le.id===X?{...le,columnId:me,rowData:{...le.rowData,Status:me}}:le)),Ie instanceof Error&&Ie.message==="AUTHENTICATION_REQUIRED"?(console.log("Authentication required - showing login popup"),I(!0)):(y(`Failed to update task status: ${Ie instanceof Error?Ie.message:"Unknown error"}`),w(!0))}finally{ue(null)}Ee(null)}const ye=r.filter(ee=>{const W=typeof ee.rowData=="object"?ee.rowData:{},Y=a.length===0||a.includes(W["Issue Type"]),X=c.length===0||c.includes(W.Assignee),B=JSON.parse(localStorage.getItem("taskBookmarks")||"{}")[W["Issue Id"]]||0,Qe=d===0||B===d,Ne=!f.trim()||(()=>{const _e=f.toLowerCase().trim(),ke=(W["Issue Id"]||"").toLowerCase(),vt=(W.Summary||"").toLowerCase(),we=(W.Assignee||"").toLowerCase();return ke.includes(_e)||vt.includes(_e)||we.includes(_e)})();return Y&&X&&Qe&&Ne});return k.jsxs("div",{className:"h-screen flex flex-col",children:[m&&k.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:k.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-rose-500"})}),C&&g&&k.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:k.jsxs("div",{className:"text-center bg-[#181b21] p-6 rounded-lg shadow-xl border border-[#2D3139]",children:[k.jsx("p",{className:"text-rose-500 mb-4",children:g}),k.jsx("button",{onClick:()=>w(!1),className:"px-4 py-2 bg-rose-500 rounded-lg hover:bg-rose-600 transition-colors",children:"Okay"})]})}),E&&k.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:k.jsxs("div",{className:"text-center bg-[#181b21] p-6 rounded-lg shadow-xl border border-[#2D3139]",children:[k.jsx("p",{className:"text-rose-500 mb-4",children:"Please log in with your Microsoft account to update task status."}),k.jsxs("div",{className:"flex gap-3 justify-center",children:[k.jsx("button",{onClick:D,className:"px-4 py-2 bg-rose-500 rounded-lg hover:bg-rose-600 transition-colors text-white",children:"Login"}),k.jsx("button",{onClick:K,className:"px-4 py-2 bg-gray-600 rounded-lg hover:bg-gray-700 transition-colors text-white",children:"Cancel"})]})]})}),k.jsx(TH,{tasks:r,selectedIssueTypes:a,selectedAssignees:c,onIssueTypeChange:l,onAssigneeChange:u,bookmarkFilter:d,onBookmarkFilterChange:h,onRefresh:Zt,searchValue:f,onSearchChange:p,filteredTasksCount:ye.length}),k.jsxs(GO,{sensors:q,onDragStart:de,onDragOver:ie,onDragEnd:qe,children:[k.jsx("div",{className:"flex-1 overflow-x-auto overflow-y-hidden p-4 hide-scrollbar",onClick:ee=>{ee.target===ee.currentTarget&&He()},children:k.jsx("div",{className:"flex gap-4",children:e.map(ee=>{const W=ye.filter(Y=>Y.columnId===ee.id);return k.jsx("div",{className:"flex flex-col h-[calc(100vh-5.5rem)] min-h-[400px] w-[350px]",children:k.jsx(VM,{column:ee,tasks:W,onStatusCheckResult:Kt,highlightedTaskId:b,successTaskId:N,updatingTaskId:V})},ee.id)})})}),ei.createPortal(k.jsx(hM,{children:o&&k.jsx(Ik,{task:o,onStatusCheckResult:Kt,isHighlighted:b===o.id,isSuccess:N===o.id,isUpdating:V===o.id})}),document.body)]})]})}function RH(){return k.jsx("div",{className:"h-screen bg-[#000] text-white overflow-hidden",children:k.jsx(bH,{})})}const NH=new qu(KE);nT(document.getElementById("root")).render(k.jsx(S.StrictMode,{children:k.jsx(yx,{instance:NH,children:k.jsx(_x,{children:k.jsx(RH,{})})})}));
